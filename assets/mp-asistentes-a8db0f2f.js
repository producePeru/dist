import{_ as G}from"./TableComponent-c5a6df1c.js";import{E as Q,r,u as j,a as q,p as D,k as J,X as S,b as y,o as m,d as k,c as f,w as c,m as R,y as Y,z as h,e as d,t as o,i as X,a2 as K,h as W}from"./index-9c3e0987.js";import{d as Z}from"./downloadExcel-8f9017e0.js";import"./es-6c78391e.js";import{_ as ee}from"./ParticipanteSed-93b98e9d.js";import"./icoexcel-1b303edf.js";import"./selectes-3a5ea8f7.js";import"./SyncOutlined-b244af5a.js";import"./MoreOutlined-97be7c4c.js";import"./FormComponent-f7493c4e.js";import"./quill.snow-e524dd0a.js";const ae={class:"layout-content mp-table"},te={key:1,class:"mp-empresario"},ne={key:2,class:"mp-empresario"},oe=["onClick"],_e={__name:"mp-asistentes",setup(le){const v=Q(),M=JSON.parse(localStorage.getItem("role"))||[],A=r([]),b=r(0),N=r(150),p=r(!1);j();const E=r(!1),g=r(null),w=r(!1),T=r({name:"Cargando..."}),n=q({year:D("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),P=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"ASISTIÃ“",dataIndex:"asistio",width:80,align:"center",fixed:"left"},{title:"EMPRESARIO",dataIndex:"empresario",width:360},{title:"DISCAPACIDAD",dataIndex:"sick",width:120,align:"center"},{title:"VINCULACIÃ“N CON LA MYPE",dataIndex:"roleCompany",width:200,align:"center"},{title:"EMPRESA",dataIndex:"empresa",width:360},{title:"SECTOR ECONÃ“MICO",dataIndex:"economicSector",align:"center",width:120},{title:"RUBRO",dataIndex:"rubro",align:"center",width:180},{title:"ACTIVIDAD COMERCIAL",dataIndex:"comercialActivity",align:"center",width:180}],U=e=>{g.value=e,p.value=!0},$=()=>{u(),p.value=!1},B=()=>{g.value=null,p.value=!0},V=async(e,t)=>{const l=v.params.slug,I=D().format("DD/MM/YYYY HH:mm"),C={slug:l,documentnumber:t.documentnumber,check:e.target.checked,date:I};try{const i=await R({url:"fair/update-attended-status",method:"PUT",data:C});i.status==200&&console.log("status",i.message)}catch(i){console.error("Error de red:",i)}},H=async e=>{try{const t=await R({url:`fair/sed-delete-user/${e.id}`,method:"DELETE"});t.status==200&&(u(),W.success(t.message))}catch(t){console.error("Error de red:",t)}},L=async()=>{w.value=!0;try{const e={},t=v.params.slug;n.name&&(e.name=n.name);let l=`download/mp-attendance-export/${t}`;await Z(l,"inscritos",e)}catch(e){console.error("Error de red:",e)}finally{w.value=!1}},F=async e=>{n.page=e,await u()},z=async e=>{e&&(n.page=1,await u())},O=e=>M.some(t=>e.includes(t.id)),u=async()=>{try{E.value=!0;const e={page:n.page},t=v.params.slug;n.year&&(e.year=D(n.year).format("YYYY")),n.range&&(e.dateStart=n.range[0].format("YYYY/MM/DD"),e.dateEnd=n.range[1].format("YYYY/MM/DD")),n.name&&(e.name=n.name),n.orderby&&(e.orderby=n.orderby);const l=await R({url:`mp/attendance-event/${t}`,method:"GET",params:e});T.value.name=l.eventTitle,A.value=l.data.data,b.value=l.data.total,N.value=l.data.per_page}catch(e){console.error("Error de red:",e)}finally{E.value=!1}};return J(async()=>{await u()}),S("search",n),S("loading",E),S("loadingFile",w),(e,t)=>{var i;const l=y("a-checkbox"),_=y("a-menu-item"),I=y("a-popconfirm"),C=y("a-drawer");return m(),k("div",ae,[f(G,{title:`ðŸ‘© INSCRITOS EN : ${(i=T.value)==null?void 0:i.name}`,new:!1,textNuevo:"NUEVO EVENTO",downloadExcel:!0,placeholderSearch:"Buscar",bread:!0,routeBack:"/admin/mp/capacitaciones",searchYear:!1,rangeDate:!1,columns:P,titleSearch:"FILTRAR POR RUC O DNI",pageSize:N.value,nameTotal:"Inscritos",dataSource:A.value,total:b.value,btnUpdate:!0,onHandleNew:B,onHandleCallFetchData:u,onHandleDownloadExcel:L,onHandleSearch:z,onHandlePaginator:F},{"data-cell":c(({column:s,record:a})=>[s.dataIndex=="asistio"?(m(),Y(l,{key:0,checked:a.attendance,"onUpdate:checked":x=>a.attendance=x,disabled:a.attendance,onChange:x=>V(x,a)},null,8,["checked","onUpdate:checked","disabled","onChange"])):h("",!0),s.dataIndex=="empresario"?(m(),k("div",te,[d("b",null,o(a.name)+" "+o(a.last_name)+" "+o(a.middle_name),1),d("span",null,o(a.typeDocument)+" "+o(a.dni)+" / "+o(a.phone)+" / "+o(a.email),1)])):h("",!0),s.dataIndex=="empresa"?(m(),k("div",ne,[d("b",null,o(a.socialReason),1),d("span",null,o(a.ruc),1),d("span",null,o(a.city)+" - "+o(a.province)+" - "+o(a.district),1)])):h("",!0)]),"custom-options":c(({record:s})=>[O([1,5])?(m(),Y(_,{key:0},{default:c(()=>[d("a",{onClick:a=>U(s)},"Editar",8,oe)]),_:2},1024)):h("",!0),O([1,5])?(m(),Y(_,{key:1},{default:c(()=>[f(I,{placement:"rightBottom",title:`Â¿Quieres eliminar ${s.documentnumber} ?`,onConfirm:a=>H(s)},{icon:c(()=>[f(X(K),{style:{color:"red"}})]),default:c(()=>[t[1]||(t[1]=d("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):h("",!0)]),_:1},8,["title","pageSize","dataSource","total"]),f(C,{open:p.value,"onUpdate:open":t[0]||(t[0]=s=>p.value=s),title:g.value?"EDITAR DATOS DEL PARTICIPANTE":"NUEVO REGISTRO",placement:"right",width:"650"},{default:c(()=>[f(ee,{onCloseDraw:$,info:g.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{_e as default};
