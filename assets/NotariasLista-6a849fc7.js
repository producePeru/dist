import{_ as j}from"./TableComponent-271f8f9e.js";import{l as K,r as m,a as z,j as G,X as Z,a7 as D,b as x,o as n,x as R,h as M,L as J,d as c,c as I,w as S,e as k,F as X,s as Q,ae as W,y as r,q as Y,P as aa,R as B,m as H,t as _}from"./index-74350c01.js";import{d as ea}from"./downloadExcel-8f634942.js";import{_ as ta}from"./FormComponent-1f50a758.js";import{u as ia}from"./selectes-b0188153.js";import"./es-c5ba4105.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-c9f3f3e4.js";import"./quill.snow-fe512795.js";const la={key:1,class:"notary-grid"},na={key:0},oa={__name:"DrawerNotaria.componente",props:["info"],emits:["closeDraw"],setup(V,{emit:U}){K.locale("es");const N=m({name:{type:"iText",label:"NOMBRE DE LA NOTARÍA",name:"name",required:!1,message:"Escribir el nombre de la notaría",disabled:!1,max:100},city_id:{type:"iSelect",label:"REGIÓN",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},addressNotary:{type:"iText",label:"DIRECCIÓN",name:"addressNotary",required:!0,message:"Escribir la dirección de la notaría",disabled:!1,max:200},gastos:{type:"iSlot",name:"iSlotOptions"},testimonio:{type:"iMoney",label:"TESTIMONIO",name:"testimonio",required:!1,message:"Escribir testimonio",disabled:!1,max:20,minValue:0},legalization:{type:"iMoney",label:"LEGALIZACION DE BENEFICIARIO FINAL",name:"legalization",required:!1,message:"Escribir tarifa social",disabled:!1,max:20,minValue:0},biometric:{type:"iMoney",label:"BIOMÉTRICO / HUELLA DIGITAL",name:"biometric",required:!1,message:"Escribir biométrico o huella digital",disabled:!1,placeholder:"Ejemplo: Hasta 3 UIT",max:20,minValue:0},aclaratory:{type:"iMoney",label:"ACLARATORIA",name:"aclaratory",required:!1,message:"Escribir tarifa aclaratoria",disabled:!1,max:20,minValue:0},socio:{type:"iMoney",label:"SOCIO O INTERVINIENTE ADICIONAL",name:"socio",required:!1,message:"Escribir tarifa social",disabled:!1,placeholder:"Ejemplo: Hasta 3 UIT",max:20,minValue:0},conditions:{type:"iText",label:"CONDICIONES",name:"conditions",required:!1,message:"Escribir monto de condiciones",disabled:!1,max:200},etiqueta2:{type:"iLabel",label:"CONTÁCTO",name:"etiqueta2"},contactName:{type:"iText",label:"NOMBRE DE CONTACTO",name:"contactName",required:!1,message:"Escribir nombre de contacto",disabled:!1,max:100},contactEmail:{type:"iText",label:"CORREO ELECTRÓNICO",name:"contactEmail",required:!1,message:"Escribir correo electrónico",disabled:!1,max:100},contactPhone:{type:"iText",label:"TELEFONO",name:"contactPhone",required:!1,message:"Escribir teléfono de contacto",disabled:!1,max:50},etiqueta3:{type:"iLabel",label:"COSTO DE TARIFAS",name:"etiqueta3"},normalTarifa:{type:"iMoney",label:"TARIFA NORMAL",name:"normalTarifa",required:!1,message:"Escribir tarifa normal",disabled:!1,max:20,minValue:0}}),d=ia(),w=U,f=V,E=m(!1),T=m("GUARDAR"),a=z({}),b=m(!1),u=m(null),y=m({id_pnte:[],city_id:[],province_id:[],district_id:[]}),l=m([]),L=()=>{if(l.value.length>=6)return;const t={gasto:null,gastoDetalle:null};l.value.push(t)},P=t=>{l.value.splice(t,1);for(let e=1;e<=6;e++)delete a[`gasto${e}`],delete a[`gasto${e}Detail`];l.value.forEach((e,i)=>{const g=i+1;a[`gasto${g}`]=e.gasto??null,a[`gasto${g}Detail`]=e.gastoDetalle??null})},$=async t=>{t=="city_id"&&(console.log("city_id kakakaka"),await d.fetchProvinces(a.city_id),y.value.province_id=d.provinces,N.value.province_id.disabled=!1),t=="province_id"&&(await d.fetchDistricts(a.province_id),y.value.district_id=d.districts,N.value.district_id.disabled=!1)},q=async t=>{t=="city_id"&&(await d.fetchCities(),a.city_id=null,a.province_id=null,a.district_id=null,y.value.province_id=[],y.value.city_id=d.cities),t=="province_id"&&(a.province_id=null,a.district_id=null,y.value.district_id=[])},F=async()=>{b.value=!0;const t={name:a.name,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,addressNotary:a.addressNotary,gasto1:a.gasto1||null,gasto1Detail:a.gasto1Detail||null,gasto2:a.gasto2||null,gasto2Detail:a.gasto2Detail||null,gasto3:a.gasto3||null,gasto3Detail:a.gasto3Detail||null,gasto4:a.gasto4||null,gasto4Detail:a.gasto4Detail||null,gasto5:a.gasto5||null,gasto5Detail:a.gasto5Detail||null,gasto6:a.gasto6||null,gasto6Detail:a.gasto6Detail||null,testimonio:a.testimonio,legalization:a.legalization,biometric:a.biometric,aclaratory:a.aclaratory,socio:a.socio,conditions:a.conditions,contactName:a.contactName,contactEmail:a.contactEmail,contactPhone:a.contactPhone,normalTarifa:a.normalTarifa,status:1};try{const e=f.info?`notary/update/${f.info.id}`:"notary/create",i=f.info?"PATCH":"POST",g=await B({url:e,method:i,data:t});g.status===200&&(A(),H.success(g.message),w("closeDraw",!0))}catch(e){console.error("Error:",e);const i=document.getElementsByClassName("ant-drawer-body")[0];i&&(i.scrollTop=0)}finally{b.value=!1}},A=()=>{a.name=null,a.city_id=null,a.province_id=null,a.district_id=null,a.addressNotary=null,l.value=[],a.gasto1=null,a.gasto1Detail=null,a.gasto2=null,a.gasto2Detail=null,a.gasto3=null,a.gasto3Detail=null,a.gasto4=null,a.gasto4Detail=null,a.gasto5=null,a.gasto5Detail=null,a.gasto6=null,a.gasto6Detail=null,a.testimonio=null,a.legalization=null,a.biometric=null,a.aclaratory=null,a.socio=null,a.conditions=null,a.contactName=null,a.contactEmail=null,a.contactPhone=null,a.normalTarifa=null},C=async t=>{E.value=!0;try{if(t){a.name=t.name,a.addressNotary=t.addressNotary,a.testimonio=t.testimonio,a.legalization=t.legalization,a.biometric=t.biometric,a.aclaratory=t.aclaratory,a.socio=t.socio,a.conditions=t.conditions,a.contactName=t.contactName,a.contactEmail=t.contactEmail,a.contactPhone=t.contactPhone,a.normalTarifa=t.normalTarifa,l.value=[];for(let e=1;e<=6;e++){const i=`gasto${e}`,g=`gasto${e}Detail`,v=t[i],h=t[g];(v==null||v==="")&&(h==null||h==="")||(a[i]=v??null,a[g]=h??null,l.value.push({gasto:v??null,gastoDetalle:h??null}))}await d.fetchCities(),y.value.city_id=d.cities,a.city_id=t.city_id,await d.fetchProvinces(a.city_id),y.value.province_id=d.provinces,N.value.province_id.disabled=!1,a.province_id=t.province_id,await d.fetchDistricts(a.province_id),y.value.district_id=d.districts,N.value.district_id.disabled=!1,a.district_id=t.district_id}}finally{E.value=!1}};return G(()=>{f.info&&C(f.info)}),Z(()=>f.info,t=>{t?C(t):A()}),D("formState",a),D("loadingState",b),(t,e)=>{const i=x("a-input-number"),g=x("a-form-item"),v=x("a-input"),h=x("a-button");return E.value?(n(),R(M(J),{key:0,style:{color:"#00a6db"}})):(n(),c("div",la,[I(ta,{fields:N.value,options:y.value,btnSaveName:T.value,mayus:!0,resetSelect:u.value,onHandleChangeSelect:$,onHandleFocusSelect:q,onOnSubmit:F},{default:S(({field:o})=>[e[0]||(e[0]=k("h4",{style:{margin:"0 0 0.5rem 0"}},"GASTOS NOTARIALES",-1)),o.name=="iSlotOptions"?(n(),c("div",na,[(n(!0),c(X,null,Q(l.value,(s,p)=>(n(),c("div",{class:"slot-gastos",key:p},[k("div",null,[I(g,{label:`Opción ${p+1} Monto`},{default:S(()=>[I(i,{min:0,style:{width:"100%"},value:a[`gasto${p+1}`],"onUpdate:value":O=>a[`gasto${p+1}`]=O,formatter:O=>`S/ ${O}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:O=>O.replace(/S\/\s?|(,*)/g,"")},null,8,["value","onUpdate:value","formatter","parser"])]),_:2},1032,["label"])]),k("div",null,[I(g,{label:`Opción ${p+1} Detalle`},{default:S(()=>[I(v,{value:a[`gasto${p+1}Detail`],"onUpdate:value":O=>a[`gasto${p+1}Detail`]=O},null,8,["value","onUpdate:value"])]),_:2},1032,["label"])]),p!=0?(n(),R(h,{key:0,type:"text",danger:"",onClick:O=>P(p)},{default:S(()=>[I(M(W))]),_:2},1032,["onClick"])):r("",!0)]))),128))])):r("",!0),l.value.length<6?(n(),R(h,{key:1,type:"primary",shape:"circle",icon:Y(M(aa)),size:"small",onClick:L},null,8,["icon"])):r("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}}};const sa={class:"advisory-table"},ca={key:0},ra={key:1},da={key:2},ua={key:3},ma={key:4},ga={key:5},pa={key:6},_a={key:7},ya={key:8},ha={key:9},Ia={key:10},fa={key:11},va=["onClick"],Aa={__name:"NotariasLista",setup(V){const N=(JSON.parse(localStorage.getItem("role"))||[]).some(e=>e.id===10||e.id===5||e.id===1),d=m([]),w=m(0),f=m(150),E=m(!1),T=m(!1),a=m(!1),b=m(null),u=z({asesor:null,name:null,page:1}),y=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"NOMBRE DE LA NOTARÍA",dataIndex:"name",width:240,fixed:"left"},{title:"REGIÓN",dataIndex:"city_name",width:120},{title:"PROVINCIA",dataIndex:"province_name",width:120},{title:"DISTRITO",dataIndex:"district_name",width:120},{title:"DIRECCIÓN",dataIndex:"addressNotary",width:180},{title:"GASTOS NOTARIALES",children:[{title:"TARIFA SOCIAL",children:[{title:"OPCION 1 (HASTA 1 UIT)",colSpan:2,children:[{dataIndex:"gasto1",width:100,colSpan:0,align:"center"},{dataIndex:"gasto1Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 2",colSpan:2,children:[{dataIndex:"gasto2",width:100,colSpan:0,align:"center"},{dataIndex:"gasto2Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 3",colSpan:2,children:[{dataIndex:"gasto3",width:100,colSpan:0,align:"center"},{dataIndex:"gasto3Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 4",colSpan:2,children:[{dataIndex:"gasto4",width:100,colSpan:0,align:"center"},{dataIndex:"gasto4Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 5",colSpan:2,children:[{dataIndex:"gasto5",width:100,colSpan:0,align:"center"},{dataIndex:"gasto5Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 6",colSpan:2,children:[{dataIndex:"gasto6",width:100,colSpan:0,align:"center"},{dataIndex:"gasto6Detail",width:120,colSpan:0,align:"center"}]}]},{title:"TESTIMONIO",width:150,align:"center",dataIndex:"testimonio"},{title:"LEGALIZACION DE BENEFICIARIO FINAL",width:150,align:"center",dataIndex:"legalization"},{title:"BIOMÉTRICO / HUELLA DIGITAL",width:150,align:"center",dataIndex:"biometric"},{title:"ACLARATORIA",width:150,align:"center",dataIndex:"aclaratory"},{title:"SOCIO O INTERVINIENTE ADICIONAL",width:150,align:"center",dataIndex:"socio"}]},{title:"CONDICIONES",dataIndex:"conditions",width:280},{title:"NOMBRE DE CONTACTO",dataIndex:"contactName",width:200},{title:"CORREO",dataIndex:"contactEmail",width:180},{title:"TELEFONO",dataIndex:"contactPhone",width:100,align:"center"},{title:"TARIFA NORMAL",dataIndex:"normalTarifa",align:"center",width:100},...N?[{title:"DISPONIBLE",dataIndex:"status",width:100,align:"center"}]:[],...N?[{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}]:[]],l=e=>{const i=parseFloat(e);return isNaN(i)?"":`S/ ${i.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})}`},L=()=>{a.value=!1,t()},P=()=>{b.value=null,a.value=!0},$=async()=>{T.value=!0;try{const e={};u.name&&(e.name=u.name),u.city_id&&(e.city_id=u.city_id),await ea("download/notaries","notarias-pnte",e)}catch(e){console.error("Error de red:",e)}finally{T.value=!1}},q=async e=>{u.page=e,await t()},F=async e=>{e&&(u.page=1,await t())},A=e=>{b.value=e,a.value=!0},C=async e=>{try{const i=await B({url:`notary/status/${e}`,method:"PUT"});i.status==200&&(t(),H.success(i.message))}catch(i){console.error("Error de red:",i)}},t=async()=>{E.value=!0;try{const e={page:u.page};u.name&&(e.name=u.name),u.city_id&&(e.city_id=u.city_id);const i=await B({url:"notary/list",method:"GET",params:e});d.value=i.data.data,w.value=i.data.total,f.value=i.data.per_page}catch(e){console.error("Error de red:",e)}finally{E.value=!1}};return G(async()=>{await t()}),D("search",u),D("loading",E),D("loadingFile",T),(e,i)=>{const g=x("a-switch"),v=x("a-menu-item"),h=x("a-drawer");return n(),c("div",sa,[I(j,{title:"NOTARÍAS",new:!0,textNuevo:"NUEVO",placeholderSearch:"Buscar",columns:y,titleSearch:"NOMBRE DE NOTARÍA",pageSize:f.value,nameTotal:"Notarías",cityList:!0,dataSource:d.value,total:w.value,onHandleNew:P,heightTable:350,onHandleDownloadExcel:$,onHandleSearch:F,onHandlePaginator:q},{"data-cell":S(({column:o,record:s})=>[o.dataIndex=="gasto1"?(n(),c("span",ca,_(l(s.gasto1)),1)):r("",!0),o.dataIndex=="gasto2"?(n(),c("span",ra,_(l(s.gasto2)),1)):r("",!0),o.dataIndex=="gasto3"?(n(),c("span",da,_(l(s.gasto3)),1)):r("",!0),o.dataIndex=="gasto4"?(n(),c("span",ua,_(l(s.gasto4)),1)):r("",!0),o.dataIndex=="gasto5"?(n(),c("span",ma,_(l(s.gasto5)),1)):r("",!0),o.dataIndex=="gasto6"?(n(),c("span",ga,_(l(s.gasto6)),1)):r("",!0),o.dataIndex=="testimonio"?(n(),c("span",pa,_(l(s.testimonio)),1)):r("",!0),o.dataIndex=="legalization"?(n(),c("span",_a,_(l(s.legalization)),1)):r("",!0),o.dataIndex=="biometric"?(n(),c("span",ya,_(l(s.biometric)),1)):r("",!0),o.dataIndex=="aclaratory"?(n(),c("span",ha,_(l(s.aclaratory)),1)):r("",!0),o.dataIndex=="socio"?(n(),c("span",Ia,_(l(s.socio)),1)):r("",!0),o.dataIndex=="normalTarifa"?(n(),c("span",fa,_(l(s.normalTarifa)),1)):r("",!0),o.dataIndex=="status"?(n(),R(g,{key:12,checked:s.status,"onUpdate:checked":p=>s.status=p,onChange:p=>C(s.id)},null,8,["checked","onUpdate:checked","onChange"])):r("",!0)]),"custom-options":S(({record:o})=>[I(v,null,{default:S(()=>[k("a",{onClick:s=>A(o)},"Editar",8,va)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),I(h,{width:"900",title:"EDITAR NOTARÍA",open:a.value,"onUpdate:open":i[0]||(i[0]=o=>a.value=o),placement:"right"},{default:S(()=>[I(oa,{onCloseDraw:L,info:b.value},null,8,["info"])]),_:1},8,["open"])])}}};export{Aa as default};
