import{c as n,A as ce,N as q,r as v,a as te,k as W,M as ae,b as p,o as r,s as S,w as s,e as I,d as w,F,y as we,h as z,v as E,O as fe,B as G,m as Y,a3 as Le,a4 as De,t as H,i as B,a5 as he,g as xe,R as Oe,a6 as Pe,J as ee,K as qe,x as Ve,W as Fe,L as Be,p as je,j as He}from"./index-0b3041a5.js";import{_ as Ge}from"./icoexcel-1b303edf.js";import{u as Ee}from"./selectes-3d62d024.js";import"./es-520b73b8.js";import{_ as ke}from"./_plugin-vue_export-helper-c27b6911.js";import{M as Je}from"./MoreOutlined-e98cf2a5.js";var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};const Ze=Xe;function ge(d){for(var l=1;l<arguments.length;l++){var o=arguments[l]!=null?Object(arguments[l]):{},u=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(o).filter(function(h){return Object.getOwnPropertyDescriptor(o,h).enumerable}))),u.forEach(function(h){Qe(d,h,o[h])})}return d}function Qe(d,l,o){return l in d?Object.defineProperty(d,l,{value:o,enumerable:!0,configurable:!0,writable:!0}):d[l]=o,d}var de=function(l,o){var u=ge({},l,o.attrs);return n(ce,ge({},u,{icon:Ze}),null)};de.displayName="CloudUploadOutlined";de.inheritAttrs=!1;const We=de;var Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};const et=Ke;function ye(d){for(var l=1;l<arguments.length;l++){var o=arguments[l]!=null?Object(arguments[l]):{},u=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(o).filter(function(h){return Object.getOwnPropertyDescriptor(o,h).enumerable}))),u.forEach(function(h){tt(d,h,o[h])})}return d}function tt(d,l,o){return l in d?Object.defineProperty(d,l,{value:o,enumerable:!0,configurable:!0,writable:!0}):d[l]=o,d}var ue=function(l,o){var u=ye({},l,o.attrs);return n(ce,ye({},u,{icon:et}),null)};ue.displayName="MessageOutlined";ue.inheritAttrs=!1;const at=ue;var nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};const ot=nt;function be(d){for(var l=1;l<arguments.length;l++){var o=arguments[l]!=null?Object(arguments[l]):{},u=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(o).filter(function(h){return Object.getOwnPropertyDescriptor(o,h).enumerable}))),u.forEach(function(h){st(d,h,o[h])})}return d}function st(d,l,o){return l in d?Object.defineProperty(d,l,{value:o,enumerable:!0,configurable:!0,writable:!0}):d[l]=o,d}var pe=function(l,o){var u=be({},l,o.attrs);return n(ce,be({},u,{icon:ot}),null)};pe.displayName="SaveOutlined";pe.inheritAttrs=!1;const it=pe,lt={city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!0},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},alliedEntity:{type:"iText",label:"Entidad Aliada",name:"alliedEntity",required:!0,message:"Escribir la entidad aliada",disabled:!0},homeOperations:{type:"iDate",label:"Fecha de suscripción del convenio",name:"homeOperations",required:!0,message:"Seleccionar fecha",disabled:!0},external:{type:"iSwitch",label:"CDE AGENTE EXTERNO",name:"external",required:!1,message:"Seleccionar",disabled:!0},startDate:{type:"iDate",label:"Inicio Convenio Vigente",name:"startDate",required:!0,message:"Seleccionar fecha de convenio vigente",disabled:!0},years:{type:"iSelect",label:"Número de años vigente",name:"years",required:!0,message:"Seleccionar años",disabled:!1},observations:{type:"iTextarea",label:"Observaciones",name:"observations",required:!1,message:"Seleccionar",disabled:!1}};const rt={class:"grid-convenios"},ct={key:5},dt={key:0},ut={key:1},Ce="DD/MM/YYYY",pt={__name:"DrawConvenio",props:["idConvenio"],emits:["closeDraw"],setup(d,{emit:l}){q.locale("es");const o=JSON.parse(localStorage.getItem("profile")),u=Ee(),h=l,x=d;u.$patch({cities:u.cities}),u.$patch({provinces:u.provinces}),u.$patch({districts:u.districts}),u.fetchCities();const f=v(!1),$=v(!1),t=te({}),D=[{value:1,label:"1 Año"},{value:2,label:"2 Años"},{value:3,label:"3 Años"},{value:4,label:"4 Años"},{value:5,label:"5 Años"},{value:6,label:"6 Años"},{value:7,label:"7 Años"},{value:8,label:"8 Años"},{value:9,label:"9 Años"},{value:10,label:"10 Años"}],N=e=>{const i=q(t.startDate).add(1,"day").startOf("day");return q(e).startOf("day").isBefore(i,"day")},V=e=>{t.province_id=null,t.district_id=null,u.fetchProvinces(e)},R=e=>{t.district_id=null,u.fetchDistricts(e)},U=(e,i)=>{const b=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return i.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(b)},L=()=>{t.city_id=null,t.province_id=null,t.district_id=null,t.alliedEntity=null,t.homeOperations=null,t.startDate=null,t.external=null,t.years=null,t.endDate=null,t.observations=null,t.created_id=o.user_id},T=async()=>{f.value=!0;const e={city_id:t.city_id,province_id:t.province_id,district_id:t.district_id,alliedEntity:t.alliedEntity,homeOperations:q(t.homeOperations).format("YYYY-MM-DD"),startDate:q(t.startDate).format("YYYY-MM-DD"),external:t.external,years:t.years,endDate:q(t.startDate).add(t.years,"year").format("YYYY-MM-DD"),observations:t.observations,created_id:o.user_id};try{const i=x.idConvenio?"PUT":"POST",b=x.idConvenio?`agreement/update-values/${x.idConvenio.id}`:"agreement/create",C=await G({url:b,method:i,data:e});C.status==200&&(Y.success(C.message),h("closeDraw",!0),L())}catch(i){Y.error("Se originó un error: "+i.message)}finally{f.value=!1}},P=()=>{Y.error("Debes de completar todos los espacios requeridos")},m=async e=>{e.id&&(t.city_id=e.city_id,V(e.city_id),t.province_id=e.province_id,R(e.province_id),t.district_id=e.district_id,t.external=e.external,t.homeOperations=q(e.startOperations,"YYYY-MM-DD"),t.startDate=q(e.startDate,"YYYY-MM-DD"),t.years=e.years,t.observations=e.observations,t.alliedEntity=e.entity)};return W(()=>{x.idConvenio&&m(x.idConvenio)}),ae(()=>x.idConvenio,e=>{e?m(e):L()}),(e,i)=>{const b=p("a-input"),C=p("a-form-item"),j=p("a-select"),J=p("a-date-picker"),k=p("a-switch"),Z=p("a-textarea"),M=p("a-button"),ne=p("a-form"),oe=p("a-spin");return r(),S(oe,{spinning:$.value},{default:s(()=>[n(ne,{layout:"vertical",model:t,name:"basic",autocomplete:"off",onFinish:T,onFinishFailed:P},{default:s(()=>[I("div",rt,[(r(!0),w(F,null,we(z(lt),(a,se)=>(r(),w(F,{key:se},[a.type==="iText"?(r(),S(C,{key:0,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,max:a.max}]},{default:s(()=>[n(b,{value:t[a.name],"onUpdate:value":O=>t[a.name]=O,maxlength:a.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):E("",!0),a.type==="iSelect"?(r(),S(C,{key:1,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:s(()=>[a.name=="city_id"?(r(),S(j,{key:0,value:t[a.name],"onUpdate:value":O=>t[a.name]=O,options:z(u).cities,"show-search":"","filter-option":U,onChange:V},null,8,["value","onUpdate:value","options"])):E("",!0),a.name=="province_id"?(r(),S(j,{key:1,value:t[a.name],"onUpdate:value":O=>t[a.name]=O,options:z(u).provinces,"show-search":"","filter-option":U,onChange:R,disabled:!t.city_id},null,8,["value","onUpdate:value","options","disabled"])):E("",!0),a.name=="district_id"?(r(),S(j,{key:2,value:t[a.name],"onUpdate:value":O=>t[a.name]=O,options:z(u).districts,"show-search":"","filter-option":U,disabled:!t.province_id},null,8,["value","onUpdate:value","options","disabled"])):E("",!0),a.name=="years"?(r(),S(j,{key:3,value:t[a.name],"onUpdate:value":O=>t[a.name]=O,options:D,"show-search":"","filter-option":U},null,8,["value","onUpdate:value"])):E("",!0)]),_:2},1032,["name","label","rules"])):E("",!0),a.type==="iDate"?(r(),S(C,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:s(()=>[a.name=="endDate"?(r(),S(J,{key:0,"disabled-date":N,locale:z(fe),disabled:!t.startDate,value:t[a.name],"onUpdate:value":O=>t[a.name]=O,style:{width:"100%"},format:Ce,placeholder:"día/mes/año"},null,8,["locale","disabled","value","onUpdate:value"])):(r(),S(J,{key:1,locale:z(fe),value:t[a.name],"onUpdate:value":O=>t[a.name]=O,style:{width:"100%"},format:Ce,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"]))]),_:2},1032,["name","label","rules"])):E("",!0),a.type==="iSwitch"?(r(),S(C,{key:3,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:s(()=>[n(k,{checked:t[a.name],"onUpdate:checked":O=>t[a.name]=O,"checked-children":"si","un-checked-children":"",checkedValue:1,unCheckedValue:0},null,8,["checked","onUpdate:checked"])]),_:2},1032,["name","label","rules"])):E("",!0),a.type==="iTextarea"?(r(),S(C,{key:4,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:s(()=>[n(Z,{value:t[a.name],"onUpdate:value":O=>t[a.name]=O,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):E("",!0),a.type==="iSpace"?(r(),w("span",ct)):E("",!0)],64))),128))]),n(C,null,{default:s(()=>[n(M,{type:"primary","html-type":"submit",loading:f.value},{default:s(()=>[d.idConvenio?(r(),w("span",dt,"ACTUALIZAR")):(r(),w("span",ut,"GUARDAR"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},mt=ke(pt,[["__scopeId","data-v-506b2ca2"]]);const vt={class:"accion-icons"},_t={key:0},ft={key:1},ht={__name:"DrawAcciones",props:["idConvenio"],emits:["refreshTable"],setup(d,{emit:l}){const o=d,u=l,h=v([]),x=v(!0),f=v(null),$=v(""),t=v(!1);v(null);const D=te({description:null});W(()=>{o.idConvenio&&T(o.idConvenio)}),ae(()=>o.idConvenio,m=>{m&&T()});function N(m){f.value=m.id,$.value=m.description,he(()=>{P()})}function V(m){const e=h.value.findIndex(i=>i.id===m.id);e!==-1&&(h.value[e].description=$.value),f.value=null,U(m.id)}const R=async m=>{try{const e=await G({url:`agreement/delete-acction/${m.id}`,method:"DELETE"});e.status==200&&(T(),Y.success(e.message),u("refreshTable",!0))}catch(e){console.error("Error de red:",e)}},U=async m=>{try{const e={description:$.value},i=await G({url:`agreement/update/${m}`,method:"PUT",data:e});i.status==200&&(Y.success(i.message),T())}catch(e){console.error("Error de red:",e)}},L=async()=>{try{const m={description:D.description,agreements_id:o.idConvenio},e=await G({url:"agreement/create-acction",method:"POST",data:m});e.status==200&&(Y.success(e.message),u("refreshTable",!0),T(),D.description=null)}catch(m){console.error("Error de red:",m)}},T=async()=>{x.value=!0;try{const m=await G({url:`agreement/list/${o.idConvenio}`,method:"GET"});m.status==200&&(h.value=m.data)}catch{}finally{x.value=!1}},P=()=>{he(()=>{const m=document.getElementById("auto-resize");m.style.height="auto",m.style.height=m.scrollHeight+"px"})};return(m,e)=>{const i=p("a-textarea"),b=p("a-spin"),C=p("a-form-item"),j=p("a-button"),J=p("a-form");return r(),w("div",null,[n(b,{spinning:x.value},{default:s(()=>[(r(!0),w(F,null,we(h.value,(k,Z)=>(r(),w("div",{class:"acciones",key:Z},[I("div",vt,[n(z(Le),{class:"pointer ico-acc",onClick:M=>N(k)},null,8,["onClick"]),f.value===k.id?(r(),S(z(it),{key:0,class:"pointer ico-save",onClick:M=>V(k)},null,8,["onClick"])):E("",!0),n(z(De),{class:"pointer ico-acc",onClick:M=>R(k)},null,8,["onClick"])]),f.value===k.id?(r(),w("div",_t,[n(i,{value:$.value,"onUpdate:value":e[0]||(e[0]=M=>$.value=M),onInput:P,id:"auto-resize"},null,8,["value"])])):(r(),w("p",ft,H(k.description),1))]))),128))]),_:1},8,["spinning"]),n(J,{layout:"vertical",model:D,name:"basic",autocomplete:"off",onFinish:L},{default:s(()=>[n(C,{name:"description",label:"Registra una acción",rules:[{required:!0,message:"Escribir la descripción"}]},{default:s(()=>[n(i,{value:D.description,"onUpdate:value":e[1]||(e[1]=k=>D.description=k),maxlength:250,rows:4},null,8,["value"])]),_:1}),n(C,null,{default:s(()=>[n(j,{type:"primary","html-type":"submit",loading:t.value},{default:s(()=>[B("CREAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const gt={__name:"DrawObservations",props:["idConvenio"],emits:["refreshTable"],setup(d,{emit:l}){const o=d,u=l;v([]);const h=v(!0);v(null),v("");const x=v(!1);v(null);const f=te({description:null});W(()=>{o.idConvenio&&t(o.idConvenio)}),ae(()=>o.idConvenio,D=>{D&&t()});const $=async()=>{x.value=!0;try{const D={observations:f.description},N=await G({url:`agreement/update-values/${o.idConvenio.id}`,method:"PUT",data:D});N.status==200&&(Y.success(N.message),u("refreshTable",!0))}catch(D){console.error("Error de red:",D)}finally{x.value=!1}},t=async()=>{f.description=o.idConvenio.observations,f.description!=null&&(h.value=!1)};return(D,N)=>{const V=p("a-textarea"),R=p("a-form-item"),U=p("a-button"),L=p("a-form"),T=p("a-spin");return r(),w("div",null,[n(T,{spinning:h.value},{default:s(()=>[n(L,{layout:"vertical",model:f,name:"basic",autocomplete:"off",onFinish:$},{default:s(()=>[n(R,{name:"description",label:"Orbservaciones",rules:[{required:!0,message:"Escribir la descripción"}]},{default:s(()=>[n(V,{value:f.description,"onUpdate:value":N[0]||(N[0]=P=>f.description=P),rows:6},null,8,["value"])]),_:1}),n(R,null,{default:s(()=>[n(U,{type:"primary","html-type":"submit",loading:x.value},{default:s(()=>[B("ACTUALIZAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}};const yt=I("div",{class:"agreements-file"},[I("b",null,"Formatos a subir"),I("span",null,"pdf, doc, docx, xls, xlsx, ppt, pptx"),I("span",null,"*(Máximo 20MB)")],-1),bt={class:"file-options"},Ct={style:{"line-height":"1.3"}},wt=["onClick"],Dt=["onClick"],xt={__name:"DrawFiles",props:["idConvenio"],setup(d){q.locale("es");const l=xe.get("token"),o=d,u="https://apituempresa.soporte-pnte.com/api/",h="http://127.0.0.1:8000/api/",x=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?h:u,f=v(!1),$=v([]),t=v(null),D=v(null),N=Oe(Pe,{style:{fontSize:"20px"},spin:!0});W(()=>{o.idConvenio&&m(o.idConvenio)}),ae(()=>o.idConvenio,e=>{e&&m(e)});const V=e=>q(e).format("DD-MM-YYYY HH:mm"),R=e=>(U(e),!1),U=async e=>{const i=new FormData;i.append("file",e),i.append("agreements_id",o.idConvenio),f.value=!0;try{const{data:b}=await ee.post(`${x}agreement/file`,i,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${l}`}});b.status==200&&(Y.success(b.message),m(o.idConvenio))}catch{Y.error("Error al subir este tipo de archivo")}finally{f.value=!1}},L=async e=>{t.value=e.uid;try{const i=await ee({url:`${x}agreement/file-download/${e.uid}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${l}`}}),b=window.URL.createObjectURL(new Blob([i.data])),C=document.createElement("a");C.href=b,C.setAttribute("download",e.name),document.body.appendChild(C),C.click(),window.URL.revokeObjectURL(b),document.body.removeChild(C)}catch(i){console.error("Error downloading file:",i)}finally{t.value=null}},T=e=>{e.file.status!=="uploading"&&console.log(e.file,e.fileList),e.file.status==="done"?(Y.success(`${e.file.name} file uploaded successfully`),$.value=e.fileList.filter(i=>i.status!=="error")):e.file.status==="error"&&(Y.error(`${e.file.name} file upload failed.`),$.value=e.fileList.filter(i=>i.uid!==e.file.uid))},P=async e=>{D.value=e.uid;try{const i=await G({url:`agreement/delete/file/${e.uid}`,method:"DELETE"});i.status==200&&(m(o.idConvenio),Y.success(i.message))}catch(i){console.error("Error de red:",i)}finally{D.value=null}},m=async e=>{try{const{data:i}=await ee.get(`${x}agreement/list-files/${e}`,{headers:{Authorization:`Bearer ${l}`}});i.status===200&&($.value=i.data.map(b=>({uid:b.id,name:b.name,status:"done",url:b.path,date:b.created_at})))}catch(i){console.error("Error fetching files:",i)}};return(e,i)=>{const b=p("a-button"),C=p("a-spin"),j=p("a-space"),J=p("a-upload");return r(),w("div",null,[yt,n(J,{"file-list":$.value,name:"file",onChange:T,"custom-request":U,"before-upload":R},{itemRender:s(({file:k,actions:Z})=>[n(j,{style:{margin:"0rem 0","font-size":"13px",width:"100%"}},{default:s(()=>[I("div",bt,[I("span",Ct,H(k.name),1),I("span",null,H(V(k.date)),1),t.value!=k.uid?(r(),w("a",{key:0,onClick:M=>L(k)},"Descargar",8,wt)):(r(),S(C,{key:1,indicator:z(N)},null,8,["indicator"])),D.value==k.uid?(r(),S(C,{key:2,indicator:z(N)},null,8,["indicator"])):(r(),w("a",{key:3,onClick:M=>P(k),style:{color:"var(--error)"}},[n(z(De))],8,Dt))])]),_:2},1024)]),default:s(()=>[n(b,{style:{"margin-bottom":".6rem"},loading:f.value},{default:s(()=>[n(z(We)),B(" SUBIR ARCHIVO ")]),_:1},8,["loading"])]),_:1},8,["file-list"])])}}};const me=d=>(je("data-v-c5957b86"),d=d(),He(),d),Ot=me(()=>I("h3",{class:"title-produce"},"ESTADO DE CONVENIOS",-1)),Et=me(()=>I("img",{width:"20",style:{margin:"-2px 0 0 0"},src:Ge},null,-1)),kt={key:0,class:"list-days"},St={key:1,class:"list-days"},It=["onClick"],$t=["onClick"],At=me(()=>I("a",null,"Eliminar",-1)),Ut={class:"paginator"},Tt={__name:"ConvenioEstado",props:["idConvenio"],setup(d){q.locale("es"),JSON.parse(localStorage.getItem("profile")),Ee();const l=xe.get("token"),o="https://apituempresa.soporte-pnte.com/api/",u="http://127.0.0.1:8000/api/",h=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?u:o;v(null),v(null);const x=v(!1),f=v(null),$=v(0),t=v(50),D=v({page:0}),N=v(1200),V=v([]),R=v(!1),U=v(!1),L=v(!1),T=v(!1),P=v(!1);v(null),v(null);const m=v(window.innerHeight-100),e=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"REGIÓN",dataIndex:"city",fixed:"left",width:120},{title:"PROVINCIA",dataIndex:"province",fixed:"left",width:120},{title:"DISTRITO",dataIndex:"district",fixed:"left",width:140},{title:"ENTIDAD ALIADA",dataIndex:"entity",width:300},{title:"CDE AGENTE EXTERNO",dataIndex:"externo",width:100,align:"center"},{title:"FECHA DE SUSCRIPCIÓN DE CONVENIO",dataIndex:"startOperations",align:"center",width:180},{title:"INICIO DE CONVENIO VIGENTE",dataIndex:"startDate",align:"center",width:180},{title:"N° DE AÑOS VIGENTE",dataIndex:"years",width:120,align:"center"},{title:"FIN DEL CONVENIO",dataIndex:"endDate",align:"center",width:180},{title:"ESTADO",dataIndex:"status",align:"center",width:150},{title:"FECHA RESTANTE",dataIndex:"numbrestantes",align:"center",width:140},{title:"OBSERVACIONES",dataIndex:"observations",align:"center",width:140},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],i=te({search:""}),b=()=>{let _={search:i.search};X(_)},C=()=>{i.search||X()},j=_=>{f.value=_,U.value=!0},J=_=>{f.value=_,T.value=!0},k=_=>q(_).format("DD/MM/YYYY"),Z=_=>{f.value=_.id,P.value=!0},M=(_,c)=>{const A=new Date(_),Q=new Date,ie=A.getTime()-Q.getTime();return Math.floor(ie/(1e3*3600*24))+1},ne=_=>_<=0||_<20?"red":_<40?"#f9e717":"#11d811",oe=_=>{D.value.page=_,X()},a=()=>{m.value=window.innerHeight-320},se=()=>{f.value=null,U.value=!0},O=_=>{X(),_==1&&(U.value=!1,f.value=null),_==2&&(L.value=!1),_==4&&(T.value=!1),f.value=null},Se=async _=>{try{const c=await G({url:`agreement/delete/${_.id}`,method:"DELETE"});c.status==200&&(X(),Y.success(c.message))}catch(c){console.error("Error de red:",c)}},Ie=qe(()=>_=>D.value.page*t.value+_+1),X=async _=>{try{R.value=!0;let c;c=D.value.page==0?"":D.value,c=_?{...c,..._}:c;const{data:A}=await G({url:"agreement/list",method:"GET",params:c});V.value=A==null?void 0:A.data,$.value=A.total,t.value=A.per_page}catch(c){console.error("Error de red:",c)}finally{R.value=!1}},$e=async()=>{x.value=!0;try{const _=await ee({url:`${h}agreement/download`,method:"GET",responseType:"blob",headers:{Authorization:`Bearer ${l}`}}),c=window.URL.createObjectURL(new Blob([_.data])),A=document.createElement("a"),Q="convenios.xlsx";A.href=c,A.setAttribute("download",Q),document.body.appendChild(A),A.click(),window.URL.revokeObjectURL(c),document.body.removeChild(A)}catch(_){console.error("Error downloading file:",_)}finally{x.value=!1}};return Ve(()=>{window.removeEventListener("resize",a)}),W(()=>{window.addEventListener("resize",a),a(),X()}),(_,c)=>{const A=p("a-button"),Q=p("a-col"),ie=p("a-input"),ve=p("a-input-group"),Ae=p("a-row"),_e=p("a-tag"),Ue=p("a-progress"),le=p("a-menu-item"),Te=p("a-popconfirm"),ze=p("a-menu"),Ne=p("a-dropdown"),Me=p("a-table"),Re=p("a-pagination"),K=p("a-drawer");return r(),w(F,null,[I("div",null,[Ot,n(Ae,{style:{margin:"1rem 0"}},{default:s(()=>[n(Q,{xs:24,md:12,lg:18},{default:s(()=>[n(A,{type:"primary",onClick:se,style:{"margin-right":".5rem"}},{default:s(()=>[B("NUEVO")]),_:1}),n(A,{class:"btn-excel",onClick:$e,loading:x.value,type:"primary"},{default:s(()=>[Et]),_:1},8,["loading"])]),_:1}),n(Q,{xs:24,md:12,lg:6},{default:s(()=>[n(ve,{compact:""},{default:s(()=>[n(ie,{value:i.search,"onUpdate:value":c[0]||(c[0]=g=>i.search=g),style:{width:"calc(100% - 80px)"},onInput:C},null,8,["value"]),n(A,{type:"primary",disabled:i.search==="",onClick:b},{default:s(()=>[B("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(Me,{bordered:"",scroll:{x:N.value,y:m.value},class:"table-agreements",columns:e,"data-source":V.value,pagination:!1,loading:R.value,size:"small"},{headerCell:s(({column:g})=>[]),bodyCell:s(({column:g,record:y,index:Ye})=>[g.dataIndex=="idx"?(r(),w(F,{key:0},[B(H(Ie.value(Ye)),1)],64)):E("",!0),g.dataIndex=="externo"?(r(),w(F,{key:1},[y.external==1?(r(),S(_e,{key:0,color:"cyan"},{default:s(()=>[B("Externo")]),_:1})):E("",!0)],64)):E("",!0),g.dataIndex=="startOperations"?(r(),w(F,{key:2},[B(H(k(y.startOperations)),1)],64)):E("",!0),g.dataIndex=="startDate"?(r(),w(F,{key:3},[B(H(k(y==null?void 0:y.startDate)),1)],64)):E("",!0),g.dataIndex=="endDate"?(r(),w(F,{key:4},[B(H(k(y==null?void 0:y.endDate)),1)],64)):E("",!0),g.dataIndex=="numbrestantes"?(r(),w(F,{key:5},[M(y.endDate,y.startDate)>=1?(r(),w("p",kt,H(M(y.endDate,y.startDate))+" días faltantes",1)):(r(),w("p",St,H(M(y.endDate,y.startDate))+" días vencidos",1))],64)):E("",!0),g.dataIndex=="status"?(r(),S(Ue,{key:6,style:{margin:"0"},percent:M(y.endDate,y.startDate),size:4,showInfo:!1,strokeColor:ne(M(y.endDate,y.startDate))},null,8,["percent","strokeColor"])):E("",!0),g.dataIndex=="observations"?(r(),w(F,{key:7},[y!=null&&y.observations?(r(),S(z(at),{key:0,class:"observation-icon",onClick:re=>J(y)},null,8,["onClick"])):E("",!0)],64)):E("",!0),g.dataIndex=="actions"?(r(),S(Ne,{key:8,trigger:["click"]},{overlay:s(()=>[n(ze,null,{default:s(()=>[n(le,null,{default:s(()=>[I("a",{onClick:re=>Z(y)},"Archivos",8,It)]),_:2},1024),n(le,null,{default:s(()=>[I("a",{onClick:re=>j(y)},"Editar",8,$t)]),_:2},1024),n(le,null,{default:s(()=>[n(Te,{title:"¿Seguro de eliminar?",onConfirm:re=>Se(y)},{icon:s(()=>[n(z(Fe),{style:{color:"red"}})]),default:s(()=>[At]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:s(()=>[I("a",{class:"ant-dropdown-link",onClick:c[1]||(c[1]=Be(()=>{},["prevent"]))},[n(A,{shape:"circle",icon:Oe(z(Je)),size:"small"},null,8,["icon"])])]),_:2},1024)):E("",!0)]),_:1},8,["scroll","data-source","loading"])]),I("div",Ut,[I("span",null,[n(_e,{color:"blue"},{default:s(()=>[I("b",null,H($.value),1)]),_:1}),B("Convenios")]),n(Re,{size:"small",total:$.value,pageSize:t.value,onChange:oe,showSizeChanger:!1},null,8,["total","pageSize"])]),n(K,{open:U.value,"onUpdate:open":c[3]||(c[3]=g=>U.value=g),"root-class-name":"root-class-name",title:"Convenios",placement:"right",width:"650"},{default:s(()=>[n(mt,{idConvenio:f.value,onCloseDraw:c[2]||(c[2]=g=>O(1))},null,8,["idConvenio"])]),_:1},8,["open"]),n(K,{open:L.value,"onUpdate:open":c[6]||(c[6]=g=>L.value=g),title:"Acciones",placement:"right",width:"550"},{default:s(()=>[n(ht,{idConvenio:f.value,onCloseDraw:c[4]||(c[4]=g=>O(2)),onRefreshTable:c[5]||(c[5]=g=>X())},null,8,["idConvenio"])]),_:1},8,["open"]),n(K,{open:P.value,"onUpdate:open":c[8]||(c[8]=g=>P.value=g),title:"Cargar Archivos",placement:"right",width:"550"},{default:s(()=>[n(xt,{idConvenio:f.value,onCloseDraw:c[7]||(c[7]=g=>O(3))},null,8,["idConvenio"])]),_:1},8,["open"]),n(K,{open:T.value,"onUpdate:open":c[11]||(c[11]=g=>T.value=g),title:"Observaciones",placement:"right",width:"550"},{default:s(()=>[n(gt,{idConvenio:f.value,onCloseDraw:c[9]||(c[9]=g=>O(4)),onRefreshTable:c[10]||(c[10]=g=>X())},null,8,["idConvenio"])]),_:1},8,["open"])],64)}}},Pt=ke(Tt,[["__scopeId","data-v-c5957b86"]]);export{Pt as default};
