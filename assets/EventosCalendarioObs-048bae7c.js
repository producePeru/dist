import{c as r,A as ve,l as c,r as d,a as te,j as ae,U as pe,a6 as X,o as f,d as _,N as me,p as fe,q as _e,b as E,e as t,h as y,w as O,t as m,L as ye,f as K,i as x,F as he,s as be,v as V,ah as ge,x as Se,y as A,z as Ee,B as Oe}from"./index-1ce1066d.js";import{l as Ce,C as De}from"./localizedFormat-f373620e.js";import"./es-20e87183.js";import{u as le}from"./selectes-83896420.js";import{_ as Ae}from"./DrawResultados-a1b4a063.js";import{_ as ke}from"./FormComponent-0b44935c.js";import{H as Me}from"./HomeOutlined-4fb2ca39.js";import{E as Re}from"./EnvironmentOutlined-da571554.js";import{T as we}from"./TeamOutlined-f7bf8c7f.js";import{U as Te}from"./UserOutlined-9c716473.js";/* empty css             */import"./quill.snow-8f6a0de6.js";var Ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"};const Ie=Ne;function ee(h){for(var u=1;u<arguments.length;u++){var n=arguments[u]!=null?Object(arguments[u]):{},v=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(v=v.concat(Object.getOwnPropertySymbols(n).filter(function(b){return Object.getOwnPropertyDescriptor(n,b).enumerable}))),v.forEach(function(b){Le(h,b,n[b])})}return h}function Le(h,u,n){return u in h?Object.defineProperty(h,u,{value:n,enumerable:!0,configurable:!0,writable:!0}):h[u]=n,h}var B=function(u,n){var v=ee({},u,n.attrs);return r(ve,ee({},v,{icon:Ie}),null)};B.displayName="FormOutlined";B.inheritAttrs=!1;const He=B;const Ue={class:"f-20"},Ye={__name:"EventosObservaciones",props:["info"],emits:["closeDraw"],setup(h,{emit:u}){c.locale("es");const n=d({obs_id:{type:"iSelect",label:"TIPO DE OBSERVACIÓN",name:"obs_id",required:!0,message:"Seleccionar una opción",disabled:!1}});JSON.parse(localStorage.getItem("profile"));const v=u,b=h,I=d("ACTUALIZAR"),s=te({}),S=d(!1);le();const k=d(null),M=d({obs_id:[]}),C=a=>{console.log("handleInputEvent",a)},i=async a=>{a=="dateReception"&&(s.dateTramite&&(s.dateTramite=null),n.value.dateTramite.disabled=!1)},R=async a=>{a=="obs_id"&&(delete n.value.rescheduled,delete n.value.date,delete n.value.hours,delete n.value.canceled,s.obs_id===1?n.value.canceled={type:"iTextArea",label:"ESCRIBIR MOTIVO DE LA CANCELACIÓN",name:"canceled",required:!0,message:"Escribir el motivo",rows:5}:s.obs_id===2&&(n.value.date={type:"iDatePicker",label:"SELECCIONAR FECHA DEL EVENTO",name:"date",message:"Seleccionar una opción"},n.value.hours={type:"iHour",label:"SELECCIONAR HORA DEL EVENTO",name:"hours",message:"Seleccionar la hora",required:!1},n.value.rescheduled={type:"iTextArea",label:"ESCRIBIR MOTIVO DE LA REPROGRAMACIÓN",name:"rescheduled",required:!0,message:"Escribir el motivo",rows:5}))},L=async a=>{a=="obs_id"&&T()},H=a=>{},T=()=>{M.value.obs_id=[{value:1,label:"CANCELADO"},{value:2,label:"REPROGRAMADO"}]},U=async()=>{let a=null;S.value=!0,s.obs_id===1?a={canceled:s.canceled,dateStart:s.dateStart,dateEnd:s.dateEnd,start:s.start,end:s.end}:s.obs_id===2&&(a={canceled:s.canceled,dateStart:c(s.date.start).format("YYYY-MM-DD"),dateEnd:c(s.date.end).format("YYYY-MM-DD"),...s.hours?{start:c(s.hours[0]).format("HH:mm"),end:c(s.hours[1]).format("HH:mm")}:{start:null,end:null},rescheduled:s.rescheduled});try{(await me({url:`event/update-obs/${b.info.id}`,method:"PUT",data:a})).status===200&&v("closeDraw",!0)}catch(D){console.error("Error:",D);const Y=document.getElementsByClassName("ant-drawer-body")[0];Y&&(Y.scrollTop=0)}finally{S.value=!1}},w=()=>{s.obs_id=null,n.value={obs_id:{type:"iSelect",label:"TIPO DE OBSERVACIÓN",name:"obs_id",required:!0,message:"Seleccionar una opción",disabled:!1}}},N=async a=>{a&&(console.log("set_info",a),T(),a.canceled?s.obs_id=1:a.rescheduled?s.obs_id=2:s.obs_id=null,R("obs_id"),s.canceled=a.canceled??null,s.date={start:c(a.dateStart).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:c(a.dateEnd).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},a.start&&a.end?s.hours=[c(a.start,"HH:mm"),c(a.end,"HH:mm")]:s.hours=[],s.rescheduled=a.rescheduled??null)};return ae(()=>{b.info?N(b.info):w()}),pe(()=>b.info,a=>{a?N(a):w()}),X("formState",s),X("loadingState",S),(a,D)=>(f(),_("div",Ue,[r(ke,{fields:n.value,options:M.value,btnSaveName:I.value,onHandleInputEvent:C,resetSelect:k.value,onHandleChangeSelect:R,onHandleFocusSelect:L,onHandleBlurSelect:H,onHandleChangeClock:i,onOnSubmit:U},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const xe={class:"container-events"},Fe={class:"filter-calendar-25"},Pe={class:"filter-calendar-25-opts"},Ve={class:"filter-calendar-check"},Be={class:"schedule"},$e={class:"schedule-header"},ze={class:"schedule-date"},Ge={key:0,class:"event-time"},qe={key:1,class:"event-time"},je={class:"event-hour-2"},Ze={class:"ugger-options"},Je={class:"title"},Qe={class:"event-description"},We=["onClick"],Xe={class:"modal-calendar-detail"},Ke={style:{"line-height":"1.3","margin-bottom":".5rem","margin-top":"0"}},et=["innerHTML"],tt={key:0},at={style:{"margin-left":".5rem"}},lt={key:1},nt={style:{"margin-left":".5rem"}},st={key:2},ot={style:{"margin-left":".5rem"}},rt={style:{"margin-left":".5rem"}},it={key:0},dt={style:{"margin-left":".5rem"}},ut={key:3},ct={style:{"margin-left":".5rem"}},vt={key:4},pt=["href"],mt={key:5},ft=["innerHTML"],_t={class:"filter-modal"},yt={style:{display:"flex","flex-direction":"column"}},wt={__name:"EventosCalendarioObs",setup(h){c.locale("es"),c.extend(fe),c.extend(Ce);const u=le();u.$patch({cities:u.cities}),u.fetchCities();const n=te({value1:["UGO","UGSE"]}),v=d(null),b=_e(ye,{style:{fontSize:"24px"},spin:!0}),I=d(null),s=d(null),S=d(!1),k=d(!1),M=d(!1),C=d(null);d(!1);const i=d(null),R=d(!1),L=d(!1),H=d(null),T=d(null),U=d(new Date),w=d([]),N=d(null),a=d([]),D=d(!1),Y=l=>{S.value=!0,s.value=l},ne=l=>{const e={id:l.id,resultado:l.resultado};I.value=e,k.value=!0},se=l=>{i.value=l,R.value=!0},$=[{label:"UGO",value:"UGO"},{label:"UGSE",value:"UGSE"}],z=(l,e)=>{const p=l.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(p)},oe=l=>{if(Array.isArray(l)&&l.length>0&&l[0].id){const e=l[0].id;H.value=e,N.value!==e&&(N.value=e,console.log("onPageChange",l),q(e))}else console.warn("⚠️ No se pudo detectar el cambio de mes.")},F=l=>({1:"#808080",red:"#f06464",3:"#fd9d0f",4:"#ffb74d",5:"#00b522",blue:"#1546b0",7:"#9c27b0",8:"#ff07d8"})[l],re=l=>({1:"Despega tu empresa",2:"Ferias",3:"Fortalece tu Mercado",4:"Mujer Produce",5:"Potencia tu Empresa",6:"Ruta Digital",7:"Otros UGSE",8:"Difusión UGO"})[l],ie=l=>{if(!Array.isArray(l)||l.length===0)return"";const e=c(l[0]).locale("es").format("DD [de] MMMM"),p=l.length>1?c(l[l.length-1]).locale("es").format("DD [de] MMMM"):null;return p?`Desde: ${e} Hasta: ${p}`:`${e}`},G=async()=>{M.value=!0,await q(H.value),await P()},P=async l=>{l&&(C.value=l.id),D.value=!0;const e={},p=c().format("YYYY-MM-DD");n.value1&&(e.office=n.value1),v.value&&(e.city_id=v.value),C.value?e.dateSelected=C.value:e.dateSelected=l?l.id:p,T.value=C.value?c(C.value).format("dddd D [de] MMMM [de] YYYY"):c(p).format("dddd D [de] MMMM [de] YYYY");try{a.value=[];const g=await K({url:"pnte/events-day",method:"GET",params:e});g.data&&Array.isArray(g.data)?a.value=g.data:console.warn("⚠️ Respuesta inesperada de la API:",g)}catch(g){console.error("❌ Error al obtener eventos:",g)}finally{D.value=!1,M.value=!1}},q=async l=>{const e={};v.value&&(e.city_id=v.value),n.value1&&(e.office=n.value1),l&&(e.year_month=l);try{const p=await K({url:"pnte/dots",method:"GET",params:e});w.value=[],p&&Array.isArray(p)?w.value=[{key:"today",highlight:"",dates:[new Date]},...p]:console.warn("⚠️ Respuesta de API inesperada:",p)}catch(p){console.error("❌ Error al obtener eventos:",p)}};return ae(async()=>{await P()}),(l,e)=>{const p=E("VCalendar"),g=E("a-checkbox-group"),j=E("a-select"),Z=E("a-button"),de=E("a-empty"),ue=E("a-spin"),J=E("a-modal"),Q=E("a-drawer");return f(),_("section",xe,[e[23]||(e[23]=t("h1",{class:"title-pc"},"CALENDARIO 2025",-1)),t("div",null,[r(p,{ref:"calendar",modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=o=>U.value=o),attributes:w.value,expanded:"",locale:"es",transparent:"",borderless:"","onUpdate:pages":oe,onDayclick:P},null,8,["modelValue","attributes"]),t("div",Fe,[t("div",null,[e[12]||(e[12]=t("h4",{style:{display:"block"}},"FILTRAR POR",-1)),t("div",Pe,[t("div",Ve,[r(g,{value:n.value1,"onUpdate:value":e[1]||(e[1]=o=>n.value1=o),name:"checkboxgroup",options:$},null,8,["value"])]),r(j,{style:{width:"100%"},value:v.value,"onUpdate:value":e[2]||(e[2]=o=>v.value=o),options:y(u).cities,"show-search":"","filter-option":z,placeholder:"SELECCIONAR REGIÓN"},null,8,["value","options"]),r(Z,{class:"btn-modal-filter",type:"primary",onClick:G,loading:M.value},{default:O(()=>e[11]||(e[11]=[x("BUSCAR")])),_:1},8,["loading"])])])])]),t("div",Be,[t("div",$e,[e[13]||(e[13]=t("h4",null,"EVENTOS",-1)),t("span",ze,m(T.value),1)]),r(ue,{indicator:y(b),spinning:D.value},{default:O(()=>[a.value.length>0?(f(!0),_(he,{key:0},be(a.value,(o,ce)=>(f(),_("div",{key:ce,class:"event"},[o.start?(f(),_("div",qe,[t("div",null,m(o.start),1),e[15]||(e[15]=t("br",null,null,-1)),t("div",je,m(o.end),1)])):(f(),_("div",Ge,e[14]||(e[14]=[t("div",{style:{"text-align":"center","line-height":"1.2"}},"Todo el día",-1)]))),t("div",{class:"schedule-details",style:V({"border-color":F(o.dot)})},[t("small",{class:"schedule-tag",style:V({"background-color":F(o.dot)})},m(o.id_pnte),5),t("div",Ze,[t("span",null,[r(y(ge),{onClick:W=>Y(o)},null,8,["onClick"])]),t("span",null,[r(y(He),{onClick:W=>ne(o)},null,8,["onClick"])])]),t("div",Je,m(o.title),1),t("div",Qe,[x(m(o.descriptionparse)+" ",1),t("span",{onClick:W=>se(o),style:{color:"#2196f3",cursor:"pointer"}},"Ver más",8,We)])],4)]))),128)):(f(),Se(de,{key:1,class:"no-events"},{description:O(()=>e[16]||(e[16]=[t("span",{class:"no-events-span"},"No hay eventos para este día",-1)])),_:1}))]),_:1},8,["indicator","spinning"])]),r(J,{open:R.value,"onUpdate:open":e[3]||(e[3]=o=>R.value=o),title:"",footer:""},{default:O(()=>[t("div",Xe,[t("div",null,[t("h3",Ke,m(i.value.titleComplete),1),t("small",{class:"modal-calendar-tag",style:V({"background-color":F(i.value.id_pnte)})},m(re(i.value.id_pnte)),5)]),t("div",{style:{"margin-bottom":"1rem",color:"#6c6c6c"},class:"html-format",innerHTML:i.value.descripionAll},null,8,et),i.value.organiza?(f(),_("div",tt,[r(y(Me)),t("span",at,m(i.value.organiza),1)])):A("",!0),i.value.region?(f(),_("div",lt,[r(y(Re)),t("span",nt,m(i.value.region),1)])):A("",!0),i.value.numMypes?(f(),_("div",st,[t("span",null,[r(y(we))]),t("span",ot,m(i.value.numMypes),1)])):A("",!0),t("div",null,[t("div",null,[r(y(Ee)),t("span",rt,m(ie(i.value.dates)),1)]),i.value.start?(f(),_("div",it,[r(y(Oe)),t("span",dt,m(i.value.start),1),e[17]||(e[17]=x(" - ")),t("span",null,m(i.value.end),1)])):A("",!0)]),i.value.nameUser?(f(),_("div",ut,[r(y(Te)),t("span",ct,[x(m(i.value.nameUser)+" ",1),e[18]||(e[18]=t("small",null,"(Representante)",-1))])])):A("",!0),i.value.link?(f(),_("div",vt,[r(y(De)),t("a",{style:{"margin-left":".5rem"},href:i.value.link,target:"_blank",rel:"noopener noreferrer"},"Link del evento",8,pt)])):A("",!0),i.value.resultado?(f(),_("div",mt,[e[19]||(e[19]=t("h3",null,"Resultados",-1)),t("div",{style:{color:"#6c6c6c"},class:"html-format",innerHTML:i.value.resultado},null,8,ft)])):A("",!0)])]),_:1},8,["open"]),r(J,{open:L.value,"onUpdate:open":e[6]||(e[6]=o=>L.value=o),title:"",footer:"",width:"350px"},{default:O(()=>[t("div",_t,[e[22]||(e[22]=t("h3",null,"FILTRAR POR:",-1)),r(g,{value:n.value1,"onUpdate:value":e[4]||(e[4]=o=>n.value1=o),name:"checkboxgroup",options:$},null,8,["value"]),t("div",yt,[e[20]||(e[20]=t("label",{style:{margin:"10px 0 6px 0","font-size":"13px"}},"REGIÓN",-1)),r(j,{allowClear:!0,value:v.value,"onUpdate:value":e[5]||(e[5]=o=>v.value=o),options:y(u).cities,"show-search":"","filter-option":z},null,8,["value","options"])]),t("pre",null,m(n.value1),1),r(Z,{class:"btn-modal-filter",type:"primary",onClick:G},{default:O(()=>e[21]||(e[21]=[t("b",{style:{"font-weight":"500"}},"BUSCAR",-1)])),_:1})])]),_:1},8,["open"]),r(Q,{open:k.value,"onUpdate:open":e[8]||(e[8]=o=>k.value=o),title:"RESULTADOS",placement:"right",width:"550"},{default:O(()=>[r(Ae,{dataRow:I.value,onCloseDraw:e[7]||(e[7]=o=>{k.value=!1})},null,8,["dataRow"])]),_:1},8,["open"]),r(Q,{open:S.value,"onUpdate:open":e[10]||(e[10]=o=>S.value=o),title:"OBSERVACIONES",placement:"right",width:"550"},{default:O(()=>[r(Ye,{info:s.value,onCloseDraw:e[9]||(e[9]=o=>{S.value=!1})},null,8,["info"])]),_:1},8,["open"])])}}};export{wt as default};
