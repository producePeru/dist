import{_ as W}from"./tuempresa-7c20bfb9.js";import{R as X}from"./ModalRegistroMYPE-3e2a4294.js";import{k as Z,u as j,r as g,a as U,x as ee,l as te,b as d,o as p,d as m,e,c as r,i as v,t as n,w as f,y as oe,m as b,f as w,s as k,F as N,v as q,p as se,j as ae,n as ne}from"./index-663e7fda.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";const c=y=>(se("data-v-75b2251a"),y=y(),ae(),y),re={class:"background"},ue={class:"container"},ce={class:"questionary"},ie={class:"box"},de=c(()=>e("div",{class:"text-center"},[e("img",{src:W,alt:""}),e("h1",{class:"title"},"Test de salida")],-1)),_e={class:"box-info-workshop"},pe=c(()=>e("b",null,"Taller: ",-1)),me=c(()=>e("b",null,"Expositor: ",-1)),he=c(()=>e("b",null,"Fecha del taller:",-1)),ve=c(()=>e("b",null,"Fecha de expiración del cuestionario:",-1)),fe={class:"box"},ge={key:0,class:"personal-info"},be=c(()=>e("h4",{class:"c-primary"},"Mis Datos",-1)),ye=c(()=>e("span",{class:"name"},"Nombres y Apellidos: ",-1)),we=c(()=>e("span",{class:"name"},"Correo electrónico: ",-1)),ke=c(()=>e("span",{class:"name"},"Número de contácto: ",-1)),xe=c(()=>e("br",null,null,-1)),Se={key:0},Te={class:"box-mensagge"},De={class:"box-title"},Ee={key:1,class:"box rate"},Ie={class:"box-title"},Ue={class:"rate-wrapper"},$e={class:"box-title"},Re={class:"box-title"},Ce={key:2,class:"box"},Fe=c(()=>e("span",{class:"box-mensagge"},"Sugerencias",-1)),Ne={class:"box-title"},qe={class:"box-btn"},Me={__name:"TestSalida",setup(y){const M=Z(),O=j(),x=g(!1),S=g(!1),T=g(!1),$=g(null),i=g(null),l=U({id:null,exponent:null,idIn:null,idOut:null,dateTestIn:null,dateTestOut:null,title:null,workShopDate:null}),a=U({name:null,email:null,phone:null,ruc:null,dni:null}),o=U({ruc:null,dni:null,ts1:null,ts2:null,ts3:null,ts4:null,ts5:null,rate_1:null,rate_2:null,rate_3:null,comments:null}),P=ee(()=>oe(l.dateTestOut).format("DD-MM-YYYY")),Y=()=>{o.ruc=o.ruc.replace(/\D/g,"")},z=s=>{a.name=s.name_complete,a.email=s.email,a.phone=s.phone,a.ruc=s.ruc,a.dni=s.dni_number},R=async()=>{let s=o.ruc;if(!s)return b.warning("Ingresa el número de RUC");S.value=!0;try{const{data:t}=await w({url:`/data-mype/${s}`,method:"GET"});t.ruc&&(a.ruc=t.ruc,a.name=t.name_complete,a.email=t.email,a.phone=t.phone,a.dni=t.dni_number)}catch(t){if(console.error("Error de red:",t.response.status),a.name=null,a.email=null,a.phone=null,a.dni=null,t.response.status==404)try{const{data:h}=await w({url:`/api-data-mype/${o.ruc}`,method:"GET"}),D={razonSocial:h.razonSocial,numeroDocumento:h.numeroDocumento};$.value=D,x.value=!0}catch(h){b.warning("El número de RUC no es válido"),console.error("Error de red:",h)}}finally{S.value=!1}},G=()=>{window.scrollTo({top:200,behavior:"smooth"})},V=async()=>{if(a.name==null&&a.dni==null&&a.ruc==null){R(),b.warning("Revisando sus respuestas"),G();return}const s={ts1:o.ts1,ts2:o.ts2,ts3:o.ts3,ts4:o.ts4,ts5:o.ts5,c1:o.rate_1,c2:o.rate_2,c3:o.rate_3,suggestions:o.comments,ruc_mype:a.ruc,dni_mype:a.dni,workshop_id:l.id};T.value=!0;try{const t=await w({url:`/sending-test-answers/${l.id}`,method:"POST",data:s});b.success(t.message),O.push({name:"enviado"})}catch(t){console.error("Error:",t.response.data.errors[0])}finally{T.value=!1}},B=()=>{b.error("Debes de completar todos los datos")},L=async s=>{try{const{data:t}=await ne({url:`/testout/${s}`,method:"GET"});i.value=t}catch(t){console.error("Error de red:",t)}};return te(async()=>{try{const s=await w({url:`/get-workshop-slug/${M.params.slug}`,method:"GET"});l.id=s.workshop.id,l.exponent=s.workshop.exponent_name,l.idIn=s.workshop.id_in,l.idOut=s.workshop.id_out,l.dateTestIn=s.workshop.test_in_date,l.dateTestOut=s.workshop.test_out_date,l.title=s.workshop.title,l.workShopDate=s.workshop.workshop_date,await L(s.workshop.id_out)}catch(s){console.error("Error de red:",s)}}),(s,t)=>{const h=d("a-divider"),D=d("a-input-search"),C=d("a-form-item"),A=d("a-radio"),H=d("a-radio-group"),E=d("a-rate"),J=d("a-textarea"),K=d("a-button"),Q=d("a-form");return p(),m("div",re,[e("section",ue,[e("div",ce,[e("div",ie,[de,r(h),e("div",_e,[e("span",null,[pe,v(n(l.title),1)]),e("span",null,[me,v(n(l.exponent),1)]),e("span",null,[he,v(" "+n(l.workShopDate),1)]),e("span",null,[ve,v(" "+n(P.value),1)])])]),r(Q,{layout:"vertical",model:o,autocomplete:"off",onFinish:V,onFinishFailed:B},{default:f(()=>[e("div",fe,[r(C,{class:"search-ruc f-15",name:"ruc",label:"Número de RUC",rules:[{required:!0,message:"Es importante el número de RUC"}]},{default:f(()=>[r(D,{maxlength:15,loading:S.value,size:"large",value:o.ruc,"onUpdate:value":t[0]||(t[0]=u=>o.ruc=u),"enter-button":"",onSearch:R,onInput:Y},null,8,["loading","value"])]),_:1}),a.name?(p(),m("div",ge,[be,e("div",null,[ye,e("span",null,n(a.name),1)]),e("div",null,[we,e("span",null,n(a.email),1)]),e("div",null,[ke,e("span",null,n(a.phone),1)]),xe])):k("",!0)]),i.value?(p(),m("div",Se,[(p(),m(N,null,q(5,(u,_)=>e("div",{class:"box",key:_},[e("span",Te,"Pregunta "+n(_+1),1),e("h3",De,n(i.value["question"+(_+1)]),1),r(C,{name:`ts${_+1}`,rules:[{required:!0,message:"Escoge una respuesta"}]},{default:f(()=>[r(H,{class:"group-radios",value:o[`ts${_+1}`],"onUpdate:value":F=>o[`ts${_+1}`]=F},{default:f(()=>[(p(),m(N,null,q(3,(F,I)=>r(A,{key:I,class:"item-radio",value:I+1},{default:f(()=>[v(n(i.value[`question${_+1}_opt${I+1}`]),1)]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["name"])])),64))])):k("",!0),i.value?(p(),m("div",Ee,[e("div",null,[e("h3",Ie,n(i.value.satistaction1),1),r(E,{class:"star-rate",value:o.rate_1,"onUpdate:value":t[1]||(t[1]=u=>o.rate_1=u)},null,8,["value"])]),e("div",Ue,[e("h3",$e,n(i.value.satistaction2),1),r(E,{class:"star-rate",value:o.rate_2,"onUpdate:value":t[2]||(t[2]=u=>o.rate_2=u)},null,8,["value"])]),e("div",null,[e("h3",Re,n(i.value.satistaction3),1),r(E,{class:"star-rate",value:o.rate_3,"onUpdate:value":t[3]||(t[3]=u=>o.rate_3=u)},null,8,["value"])])])):k("",!0),i.value?(p(),m("div",Ce,[Fe,e("h3",Ne,n(i.value.comments),1),r(J,{value:o.comments,"onUpdate:value":t[4]||(t[4]=u=>o.comments=u),"allow-clear":""},null,8,["value"])])):k("",!0),e("div",qe,[r(K,{type:"primary","html-type":"submit",size:"large",loading:T.value},{default:f(()=>[v("Enviar respuestas")]),_:1},8,["loading"])])]),_:1},8,["model"])])]),e("pre",null,n(o),1),r(X,{open:x.value,onHandleCloseModal:t[5]||(t[5]=u=>x.value=!1),rucProp:$.value,onHandleSetData:z},null,8,["open","rucProp"])])}}},Ve=le(Me,[["__scopeId","data-v-75b2251a"]]);export{Ve as default};
