import{c as a,A as ze,L as Z,r as c,a as ne,j as ee,K as oe,b as i,o as l,p as U,w as n,e as u,d as y,F as H,v as de,h as M,q as O,M as _e,y as J,m as F,a1 as Me,a2 as he,t as B,i as j,a3 as fe,g as be,P as Ce,a4 as Le,H as re,a6 as Pe,I as Fe,s as Ne,U as qe,J as Ye}from"./index-79af4362.js";import{_ as Be}from"./icoexcel-1b303edf.js";import{u as we}from"./selectes-e1532de0.js";import"./es-ec42f3d3.js";import{_ as De}from"./_plugin-vue_export-helper-c27b6911.js";import{S as Ge}from"./SaveOutlined-77e3e863.js";import{C as Ve,M as He}from"./MessageOutlined-82c31c06.js";import{M as je}from"./MoreOutlined-9822b1f7.js";var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 264c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48zm-8 136H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM480 544H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zm-48 308H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h264c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm356.8-74.4c29-26.3 47.2-64.3 47.2-106.6 0-79.5-64.5-144-144-144s-144 64.5-144 144c0 42.3 18.2 80.3 47.2 106.6-57 32.5-96.2 92.7-99.2 162.1-.2 4.5 3.5 8.3 8 8.3h48.1c4.2 0 7.7-3.3 8-7.6C564 871.2 621.7 816 692 816s128 55.2 131.9 124.4c.2 4.2 3.7 7.6 8 7.6H880c4.6 0 8.2-3.8 8-8.3-2.9-69.5-42.2-129.6-99.2-162.1zM692 591c44.2 0 80 35.8 80 80s-35.8 80-80 80-80-35.8-80-80 35.8-80 80-80z"}}]},name:"solution",theme:"outlined"};const Ke=Je;function ge(T){for(var h=1;h<arguments.length;h++){var p=arguments[h]!=null?Object(arguments[h]):{},g=Object.keys(p);typeof Object.getOwnPropertySymbols=="function"&&(g=g.concat(Object.getOwnPropertySymbols(p).filter(function(I){return Object.getOwnPropertyDescriptor(p,I).enumerable}))),g.forEach(function(I){Ze(T,I,p[I])})}return T}function Ze(T,h,p){return h in T?Object.defineProperty(T,h,{value:p,enumerable:!0,configurable:!0,writable:!0}):T[h]=p,T}var me=function(h,p){var g=ge({},h,p.attrs);return a(ze,ge({},g,{icon:Ke}),null)};me.displayName="SolutionOutlined";me.inheritAttrs=!1;const Qe=me,Xe={city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!0},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},alliedEntity:{type:"iText",label:"Entidad Aliada",name:"alliedEntity",required:!0,message:"Escribir la entidad aliada",disabled:!0,max:100},ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!0,message:"Escribir la entidad aliada",disabled:!0,min:11,max:11},component:{type:"iSelect",label:"Componente",name:"components",required:!0,message:"Seleccionar una región",disabled:!0},startDate:{type:"iDate",label:"Inicio Convenio Vigente",name:"startDate",required:!0,message:"Seleccionar fecha de convenio vigente",disabled:!0},years:{type:"iSelect",label:"Años del convenio",name:"years",required:!0,message:"Seleccionar años",disabled:!1},aliado:{type:"iText",label:"Representante Legal (nombres)",name:"aliado",required:!0,message:"Escribir la entidad aliada",disabled:!0,max:100},focal:{type:"iText",label:"PUNTO FOCAL - nombres",name:"focal",required:!0,message:"Escribir la entidad aliada",disabled:!0,max:100},focalCargo:{type:"iText",label:"PUNTO FOCAL - cargo",name:"focalCargo",required:!0,message:"Escribir la entidad aliada",disabled:!0,max:50},observations:{type:"iTextarea",label:"Observaciones",name:"observations",required:!1,message:"Seleccionar",disabled:!1}};const We={class:"grid-convenios"},et={key:5},tt={key:0},at={key:1},ye="DD/MM/YYYY",nt={__name:"DrawConvenioUGSE",props:["idConvenio"],emits:["closeDraw"],setup(T,{emit:h}){Z.locale("es");const p=JSON.parse(localStorage.getItem("profile")),g=we(),I=h,w=T;g.$patch({cities:g.cities}),g.$patch({provinces:g.provinces}),g.$patch({districts:g.districts}),g.fetchCities();const m=c(!1),$=c(!1),e=ne({}),S=[{value:1,label:"1 Año"},{value:2,label:"2 Años"},{value:3,label:"3 Años"},{value:4,label:"4 Años"},{value:5,label:"5 Años"},{value:6,label:"6 Años"},{value:7,label:"7 Años"},{value:8,label:"8 Años"},{value:9,label:"9 Años"},{value:10,label:"10 Años"}],R=[{value:"digitalizacion",label:"Digitalización"},{value:"formalizacion",label:"Formalización"},{value:"gestion",label:"Gestión Empresarial"},{value:"desarrollo",label:"Desarrollo Productivo"}],G=t=>{const d=Z(e.startDate).add(1,"day").startOf("day");return Z(t).startOf("day").isBefore(d,"day")},N=t=>{e.province_id=null,e.district_id=null,g.fetchProvinces(t)},z=t=>{e.district_id=null,g.fetchDistricts(t)},D=(t,d)=>{const x=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return d.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(x)},r=()=>{e.city_id=null,e.province_id=null,e.district_id=null,e.alliedEntity=null,e.homeOperations=null,e.startDate=null,e.external=null,e.years=null,e.endDate=null,e.observations=null,e.created_id=p.user_id},q=async()=>{m.value=!0;const t={city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,alliedEntity:e.alliedEntity,ruc:e.ruc,components:e.components,startDate:Z(e.startDate).format("YYYY-MM-DD"),years:e.years,aliado:e.aliado,focal:e.focal,focalCargo:e.focalCargo,endDate:Z(e.startDate).add(e.years,"year").format("YYYY-MM-DD"),observations:e.observations,created_id:p.user_id,entity:"ugse"};try{const d=w.idConvenio?"PUT":"POST",x=w.idConvenio?`agreement/update-values/${w.idConvenio.id}`:"agreement/create-ugse",k=await J({url:x,method:d,data:t});k.status==200&&(F.success(k.message),I("closeDraw",!0),r())}catch(d){F.error("Se originó un error: "+d.message)}finally{m.value=!1}},v=()=>{F.error("Por favor corrige los valores con errores")},_=async t=>{t.id&&(e.city_id=t.city_id,N(t.city_id),e.province_id=t.province_id,z(t.province_id),e.district_id=t.district_id,e.external=t.external,e.homeOperations=Z(t.startOperations,"YYYY-MM-DD"),e.startDate=Z(t.startDate,"YYYY-MM-DD"),e.years=t.years,e.observations=t.observations,e.alliedEntity=t.entity)};return ee(()=>{w.idConvenio&&_(w.idConvenio)}),oe(()=>w.idConvenio,t=>{t?_(t):r()}),(t,d)=>{const x=i("a-input"),k=i("a-form-item"),V=i("a-select"),P=i("a-date-picker"),b=i("a-switch"),Y=i("a-textarea"),K=i("a-button"),X=i("a-form"),ce=i("a-spin");return l(),U(ce,{spinning:$.value},{default:n(()=>[a(X,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:q,onFinishFailed:v},{default:n(()=>[u("div",We,[(l(!0),y(H,null,de(M(Xe),(s,te)=>(l(),y(H,{key:te},[s.type==="iText"?(l(),U(k,{key:0,name:s.name,label:s.label,rules:[{required:s.required,message:s.message,max:s.max},...s.name==="ruc"?[{type:"string",len:11,message:"El RUC debe tener exactamente 11 caracteres."},{pattern:/^\d{11}$/,message:"El RUC debe ser numérico."}]:[]]},{default:n(()=>[a(x,{value:e[s.name],"onUpdate:value":A=>e[s.name]=A,maxlength:s.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):O("",!0),s.type==="iSelect"?(l(),U(k,{key:1,class:"item-max",name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:n(()=>[s.name=="city_id"?(l(),U(V,{key:0,value:e[s.name],"onUpdate:value":A=>e[s.name]=A,options:M(g).cities,"show-search":"","filter-option":D,onChange:N},null,8,["value","onUpdate:value","options"])):O("",!0),s.name=="province_id"?(l(),U(V,{key:1,value:e[s.name],"onUpdate:value":A=>e[s.name]=A,options:M(g).provinces,"show-search":"","filter-option":D,onChange:z,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):O("",!0),s.name=="district_id"?(l(),U(V,{key:2,value:e[s.name],"onUpdate:value":A=>e[s.name]=A,options:M(g).districts,"show-search":"","filter-option":D,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):O("",!0),s.name=="years"?(l(),U(V,{key:3,value:e[s.name],"onUpdate:value":A=>e[s.name]=A,options:S,"show-search":"","filter-option":D},null,8,["value","onUpdate:value"])):O("",!0),s.name=="components"?(l(),U(V,{key:4,value:e[s.name],"onUpdate:value":A=>e[s.name]=A,options:R,"show-search":"","filter-option":D},null,8,["value","onUpdate:value"])):O("",!0)]),_:2},1032,["name","label","rules"])):O("",!0),s.type==="iDate"?(l(),U(k,{key:2,name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:n(()=>[s.name=="endDate"?(l(),U(P,{key:0,"disabled-date":G,locale:M(_e),disabled:!e.startDate,value:e[s.name],"onUpdate:value":A=>e[s.name]=A,style:{width:"100%"},format:ye,placeholder:"día/mes/año"},null,8,["locale","disabled","value","onUpdate:value"])):(l(),U(P,{key:1,locale:M(_e),value:e[s.name],"onUpdate:value":A=>e[s.name]=A,style:{width:"100%"},format:ye,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"]))]),_:2},1032,["name","label","rules"])):O("",!0),s.type==="iSwitch"?(l(),U(k,{key:3,name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:n(()=>[a(b,{checked:e[s.name],"onUpdate:checked":A=>e[s.name]=A,"checked-children":"si","un-checked-children":"",checkedValue:1,unCheckedValue:0},null,8,["checked","onUpdate:checked"])]),_:2},1032,["name","label","rules"])):O("",!0),s.type==="iTextarea"?(l(),U(k,{key:4,name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:n(()=>[a(Y,{value:e[s.name],"onUpdate:value":A=>e[s.name]=A,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):O("",!0),s.type==="iSpace"?(l(),y("span",et)):O("",!0)],64))),128))]),a(k,null,{default:n(()=>[a(K,{type:"primary","html-type":"submit",loading:m.value},{default:n(()=>[T.idConvenio?(l(),y("span",tt,"ACTUALIZAR")):(l(),y("span",at,"GUARDAR"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},ot=De(nt,[["__scopeId","data-v-763396be"]]);const st={class:"accion-icons"},lt={key:0},it={key:1},rt={__name:"DrawAcciones",props:["idConvenio"],emits:["refreshTable"],setup(T,{emit:h}){const p=T,g=h,I=c([]),w=c(!0),m=c(null),$=c(""),e=c(!1);c(null);const S=ne({description:null});ee(()=>{p.idConvenio&&r(p.idConvenio)}),oe(()=>p.idConvenio,v=>{v&&r()});function R(v){m.value=v.id,$.value=v.description,fe(()=>{q()})}function G(v){const _=I.value.findIndex(t=>t.id===v.id);_!==-1&&(I.value[_].description=$.value),m.value=null,z(v.id)}const N=async v=>{try{const _=await J({url:`agreement/delete-acction/${v.id}`,method:"DELETE"});_.status==200&&(r(),F.success(_.message),g("refreshTable",!0))}catch(_){console.error("Error de red:",_)}},z=async v=>{try{const _={description:$.value},t=await J({url:`agreement/update/${v}`,method:"PUT",data:_});t.status==200&&(F.success(t.message),r())}catch(_){console.error("Error de red:",_)}},D=async()=>{try{const v={description:S.description,agreements_id:p.idConvenio},_=await J({url:"agreement/create-acction",method:"POST",data:v});_.status==200&&(F.success(_.message),g("refreshTable",!0),r(),S.description=null)}catch(v){console.error("Error de red:",v)}},r=async()=>{w.value=!0;try{const v=await J({url:`agreement/list/${p.idConvenio}`,method:"GET"});v.status==200&&(I.value=v.data)}catch{}finally{w.value=!1}},q=()=>{fe(()=>{const v=document.getElementById("auto-resize");v.style.height="auto",v.style.height=v.scrollHeight+"px"})};return(v,_)=>{const t=i("a-textarea"),d=i("a-spin"),x=i("a-form-item"),k=i("a-button"),V=i("a-form");return l(),y("div",null,[a(d,{spinning:w.value},{default:n(()=>[(l(!0),y(H,null,de(I.value,(P,b)=>(l(),y("div",{class:"acciones",key:b},[u("div",st,[a(M(Me),{class:"pointer ico-acc",onClick:Y=>R(P)},null,8,["onClick"]),m.value===P.id?(l(),U(M(Ge),{key:0,class:"pointer ico-save",onClick:Y=>G(P)},null,8,["onClick"])):O("",!0),a(M(he),{class:"pointer ico-acc",onClick:Y=>N(P)},null,8,["onClick"])]),m.value===P.id?(l(),y("div",lt,[a(t,{value:$.value,"onUpdate:value":_[0]||(_[0]=Y=>$.value=Y),onInput:q,id:"auto-resize"},null,8,["value"])])):(l(),y("p",it,B(P.description),1))]))),128))]),_:1},8,["spinning"]),a(V,{layout:"vertical",model:S,name:"basic",autocomplete:"off",onFinish:D},{default:n(()=>[a(x,{name:"description",label:"Registra una acción",rules:[{required:!0,message:"Escribir la descripción"}]},{default:n(()=>[a(t,{value:S.description,"onUpdate:value":_[1]||(_[1]=P=>S.description=P),maxlength:250,rows:4},null,8,["value"])]),_:1}),a(x,null,{default:n(()=>[a(k,{type:"primary","html-type":"submit",loading:e.value},{default:n(()=>_[2]||(_[2]=[j("CREAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const dt={__name:"DrawObservations",props:["idConvenio"],emits:["refreshTable"],setup(T,{emit:h}){const p=T,g=h;c([]);const I=c(!0);c(null),c("");const w=c(!1);c(null);const m=ne({description:null});ee(()=>{p.idConvenio&&e(p.idConvenio)}),oe(()=>p.idConvenio,S=>{S&&e()});const $=async()=>{w.value=!0;try{const S={observations:m.description},R=await J({url:`agreement/update-values/${p.idConvenio.id}`,method:"PUT",data:S});R.status==200&&(F.success(R.message),g("refreshTable",!0))}catch(S){console.error("Error de red:",S)}finally{w.value=!1}},e=async()=>{m.description=p.idConvenio.observations,m.description!=null&&(I.value=!1)};return(S,R)=>{const G=i("a-textarea"),N=i("a-form-item"),z=i("a-button"),D=i("a-form"),r=i("a-spin");return l(),y("div",null,[a(r,{spinning:I.value},{default:n(()=>[a(D,{layout:"vertical",model:m,name:"basic",autocomplete:"off",onFinish:$},{default:n(()=>[a(N,{name:"description",label:"Orbservaciones",rules:[{required:!0,message:"Escribir la descripción"}]},{default:n(()=>[a(G,{value:m.description,"onUpdate:value":R[0]||(R[0]=q=>m.description=q),rows:6},null,8,["value"])]),_:1}),a(N,null,{default:n(()=>[a(z,{type:"primary","html-type":"submit",loading:w.value},{default:n(()=>R[1]||(R[1]=[j("ACTUALIZAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}};const ct={class:"file-options"},ut={style:{"line-height":"1.3"}},mt=["onClick"],pt=["onClick"],vt={__name:"DrawFiles",props:["idConvenio"],setup(T){Z.locale("es");const h=be.get("token"),p=T,g="https://apituempresa.soporte-pnte.com/api/",I="http://127.0.0.1:8000/api/",w=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?I:g,m=c(!1),$=c([]),e=c(null),S=c(null),R=c(!1),G=Ce(Le,{style:{fontSize:"20px"},spin:!0});ee(()=>{p.idConvenio&&_(p.idConvenio)}),oe(()=>p.idConvenio,t=>{t&&_(t)});const N=t=>Z(t).format("DD-MM-YYYY HH:mm"),z=t=>(D(t),!1),D=async t=>{const d=new FormData;d.append("file",t),d.append("agreements_id",p.idConvenio),m.value=!0;try{const{data:x}=await re.post(`${w}agreement/file`,d,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${h}`}});x.status==200&&(F.success(x.message),_(p.idConvenio))}catch{F.error("Error al subir este tipo de archivo")}finally{m.value=!1}},r=async t=>{e.value=t.uid;try{const d=await re({url:`${w}agreement/file-download/${t.uid}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${h}`}}),x=window.URL.createObjectURL(new Blob([d.data])),k=document.createElement("a");k.href=x,k.setAttribute("download",t.name),document.body.appendChild(k),k.click(),window.URL.revokeObjectURL(x),document.body.removeChild(k)}catch(d){console.error("Error downloading file:",d)}finally{e.value=null}},q=t=>{t.file.status!=="uploading"&&console.log(t.file,t.fileList),t.file.status==="done"?(F.success(`${t.file.name} file uploaded successfully`),$.value=t.fileList.filter(d=>d.status!=="error")):t.file.status==="error"&&(F.error(`${t.file.name} file upload failed.`),$.value=t.fileList.filter(d=>d.uid!==t.file.uid))},v=async t=>{S.value=t.uid;try{const d=await J({url:`agreement/delete/file/${t.uid}`,method:"DELETE"});d.status==200&&(_(p.idConvenio),F.success(d.message))}catch(d){console.error("Error de red:",d)}finally{S.value=null}},_=async t=>{R.value=!0;try{const{data:d}=await re.get(`${w}agreement/list-files/${t}`,{headers:{Authorization:`Bearer ${h}`}});d.status===200&&($.value=d.data.map(x=>({uid:x.id,name:x.name,status:"done",url:x.path,date:x.created_at})))}catch(d){console.error("Error fetching files:",d)}finally{R.value=!1}};return(t,d)=>{const x=i("a-button"),k=i("a-spin"),V=i("a-space"),P=i("a-upload");return l(),U(k,{spinning:R.value},{default:n(()=>[d[1]||(d[1]=u("div",{class:"agreements-file"},[u("b",null,"Formatos a subir"),u("span",null,"pdf, doc, docx, xls, xlsx, ppt, pptx"),u("span",null,"*(Máximo 20MB)")],-1)),a(P,{"file-list":$.value,name:"file",onChange:q,"custom-request":D,"before-upload":z},{itemRender:n(({file:b,actions:Y})=>[a(V,{style:{margin:"0rem 0","font-size":"13px",width:"100%"}},{default:n(()=>[u("div",ct,[u("span",ut,B(b.name),1),u("span",null,B(N(b.date)),1),e.value!=b.uid?(l(),y("a",{key:0,onClick:K=>r(b)},"Descargar",8,mt)):(l(),U(k,{key:1,indicator:M(G)},null,8,["indicator"])),S.value==b.uid?(l(),U(k,{key:2,indicator:M(G)},null,8,["indicator"])):(l(),y("a",{key:3,onClick:K=>v(b),style:{color:"var(--error)"}},[a(M(he))],8,pt))])]),_:2},1024)]),default:n(()=>[a(x,{style:{"margin-bottom":".6rem"},loading:m.value},{default:n(()=>[a(M(Ve)),d[0]||(d[0]=j(" SUBIR ARCHIVO "))]),_:1},8,["loading"])]),_:1},8,["file-list"])]),_:1},8,["spinning"])}}};const _t={key:0},ft={class:"compromiso-number"},gt={class:"compromiso-check"},yt={style:{"font-size":"13px"}},ht={key:0},bt={class:"compromiso-number"},Ct={class:"compromiso-check"},wt={class:"convenios-form"},Dt={__name:"DrawCompromisosUGSE",props:["convenio"],setup(T){const h=T,p=Pe.PRESENTED_IMAGE_SIMPLE,g=c("1");c(!1);const I=c(!1),w=c(!1),m=c([]),$=c(null),e=ne({commitment:null}),S=D=>{z()},R=async()=>{const D={commitment:e.commitment,fulfilled:0,type:g.value=="1"?"tuempresa":"aliado",id_agreement:h.convenio.id};I.value=!0;try{(await J({url:"/commitments/create",method:"POST",data:D})).status==200&&(F.success("Compromiso agregado"),e.commitment=null,z())}catch{F.error("Se presentó un error en el servidor")}finally{I.value=!1}},G=D=>{console.log("Failed:",D)},N=async D=>{try{const r=await J({url:`/commitments/fulfilled/${D}`,method:"PUT"});r.status==200&&F.success(r.message)}catch{F.error("Se presentó un error en el servidor")}},z=async D=>{w.value=!0;try{const r=await J({url:`commitments/list/${h.convenio.id}/${g.value=="1"?"tuempresa":"aliado"}`,method:"GET"});m.value=r.data,$.value=r.data}catch(r){console.error("Error de red:",r)}finally{w.value=!1}};return ee(()=>{h.convenio&&z(h.convenio)}),oe(()=>h.convenio,D=>{D?z():console.log("Fetching data........")}),(D,r)=>{const q=i("a-checkbox"),v=i("a-empty"),_=i("a-spin"),t=i("a-tab-pane"),d=i("a-tabs"),x=i("a-textarea"),k=i("a-form-item"),V=i("a-button"),P=i("a-form");return l(),y("section",null,[a(d,{activeKey:g.value,"onUpdate:activeKey":r[0]||(r[0]=b=>g.value=b),onChange:S},{default:n(()=>[a(t,{key:"1"},{tab:n(()=>r[2]||(r[2]=[u("span",{style:{"font-size":"13px"}}," TU EMPRESA ",-1)])),default:n(()=>[a(_,{spinning:w.value},{default:n(()=>[m.value.length>=1?(l(),y("div",_t,[r[3]||(r[3]=u("div",{class:"compromiso compromiso-head"},[u("span",null,"#"),u("span",null,"COMPROMISOS"),u("span",{style:{"text-align":"center"}},"¿CUMPLIÓ?")],-1)),(l(!0),y(H,null,de(m.value,(b,Y)=>(l(),y("div",{class:"compromiso compromiso-body",key:Y},[u("span",ft,B(Y+1),1),u("p",null,B(b.commitment),1),u("span",gt,[a(q,{checked:b.fulfilled,"onUpdate:checked":K=>b.fulfilled=K,onChange:K=>N(b.id)},null,8,["checked","onUpdate:checked","onChange"])])]))),128))])):(l(),U(v,{key:1,image:M(p)},null,8,["image"]))]),_:1},8,["spinning"])]),_:1}),a(t,{key:"2"},{tab:n(()=>[u("span",yt,[a(M(Qe)),r[4]||(r[4]=j(" ALIADO "))])]),default:n(()=>[a(_,{spinning:w.value},{default:n(()=>[m.value.length>=1?(l(),y("div",ht,[r[5]||(r[5]=u("div",{class:"compromiso compromiso-head"},[u("span",null,"#"),u("span",null,"COMPROMISOS"),u("span",{style:{"text-align":"center"}},"¿CUMPLIÓ?")],-1)),(l(!0),y(H,null,de($.value,(b,Y)=>(l(),y("div",{class:"compromiso compromiso-body",key:Y},[u("span",bt,B(Y+1),1),u("p",null,B(b.commitment),1),u("span",Ct,[a(q,{checked:b.fulfilled,"onUpdate:checked":K=>b.fulfilled=K,onChange:K=>N(b.id)},null,8,["checked","onUpdate:checked","onChange"])])]))),128))])):(l(),U(v,{key:1,image:M(p)},null,8,["image"]))]),_:1},8,["spinning"])]),_:1})]),_:1},8,["activeKey"]),u("div",wt,[r[7]||(r[7]=u("h4",null,"Regitsrar nuevo compromiso - TU EMPRESA",-1)),a(P,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:R,onFinishFailed:G},{default:n(()=>[a(k,{label:"Descripción:",name:"commitment",rules:[{required:!0,message:"Por favor menciona el compromiso"}]},{default:n(()=>[a(x,{value:e.commitment,"onUpdate:value":r[1]||(r[1]=b=>e.commitment=b),rows:4},null,8,["value"])]),_:1}),a(k,null,{default:n(()=>[a(V,{type:"primary","html-type":"submit",loading:I.value},{default:n(()=>r[6]||(r[6]=[j("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}};const xt={key:0,class:"list-days"},kt={key:1,class:"list-days"},Et=["onClick"],St=["onClick"],Ut=["onClick"],Ot={class:"paginator"},It={__name:"ConvenioEstado",props:["idConvenio"],setup(T){Z.locale("es"),JSON.parse(localStorage.getItem("profile")),we();const h=be.get("token"),p="https://apituempresa.soporte-pnte.com/api/",g="http://127.0.0.1:8000/api/",I=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?g:p;c(null),c(null);const w=c(!1),m=c(null),$=c(0),e=c(50),S=c({page:0}),R=c(1200),G=c([]),N=c(!1),z=c(!1),D=c(!1),r=c(!1),q=c(!1),v=c(!1);c(null),c(null);const _=c(window.innerHeight-100),t=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"REGIÓN",dataIndex:"city",fixed:"left",width:120},{title:"PROVINCIA",dataIndex:"province",fixed:"left",width:120},{title:"DISTRITO",dataIndex:"district",fixed:"left",width:140},{title:"ENTIDAD ALIADA",dataIndex:"entity",width:220},{title:"INICIO DE CONVENIO VIGENTE",dataIndex:"startDate",align:"center",width:180},{title:"N° DE AÑOS VIGENTE",dataIndex:"years",width:120,align:"center"},{title:"FIN DEL CONVENIO",dataIndex:"endDate",align:"center",width:180},{title:"ESTADO",dataIndex:"status",align:"center",width:150},{title:"FECHA RESTANTE",dataIndex:"numbrestantes",align:"center",width:140},{title:"OBSERVACIONES",dataIndex:"observations",align:"center",width:140},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],d=ne({search:""}),x=()=>{let f={search:d.search};Q(f)},k=()=>{d.search||Q()},V=f=>{m.value=f,z.value=!0},P=f=>{m.value=f,r.value=!0},b=f=>Z(f).format("DD/MM/YYYY"),Y=f=>{m.value=f.id,q.value=!0},K=f=>{m.value=f,v.value=!0},X=(f,o)=>{const L=new Date(f),W=new Date,ue=L.getTime()-W.getTime();return Math.floor(ue/(1e3*3600*24))+1},ce=f=>f<=0||f<20?"red":f<40?"#f9e717":"#11d811",s=f=>{S.value.page=f,Q()},te=()=>{_.value=window.innerHeight-320},A=()=>{m.value=null,z.value=!0},se=f=>{Q(),f==1&&(z.value=!1,m.value=null),f==2&&(D.value=!1),f==4&&(r.value=!1),m.value=null},xe=async f=>{try{const o=await J({url:`agreement/delete/${f.id}`,method:"DELETE"});o.status==200&&(Q(),F.success(o.message))}catch(o){console.error("Error de red:",o)}},ke=Fe(()=>f=>S.value.page*e.value+f+1),Q=async f=>{try{N.value=!0;let o;o=S.value.page==0?"":S.value,o=f?{...o,...f}:o;const{data:L}=await J({url:"agreement/list/ugse",method:"GET",params:o});G.value=L==null?void 0:L.data,$.value=L.total,e.value=L.per_page}catch(o){console.error("Error de red:",o)}finally{N.value=!1}},Ee=async()=>{w.value=!0;try{const f=await re({url:`${I}agreement/download`,method:"GET",responseType:"blob",headers:{Authorization:`Bearer ${h}`}}),o=window.URL.createObjectURL(new Blob([f.data])),L=document.createElement("a"),W="convenios.xlsx";L.href=o,L.setAttribute("download",W),document.body.appendChild(L),L.click(),window.URL.revokeObjectURL(o),document.body.removeChild(L)}catch(f){console.error("Error downloading file:",f)}finally{w.value=!1}};return Ne(()=>{window.removeEventListener("resize",te)}),ee(()=>{window.addEventListener("resize",te),te(),Q()}),(f,o)=>{const L=i("a-button"),W=i("a-col"),ue=i("a-input"),pe=i("a-input-group"),Se=i("a-row"),ve=i("a-tag"),Ue=i("a-progress"),le=i("a-menu-item"),Oe=i("a-popconfirm"),Ie=i("a-menu"),$e=i("a-dropdown"),Ae=i("a-table"),Te=i("a-pagination"),ae=i("a-drawer");return l(),y(H,null,[u("div",null,[o[19]||(o[19]=u("h3",{class:"title-produce"},"CONVENIOS UGSE",-1)),a(Se,{style:{margin:"1rem 0"}},{default:n(()=>[a(W,{xs:24,md:12,lg:18},{default:n(()=>[a(L,{type:"primary",onClick:A,style:{"margin-right":".5rem"}},{default:n(()=>o[13]||(o[13]=[j("NUEVO")])),_:1}),a(L,{class:"btn-excel",onClick:Ee,loading:w.value,type:"primary"},{default:n(()=>o[14]||(o[14]=[u("img",{width:"20",style:{margin:"-2px 0 0 0"},src:Be},null,-1)])),_:1},8,["loading"])]),_:1}),a(W,{xs:24,md:12,lg:6},{default:n(()=>[a(pe,{compact:""},{default:n(()=>[a(ue,{value:d.search,"onUpdate:value":o[0]||(o[0]=C=>d.search=C),style:{width:"calc(100% - 80px)"},onInput:k},null,8,["value"]),a(L,{type:"primary",disabled:d.search==="",onClick:x},{default:n(()=>o[15]||(o[15]=[j("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),a(Ae,{bordered:"",scroll:{x:R.value,y:_.value},class:"table-agreements",columns:t,"data-source":G.value,pagination:!1,loading:N.value,size:"small"},{headerCell:n(({column:C})=>o[16]||(o[16]=[])),bodyCell:n(({column:C,record:E,index:Re})=>[C.dataIndex=="idx"?(l(),y(H,{key:0},[j(B(ke.value(Re)),1)],64)):O("",!0),C.dataIndex=="externo"?(l(),y(H,{key:1},[E.external==1?(l(),U(ve,{key:0,color:"cyan"},{default:n(()=>o[17]||(o[17]=[j("Externo")])),_:1})):O("",!0)],64)):O("",!0),C.dataIndex=="startOperations"?(l(),y(H,{key:2},[j(B(b(E.startOperations)),1)],64)):O("",!0),C.dataIndex=="startDate"?(l(),y(H,{key:3},[j(B(b(E==null?void 0:E.startDate)),1)],64)):O("",!0),C.dataIndex=="endDate"?(l(),y(H,{key:4},[j(B(b(E==null?void 0:E.endDate)),1)],64)):O("",!0),C.dataIndex=="numbrestantes"?(l(),y(H,{key:5},[X(E.endDate,E.startDate)>=1?(l(),y("p",xt,B(X(E.endDate,E.startDate))+" días faltantes",1)):(l(),y("p",kt,B(X(E.endDate,E.startDate))+" días vencidos",1))],64)):O("",!0),C.dataIndex=="status"?(l(),U(Ue,{key:6,style:{margin:"0"},percent:X(E.endDate,E.startDate),size:4,showInfo:!1,strokeColor:ce(X(E.endDate,E.startDate))},null,8,["percent","strokeColor"])):O("",!0),C.dataIndex=="observations"?(l(),y(H,{key:7},[E!=null&&E.observations?(l(),U(M(He),{key:0,class:"observation-icon",onClick:ie=>P(E)},null,8,["onClick"])):O("",!0)],64)):O("",!0),C.dataIndex=="actions"?(l(),U($e,{key:8,trigger:["click"]},{overlay:n(()=>[a(Ie,null,{default:n(()=>[a(le,null,{default:n(()=>[u("a",{onClick:ie=>Y(E)},"Archivos",8,Et)]),_:2},1024),a(le,null,{default:n(()=>[u("a",{onClick:ie=>K(E)},"Compromisos",8,St)]),_:2},1024),a(le,null,{default:n(()=>[u("a",{onClick:ie=>V(E)},"Editar",8,Ut)]),_:2},1024),a(le,null,{default:n(()=>[a(Oe,{title:"¿Seguro de eliminar?",onConfirm:ie=>xe(E)},{icon:n(()=>[a(M(qe),{style:{color:"red"}})]),default:n(()=>[o[18]||(o[18]=u("a",null,"Eliminar",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:n(()=>[u("a",{class:"ant-dropdown-link",onClick:o[1]||(o[1]=Ye(()=>{},["prevent"]))},[a(L,{shape:"circle",icon:Ce(M(je)),size:"small"},null,8,["icon"])])]),_:2},1024)):O("",!0)]),_:1},8,["scroll","data-source","loading"])]),u("div",Ot,[u("span",null,[a(ve,{color:"blue"},{default:n(()=>[u("b",null,B($.value),1)]),_:1}),o[20]||(o[20]=j("Convenios"))]),a(Te,{size:"small",total:$.value,pageSize:e.value,onChange:s,showSizeChanger:!1},null,8,["total","pageSize"])]),a(ae,{open:z.value,"onUpdate:open":o[3]||(o[3]=C=>z.value=C),"root-class-name":"root-class-name",title:"Convenios",placement:"right",width:"650"},{default:n(()=>[a(ot,{idConvenio:m.value,onCloseDraw:o[2]||(o[2]=C=>se(1))},null,8,["idConvenio"])]),_:1},8,["open"]),a(ae,{open:D.value,"onUpdate:open":o[6]||(o[6]=C=>D.value=C),title:"Acciones",placement:"right",width:"550"},{default:n(()=>[a(rt,{idConvenio:m.value,onCloseDraw:o[4]||(o[4]=C=>se(2)),onRefreshTable:o[5]||(o[5]=C=>Q())},null,8,["idConvenio"])]),_:1},8,["open"]),a(ae,{open:q.value,"onUpdate:open":o[8]||(o[8]=C=>q.value=C),title:"Cargar Archivos",placement:"right",width:"550"},{default:n(()=>[a(vt,{idConvenio:m.value,onCloseDraw:o[7]||(o[7]=C=>se(3))},null,8,["idConvenio"])]),_:1},8,["open"]),a(ae,{open:r.value,"onUpdate:open":o[11]||(o[11]=C=>r.value=C),title:"Observaciones",placement:"right",width:"550"},{default:n(()=>[a(dt,{idConvenio:m.value,onCloseDraw:o[9]||(o[9]=C=>se(4)),onRefreshTable:o[10]||(o[10]=C=>Q())},null,8,["idConvenio"])]),_:1},8,["open"]),a(ae,{open:v.value,"onUpdate:open":o[12]||(o[12]=C=>v.value=C),title:"Compromisos",placement:"right",width:"850"},{default:n(()=>[a(Dt,{convenio:m.value},null,8,["convenio"])]),_:1},8,["open"])],64)}}},Ft=De(It,[["__scopeId","data-v-5982c910"]]);export{Ft as default};
