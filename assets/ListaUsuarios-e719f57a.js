import{r as d,a as $,j as q,b as t,o,d as g,e as h,c as n,w as e,F as w,k as I,m as z,y as i,g as l,n as u,C as G,E as R,f as X}from"./index-96f21589.js";import{M as Y}from"./MoreOutlined-99b8e153.js";const H={id:"components-table-demo-size"},J=h("h3",null,"Lista de usuarios",-1),K={class:"paginator"},ae={__name:"ListaUsuarios",setup(Q){const y=d([]),f=d(!1),A=d(1e3),E=d("60vh"),m=d(!1),k=d(0),x=d(null),p=$({password:""}),b=d({page:1}),U=[{title:"Nombres",dataIndex:"nombres",fixed:"left",width:160},{title:"Apellidos",dataIndex:"apellidos",fixed:"left",width:160},{title:"N° documento",dataIndex:"nro_documento",align:"center",width:150},{title:"Usuario",dataIndex:"usuario",align:"center",width:120},{title:"Correo",dataIndex:"correo",width:180},{title:"Celular",dataIndex:"celular",align:"center",width:120},{title:"Tipo de usuario",dataIndex:"tipo_usuario",align:"center",width:150},{title:"Estado",dataIndex:"estado",align:"center",width:130},{title:"",dataIndex:"actions",width:55}],N=a=>{b.value.page=a,C()},C=async()=>{try{f.value=!0;const a=await I({url:"/users",method:"GET",params:b.value});y.value=a,k.value=a.total}catch(a){console.error("Error de red:",a)}finally{f.value=!1}},M=a=>{m.value=!0,x.value=a},S=async()=>{if(!p.password)return z.error("El campo contraseña esta vacío");const a=x.value,r={new_password:p.password},s=await I({url:`/user/change-password/${a}`,method:"PUT",data:r});s.message&&(p.password="",z.success(s.message)),m.value=!1};return q(C),(a,r)=>{const s=t("a-tag"),B=t("a-button"),v=t("a-menu-item"),T=t("a-menu"),V=t("a-dropdown"),L=t("a-table"),O=t("a-pagination"),P=t("a-input"),j=t("a-form-item"),D=t("a-form"),F=t("a-modal");return o(),g(w,null,[h("div",H,[J,n(L,{bordered:"",class:"ant-table-striped",scroll:{x:A.value,y:E.value},columns:U,"data-source":y.value,pagination:!1,loading:f.value,size:"small"},{bodyCell:e(({column:c,record:_})=>[c.dataIndex=="tipo_usuario"?(o(),g(w,{key:0},[_.tipo_usuario=="Admin"?(o(),i(s,{key:0,bordered:!1,color:"processing"},{default:e(()=>[l("Administrador")]),_:1})):u("",!0),_.tipo_usuario=="Invitado"?(o(),i(s,{key:1,bordered:!1,color:"magenta"},{default:e(()=>[l("Invitado")]),_:1})):u("",!0),_.tipo_usuario===3?(o(),i(s,{key:2,bordered:!1,color:"purple"},{default:e(()=>[l("3")]),_:1})):u("",!0),_.tipo_usuario===4?(o(),i(s,{key:3,bordered:!1,color:"warning"},{default:e(()=>[l("4")]),_:1})):u("",!0),_.tipo_usuario===5?(o(),i(s,{key:4,bordered:!1,color:"cyan"},{default:e(()=>[l("5")]),_:1})):u("",!0)],64)):u("",!0),c.dataIndex=="estado"?(o(),g(w,{key:1},[_.activo==1?(o(),i(s,{key:0,color:"success"},{default:e(()=>[l("Activo")]),_:1})):(o(),i(s,{key:1,color:"error"},{default:e(()=>[l("Inactivo")]),_:1}))],64)):u("",!0),c.dataIndex=="actions"?(o(),i(V,{key:2,trigger:["click"]},{overlay:e(()=>[n(T,null,{default:e(()=>[n(v,{key:"1"},{default:e(()=>[l("Editar")]),_:1}),n(v,{key:"2"},{default:e(()=>[l("Dar de baja / Activar")]),_:1}),n(v,{key:"3",onClick:W=>M(_.id)},{default:e(()=>[l(" Actualizar clave")]),_:2},1032,["onClick"])]),_:2},1024)]),default:e(()=>[n(B,{onClick:r[0]||(r[0]=G(()=>{},["prevent"])),shape:"circle",size:"small",icon:R(X(Y))},null,8,["icon"])]),_:2},1024)):u("",!0)]),_:1},8,["scroll","data-source","loading"])]),h("div",K,[n(O,{size:"small",total:k.value,pageSize:20,onChange:N,showSizeChanger:!1},null,8,["total"])]),n(F,{"ok-text":"Cambiar contraseña",open:m.value,"onUpdate:open":r[2]||(r[2]=c=>m.value=c),title:"Actualizar contraseña",onOk:S},{default:e(()=>[n(D,{layout:"vertical",model:p,name:"basic",autocomplete:"off"},{default:e(()=>[n(j,{label:"Contraseña",name:"password"},{default:e(()=>[n(P,{value:p.password,"onUpdate:value":r[1]||(r[1]=c=>p.password=c)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])],64)}}};export{ae as default};
