import{_ as Y}from"./TableComponent-57856cc1.js";import{r as o,a as C,j as L,a5 as u,b as v,o as R,d as M,c as d,w as f,l as E,K as x,f as z,e as k}from"./index-ba79ebd4.js";import{d as P}from"./downloadExcel-eb41d24b.js";import{_ as U}from"./DrawerSolicitante.componente-0a665b8f.js";import"./es-86686782.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-60df6982.js";import"./FormComponent-9e3f442c.js";import"./selectes-433e444c.js";const G={class:"advisory-table"},B=["onClick"],W={__name:"SolicitantesLista",setup(F){JSON.parse(localStorage.getItem("role"));const p=o([]),h=o(0),w=o(150),c=o(!1),m=o(!1);o("Asesorías");const i=o(!1),g=o(null),a=C({asesor:null,name:null,page:1}),I=o([]),S=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"TIPO DOCUMENTO",fixed:"left",dataIndex:"typedocument",align:"center",width:120},{title:"NUM. DOC",dataIndex:"document",fixed:"left",width:120,align:"center"},{title:"NOMBRES",dataIndex:"name",width:170},{title:"APELLIDOS",dataIndex:"last_name",width:180},{title:"REGIÓN",dataIndex:"city",align:"center",width:140},{title:"PROVINCIA",dataIndex:"province",align:"center",width:140},{title:"DISTRITO",dataIndex:"district",align:"center",width:150},{title:"CELULAR",dataIndex:"phone",align:"center",width:100},{title:"EMAIL",dataIndex:"email",width:240},{title:"GÉNERO",dataIndex:"gender",align:"center",width:90},{title:"DISCAPACIDAD",dataIndex:"sick",align:"center",width:120},{title:"HIJOS",dataIndex:"hasSoon",align:"center",width:120},{title:"REGISTRADO POR",dataIndex:"registered",width:200},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],y=()=>{console.log("handleNew...")},D=async()=>{m.value=!0;try{const e={paginate:!1};a.year&&(e.year=E(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);let t=null,n=null,s=null;a.type==1&&(t="historial/advisories/filters",n="download/asesories",s="Asesorías"),a.type==2&&(t="historial/formalizations-10/filters",n="download/formalizations-ruc10",s="Formalizaciones 10"),a.type==3&&(t="historial/formalizations-20/filters",n="download/formalizations-ruc20",s="Formalizaciones 20");const _=(await x({url:t,method:"GET",params:e})).data;await P(n,s,_)}catch(e){console.error("Error de red:",e)}finally{m.value=!1}},O=async e=>{a.page=e,await r()},N=async e=>{e&&(a.page=1,await r())},T=e=>{g.value=e,i.value=!0},r=async()=>{c.value=!0;try{const e={page:a.page};a.year&&(e.year=E(a.year).format("YYYY")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);const t=await x({url:"person/list",method:"GET",params:e});p.value=t.data.data,h.value=t.data.total,w.value=t.data.per_page}catch(e){console.error("Error de red:",e)}finally{c.value=!1}},A=async()=>{try{const e=await z({url:"select/asesores-report",method:"GET"});e.status==200&&(I.value=e.data)}catch{console.log("Failed to delete")}};return L(async()=>{await r(),await A()}),u("search",a),u("loading",c),u("loadingFile",m),(e,t)=>{const n=v("a-menu-item"),s=v("a-drawer");return R(),M("div",G,[d(Y,{title:"SOLICITANTES",new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",columns:S,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:w.value,nameTotal:"Solicitantes",asesoresList:I.value,dataSource:p.value,total:h.value,onHandleNew:y,onHandleDownloadExcel:D,onHandleSearch:N,onHandlePaginator:O},{"custom-options":f(({record:l})=>[d(n,null,{default:f(()=>[k("a",{onClick:_=>T(l)},"Editar",8,B)]),_:2},1024)]),_:1},8,["pageSize","asesoresList","dataSource","total"]),d(s,{width:"500",title:"EDITAR DATOS DEL SOLICITANTE",open:i.value,"onUpdate:open":t[1]||(t[1]=l=>i.value=l),placement:"right"},{default:f(()=>[d(U,{info:g.value,onCloseDraw:t[0]||(t[0]=l=>(i.value=!1,r()))},null,8,["info"])]),_:1},8,["open"])])}}};export{W as default};
