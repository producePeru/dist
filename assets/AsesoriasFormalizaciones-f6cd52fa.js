import{u as _e}from"./selectes-4a1e1ee8.js";import{f as Oe,r as $e,a as Fe}from"./asesorias-112f0f38.js";import{c as n,A as Ee,L as pe,r as h,a as ye,k as we,K as qe,b as y,o as l,d as T,w as o,e as _,F as Z,x as ve,q as v,h as C,s as u,t as k,M as Te,_ as Ce,i as M,$ as Ue,z as te,m as J,f as Pe,V as Se,u as Le,y as Me,a1 as Ye,p as Ve,j as Ge}from"./index-82550cb7.js";import"./es-8385b054.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import"./storage-f52a41a4.js";import{S as He}from"./DrawerSolicitante.componente-33deae9b.js";var je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};const Be=je;function xe(O){for(var R=1;R<arguments.length;R++){var E=arguments[R]!=null?Object(arguments[R]):{},m=Object.keys(E);typeof Object.getOwnPropertySymbols=="function"&&(m=m.concat(Object.getOwnPropertySymbols(E).filter(function(I){return Object.getOwnPropertyDescriptor(E,I).enumerable}))),m.forEach(function(I){Je(O,I,E[I])})}return O}function Je(O,R,E){return R in O?Object.defineProperty(O,R,{value:E,enumerable:!0,configurable:!0,writable:!0}):O[R]=E,O}var ge=function(R,E){var m=xe({},R,E.attrs);return n(Ee,xe({},m,{icon:Be}),null)};ge.displayName="RedoOutlined";ge.inheritAttrs=!1;const Ke=ge;const We={class:"grid-ruc20"},Qe={class:"select-notaries"},Ze={class:"name"},Xe={class:"city"},ea={class:"address"},aa="DD/MM/YYYY",ta={__name:"AllFormalizacion20",props:["info","idCde"],emits:["closeDraw"],setup(O,{emit:R}){pe.locale("es");const E=Ue({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),m=R,I=O,$=h(null),z=JSON.parse(localStorage.getItem("profile")),Y=JSON.parse(localStorage.getItem("role")),p=_e(),a=h(!1),V=h(!1),G=h(!0),d=h([]),q=h(null),e=ye({});p.$patch({cities:p.cities}),p.$patch({modalities:p.modalities}),p.$patch({economicSectors:p.economicSectors}),p.$patch({comercialActivities:p.comercialActivities}),p.$patch({regimes:p.regimes}),p.$patch({typeCapital:p.typeCapital}),p.fetchEconomicSectors(),p.fetchComercialActivities(),p.fetchRegimes(),p.fetchModalities(),p.fetchTypeCapital(),p.fetchCities();const F=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}],K=t=>t&&t>pe().endOf("day"),B=t=>{if(t=="ruc"){const x=e.ruc;(x<2e10||x>20999999999)&&(e.ruc=null)}},U=t=>{(t=="ruc"||t=="montocapital")&&(e[t]=e[t].replace(/\D/g,""))},S=(t,x)=>{const c=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=x.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),ae=x.city.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),D=x.province.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Q=x.district.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.includes(c)||ae.includes(c)||D.includes(c)||Q.includes(c)},r=async()=>{try{V.value=!0;const t={name:q.value};(await te({url:"create/comercial-activities",method:"POST",data:t})).status==200&&(q.value=null,p.fetchComercialActivities())}catch(t){console.log(t)}finally{V.value=!1}},b=t=>{e.province_id=null,e.district_id=null,p.fetchProvinces(t)},A=t=>{e.district_id=null,p.fetchDistricts(t)},H=async()=>{try{const{data:t}=await Pe({url:"public/notaries-filters",method:"GET"}),x=t.map(c=>({value:c.id,name:c.name,city:c.city.name,province:c.province.name,district:c.district.name,address:c.address}));d.value=x,G.value=!1}catch(t){console.error("Error de red:",t)}},j=(t,x)=>{const c=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return x.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(c)};function W(t){$.value=Oe;const{documentnumber:x,city_id:c,province_id:s,district_id:ae,address:D}=I.info,Q=Y.some(ne=>ne.id===7);e.dni=x,e.city_id=c,b(c),e.province_id=s,A(s),e.district_id=ae,e.address=D,H(),Q&&($.value.notary_id.disabled=!0,$.value.modality_id.disabled=!0,e.modality_id=1,e.notary_id=z.notary_id)}const ee=async()=>{if(a.value=!0,!I.info.id)return J.error("Error al registrar, actualiza la página");const t={codesunarp:e.codesunarp,numbernotary:e.numbernotary,address:e.address,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,regime_id:e.regime_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,modality_id:e.modality_id,notary_id:e.notary_id,user_id:z.user_id,people_id:I.info.id,nameMype:e.nameMype,dateReception:e.dateReception?pe(e.dateReception).format("YYYY-MM-DD"):null,dateTramite:e.dateTramite?pe(e.dateTramite).format("YYYY-MM-DD"):null,ruc:e.ruc,dni:e.dni,typecapital_id:e.typecapital_id,isbic:e.isbic,montocapital:e.montocapital,cde_id:I.idCde?I.idCde:null};try{const x=await te({url:"formalization/create-ruc20",method:"POST",data:t});if(x.status===200){const c={razonSocial:null,ruc:e.ruc,createdFrom:"F20"};J.success(x.message),e.codesunarp=null,e.economicsector_id=null,e.comercialactivity_id=null,e.regime_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.modality_id=null,e.nameMype=null,e.dateReception=null,e.dateTramite=null,e.notary_id=null,e.ruc=null,e.numbernotary=null,e.isbic=null,e.montocapital=null,e.typecapital_id=null,m("closeDraw",!0)}}catch(x){console.log("Error: "+x)}finally{a.value=!1}};return we(()=>{I.info&&W(I.info)}),qe(()=>I.info,t=>{t&&W()}),(t,x)=>{const c=y("a-select"),s=y("a-form-item"),ae=y("a-date-picker"),D=y("a-divider"),Q=y("a-input"),ne=y("a-button"),de=y("a-space"),re=y("a-input-number"),fe=y("a-form"),ce=y("a-spin");return l(),T("div",null,[n(ce,{spinning:G.value},{default:o(()=>[n(fe,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:ee},{default:o(()=>[_("div",We,[(l(!0),T(Z,null,ve($.value,(i,le)=>(l(),T(Z,{key:le},[i.type==="iSelect"?(l(),v(s,{key:0,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[i.name=="regime_id"?(l(),v(c,{key:0,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:C(p).regimes,"show-search":"","filter-option":j},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="modality_id"?(l(),v(c,{key:1,disabled:i.disabled,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:C(p).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0),i.name=="typecapital_id"?(l(),v(c,{key:2,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:C(p).typeCapital},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="isbic"?(l(),v(c,{key:3,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:F},null,8,["value","onUpdate:value"])):u("",!0),i.name=="notary_id"?(l(),v(c,{key:4,disabled:i.disabled,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:d.value,"option-label-prop":"name","show-search":"","filter-option":S},{option:o(({value:f,name:ie,city:N,province:g,district:X,address:oe})=>[_("div",Qe,[_("span",Ze,k(ie),1),_("span",Xe,k(N)+" - "+k(g)+" - "+k(X),1),_("span",ea,k(oe),1)])]),_:2},1032,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iDate"?(l(),v(s,{key:1,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(ae,{locale:C(Te),value:e[i.name],"onUpdate:value":f=>e[i.name]=f,style:{width:"100%"},format:aa,placeholder:"día/mes/año","disabled-date":K,disabled:i.disabled,onChange:x[0]||(x[0]=f=>e.birthday=t.birthdateDate)},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iSelectWrite"?(l(),v(s,{key:2,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[i.name=="comercialactivity_id"?(l(),v(c,{key:0,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:C(p).comercialActivities,"filter-option":j},{dropdownRender:o(({menuNode:f})=>[n(C(E),{vnodes:f},null,8,["vnodes"]),n(D,{style:{margin:"4px 0"}}),n(de,{style:{padding:"4px 8px"}},{default:o(()=>[n(Q,{ref_for:!0,ref:"inputRef",value:q.value,"onUpdate:value":x[1]||(x[1]=ie=>q.value=ie),placeholder:"Nueva actividad"},null,8,["value"]),n(ne,{type:"text",onClick:r,loading:V.value},{icon:o(()=>[n(C(Ce))]),default:o(()=>[M(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):u("",!0),i.name=="economicsector_id"?(l(),v(c,{key:1,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:C(p).economicSectors,"filter-option":j},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="city_id"?(l(),v(c,{key:2,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:C(p).cities,"filter-option":j,onChange:b},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="province_id"?(l(),v(c,{key:3,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:C(p).provinces,"filter-option":j,onChange:A,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),i.name=="district_id"?(l(),v(c,{key:4,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:C(p).districts,"filter-option":j,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iText"?(l(),v(s,{key:3,name:i.name,label:i.label,rules:[{required:i.required,message:i.message,type:i.email,max:i.max,min:i.min}]},{default:o(()=>[n(Q,{onInput:f=>U(i.name),value:e[i.name],"onUpdate:value":f=>e[i.name]=f,disabled:i.disabled,maxlength:i.max,placeholder:i.placeholder},null,8,["onInput","value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iNumber"?(l(),v(s,{key:4,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(re,{style:{width:"100%"},value:e[i.name],"onUpdate:value":f=>e[i.name]=f,maxlength:11,onChange:f=>B(i.name)},null,8,["value","onUpdate:value","onChange"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iTextLol"?(l(),v(s,{key:5,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(Q,{onInput:f=>U(i.name),value:e.dni,"onUpdate:value":x[2]||(x[2]=f=>e.dni=f),disabled:!I.documentnumber,maxlength:i.max,placeholder:i.placeholder},null,8,["onInput","value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iMoney"?(l(),v(s,{key:6,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(re,{"min:":0,style:{width:"100%"},value:e[i.name],"onUpdate:value":f=>e[i.name]=f,formatter:f=>`S/ ${f}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:f=>f.replace(/S\/\s?|(,*)/g,"")},null,8,["value","onUpdate:value","formatter","parser"])]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),n(s,null,{default:o(()=>[n(ne,{class:"btn-produce",type:"primary","html-type":"submit",loading:a.value},{default:o(()=>[M("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},oa=se(ta,[["__scopeId","data-v-2687f40d"]]);const na={class:"wrapper-booking"},ia={class:"grid-booking"},la={__name:"FormalizacionRUC10",props:["info","idCde"],emits:["closeDraw"],setup(O,{emit:R}){const E=JSON.parse(localStorage.getItem("role")),m=Ue({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),I=JSON.parse(localStorage.getItem("profile")),$=O,z=R,Y=h(!1),p=h(null);h(null),h(!1);const a=_e(),V=h(!1);a.$patch({cities:a.cities}),a.$patch({provinces:a.provinces}),a.$patch({districts:a.districts}),a.$patch({modalities:a.modalities}),a.$patch({detailProcedures:a.detailProcedures}),a.$patch({economicSectors:a.economicSectors}),a.$patch({comercialActivities:a.comercialActivities}),a.fetchDetailProcedures(),a.fetchModalities(),a.fetchEconomicSectors(),a.fetchComercialActivities(),a.fetchCities();const G=h(!0),d=ye({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,address:null,user_id:I.user_id}),q=()=>{const{documentnumber:r,city_id:b,province_id:A,district_id:H,address:j}=$.info;d.dni=r,d.modality_id=E.some(W=>W.id===7)?1:null,d.city_id=b,F(b),d.province_id=A,K(A),d.district_id=H,d.address=j,a.cities&&(G.value=!1)},e=async()=>{try{V.value=!0;const r={name:p.value};(await te({url:"create/comercial-activities",method:"POST",data:r})).status==200&&(p.value=null,a.fetchComercialActivities())}catch(r){console.log(r)}finally{V.value=!1}},F=r=>{d.province_id=null,d.district_id=null,a.fetchProvinces(r)},K=r=>{d.district_id=null,a.fetchDistricts(r)},B=(r,b)=>{const A=r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return b.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(A)},U=async()=>{if(Y.value=!0,!$.info.id)return J.error("Error al registrar, actualiza la página");const r={dni:d.dni,detailprocedure_id:d.detailprocedure_id,modality_id:d.modality_id,economicsector_id:d.economicsector_id,comercialactivity_id:d.comercialactivity_id,city_id:d.city_id,province_id:d.province_id,district_id:d.district_id,address:d.address,ruc:d.ruc,user_id:I.user_id,people_id:$.info.id,cde_id:$.idCde?$.idCde:null};try{const b=await te({url:"formalization/create-ruc-10",method:"POST",data:r});if(b.status===200){const A={razonSocial:null,ruc:d.ruc,createdFrom:"F10"};J.success(b.message),d.detailprocedure_id=null,d.modality_id=null,d.economicsector_id=null,d.comercialactivity_id=null,d.city_id=null,d.province_id=null,d.district_id=null,d.address=null,d.ruc=null,z("closeDraw",!0)}}catch(b){console.log("Error: "+b)}finally{Y.value=!1}},S=()=>{J.warning("Debes de completar todos los espacios requeridos")};return(r,b)=>{const A=y("a-select"),H=y("a-form-item"),j=y("a-input"),W=y("a-divider"),ee=y("a-button"),t=y("a-space"),x=y("a-form"),c=y("a-spin");return l(),T("div",na,[n(c,{spinning:G.value},{default:o(()=>[n(x,{layout:"vertical",model:d,name:"basic",autocomplete:"off",onFinish:U,onFinishFailed:S},{default:o(()=>[_("div",ia,[(l(!0),T(Z,null,ve(C($e),(s,ae)=>(l(),T(Z,{key:ae},[s.type==="iSelect"?(l(),v(H,{key:0,class:"item-max",name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:o(()=>[s.name=="detailprocedure_id"?(l(),v(A,{key:0,value:d[s.name],"onUpdate:value":D=>d[s.name]=D,options:C(a).detailProcedures},null,8,["value","onUpdate:value","options"])):u("",!0),s.name=="modality_id"?(l(),v(A,{key:1,disabled:s.disabled,value:d[s.name],"onUpdate:value":D=>d[s.name]=D,options:C(a).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),s.type==="iText"?(l(),v(H,{key:1,name:s.name,label:s.label,rules:[{required:s.required,message:s.message,type:s.email,max:s.max}]},{default:o(()=>[n(j,{value:d[s.name],"onUpdate:value":D=>d[s.name]=D,disabled:s.name==="dni"&&!!d[s.name],maxlength:s.max,placeholder:s.placeholder},null,8,["value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),s.type==="iSelectWrite"?(l(),v(H,{key:2,class:"item-max",name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:o(()=>[s.name=="comercialactivity_id"?(l(),v(A,{key:0,value:d[s.name],"onUpdate:value":D=>d[s.name]=D,"show-search":"",options:C(a).comercialActivities,"filter-option":B},{dropdownRender:o(({menuNode:D})=>[n(C(m),{vnodes:D},null,8,["vnodes"]),n(W,{style:{margin:"4px 0"}}),n(t,{style:{padding:"4px 8px"}},{default:o(()=>[n(j,{ref_for:!0,ref:"inputRef",value:p.value,"onUpdate:value":b[0]||(b[0]=Q=>p.value=Q),placeholder:"Nueva actividad"},null,8,["value"]),n(ee,{type:"text",onClick:e,loading:V.value},{icon:o(()=>[n(C(Ce))]),default:o(()=>[M(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):u("",!0),s.name=="economicsector_id"?(l(),v(A,{key:1,value:d[s.name],"onUpdate:value":D=>d[s.name]=D,"show-search":"",options:C(a).economicSectors,"filter-option":B},null,8,["value","onUpdate:value","options"])):u("",!0),s.name=="city_id"?(l(),v(A,{key:2,value:d[s.name],"onUpdate:value":D=>d[s.name]=D,"show-search":"",options:C(a).cities,"filter-option":B,onChange:F},null,8,["value","onUpdate:value","options"])):u("",!0),s.name=="province_id"?(l(),v(A,{key:3,value:d[s.name],"onUpdate:value":D=>d[s.name]=D,"show-search":"",options:C(a).provinces,"filter-option":B,onChange:K,disabled:!d.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),s.name=="district_id"?(l(),v(A,{key:4,value:d[s.name],"onUpdate:value":D=>d[s.name]=D,"show-search":"",options:C(a).districts,"filter-option":B,disabled:!d.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),n(H,null,{default:o(()=>[n(ee,{type:"primary",class:"btn-produce","html-type":"submit",loading:Y.value},{default:o(()=>[M("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),_("div",null,k(q()),1)]),_:1},8,["spinning"])])}}},sa=se(la,[["__scopeId","data-v-8ce8f14c"]]);const da={class:"wrapper-booking"},ra={class:"grid-booking"},ca={__name:"AsesoriaNuevo",props:["info","idCde"],emits:["closeDraw"],setup(O,{emit:R}){const E=JSON.parse(localStorage.getItem("role")),m=_e(),I=JSON.parse(localStorage.getItem("profile")),$=h(!1),z=O,Y=R;h(!1),h(null),h(null),m.$patch({components:m.components}),m.$patch({componentThemes:m.componentThemes}),m.$patch({modalities:m.modalities}),m.$patch({cities:m.cities}),m.$patch({economicSectors:m.economicSectors}),m.$patch({comercialActivities:m.comercialActivities}),m.fetchEconomicSectors(),m.fetchComercialActivities(),m.fetchComponents(),m.fetchComponentThemes(),m.fetchModalities(),m.fetchCities(),m.fetchGenders();const p=h(!0),a=ye({cde_id:null,dni:null,economicsector_id:null,comercialactivity_id:null,component_id:null,theme_id:null,modality_id:null,ruc:null,city_id:null,province_id:null,district_id:null,observations:null,user_id:I.user_id}),V=U=>{U=="ruc"&&(a[U]=a[U].replace(/\D/g,""))},G=()=>{const{documentnumber:U,city_id:S,province_id:r,district_id:b}=z.info,A=E.some(H=>H.id===7);a.dni=U,a.city_id=S,q(S),a.province_id=r,e(r),a.district_id=b,a.component_id=A?4:null,a.modality_id=A?1:null,A&&m.fetchComponentThemes(4),m.districts&&(p.value=!1)},d=U=>{a.theme_id=null,m.fetchComponentThemes(U)},q=U=>{a.province_id=null,a.district_id=null,m.fetchProvinces(U)},e=U=>{a.district_id=null,m.fetchDistricts(U)},F=(U,S)=>{const r=U.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return S.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(r)},K=async()=>{if($.value=!0,!z.info.id)return J.error("Error al registrar actualiza la página");const U={dni:a.dni,economicsector_id:a.economicsector_id,comercialactivity_id:a.comercialactivity_id,observations:a.observations,user_id:I.user_id,people_id:z.info.id,component_id:a.component_id,theme_id:a.theme_id,modality_id:a.modality_id,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,ruc:a.ruc,cde_id:z.idCde?z.idCde:null};try{const S=await te({url:"advisory/create",method:"POST",data:U});if(S.status===200){const r={razonSocial:null,ruc:a.ruc,createdFrom:"asesorias"};J.success(S.message),a.component_id=null,a.theme_id=null,a.modality_id=null,a.city_id=null,a.province_id=null,a.district_id=null,a.observations=null,a.ruc=null,a.economicsector_id=null,a.comercialactivity_id=null,Y("closeDraw",!0)}}catch(S){console.log("Error: "+S)}finally{$.value=!1}},B=()=>{J.warning("Debes de completar todos los espacios requeridos")};return(U,S)=>{const r=y("a-select"),b=y("a-form-item"),A=y("a-textarea"),H=y("a-input"),j=y("a-button"),W=y("a-form"),ee=y("a-spin");return l(),T("div",da,[n(ee,{spinning:p.value},{default:o(()=>[n(W,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:K,onFinishFailed:B},{default:o(()=>[_("div",ra,[(l(!0),T(Z,null,ve(C(Fe),(t,x)=>(l(),T(Z,{key:x},[t.type==="iSelect"?(l(),v(b,{key:0,class:"item-max",name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:o(()=>[t.name=="modality_id"?(l(),v(r,{key:0,disabled:t.disabled,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,options:C(m).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),t.type==="iTextarea"?(l(),v(b,{key:1,name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:o(()=>[n(A,{value:a[t.name],"onUpdate:value":c=>a[t.name]=c,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):u("",!0),t.type==="iText"?(l(),v(b,{key:2,name:t.name,label:t.label,rules:[{required:t.required,message:t.message,type:t.email,max:t.max}]},{default:o(()=>[n(H,{value:a[t.name],"onUpdate:value":c=>a[t.name]=c,maxlength:t.max,onInput:c=>V(t.name),placeholder:t.placeholder,disabled:t.name==="dni"&&!!a[t.name]},null,8,["value","onUpdate:value","maxlength","onInput","placeholder","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),t.type==="iSelectWrite"?(l(),v(b,{key:3,class:"item-max",name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:o(()=>[t.name=="city_id"?(l(),v(r,{key:0,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:C(m).cities,"filter-option":F,onChange:q},null,8,["value","onUpdate:value","options"])):u("",!0),t.name=="province_id"?(l(),v(r,{key:1,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:C(m).provinces,"filter-option":F,onChange:e,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),t.name=="district_id"?(l(),v(r,{key:2,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:C(m).districts,"filter-option":F,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),t.name=="economicsector_id"?(l(),v(r,{key:3,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:C(m).economicSectors,"filter-option":F},null,8,["value","onUpdate:value","options"])):u("",!0),t.name=="comercialactivity_id"?(l(),v(r,{key:4,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:C(m).comercialActivities,"filter-option":F},null,8,["value","onUpdate:value","options"])):u("",!0),t.name=="component_id"?(l(),v(r,{key:5,disabled:t.disabled,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:C(m).components,"filter-option":F,onChange:d},null,8,["disabled","value","onUpdate:value","options"])):u("",!0),t.name=="theme_id"?(l(),v(r,{key:6,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:C(m).componentThemes,"filter-option":F,disabled:!a.component_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),_("div",null,k(G()),1),n(b,null,{default:o(()=>[n(j,{type:"primary",class:"btn-produce","html-type":"submit",loading:$.value},{default:o(()=>[M("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},ua=se(ca,[["__scopeId","data-v-dd040715"]]);const ma={key:0},pa={key:0},_a={key:0},va={__name:"AsesoriasHistorial",props:["totaladvisories","totalformalization10","totalformalization20"],setup(O){const R=O,E=h("1"),m=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Componente",dataIndex:"component",width:20},{title:"Tema",dataIndex:"theme",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:60},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],I=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Detalle del trámite",dataIndex:"detailprocedure",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:100},{title:"RUC",dataIndex:"ruc",width:50},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],$=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Régimen",dataIndex:"regime",width:80,align:"center"},{title:"Número solicitud constancia",dataIndex:"numbernotary",width:100},{title:"Nombre empresa",dataIndex:"mypename",width:160},{title:"RUC",dataIndex:"ruc",width:80},{title:"Modalidad",dataIndex:"modality",align:"center",width:70},{title:"Ciudad",dataIndex:"city",width:30},{title:"Provincia",dataIndex:"province",width:20},{title:"Distrito",dataIndex:"district",width:20},{title:"Dirección",dataIndex:"address",width:200}],z=Y=>Se(Y).format("DD/MM/YYYY HH:mm A");return(Y,p)=>{const a=y("a-table"),V=y("a-card"),G=y("a-tab-pane"),d=y("a-tabs");return l(),v(d,{activeKey:E.value,"onUpdate:activeKey":p[0]||(p[0]=q=>E.value=q),type:"card",class:"box-hist"},{default:o(()=>[n(G,{key:"1",tab:"ASESORÍAS"},{default:o(()=>[n(V,null,{default:o(()=>[n(a,{columns:m,"data-source":R.totaladvisories,bordered:"",pagination:!1,size:"small",scroll:{x:1200},"expand-column-width":100},{bodyCell:o(({index:q,column:e,record:F})=>[e.dataIndex==="idx"?(l(),T("span",ma,k(q+1),1)):u("",!0),e.dataIndex==="date_start"?(l(),T(Z,{key:1},[M(k(z(F.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),n(G,{key:"2",tab:"RUC 10"},{default:o(()=>[n(V,null,{default:o(()=>[n(a,{columns:I,"data-source":R.totalformalization10,bordered:"",pagination:!1,size:"small",scroll:{x:1800},"expand-column-width":100},{bodyCell:o(({index:q,column:e,record:F})=>[e.dataIndex==="idx"?(l(),T("span",pa,k(q+1),1)):u("",!0),e.dataIndex==="date_start"?(l(),T(Z,{key:1},[M(k(z(F.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),n(G,{key:"3",tab:"RUC 20"},{default:o(()=>[n(V,null,{default:o(()=>[n(a,{columns:$,"data-source":R.totalformalization20,bordered:"",pagination:!1,size:"small",scroll:{x:2200},"expand-column-width":100},{bodyCell:o(({index:q,column:e,record:F})=>[e.dataIndex==="idx"?(l(),T("span",_a,k(q+1),1)):u("",!0),e.dataIndex==="date_start"?(l(),T(Z,{key:1},[M(k(z(F.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1},8,["activeKey"])}}},fa=se(va,[["__scopeId","data-v-01e75dfe"]]);const P=O=>(Ve("data-v-07b1ea07"),O=O(),Ge(),O),ha={class:"asesorias"},ya=P(()=>_("h3",{class:"title-produce"},"REGISTRO DE FORMALIZACIONES Y ASESORÍAS",-1)),ga=P(()=>_("br",null,null,-1)),ba={class:"wrapper-s"},xa=P(()=>_("label",{class:"label"},"Seleccione el tipo de documento",-1)),wa=P(()=>_("label",{class:"label"},"Digite el número de documento",-1)),Ca=P(()=>_("h4",{class:"title-produce"},"RESULTADO DE LA BÚSQUEDA",-1)),Ua=P(()=>_("b",{class:"box-title"},"Apellidos y nombres:",-1)),Sa=P(()=>_("b",{class:"box-title"},"Número de celular:",-1)),Ia=P(()=>_("b",{class:"box-title"},"Correo electrónico:",-1)),Da=P(()=>_("b",{class:"box-title"},"Asesorías:",-1)),ka=P(()=>_("b",{class:"box-title"},"Formalizaciones RUC 20:",-1)),za=P(()=>_("b",{class:"box-title"},"Formalizaciones RUC 10:",-1)),Aa=P(()=>_("h4",{class:"title-produce"},"SELECCIONAR CDE",-1)),Ra=P(()=>_("h4",{class:"title-produce"},"¿DESEA REGISTRAR UN NUEVO SERVICIO?",-1)),Na={key:0,class:"card-as",style:{padding:"1rem"}},Oa=P(()=>_("h4",{class:"title-produce"},"HISTORIAL",-1)),$a=P(()=>_("div",{class:"steps-content"},null,-1)),Fa={class:"pendient"},Ea={class:"info"},qa=P(()=>_("b",null,"Código SID SUNARP",-1)),Ta={class:"code-number"},Pa=P(()=>_("b",null,"Atendido por: ",-1)),La=P(()=>_("b",null,"Fecha de registro: ",-1)),Ma=P(()=>_("div",{style:{"text-align":"center"}},"NUEVO REGISTRO",-1)),Ya=[Ma],Va={__name:"AsesoriasFormalizaciones",setup(O){const R=JSON.parse(localStorage.getItem("role")),E=()=>R.some(N=>N.id===7),m=_e(),I=Le(),$=Me(),z=h(0),Y=h(null),p=h(null),a=h([{value:"asesoria",label:"ASESORÍA"},{value:"ruc20",label:"RUC 20"},{value:"ruc10",label:"RUC 10"}]);m.$patch({cdes:m.cdes}),m.fetchCdes();const V=h(null),G=h(!1),d=h(null),q=h(!1),e=h(!1),F=h(!1),K=h(!1),B=h(!1),U=h(!1),S=h(""),r=h([]),b=h(!1),A=h(0),H=h(!1),j=h([]);h(null);const W=h([]),ee=h([]),t=h([]),x=h(!1),c=N=>{p.value.cde_id=N,localStorage.setItem("profile",JSON.stringify(p.value))},s=(N,g)=>{const X=N.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return g.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(X)},ae=()=>{f(S.value),G.value=!1},D=N=>Se(N).format("DD/MM/YYYY HH:mm A"),Q=()=>{de()},ne=()=>{S.value=S.value.replace(/\D/g,"")},de=()=>{x.value=!1,S.value="",r.value=[],j.value=[],I.push({name:"asesorias-formalizaciones"})},re=()=>{if(d.value=null,d.value=r.value,!Y.value)return J.warning("Seleccionar un tipo de servicio");Y.value=="asesoria"&&(U.value=!0),Y.value=="ruc10"&&(B.value=!0),Y.value=="ruc20"&&i()},fe=()=>{V.value=r.value,G.value=!0},ce=()=>{A.value=0,K.value=!0,e.value=!1},i=async()=>{try{H.value=!0;const N=await te({url:`formalization/list-ruc-20/${r.value.id}`,method:"GET"});if(N.length<1)return ce();F.value=N,e.value=!0}catch(N){console.log(N)}finally{H.value=!1}},le=async()=>{b.value=!0;const N=await te({url:`person/found/${z.value}/${S.value}`,method:"GET"});if(N.status==200)return r.value=N.data,ie(r.value.id),b.value=!1},f=async N=>{if(b.value=!0,!N)return J.warning("Ingresa un número de documento"),b.value=!1;if(z.value==0)return J.warning("Seleccionar el tipo de documento"),b.value=!1;if(z.value==1&&S.value.length<8){J.warning("El número de DNI está incompleto"),b.value=!1;return}const g=await te({url:`person/found/${z.value}/${S.value}`,method:"GET"});if(g.status==200)return r.value=g.data,ie(g.data.id),p.value=JSON.parse(localStorage.getItem("profile")),b.value=!1;if(g.status===404){const X={type:z.value,access:"asesorias",number:S.value};I.push({name:"registrar-persona",query:X})}},ie=async N=>{try{const{data:g}=await te({url:`historial/registers/${N}`,method:"GET"});W.value=g.advisories,ee.value=g.formalization10,t.value=g.formalization20,x.value=!0}catch(g){console.error("Error de red:",g)}};return we(()=>{$.query.type&&(z.value=$.query.type,S.value=$.query.number)}),(N,g)=>{const X=y("a-radio"),oe=y("a-tooltip"),Ie=y("a-radio-group"),De=y("a-input-search"),he=y("a-card"),L=y("a-col"),ue=y("a-row"),be=y("a-select"),ke=y("a-button"),me=y("a-drawer"),ze=y("a-tag"),Ae=y("a-spin"),Re=y("a-modal");return l(),T(Z,null,[_("div",ha,[ya,ga,n(he,{class:"card-as card-gray"},{default:o(()=>[C($).query.dni?(l(),v(C(Ke),{key:0,class:"ico-reload",onClick:Q})):u("",!0),_("div",ba,[_("div",null,[xa,n(Ie,{value:z.value,"onUpdate:value":g[0]||(g[0]=w=>z.value=w),onChange:de,class:"radio-produce"},{default:o(()=>[n(oe,{color:"cyan"},{title:o(()=>[M("Documento Nacional de Identidad")]),default:o(()=>[n(X,{value:"1"},{default:o(()=>[M("DNI")]),_:1})]),_:1}),n(oe,{color:"cyan"},{title:o(()=>[M("Carnet de Extranjería")]),default:o(()=>[n(X,{value:"2"},{default:o(()=>[M("CE")]),_:1})]),_:1}),n(oe,{color:"cyan"},{title:o(()=>[M("Pasaporte")]),default:o(()=>[n(X,{value:"3"},{default:o(()=>[M("PAS")]),_:1})]),_:1}),n(oe,{color:"cyan"},{title:o(()=>[M("Permiso Temporal de Permanencia")]),default:o(()=>[n(X,{value:"4"},{default:o(()=>[M("PTP")]),_:1})]),_:1})]),_:1},8,["value"])]),_("div",null,[wa,n(De,{"enter-button":"BUSCAR",value:S.value,"onUpdate:value":g[1]||(g[1]=w=>S.value=w),placeholder:"",loading:b.value,onSearch:f,onInput:ne,class:"search-produce",maxlength:z.value==1?8:20},null,8,["value","loading","maxlength"])])])]),_:1}),n(ue,{gutter:[16,16]},{default:o(()=>[n(L,{xs:24,sm:24,lg:12},{default:o(()=>[r.value.length!=0?(l(),v(he,{key:0},{default:o(()=>[Ca,n(C(Ye),{class:"box-icoedit",onClick:fe}),n(ue,{gutter:[0,2],class:"box-info"},{default:o(()=>[n(L,{xs:12,sm:8},{default:o(()=>[Ua]),_:1}),n(L,{xs:12,sm:12},{default:o(()=>[_("span",null,k(r.value.lastname)+" "+k(r.value.middlename)+", "+k(r.value.name),1)]),_:1}),n(L,{xs:12,sm:8},{default:o(()=>[Sa]),_:1}),n(L,{xs:12,sm:12},{default:o(()=>[_("span",null,k(r.value.phone?r.value.phone:"-"),1)]),_:1}),n(L,{xs:12,sm:8},{default:o(()=>[Ia]),_:1}),n(L,{xs:12,sm:12},{default:o(()=>[_("span",null,k(r.value.email?r.value.email:"-"),1)]),_:1}),n(L,{xs:12,sm:8},{default:o(()=>[Da]),_:1}),n(L,{xs:12,sm:12},{default:o(()=>{var w;return[_("span",null,k((w=r.value)==null?void 0:w.idadvisory.length),1)]}),_:1}),n(L,{xs:12,sm:8},{default:o(()=>[ka]),_:1}),n(L,{xs:12,sm:12},{default:o(()=>{var w;return[_("span",null,k((w=r.value)==null?void 0:w.idformalization20.length),1)]}),_:1}),n(L,{xs:12,sm:8},{default:o(()=>[za]),_:1}),n(L,{xs:12,sm:12},{default:o(()=>{var w;return[_("span",null,k((w=r.value)==null?void 0:w.idformalization10.length),1)]}),_:1})]),_:1})]),_:1})):u("",!0)]),_:1}),n(L,{xs:24,sm:24,lg:12},{default:o(()=>[r.value.length!=0?(l(),v(he,{key:0,style:{height:"100%"}},{default:o(()=>[n(ue,{gutter:[16,24]},{default:o(()=>[E()?u("",!0):(l(),v(L,{key:0,xs:24,sm:18,md:12,lg:12},{default:o(()=>[Aa,n(be,{class:"w-100",value:p.value.cde_id,"onUpdate:value":g[2]||(g[2]=w=>p.value.cde_id=w),options:C(m).cdes,"show-search":"","filter-option":s,onChange:c},null,8,["value","options"])]),_:1})),n(L,{xs:24,sm:18,md:12,lg:17},{default:o(()=>[Ra,n(ue,{gutter:[10,0]},{default:o(()=>[n(L,{xs:17,sm:18},{default:o(()=>[n(be,{class:"w-100",value:Y.value,"onUpdate:value":g[3]||(g[3]=w=>Y.value=w),options:a.value},null,8,["value","options"])]),_:1}),n(L,{xs:6},{default:o(()=>[n(ke,{type:"primary",onClick:re},{default:o(()=>[M("REGISTRAR")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):u("",!0)]),_:1})]),_:1}),x.value?(l(),T("div",Na,[Oa,n(fa,{totaladvisories:W.value,totalformalization10:ee.value,totalformalization20:t.value},null,8,["totaladvisories","totalformalization10","totalformalization20"])])):u("",!0)]),_("section",null,[n(me,{title:"Regitsrar una Formalización con RUC 20",open:K.value,"onUpdate:open":g[5]||(g[5]=w=>K.value=w),placement:"right",width:"880px"},{default:o(()=>[n(oa,{info:d.value,idCde:p.value.cde_id,onCloseDraw:g[4]||(g[4]=w=>(K.value=!1,le()))},null,8,["info","idCde"]),$a]),_:1},8,["open"]),n(me,{width:"600px",title:"Regitsrar Formalización con RUC 10",open:B.value,"onUpdate:open":g[7]||(g[7]=w=>B.value=w),placement:"right"},{default:o(()=>[n(sa,{info:r.value,idCde:p.value.cde_id,onCloseDraw:g[6]||(g[6]=w=>(B.value=!1,le()))},null,8,["info","idCde"])]),_:1},8,["open"]),n(me,{width:"600px",title:"Registrar una asesoría",open:U.value,"onUpdate:open":g[9]||(g[9]=w=>U.value=w),placement:"right"},{default:o(()=>[n(ua,{info:r.value,idCde:p.value.cde_id,onCloseDraw:g[8]||(g[8]=w=>(U.value=!1,le()))},null,8,["info","idCde"])]),_:1},8,["open"]),n(Re,{open:e.value,"onUpdate:open":g[10]||(g[10]=w=>e.value=w),title:"Pendientes",closable:!0,cancelText:"Cerrar",footer:null,maskClosable:!1,width:"380px"},{default:o(()=>[n(Ae,{spinning:q.value},{default:o(()=>[(l(!0),T(Z,null,ve(F.value,(w,Ne)=>(l(),T("div",{key:Ne},[_("div",Fa,[_("div",Ea,[qa,_("span",null,[_("b",Ta,[n(ze,{color:"error",style:{margin:"0"}},{default:o(()=>[M(k(w.codesunarp),1)]),_:2},1024)])]),Pa,_("span",null,k(w.user.profile.name)+" "+k(w.user.profile.lastname),1),La,_("span",null,k(D(w.updated_at)),1)])])]))),128)),_("div",{class:"pendient pendient-btn btn-produce",onClick:ce},Ya)]),_:1},8,["spinning"])]),_:1},8,["open"]),n(me,{width:"600",open:G.value,"onUpdate:open":g[11]||(g[11]=w=>G.value=w),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:o(()=>[n(He,{onCloseDraw:ae,updateValues:V.value},null,8,["updateValues"])]),_:1},8,["open"])])],64)}}},Qa=se(Va,[["__scopeId","data-v-07b1ea07"]]);export{Qa as default};
