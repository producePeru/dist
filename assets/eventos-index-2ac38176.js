import{r as p,a as he,p as b,k as ye,W as O,b as c,o as i,d as $,c as s,w as l,m as A,f as ge,e as m,y as r,s as Ee,i as G,z as h,ab as we,j as B,t as Ie,O as De,h as D,Q as xe,H as Ae}from"./index-9efe7972.js";import{_ as ke}from"./TableComponent-b5e2290e.js";import{_ as Ce}from"./EventosUgo-81a8cecc.js";import{d as H}from"./downloadExcel-b0647e83.js";import{g as Te}from"./usePermissions-e5990c2a.js";import"./es-4cb79e05.js";import{g as j}from"./publicInscripcion-623ff37e.js";import{F as be}from"./FileExcelOutlined-e151562d.js";import"./icoexcel-1b303edf.js";import"./selectes-5b97efab.js";import"./SyncOutlined-ac0e435d.js";import"./MoreOutlined-55406c12.js";/* empty css                                                   */const Oe={class:"layout-content"},Se={style:{margin:"0.6rem 0 0.6rem"}},Ye={class:"stat-box"},Ne={class:"stat-box"},Re={class:"stat-box"},Fe={class:"stat-box"},Me={key:0},Le={class:"draw-filter-item"},ze=["onClick"],Ue=["onClick"],Ve=["onClick"],Pe=["onClick"],ta={__name:"eventos-index",setup($e){const S=p([]),Y=p(0),N=p(150),f=p(null),v=p({}),w=p(!1),k=p(!1),x=p(null),E=p(!1),R=p([]),t=he({year:b("2026","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),q=[{title:"",dataIndex:"copy",fixed:"left",width:50},{title:"TIPO DE ACTIVIDAD",dataIndex:"tipo_actividad",width:180},{title:"NOMBRE DE ACTIVIDAD",dataIndex:"nombre_actividad",width:180},{title:"TEMA DE ACTIVIDAD",dataIndex:"tema",width:180},{title:"NOMBRE DE ENTIDAD ORGANIZADORA",dataIndex:"entidad_aliada",width:180},{title:"ASESOR",dataIndex:"asesor",width:180},{title:"MYPE Y/O EMPRENDEDORES BENEFICIADOS ESPERADOS",dataIndex:"beneficiarios",align:"center",width:180},{title:"MYPE Y/O EMPRENDEDORES INSCRITOS",dataIndex:"attendance_list_count",align:"center",width:180},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:120},{title:"REGIÓN DE LA ACTIVIDAD",dataIndex:"city",width:120},{title:"PROVINCIA DE LA ACTIVIDAD",dataIndex:"province",width:120},{title:"DISTRITO DE LA ACTIVIDAD",dataIndex:"district",width:120},{title:"LUGAR DE LA ACTIVIDAD",dataIndex:"address",width:120},{title:"FECHA CREACIÓN",dataIndex:"created_at",width:140,align:"center"},{title:"TOTAL DE ASESORÍAS",dataIndex:"totalAsesorias",width:140,fixed:"right",align:"center"},{title:"TOTAL DE FORMALIZACIONES",dataIndex:"totalFormalizaciones",width:140,fixed:"right",align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],Z=(e,a)=>{const n=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(n)};async function Q(e,a){const n=W(e,a);await J(n)?D.success("Link copiado"):D.error("No se pudo copiar el link")}function W(e,a){return`${j()}/actividades-ugo/${a}`}async function J(e){var a;try{if((a=navigator.clipboard)!=null&&a.writeText)return await navigator.clipboard.writeText(e),!0;const n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n),n.select();const _=document.execCommand("copy");return document.body.removeChild(n),_}catch{return!1}}const K=p([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]);function X(e,a){const n=`${j()}/actividades-ugo/${a}`;window.open(n,"_blank")}const ee=e=>{x.value=e,w.value=!0},ae=()=>{y(),w.value=!1},te=()=>{x.value=null,w.value=!0},ne=e=>{xe.confirm({title:"¿Deseas eliminar esta actividad?",icon:s(Ae),content:`Se eliminará la actividad: ${e.tema}`,okText:"Eliminar",okType:"danger",cancelText:"Cancelar",async onOk(){try{const a=await A({url:`attendance/delete/${e.id}`,method:"DELETE"});a.status===200&&(y(),D.success(a.message))}catch(a){console.error("Error de red:",a),D.error("Ocurrió un error al eliminar.")}}})},oe=async e=>{try{const a=await A({url:`attendance/event-finally/${e.id}`,method:"PUT"});a.status==200&&(y(),D.success(a.message))}catch(a){console.error("Error de red:",a)}},le=async()=>{E.value=!0;try{const e={};t.year&&(e.year=b(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby),t.asesor&&(e.asesor=t.asesor),await H("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{E.value=!1}},ie=async()=>{E.value=!0;try{await H("download/all-activities-the-year","Actividades-UGO-2025")}catch(e){console.error("Error de red:",e)}finally{E.value=!1}},se=async e=>{t.page=e,await y()},re=async e=>{e&&(t.page=1,await y())},C=new Map,F=(e,a)=>{const n=`${e.id}-${a}`;C.has(n)&&clearTimeout(C.get(n));const _=setTimeout(async()=>{let d=e[a];if(d===""||d===null||d===void 0){e[a]=null;return}d=Number(d),!(!Number.isInteger(d)||d<0||d>100)&&await A({url:"events-ugo/set-number-values",method:"PUT",data:{id:e.id,field:a,value:d}})},500);C.set(n,_)},y=async()=>{try{k.value=!0;const e={page:t.page};t.year&&(e.year=b(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby),t.asesor&&(e.asesor=t.asesor);const n=await A({url:"events-ugo/list",method:"GET",params:e});S.value=n.data.data,Y.value=n.data.total,N.value=n.data.per_page,f.value=n.statisti}catch(e){console.error("Error de red:",e)}finally{k.value=!1}},de=async()=>{try{const e=await ge({url:"select/asesores",method:"GET"});e.status==200&&(R.value=e.data)}catch{console.log("Failed to delete")}};return ye(async()=>{var e;v.value=await Te("eventos-ugo"),(e=v.value)!=null&&e.can_view_all&&(await y(),await de())}),O("search",t),O("loading",k),O("loadingFile",E),(e,a)=>{var z,U,V;const n=c("a-statistic"),_=c("a-skeleton"),d=c("a-col"),ce=c("a-row"),M=c("a-button"),ue=c("a-select"),pe=c("a-tooltip"),me=c("a-input-group"),ve=c("a-tag"),L=c("a-input"),I=c("a-menu-item"),_e=c("router-link"),fe=c("a-drawer");return i(),$("div",Oe,[s(ke,{title:"LISTA ACTIVIDADES UGO",textNuevo:"NUEVO",new:(z=v.value)==null?void 0:z.can_create,searchYear:!0,rangeDate:(U=v.value)==null?void 0:U.can_date_range,btnUpdate:!0,btnImport:!0,downloadExcel:(V=v.value)==null?void 0:V.can_download_reporte,placeholderSearch:"Buscar",columns:q,othersList:K.value,titleSearch:"BUSCAR POR EVENTO",pageSize:N.value,nameTotal:"Actividades UGO",dataSource:S.value,total:Y.value,onHandleNew:te,onHandleDownloadExcel:le,onHandleSearch:re,permisos:v.value,onHandleCallFetchData:y,onHandlePaginator:se,heightTable:440},{statics:l(()=>[m("div",Se,[s(ce,{gutter:16},{default:l(()=>[s(d,{span:6},{default:l(()=>{var o;return[m("div",Ye,[(o=f.value)!=null&&o.diaria?(i(),r(n,{key:0,title:"Programación diaria",value:f.value.diaria},null,8,["value"])):(i(),r(_,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1}),s(d,{span:6},{default:l(()=>{var o;return[m("div",Ne,[(o=f.value)!=null&&o.consolidada?(i(),r(n,{key:0,title:"Programación consolidada",value:f.value.consolidada},null,8,["value"])):(i(),r(_,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1}),s(d,{span:6},{default:l(()=>{var o;return[m("div",Re,[(o=f.value)!=null&&o.pendiente?(i(),r(n,{key:0,title:"Pendiente para resultado",value:f.value.pendiente},null,8,["value"])):(i(),r(_,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1}),s(d,{span:6},{default:l(()=>{var o;return[m("div",Fe,[(o=f.value)!=null&&o.finalizadas?(i(),r(n,{key:0,title:"Finalizadas",value:f.value.finalizadas},null,8,["value"])):(i(),r(_,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1})]),_:1})])]),header:l(()=>[v.value.can_download_everything?(i(),$("div",Me,[s(M,{loading:E.value,type:"text",icon:Ee(G(be)),onClick:ie},null,8,["loading","icon"])])):h("",!0),m("div",Le,[a[2]||(a[2]=m("span",null,"POR ASESOR",-1)),s(ue,{allowClear:!0,value:t.asesor,"onUpdate:value":a[0]||(a[0]=o=>t.asesor=o),placeholder:"Selecciona Asesor","show-search":"",options:R.value,"filter-option":Z},null,8,["value","options"])])]),"data-cell":l(({column:o,record:u})=>[o.dataIndex=="copy"?(i(),r(me,{key:0,compact:""},{default:l(()=>[s(pe,{title:"copiar link"},{default:l(()=>[s(M,{type:"text",onClick:g=>Q(u.eventsoffice_id,u.slug)},{icon:l(()=>[s(G(we),{style:{"font-size":"11px"}})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):h("",!0),o.dataIndex=="attendance_list_count"?(i(),r(ve,{key:1,color:"blue"},{default:l(()=>[B(Ie(u.attendance_list_count),1)]),_:2},1024)):h("",!0),o.dataIndex=="totalAsesorias"?(i(),r(L,{key:2,style:{width:"70px","text-align":"center"},value:u.totalAsesorias,"onUpdate:value":g=>u.totalAsesorias=g,onInput:()=>F(u,"totalAsesorias")},null,8,["value","onUpdate:value","onInput"])):h("",!0),o.dataIndex=="totalFormalizaciones"?(i(),r(L,{key:3,style:{width:"70px","text-align":"center"},value:u.totalFormalizaciones,"onUpdate:value":g=>u.totalFormalizaciones=g,onInput:()=>F(u,"totalFormalizaciones")},null,8,["value","onUpdate:value","onInput"])):h("",!0)]),"custom-options":l(({record:o})=>{var u,g,P;return[s(I,null,{default:l(()=>[m("a",{href:"#",onClick:De(T=>X(o.eventsoffice_id,o.slug),["prevent"])}," Ver Link ",8,ze)]),_:2},1024),s(I,null,{default:l(()=>[s(_e,{to:`eventos-inscritos/${o.slug}`},{default:l(()=>a[3]||(a[3]=[B("Inscritos")])),_:2},1032,["to"])]),_:2},1024),(u=v.value)!=null&&u.can_update?(i(),r(I,{key:0},{default:l(()=>[m("a",{onClick:T=>ee(o)},"Editar",8,Ue)]),_:2},1024)):h("",!0),(g=v.value)!=null&&g.can_finish?(i(),r(I,{key:1},{default:l(()=>[m("span",{style:{color:"#ff4d4f"},onClick:T=>oe(o)},"Finalizar",8,Ve)]),_:2},1024)):h("",!0),(P=v.value)!=null&&P.can_delete?(i(),r(I,{key:2},{default:l(()=>[m("span",{onClick:T=>ne(o)},"Eliminar",8,Pe)]),_:2},1024)):h("",!0)]}),_:1},8,["new","rangeDate","downloadExcel","othersList","pageSize","dataSource","total","permisos"]),s(fe,{open:w.value,"onUpdate:open":a[1]||(a[1]=o=>w.value=o),title:x.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD - UGO",placement:"right",width:"550"},{default:l(()=>[s(Ce,{onCloseDraw:ae,dataRow:x.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{ta as default};
