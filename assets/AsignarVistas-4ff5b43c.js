import{_ as D}from"./FormComponent-33b171d3.js";import{p as b,r,a as N,X as m,o as d,d as O,e as E,t as U,c as T,m as I,h as k,k as P,U as G,b as z,w as B,y as l,z as i}from"./index-5df45652.js";import"./es-b49b6a64.js";import{_ as L}from"./TableComponent-7868579a.js";const M={class:"password-pnte"},F={style:{color:"#00a6db"}},X={__name:"CambiarContrasena",props:["info"],emits:["closeDraw"],setup(u,{emit:R}){b.locale("es");const h=R,v=u,w=r({password:{type:"iText",label:"CONTRASEÑA",name:"password",required:!0,message:"Ingrese la nueva contraseña",disabled:!1}}),y=r("CAMBIAR"),g=N({}),_=r(!1),S=r(null),C=async()=>{_.value=!0;const x={id:v.info.id,password:g.password};try{const t=await I({url:"user/change-password",method:"POST",data:x});t.status===200&&(k.success(t.message),A(),h("closeDraw",!0))}catch(t){t.response&&t.response.data&&t.response.data.message?k.error(t.response.data.message):k.error("Ocurrió un error inesperado.");const c=document.getElementsByClassName("ant-drawer-body")[0];c&&(c.scrollTop=0)}finally{_.value=!1}},A=()=>{g.password=null};return m("formState",g),m("loadingState",_),(x,t)=>{var c,n,p;return d(),O("div",M,[E("h4",F,U((c=u.info)==null?void 0:c.name)+" "+U((n=u.info)==null?void 0:n.lastname)+" "+U((p=u.info)==null?void 0:p.middlename),1),t[0]||(t[0]=E("br",null,null,-1)),T(D,{fields:w.value,btnSaveName:y.value,resetSelect:S.value,onOnSubmit:C},null,8,["fields","btnSaveName","resetSelect"])])}}},$={class:"advisory-table"},Z={__name:"AsignarVistas",props:["info","typeOffice"],emits:["closeDraw"],setup(u,{emit:R}){const h=u,v=r([]),w=r(0),y=r(150),g=r(!1),_=r(!1),S=r([]),C=N({year:b("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),A=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:10},{title:"NOMBRE PÁGINA",dataIndex:"name",fixed:"left",width:50},{title:"ASIGNAR",dataIndex:"asignar",width:20,align:"center"},{title:"CREAR",dataIndex:"crear",width:20,align:"center"},{title:"ACTUALIZAR",dataIndex:"actualizar",width:20,align:"center"},{title:"ELIMINAR",dataIndex:"eliminar",width:20,align:"center"},{title:"DESCARGAR",dataIndex:"descargar",width:20,align:"center"},{title:"FINALIZAR",dataIndex:"finalizar",width:20,align:"center"},{title:"IMPORTAR",dataIndex:"importar",width:20,align:"center"},{title:"DESCARGAR TODO",dataIndex:"todo",width:20,align:"center"},{title:"RANGO DE FECHAS",dataIndex:"rango",width:20,align:"center"},{title:"DESCARGAR REPORTE EXCEL",dataIndex:"reporteexcel",width:20,align:"center"}],x=async n=>{C.page=n,await c()},t=async(n,p,o)=>{const s={user_id:h.info.id,page_id:o.id,type:n,value:p.target.checked};try{const a=await I({url:"page/user-assign-view",method:"PUT",data:s});console.log(":)",a.message)}catch(a){a.response&&a.response.data&&a.response.data.message?k.error(a.response.data.message):k.error("Ocurrió un error inesperado.");const e=document.getElementsByClassName("ant-drawer-body")[0];e&&(e.scrollTop=0)}},c=async()=>{try{g.value=!0;let n=null;h.typeOffice=="UGO"&&(n="page/list-ugo"),h.typeOffice=="ALL"&&(n="page/list-all");const[p,o]=await Promise.all([I({url:n,method:"GET"}),I({url:`page/views-to-user/${h.info.id}`,method:"GET"})]),s=p.data.data,a=o.data,e={};a.forEach(f=>{e[f.slug]=f.pivot}),v.value=s.map(f=>({...f,pivot:e[f.slug]||{can_create:!1,can_update:!1,can_delete:!1,can_download:!1,can_finish:!1,can_import:!1}})),w.value=p.data.total,y.value=p.data.per_page}catch(n){console.error("Error al obtener datos:",n)}finally{g.value=!1}};return P(async()=>{h.info&&c()}),G(()=>h.info,n=>{n?c():S.value=[]}),m("search",C),m("loading",g),m("loadingFile",_),(n,p)=>{const o=z("a-checkbox");return d(),O("div",$,[T(L,{nameTotal:"Páginas disponibles",columns:A,pageSize:y.value,dataSource:v.value,total:w.value,onHandleCallFetchData:c,onHandlePaginator:x,cityList:!1},{"data-cell":B(({column:s,record:a})=>[s.dataIndex=="asignar"?(d(),l(o,{key:0,checked:a.pivot.can_view_all,"onUpdate:checked":e=>a.pivot.can_view_all=e,onChange:e=>t("can_view_all",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="crear"?(d(),l(o,{key:1,checked:a.pivot.can_create,"onUpdate:checked":e=>a.pivot.can_create=e,onChange:e=>t("can_create",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="actualizar"?(d(),l(o,{key:2,checked:a.pivot.can_update,"onUpdate:checked":e=>a.pivot.can_update=e,onChange:e=>t("can_update",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="eliminar"?(d(),l(o,{key:3,checked:a.pivot.can_delete,"onUpdate:checked":e=>a.pivot.can_delete=e,onChange:e=>t("can_delete",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="descargar"?(d(),l(o,{key:4,checked:a.pivot.can_download,"onUpdate:checked":e=>a.pivot.can_download=e,onChange:e=>t("can_download",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="finalizar"?(d(),l(o,{key:5,checked:a.pivot.can_finish,"onUpdate:checked":e=>a.pivot.can_finish=e,onChange:e=>t("can_finish",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="importar"?(d(),l(o,{key:6,checked:a.pivot.can_import,"onUpdate:checked":e=>a.pivot.can_import=e,onChange:e=>t("can_import",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="todo"?(d(),l(o,{key:7,checked:a.pivot.download_everything,"onUpdate:checked":e=>a.pivot.download_everything=e,onChange:e=>t("can_download_everything",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="rango"?(d(),l(o,{key:8,checked:a.pivot.can_date_range,"onUpdate:checked":e=>a.pivot.can_date_range=e,onChange:e=>t("can_date_range",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="reporteexcel"?(d(),l(o,{key:9,checked:a.pivot.can_download_reporte,"onUpdate:checked":e=>a.pivot.can_download_reporte=e,onChange:e=>t("can_download_reporte",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0)]),_:1},8,["pageSize","dataSource","total"])])}}};export{X as _,Z as a};
