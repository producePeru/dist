import{N as V,r as b,z as ae,a as le,b as _,o as t,d as y,c as d,e as A,w as m,F as h,B as $,$ as ne,R as N,m as F,y as te,s as u,h as c,v as i,a0 as oe,i as E,O as se,p as re,j as ue,a1 as ie}from"./index-e39b76b0.js";import{u as de}from"./selectes-aa9b9d52.js";import"./es-7acbf532.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";const ce={email:{type:"iText",label:"Correo",name:"email",required:!1,email:"email",message:"Escribe el correo del usuario",disabled:!0},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Ingresar los nombres"},lastname:{type:"iText",label:"Apellido paterno",name:"lastname",required:!0,message:"Escribe el apellido paterno"},middlename:{type:"iText",label:"Apellido materno",name:"middlename",required:!0,message:"Escribe el apellido paterno"},documentnumber:{type:"iText",label:"Número de DNI",name:"documentnumber",required:!0,message:"Ingresa el número de DNI",max:8},birthday:{type:"iDate",label:"Fecha de nacimiento - día/mes/año",name:"birthday",required:!1,message:"año-mes-día"},phone:{type:"iText",label:"Ingresar número celular",name:"phone",required:!0,message:"Escribe número de documento",disabled:!1,max:9},gender_id:{type:"iSelect",label:"Género",name:"gender_id",required:!0,message:"Seleccionar un tipo de género",disabled:!0},cde_id:{type:"iSelect",label:"CDE",name:"cde_id",required:!0,message:"Seleccionar la sede",disabled:!0},office_id:{type:"iSelect",label:"Oficina",name:"office_id",required:!0,message:"Seleccionar la oficina",disabled:!0},role_id:{type:"iSelect",label:"Rol",name:"role_id",required:!0,message:"Seleccionar un rol de usuario",disabled:!0}};const pe=S=>(re("data-v-2999c76c"),S=S(),ue(),S),ve=pe(()=>A("h3",{class:"title-produce"},"REGISTRO DE USUARIO",-1)),_e={class:"user"},fe={class:"grid-item"},be="DD/MM/YYYY",ge={__name:"NuevoUsuarios",setup(S){V.locale("es");const Y=ie({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),z=JSON.parse(localStorage.getItem("profile")),w=JSON.parse(localStorage.getItem("role")),n=de();n.$patch({genders:n.genders}),n.$patch({cdes:n.cdes}),n.$patch({Offices:n.Offices}),n.$patch({roles:n.roles}),n.$patch({supervisores:n.supervisores}),n.fetchGenders(),n.fetchCdes(),n.fetchOffices(),n.fetchRoles();const s=b(ce),x=b(null);ae();const I=b(!1),M=b(!1),B=b(!1),C=b(!1),U=b(null),P=[{label:"Supervisor",value:1},{label:"Asesor",value:2},{label:"Notario",value:7}],G=[{label:"Drive Administrador",value:3},{label:"Drive Usuario",value:4}],a=le({name:null,lastname:null,middlename:null,documentnumber:null,birthday:null,sick:2,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:z.user_id,email:null,password:null}),j=()=>{a.name=null,a.lastname=null,a.middlename=null,a.documentnumber=null,x.value=null,a.phone=null,a.gender_id=null,a.cde_id=null,a.office_id=null,a.email=null,a.password=null,a.role_id=null},L=o=>{a[o]=a[o].replace(/\D/g,"")},J=async()=>{try{C.value=!0;const o={name:U.value};(await $({url:"create/office",method:"POST",data:o})).status==200&&(U.value=null,n.fetchOffices())}catch(o){console.log(o)}finally{C.value=!1}},H=(o,r)=>{const f=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(f)},O=o=>{const r={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0},f={type:"iText",label:"Ciudad de la notaría",name:"city",required:!0,message:"Ciudad de la notaría",disabled:!1},p={type:"iText",label:"Provincia de la de la notaría",name:"province",required:!0,message:"Provincia de la de la notaría",disabled:!1},g={type:"iText",label:"Distrito de la notaría",name:"district",required:!0,message:"Distrito de la notaría",disabled:!1},q={type:"iText",label:"Dirección de la notaría",name:"address",required:!1,message:"Dirección de la notaría",disabled:!1};if(o===2){n.fetchSupervisores(),s.value={...s.value,supervisor_id:r};const{city:k,province:v,district:T,address:R,...D}=s.value;s.value=D}else if(o===7){s.value={...s.value,city:f,province:p,district:g,address:q};const{supervisor_id:k,...v}=s.value;s.value=v,s.value.cde_id.required=!1}else{let{city:k,province:v,district:T,address:R,supervisor_id:D,...e}=s.value;s.value=e}},K=async()=>{I.value=!0,a.email=a.name.replace(/\s/g,"").toLowerCase()+a.lastname.replace(/\s/g,"").toLowerCase()+"@pnte.com",a.password=a.documentnumber,a.birthday=x.value?V(x.value).format("YYYY-MM-DD"):null;try{const o=await $({url:"user/create",method:"POST",data:a});ne.success({title:"La cuenta ha sido registrada",content:N("div",{},[N("br"),N("p",`Correo: ${a.email}`),N("p","Contraseña es el número de DNI ingresado")]),onOk(){j(),F.success(o.message);const{supervisor_id:r,...f}=s.value;s.value=f}})}catch{F.error("No se pudo registrar este usuario")}finally{I.value=!1}},Q=()=>{F.error("Debes de completar todos los espacios requeridos")},W=async o=>{console.log("Hello",o)},X=()=>{a.document_number=a.document_number.replace(/\D/g,"")};return(o,r)=>{const f=_("a-divider"),p=_("a-select"),g=_("a-input"),q=_("a-button"),k=_("a-space"),v=_("a-form-item"),T=_("a-input-search"),R=_("a-date-picker"),D=_("a-form");return t(),y(h,null,[ve,d(f),A("div",_e,[d(D,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:K,onFinishFailed:Q},{default:m(()=>[A("div",fe,[(t(!0),y(h,null,te(s.value,(e,Z)=>(t(),y(h,{key:Z},[e.type==="iSelect"?(t(),u(v,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:m(()=>[e.name=="gender_id"?(t(),u(p,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:c(n).genders},null,8,["value","onUpdate:value","options"])):i("",!0),e.name=="cde_id"?(t(),u(p,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:c(n).cdes},null,8,["value","onUpdate:value","options"])):i("",!0),c(w)[0].id==1?(t(),y(h,{key:2},[e.name=="role_id"?(t(),u(p,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:P,onChange:O},null,8,["value","onUpdate:value"])):i("",!0)],64)):i("",!0),c(w)[0].id==3?(t(),y(h,{key:3},[e.name=="role_id"?(t(),u(p,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:G,onChange:O},null,8,["value","onUpdate:value"])):i("",!0)],64)):i("",!0),c(w)[0].id==5?(t(),y(h,{key:4},[e.name=="role_id"?(t(),u(p,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:c(n).roles,onChange:O},null,8,["value","onUpdate:value","options"])):i("",!0)],64)):i("",!0),e.name=="supervisor_id"?(t(),u(p,{key:5,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:c(n).supervisores},null,8,["value","onUpdate:value","options"])):i("",!0),e.name=="office_id"?(t(),u(p,{key:6,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:c(n).Offices,"filter-option":H},{dropdownRender:m(({menuNode:l})=>[d(c(Y),{vnodes:l},null,8,["vnodes"]),d(f,{style:{margin:"4px 0"}}),d(k,{style:{padding:"4px 8px"}},{default:m(()=>[d(g,{ref_for:!0,ref:"inputRef",value:U.value,"onUpdate:value":r[0]||(r[0]=ee=>U.value=ee),placeholder:"Nueva actividad"},null,8,["value"]),d(q,{type:"text",onClick:J,loading:C.value},{icon:m(()=>[d(c(oe))]),default:m(()=>[E(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):i("",!0)]),_:2},1032,["name","label","rules"])):i("",!0),e.type==="iSearch"?(t(),u(v,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:m(()=>[d(T,{maxlength:15,loading:M.value,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,onSearch:W,onInput:X,disabled:B.value},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):i("",!0),e.type==="iText"?(t(),u(v,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:m(()=>[e.name=="documentnumber"?(t(),u(g,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,maxlength:e.max,onInput:r[1]||(r[1]=l=>L("documentnumber"))},null,8,["value","onUpdate:value","maxlength"])):e.name=="phone"?(t(),u(g,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,maxlength:e.max,onInput:r[2]||(r[2]=l=>L("phone"))},null,8,["value","onUpdate:value","maxlength"])):(t(),u(g,{key:2,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"]))]),_:2},1032,["name","label","rules"])):i("",!0),e.type==="iDate"?(t(),u(v,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:m(()=>[d(R,{locale:c(se),value:x.value,"onUpdate:value":r[3]||(r[3]=l=>x.value=l),style:{width:"100%"},format:be},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):i("",!0)],64))),128))]),d(v,null,{default:m(()=>[d(q,{class:"btn-produce",type:"primary","html-type":"submit",loading:I.value},{default:m(()=>[E("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])],64)}}},Ue=me(ge,[["__scopeId","data-v-2999c76c"]]);export{Ue as default};
