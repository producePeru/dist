import{p as j,r as a,a as K,b as n,o as u,y as q,w as s,c as t,e as m,d as k,F as A,v as P,i as X,z as R,j as C,m as B,h as I,u as J,a9 as Q,G as W,k as Z,t as N,cm as ee}from"./index-72b7b769.js";import{u as ae}from"./selectes-4d712e97.js";import"./es-fa2c519e.js";const te={token:{type:"iText",label:"Token",name:"token",required:!0,message:"Escribir el token",disabled:!0}},ne={class:"grid-convenios"},oe={__name:"DrawTokens",emits:["closeDraw"],setup(H,{emit:b}){j.locale("es");const c=b,p=a(!1),_=a(!1),r=K({}),v=()=>{r.token=null,r.name=null},g=async()=>{p.value=!0;const h={token:r.token};try{const l=await B({url:"token/create",method:"POST",data:h});l.status==200&&(I.success(l.message),c("closeDraw",!0),v())}catch(l){I.error("Se originÃ³ un error: "+l.message)}finally{p.value=!1}},d=()=>{I.error("Debes de completar todos los espacios requeridos")};return(h,l)=>{const x=n("a-input"),D=n("a-form-item"),f=n("a-button"),z=n("a-form"),E=n("a-spin");return u(),q(E,{spinning:_.value},{default:s(()=>[t(z,{layout:"vertical",model:r,name:"basic",autocomplete:"off",onFinish:g,onFinishFailed:d},{default:s(()=>[m("div",ne,[(u(!0),k(A,null,P(X(te),(o,F)=>(u(),k(A,{key:F},[o.type==="iText"?(u(),q(D,{key:0,name:o.name,label:o.label,rules:[{required:o.required,message:o.message,max:o.max}]},{default:s(()=>[t(x,{value:r[o.name],"onUpdate:value":y=>r[o.name]=y,maxlength:o.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):R("",!0)],64))),128))]),t(D,null,{default:s(()=>[t(f,{type:"primary","html-type":"submit",loading:p.value},{default:s(()=>l[0]||(l[0]=[C("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}};const se={class:"layout-content"},re={key:1},le={class:"paginator"},de={__name:"MisTokens",setup(H){const b=ae();b.$patch({cdes:b.cdes});const c=a(!1),p=a(1);a(0);const _=a(50),r=a([]),v=a(!1),g=a(0);J();const d=a({page:0}),h=a("token/list"),l=a(1200),x=a(window.innerHeight-100);a(!1);const D=[{title:"#",dataIndex:"idx",align:"center",width:10},{title:"FECHA REGISTRADO",dataIndex:"created_at",width:30,align:"center"},{title:"TOKEN",dataIndex:"token",width:120}],f=()=>{x.value=window.innerHeight-300};Q(()=>{window.removeEventListener("resize",f)});const z=i=>ee(i).format("DD/MM/YYYY HH:mm A"),E=()=>{c.value=!0},o=()=>{y(),c.value=!1},F=i=>{d.value.page=i,y()},y=async i=>{try{v.value=!0;let e;e=d.value.page==0?"":d.value,e=i?{...e,...i}:e;const S=await B({url:h.value,method:"GET",params:e}),w=S.data;r.value=w.data,g.value=w.total,_.value=w.per_page,p.value=S.id_active}catch(e){console.error("Error de red:",e)}finally{v.value=!1}},M=W(()=>i=>d.value.page*_.value+i+1);return Z(()=>{y(),window.addEventListener("resize",f),f()}),(i,e)=>{const S=n("a-button"),w=n("a-col"),U=n("a-row"),Y=n("a-table"),G=n("a-tag"),O=n("a-pagination"),V=n("a-drawer");return u(),k("div",se,[e[4]||(e[4]=m("h3",{class:"title-produce"},"TOKENS",-1)),t(U,{style:{margin:"1rem 0"}},{default:s(()=>[t(w,{xs:24,md:12,lg:18},{default:s(()=>[t(S,{type:"primary",onClick:E,style:{"margin-right":".5rem"}},{default:s(()=>e[1]||(e[1]=[C("Nuevo Token")])),_:1}),e[2]||(e[2]=m("a",{href:"https://apis.net.pe/app/account/signup",target:"_blank"},"Crear cuenta",-1))]),_:1})]),_:1}),t(Y,{bordered:"",scroll:{x:l.value,y:x.value},class:"table-users",columns:D,"data-source":r.value,pagination:!1,loading:v.value,size:"small"},{bodyCell:s(({column:T,record:L,index:$})=>[T.dataIndex=="idx"?(u(),k(A,{key:0},[C(N(M.value($)),1)],64)):R("",!0),T.dataIndex=="created_at"?(u(),k("div",re,N(z(L.created_at)),1)):R("",!0)]),_:1},8,["scroll","data-source","loading"]),m("div",le,[m("span",null,[t(G,{color:"blue"},{default:s(()=>[m("b",null,N(g.value),1)]),_:1}),e[3]||(e[3]=C("Itens"))]),t(O,{size:"small",total:g.value,pageSize:_.value,onChange:F,showSizeChanger:!1},null,8,["total","pageSize"])]),t(V,{open:c.value,"onUpdate:open":e[0]||(e[0]=T=>c.value=T),class:"draw-notary","root-class-name":"root-class-name",title:"Tokens",placement:"right",width:"500"},{default:s(()=>[t(oe,{onCloseDraw:o})]),_:1},8,["open"])])}}};export{de as default};
