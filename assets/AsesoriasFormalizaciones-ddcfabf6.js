import{u as ne}from"./selectes-fbb92cea.js";import{f as ye,r as ge,a as he}from"./asesorias-581a11a2.js";import{z as Z,r as y,a as re,j as le,T as de,b,o as d,d as T,c as o,w as n,e as C,F as Q,v as ce,p as f,h as w,q as p,t as F,B as be,P as ue,i as X,a3 as me,I as ae,m as J,f as xe,$ as we,u as Ue,D as Ce,a5 as Se}from"./index-80dd7c4c.js";import"./es-9c794631.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";import"./storage-e9b13b08.js";import{S as Ie}from"./DrawerSolicitante.componente-242ea154.js";const ze={class:"grid-ruc20"},De={class:"select-notaries"},ke={class:"name"},Ae={class:"city"},Re={class:"address"},Ne="DD/MM/YYYY",Fe={__name:"AllFormalizacion20",props:["info","idCde"],emits:["closeDraw"],setup(ee,{emit:j}){Z.locale("es");const H=me({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),A=j,$=ee,u=y(null),E=JSON.parse(localStorage.getItem("profile")),R=JSON.parse(localStorage.getItem("role")),m=ne(),a=y(!1),O=y(!1),L=y(!0),r=y([]),N=y(null),e=re({});m.$patch({cities:m.cities}),m.$patch({modalities:m.modalities}),m.$patch({economicSectors:m.economicSectors}),m.$patch({comercialActivities:m.comercialActivities}),m.$patch({regimes:m.regimes}),m.$patch({typeCapital:m.typeCapital}),m.fetchEconomicSectors(),m.fetchComercialActivities(),m.fetchRegimes(),m.fetchModalities(),m.fetchTypeCapital(),m.fetchCities();const q=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}],V=(t,g)=>{const c=e.dateReception?Z(e.dateReception):null,l=e.dateTramite?Z(e.dateTramite):null;if(t==="dateReception"&&l&&Z(g).isAfter(l))return Promise.reject("La fecha de recepción no puede ser mayor que la fecha de trámite");if(t==="dateTramite"&&c){const B=c.add(30,"days");if(Z(g).isBefore(c)&&!Z(g).isSame(c))return Promise.reject("La fecha de trámite no puede ser menor que la fecha de recepción");if(Z(g).isAfter(B))return Promise.reject("La fecha de trámite no puede ser más de 30 días después de la fecha de recepción")}return Promise.resolve()},G=(t,g)=>!g||/^20\d{9}$/.test(g)?Promise.resolve():Promise.reject("El RUC debe comenzar por 20 y ser 11 carácteres"),v=t=>{(t=="ruc"||t=="montocapital")&&(e[t]=e[t].replace(/\D/g,""))},I=(t,g)=>{const c=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),l=g.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),B=g.city.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),S=g.province.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Y=g.district.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return l.includes(c)||B.includes(c)||S.includes(c)||Y.includes(c)},h=async()=>{try{O.value=!0;const t={name:N.value};(await ae({url:"create/comercial-activities",method:"POST",data:t})).status==200&&(N.value=null,m.fetchComercialActivities())}catch(t){console.log(t)}finally{O.value=!1}},x=t=>{e.province_id=null,e.district_id=null,m.fetchProvinces(t)},D=t=>{e.district_id=null,m.fetchDistricts(t)},P=async()=>{try{const{data:t}=await xe({url:"public/notaries-filters",method:"GET"}),g=t.map(c=>({value:c.id,name:c.name,city:c.city.name,province:c.province.name,district:c.district.name,address:c.address}));r.value=g,L.value=!1}catch(t){console.error("Error de red:",t)}},M=(t,g)=>{const c=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return g.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(c)};function K(t){u.value=ye;const{documentnumber:g,city_id:c,province_id:l,district_id:B,address:S}=$.info,Y=R.some(k=>k.id===7);e.dni=g,e.city_id=c,x(c),e.province_id=l,D(l),e.district_id=B,e.address=S,P(),Y&&(u.value.notary_id.disabled=!0,u.value.modality_id.disabled=!0,e.modality_id=1,e.notary_id=E.notary_id)}const W=async()=>{if(a.value=!0,!$.info.id)return J.error("Error al registrar, actualiza la página");const t={codesunarp:e.codesunarp,numbernotary:e.numbernotary,address:e.address,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,regime_id:e.regime_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,modality_id:e.modality_id,notary_id:e.notary_id,user_id:E.user_id,people_id:$.info.id,nameMype:e.nameMype,dateReception:e.dateReception?Z(e.dateReception).format("YYYY-MM-DD"):null,dateTramite:e.dateTramite?Z(e.dateTramite).format("YYYY-MM-DD"):null,ruc:e.ruc,dni:e.dni,typecapital_id:e.typecapital_id,isbic:e.isbic,montocapital:e.montocapital,cde_id:$.idCde?$.idCde:null};try{const g=await ae({url:"formalization/create-ruc20",method:"POST",data:t});if(g.status===200){const c={razonSocial:null,ruc:e.ruc,createdFrom:"F20"};J.success(g.message),e.codesunarp=null,e.economicsector_id=null,e.comercialactivity_id=null,e.regime_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.modality_id=null,e.nameMype=null,e.dateReception=null,e.dateTramite=null,e.notary_id=null,e.ruc=null,e.numbernotary=null,e.isbic=null,e.montocapital=null,e.typecapital_id=null,A("closeDraw",!0)}}catch(g){console.log("Error: "+g)}finally{a.value=!1}};return le(()=>{$.info&&K($.info)}),de(()=>$.info,t=>{t&&K()}),(t,g)=>{const c=b("a-select"),l=b("a-form-item"),B=b("a-date-picker"),S=b("a-divider"),Y=b("a-input"),k=b("a-button"),s=b("a-space"),z=b("a-input-number"),te=b("a-form"),oe=b("a-spin");return d(),T("div",null,[o(oe,{spinning:L.value},{default:n(()=>[o(te,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:W},{default:n(()=>[C("div",ze,[(d(!0),T(Q,null,ce(u.value,(i,se)=>(d(),T(Q,{key:se},[i.type==="iSelect"?(d(),f(l,{key:0,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:n(()=>[i.name=="regime_id"?(d(),f(c,{key:0,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,options:w(m).regimes,"show-search":"","filter-option":M},null,8,["value","onUpdate:value","options"])):p("",!0),i.name=="modality_id"?(d(),f(c,{key:1,disabled:i.disabled,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,options:w(m).modalities},null,8,["disabled","value","onUpdate:value","options"])):p("",!0),i.name=="typecapital_id"?(d(),f(c,{key:2,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,options:w(m).typeCapital},null,8,["value","onUpdate:value","options"])):p("",!0),i.name=="isbic"?(d(),f(c,{key:3,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,options:q},null,8,["value","onUpdate:value"])):p("",!0),i.name=="notary_id"?(d(),f(c,{key:4,disabled:i.disabled,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,options:r.value,"option-label-prop":"name","show-search":"","filter-option":I},{option:n(({value:_,name:U,city:pe,province:_e,district:ve,address:fe})=>[C("div",De,[C("span",ke,F(U),1),C("span",Ae,F(pe)+" - "+F(_e)+" - "+F(ve),1),C("span",Re,F(fe),1)])]),_:2},1032,["disabled","value","onUpdate:value","options"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),i.type==="iDate"?(d(),f(l,{key:1,name:i.name,label:i.label,rules:[{required:i.required,message:i.message,validator:(_,U)=>V(i.name,U)}]},{default:n(()=>[o(B,{locale:w(be),value:e[i.name],"onUpdate:value":_=>e[i.name]=_,style:{width:"100%"},format:Ne,placeholder:"día/mes/año",disabled:i.disabled},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):p("",!0),i.type==="iSelectWrite"?(d(),f(l,{key:2,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:n(()=>[i.name=="comercialactivity_id"?(d(),f(c,{key:0,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,"show-search":"",options:w(m).comercialActivities,"filter-option":M},{dropdownRender:n(({menuNode:_})=>[o(w(H),{vnodes:_},null,8,["vnodes"]),o(S,{style:{margin:"4px 0"}}),o(s,{style:{padding:"4px 8px"}},{default:n(()=>[o(Y,{ref_for:!0,ref:"inputRef",value:N.value,"onUpdate:value":g[0]||(g[0]=U=>N.value=U),placeholder:"Nueva actividad"},null,8,["value"]),o(k,{type:"text",onClick:h,loading:O.value},{icon:n(()=>[o(w(ue))]),default:n(()=>[g[2]||(g[2]=X(" Agregar "))]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):p("",!0),i.name=="economicsector_id"?(d(),f(c,{key:1,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,"show-search":"",options:w(m).economicSectors,"filter-option":M},null,8,["value","onUpdate:value","options"])):p("",!0),i.name=="city_id"?(d(),f(c,{key:2,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,"show-search":"",options:w(m).cities,"filter-option":M,onChange:x},null,8,["value","onUpdate:value","options"])):p("",!0),i.name=="province_id"?(d(),f(c,{key:3,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,"show-search":"",options:w(m).provinces,"filter-option":M,onChange:D,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0),i.name=="district_id"?(d(),f(c,{key:4,value:e[i.name],"onUpdate:value":_=>e[i.name]=_,"show-search":"",options:w(m).districts,"filter-option":M,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),i.type==="iText"?(d(),f(l,{key:3,name:i.name,label:i.label,rules:[{required:i.required,message:i.message,type:i.email,max:i.max,min:i.min}]},{default:n(()=>[o(Y,{onInput:_=>v(i.name),value:e[i.name],"onUpdate:value":_=>e[i.name]=_,disabled:i.disabled,maxlength:i.max,placeholder:i.placeholder},null,8,["onInput","value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):p("",!0),i.type==="iNumber"?(d(),f(l,{key:4,name:i.name,label:i.label,rules:[{required:i.required,message:i.message},...i.name==="ruc"?[{validator:G,trigger:"change"}]:[]]},{default:n(()=>[o(z,{style:{width:"100%"},value:e[i.name],"onUpdate:value":_=>e[i.name]=_,maxlength:i.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):p("",!0),i.type==="iTextLol"?(d(),f(l,{key:5,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:n(()=>[o(Y,{onInput:_=>v(i.name),value:e.dni,"onUpdate:value":g[1]||(g[1]=_=>e.dni=_),disabled:!$.documentnumber,maxlength:i.max,placeholder:i.placeholder},null,8,["onInput","value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):p("",!0),i.type==="iMoney"?(d(),f(l,{key:6,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:n(()=>[o(z,{min:1,style:{width:"100%"},value:e[i.name],"onUpdate:value":_=>e[i.name]=_,formatter:_=>`S/ ${_}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:_=>_.replace(/S\/\s?|(,*)/g,"")},null,8,["value","onUpdate:value","formatter","parser"])]),_:2},1032,["name","label","rules"])):p("",!0)],64))),128))]),o(l,null,{default:n(()=>[o(k,{class:"btn-produce",type:"primary","html-type":"submit",loading:a.value},{default:n(()=>g[3]||(g[3]=[X("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},$e=ie(Fe,[["__scopeId","data-v-f5683664"]]);const Ee={class:"wrapper-booking"},qe={class:"grid-booking"},Te={__name:"FormalizacionRUC10",props:["info","idCde"],emits:["closeDraw"],setup(ee,{emit:j}){const H=JSON.parse(localStorage.getItem("role")),A=me({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),$=JSON.parse(localStorage.getItem("profile")),u=ee,E=j,R=y(!1),m=y(null);y(null),y(!1);const a=ne(),O=y(!1);a.$patch({cities:a.cities}),a.$patch({provinces:a.provinces}),a.$patch({districts:a.districts}),a.$patch({modalities:a.modalities}),a.$patch({detailProcedures:a.detailProcedures}),a.$patch({economicSectors:a.economicSectors}),a.$patch({comercialActivities:a.comercialActivities}),a.fetchDetailProcedures(),a.fetchModalities(),a.fetchEconomicSectors(),a.fetchComercialActivities(),a.fetchCities();const L=y(!0),r=re({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,address:null,user_id:$.user_id}),N=async()=>{try{O.value=!0;const h={name:m.value};(await ae({url:"create/comercial-activities",method:"POST",data:h})).status==200&&(m.value=null,a.fetchComercialActivities())}catch(h){console.log(h)}finally{O.value=!1}},e=h=>{r.province_id=null,r.district_id=null,a.fetchProvinces(h)},q=h=>{r.district_id=null,a.fetchDistricts(h)},V=(h,x)=>{const D=h.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return x.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(D)},G=async()=>{if(R.value=!0,!u.info.id)return J.error("Error al registrar, actualiza la página");const h={dni:r.dni,detailprocedure_id:r.detailprocedure_id,modality_id:r.modality_id,economicsector_id:r.economicsector_id,comercialactivity_id:r.comercialactivity_id,city_id:r.city_id,province_id:r.province_id,district_id:r.district_id,address:r.address,ruc:r.ruc,user_id:$.user_id,people_id:u.info.id,cde_id:u.idCde?u.idCde:null};try{const x=await ae({url:"formalization/create-ruc-10",method:"POST",data:h});if(x.status===200){const D={razonSocial:null,ruc:r.ruc,createdFrom:"F10"};J.success(x.message),r.detailprocedure_id=null,r.modality_id=null,r.economicsector_id=null,r.comercialactivity_id=null,r.city_id=null,r.province_id=null,r.district_id=null,r.address=null,r.ruc=null,E("closeDraw",!0)}}catch(x){console.log("Error: "+x)}finally{R.value=!1}},v=()=>{J.warning("Debes de completar todos los espacios requeridos")};function I(){const{documentnumber:h,city_id:x,province_id:D,district_id:P,address:M}=u.info,K=H.some(W=>W.id===7);r.dni=h,r.city_id=x,e(x),r.province_id=D,q(D),r.district_id=P,r.address=M,K&&(r.modality_id=1),r.district_id&&setTimeout(()=>{L.value=!1},1500)}return le(()=>{u.info&&I(u.info)}),de(()=>u.info,h=>{h&&I()}),(h,x)=>{const D=b("a-select"),P=b("a-form-item"),M=b("a-input"),K=b("a-divider"),W=b("a-button"),t=b("a-space"),g=b("a-form"),c=b("a-spin");return d(),T("div",Ee,[o(c,{spinning:L.value},{default:n(()=>[o(g,{layout:"vertical",model:r,name:"basic",autocomplete:"off",onFinish:G,onFinishFailed:v},{default:n(()=>[C("div",qe,[(d(!0),T(Q,null,ce(w(ge),(l,B)=>(d(),T(Q,{key:B},[l.type==="iSelect"?(d(),f(P,{key:0,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:n(()=>[l.name=="detailprocedure_id"?(d(),f(D,{key:0,value:r[l.name],"onUpdate:value":S=>r[l.name]=S,options:w(a).detailProcedures},null,8,["value","onUpdate:value","options"])):p("",!0),l.name=="modality_id"?(d(),f(D,{key:1,disabled:l.disabled,value:r[l.name],"onUpdate:value":S=>r[l.name]=S,options:w(a).modalities},null,8,["disabled","value","onUpdate:value","options"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),l.type==="iText"?(d(),f(P,{key:1,name:l.name,label:l.label,rules:[{required:l.required,message:l.message,type:"string",max:l.max},...l.name==="ruc"?[{validator:(S,Y,k)=>{Y?/^(10|15|17)\d{9}$/.test(Y)?k():k(new Error("El RUC debe comenzar con 10, 15 o 17 y tener 11 caracteres en total")):k()}}]:[]]},{default:n(()=>[o(M,{value:r[l.name],"onUpdate:value":S=>r[l.name]=S,disabled:l.name==="dni"&&!!r[l.name],maxlength:l.max,placeholder:l.placeholder},null,8,["value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):p("",!0),l.type==="iSelectWrite"?(d(),f(P,{key:2,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:n(()=>[l.name=="comercialactivity_id"?(d(),f(D,{key:0,value:r[l.name],"onUpdate:value":S=>r[l.name]=S,"show-search":"",options:w(a).comercialActivities,"filter-option":V},{dropdownRender:n(({menuNode:S})=>[o(w(A),{vnodes:S},null,8,["vnodes"]),o(K,{style:{margin:"4px 0"}}),o(t,{style:{padding:"4px 8px"}},{default:n(()=>[o(M,{ref_for:!0,ref:"inputRef",value:m.value,"onUpdate:value":x[0]||(x[0]=Y=>m.value=Y),placeholder:"Nueva actividad"},null,8,["value"]),o(W,{type:"text",onClick:N,loading:O.value},{icon:n(()=>[o(w(ue))]),default:n(()=>[x[1]||(x[1]=X(" Agregar "))]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):p("",!0),l.name=="economicsector_id"?(d(),f(D,{key:1,value:r[l.name],"onUpdate:value":S=>r[l.name]=S,"show-search":"",options:w(a).economicSectors,"filter-option":V},null,8,["value","onUpdate:value","options"])):p("",!0),l.name=="city_id"?(d(),f(D,{key:2,value:r[l.name],"onUpdate:value":S=>r[l.name]=S,"show-search":"",options:w(a).cities,"filter-option":V,onChange:e},null,8,["value","onUpdate:value","options"])):p("",!0),l.name=="province_id"?(d(),f(D,{key:3,value:r[l.name],"onUpdate:value":S=>r[l.name]=S,"show-search":"",options:w(a).provinces,"filter-option":V,onChange:q,disabled:!r.city_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0),l.name=="district_id"?(d(),f(D,{key:4,value:r[l.name],"onUpdate:value":S=>r[l.name]=S,"show-search":"",options:w(a).districts,"filter-option":V,disabled:!r.province_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0)],64))),128))]),o(P,null,{default:n(()=>[o(W,{type:"primary",class:"btn-produce","html-type":"submit",loading:R.value},{default:n(()=>x[2]||(x[2]=[X("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},Oe=ie(Te,[["__scopeId","data-v-84400cbe"]]);const Le={class:"wrapper-booking"},Pe={class:"grid-booking"},Me={__name:"AsesoriaNuevo",props:["info","idCde"],emits:["closeDraw"],setup(ee,{emit:j}){const H=JSON.parse(localStorage.getItem("role")),A=ee,$=j,u=ne(),E=JSON.parse(localStorage.getItem("profile")),R=y(!1);y(!1),y(null),y(null),u.$patch({components:u.components}),u.$patch({componentThemes:u.componentThemes}),u.$patch({modalities:u.modalities}),u.$patch({cities:u.cities}),u.$patch({economicSectors:u.economicSectors}),u.$patch({comercialActivities:u.comercialActivities}),u.fetchEconomicSectors(),u.fetchComercialActivities(),u.fetchComponents(),u.fetchModalities(),u.fetchCities();const m=y(!0),a=re({cde_id:null,dni:null,economicsector_id:null,comercialactivity_id:null,component_id:null,theme_id:null,modality_id:null,ruc:null,city_id:null,province_id:null,district_id:null,observations:null,user_id:E.user_id}),O=v=>{v=="ruc"&&(a[v]=a[v].replace(/\D/g,""))},L=v=>{a.theme_id=null,u.fetchComponentThemes(v)},r=v=>{a.province_id=null,a.district_id=null,u.fetchProvinces(v)},N=v=>{a.district_id=null,u.fetchDistricts(v)},e=(v,I)=>{const h=v.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return I.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(h)},q=async()=>{if(R.value=!0,!A.info.id)return J.error("Error al registrar actualiza la página");const v={dni:a.dni,economicsector_id:a.economicsector_id,comercialactivity_id:a.comercialactivity_id,observations:a.observations,user_id:E.user_id,people_id:A.info.id,component_id:a.component_id,theme_id:a.theme_id,modality_id:a.modality_id,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,ruc:a.ruc,cde_id:A.idCde?A.idCde:null};try{const I=await ae({url:"advisory/create",method:"POST",data:v});if(I.status===200){const h={razonSocial:null,ruc:a.ruc,createdFrom:"asesorias"};J.success(I.message),a.component_id=null,a.theme_id=null,a.modality_id=null,a.city_id=null,a.province_id=null,a.district_id=null,a.observations=null,a.ruc=null,a.economicsector_id=null,a.comercialactivity_id=null,$("closeDraw",!0)}}catch(I){console.log("Error: "+I)}finally{R.value=!1}},V=()=>{J.warning("Debes de completar todos los espacios requeridos")};function G(){const{documentnumber:v,city_id:I,province_id:h,district_id:x}=A.info,D=H.some(P=>P.id===7);a.dni=v,a.city_id=I,r(I),a.province_id=h,N(h),a.district_id=x,D&&(u.fetchComponentThemes(4),a.component_id=4,a.modality_id=1),a.district_id&&setTimeout(()=>{m.value=!1},1500)}return le(()=>{A.info&&G(A.info)}),de(()=>A.info,v=>{v&&G()}),(v,I)=>{const h=b("a-select"),x=b("a-form-item"),D=b("a-textarea"),P=b("a-input"),M=b("a-button"),K=b("a-form"),W=b("a-spin");return d(),T("div",Le,[o(W,{spinning:m.value},{default:n(()=>[o(K,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:q,onFinishFailed:V},{default:n(()=>[C("div",Pe,[(d(!0),T(Q,null,ce(w(he),(t,g)=>(d(),T(Q,{key:g},[t.type==="iSelect"?(d(),f(x,{key:0,class:"item-max",name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:n(()=>[t.name=="modality_id"?(d(),f(h,{key:0,disabled:t.disabled,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,options:w(u).modalities},null,8,["disabled","value","onUpdate:value","options"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),t.type==="iTextarea"?(d(),f(x,{key:1,name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:n(()=>[o(D,{value:a[t.name],"onUpdate:value":c=>a[t.name]=c,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):p("",!0),t.type==="iText"?(d(),f(x,{key:2,name:t.name,label:t.label,rules:[{required:t.required,message:t.message,type:t.email,max:t.max}]},{default:n(()=>[o(P,{value:a[t.name],"onUpdate:value":c=>a[t.name]=c,maxlength:t.max,onInput:c=>O(t.name),placeholder:t.placeholder,disabled:t.name==="dni"&&!!a[t.name]},null,8,["value","onUpdate:value","maxlength","onInput","placeholder","disabled"])]),_:2},1032,["name","label","rules"])):p("",!0),t.type==="iSelectWrite"?(d(),f(x,{key:3,class:"item-max",name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:n(()=>[t.name=="city_id"?(d(),f(h,{key:0,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:w(u).cities,"filter-option":e,onChange:r},null,8,["value","onUpdate:value","options"])):p("",!0),t.name=="province_id"?(d(),f(h,{key:1,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:w(u).provinces,"filter-option":e,onChange:N,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0),t.name=="district_id"?(d(),f(h,{key:2,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:w(u).districts,"filter-option":e,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0),t.name=="economicsector_id"?(d(),f(h,{key:3,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:w(u).economicSectors,"filter-option":e},null,8,["value","onUpdate:value","options"])):p("",!0),t.name=="comercialactivity_id"?(d(),f(h,{key:4,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:w(u).comercialActivities,"filter-option":e},null,8,["value","onUpdate:value","options"])):p("",!0),t.name=="component_id"?(d(),f(h,{key:5,disabled:t.disabled,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:w(u).components,"filter-option":e,onChange:L},null,8,["disabled","value","onUpdate:value","options"])):p("",!0),t.name=="theme_id"?(d(),f(h,{key:6,value:a[t.name],"onUpdate:value":c=>a[t.name]=c,"show-search":"",options:w(u).componentThemes,"filter-option":e,disabled:!a.component_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0)],64))),128))]),o(x,null,{default:n(()=>[o(M,{type:"primary",class:"btn-produce","html-type":"submit",loading:R.value},{default:n(()=>I[0]||(I[0]=[X("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},Ye=ie(Me,[["__scopeId","data-v-7d34e3f3"]]);const Ve={key:0},Ge={key:0},Be={key:0},Je={__name:"AsesoriasHistorial",props:["totaladvisories","totalformalization10","totalformalization20"],setup(ee){const j=ee,H=y("1"),A=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Componente",dataIndex:"component",width:20},{title:"Tema",dataIndex:"theme",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:60},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],$=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Detalle del trámite",dataIndex:"detailprocedure",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:100},{title:"RUC",dataIndex:"ruc",width:50},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],u=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Régimen",dataIndex:"regime",width:80,align:"center"},{title:"Número solicitud constancia",dataIndex:"numbernotary",width:100},{title:"Nombre empresa",dataIndex:"mypename",width:160},{title:"RUC",dataIndex:"ruc",width:80},{title:"Modalidad",dataIndex:"modality",align:"center",width:70},{title:"Ciudad",dataIndex:"city",width:30},{title:"Provincia",dataIndex:"province",width:20},{title:"Distrito",dataIndex:"district",width:20},{title:"Dirección",dataIndex:"address",width:200}],E=R=>we(R).format("DD/MM/YYYY HH:mm A");return(R,m)=>{const a=b("a-table"),O=b("a-card"),L=b("a-tab-pane"),r=b("a-tabs");return d(),f(r,{activeKey:H.value,"onUpdate:activeKey":m[0]||(m[0]=N=>H.value=N),type:"card",class:"box-hist"},{default:n(()=>[o(L,{key:"1",tab:"ASESORÍAS"},{default:n(()=>[o(O,null,{default:n(()=>[o(a,{columns:A,"data-source":j.totaladvisories,bordered:"",pagination:!1,size:"small",scroll:{x:1200},"expand-column-width":100},{bodyCell:n(({index:N,column:e,record:q})=>[e.dataIndex==="idx"?(d(),T("span",Ve,F(N+1),1)):p("",!0),e.dataIndex==="date_start"?(d(),T(Q,{key:1},[X(F(E(q.createDate)),1)],64)):p("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),o(L,{key:"2",tab:"RUC 10"},{default:n(()=>[o(O,null,{default:n(()=>[o(a,{columns:$,"data-source":j.totalformalization10,bordered:"",pagination:!1,size:"small",scroll:{x:1800},"expand-column-width":100},{bodyCell:n(({index:N,column:e,record:q})=>[e.dataIndex==="idx"?(d(),T("span",Ge,F(N+1),1)):p("",!0),e.dataIndex==="date_start"?(d(),T(Q,{key:1},[X(F(E(q.createDate)),1)],64)):p("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),o(L,{key:"3",tab:"RUC 20"},{default:n(()=>[o(O,null,{default:n(()=>[o(a,{columns:u,"data-source":j.totalformalization20,bordered:"",pagination:!1,size:"small",scroll:{x:2200},"expand-column-width":100},{bodyCell:n(({index:N,column:e,record:q})=>[e.dataIndex==="idx"?(d(),T("span",Be,F(N+1),1)):p("",!0),e.dataIndex==="date_start"?(d(),T(Q,{key:1},[X(F(E(q.createDate)),1)],64)):p("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1},8,["activeKey"])}}},je=ie(Je,[["__scopeId","data-v-01e75dfe"]]);const He={class:"asesorias"},Ke={key:0,class:"card-as",style:{padding:"1rem"}},We={__name:"AsesoriasFormalizaciones",setup(ee){const j=JSON.parse(localStorage.getItem("role")),H=()=>j.some(k=>k.id===7),A=ne(),$=Ue(),u=Ce(),E=y(0),R=y(null),m=y(null),a=y([{value:"asesoria",label:"ASESORÍA"},{value:"ruc20",label:"RUC 20"},{value:"ruc10",label:"RUC 10"}]);A.$patch({cdes:A.cdes}),A.fetchCdes();const O=y(null),L=y(!1),r=y(null);y(!1);const N=y(!1);y(!1);const e=y(!1),q=y(!1),V=y(!1),G=y(""),v=y([]),I=y(!1),h=y(0);y(!1),y([]),y(null);const x=y([]),D=y([]),P=y([]),M=y(!1),K=k=>{m.value.cde_id=k,localStorage.setItem("profile",JSON.stringify(m.value))},W=(k,s)=>{const z=k.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(z)},t=()=>{S(G.value),L.value=!1},g=()=>{if(r.value=null,r.value=v.value,!R.value)return J.warning("Seleccionar un tipo de servicio");R.value=="asesoria"&&(V.value=!0),R.value=="ruc10"&&(q.value=!0),R.value=="ruc20"&&l()},c=()=>{O.value=v.value,L.value=!0},l=()=>{h.value=0,e.value=!0,N.value=!1},B=async()=>{I.value=!0;const k=await ae({url:`person/found/${E.value}/${G.value}`,method:"GET"});if(k.status==200)return v.value=k.data,Y(v.value.id),I.value=!1},S=async k=>{if(I.value=!0,!k)return J.warning("Ingresa un número de documento"),I.value=!1;if(E.value==0)return J.warning("Seleccionar el tipo de documento"),I.value=!1;if(E.value==1&&G.value.length<8){J.warning("El número de DNI está incompleto"),I.value=!1;return}const s=await ae({url:`person/found/${E.value}/${G.value}`,method:"GET"});if(s.status==200)return v.value=s.data,Y(s.data.id),m.value=JSON.parse(localStorage.getItem("profile")),I.value=!1;if(s.status===404){const z={type:E.value,access:"asesorias",number:G.value};$.push({name:"registrar-persona",query:z})}},Y=async k=>{try{const{data:s}=await ae({url:`historial/registers/${k}`,method:"GET"});x.value=s.advisories,D.value=s.formalization10,P.value=s.formalization20,M.value=!0}catch(s){console.error("Error de red:",s)}};return le(()=>{u.query.type&&(E.value=u.query.type,G.value=u.query.number)}),(k,s)=>{const z=b("a-col"),te=b("a-row"),oe=b("a-card"),i=b("a-select"),se=b("a-button"),_=b("a-drawer");return d(),T(Q,null,[C("div",He,[s[20]||(s[20]=C("h3",{class:"title-produce"},"REGISTRO DE FORMALIZACIONES Y ASESORÍAS",-1)),s[21]||(s[21]=C("br",null,null,-1)),s[22]||(s[22]=C("img",{width:"80",src:"https://media1.giphy.com/media/yxs0nFzaZQtzy2g5Lt/giphy.gif?cid=6c09b952u31enpm7kdb8eqx8itse42dsf0dkhk99gg5df027&ep=v1_gifs_search&rid=giphy.gif&ct=g",alt:""},null,-1)),o(te,{gutter:[16,16]},{default:n(()=>[o(z,{xs:24,sm:24,lg:12},{default:n(()=>[v.value.length!=0?(d(),f(oe,{key:0},{default:n(()=>[s[15]||(s[15]=C("h4",{class:"title-produce"},"RESULTADO DE LA BÚSQUEDA",-1)),o(w(Se),{class:"box-icoedit",onClick:c}),o(te,{gutter:[0,2],class:"box-info"},{default:n(()=>[o(z,{xs:12,sm:8},{default:n(()=>s[9]||(s[9]=[C("b",{class:"box-title"},"Apellidos y nombres:",-1)])),_:1}),o(z,{xs:12,sm:12},{default:n(()=>[C("span",null,F(v.value.lastname)+" "+F(v.value.middlename)+", "+F(v.value.name),1)]),_:1}),o(z,{xs:12,sm:8},{default:n(()=>s[10]||(s[10]=[C("b",{class:"box-title"},"Número de celular:",-1)])),_:1}),o(z,{xs:12,sm:12},{default:n(()=>[C("span",null,F(v.value.phone?v.value.phone:"-"),1)]),_:1}),o(z,{xs:12,sm:8},{default:n(()=>s[11]||(s[11]=[C("b",{class:"box-title"},"Correo electrónico:",-1)])),_:1}),o(z,{xs:12,sm:12},{default:n(()=>[C("span",null,F(v.value.email?v.value.email:"-"),1)]),_:1}),o(z,{xs:12,sm:8},{default:n(()=>s[12]||(s[12]=[C("b",{class:"box-title"},"Asesorías:",-1)])),_:1}),o(z,{xs:12,sm:12},{default:n(()=>{var U;return[C("span",null,F((U=v.value)==null?void 0:U.idadvisory.length),1)]}),_:1}),o(z,{xs:12,sm:8},{default:n(()=>s[13]||(s[13]=[C("b",{class:"box-title"},"Formalizaciones RUC 20:",-1)])),_:1}),o(z,{xs:12,sm:12},{default:n(()=>{var U;return[C("span",null,F((U=v.value)==null?void 0:U.idformalization20.length),1)]}),_:1}),o(z,{xs:12,sm:8},{default:n(()=>s[14]||(s[14]=[C("b",{class:"box-title"},"Formalizaciones RUC 10:",-1)])),_:1}),o(z,{xs:12,sm:12},{default:n(()=>{var U;return[C("span",null,F((U=v.value)==null?void 0:U.idformalization10.length),1)]}),_:1})]),_:1})]),_:1})):p("",!0)]),_:1}),o(z,{xs:24,sm:24,lg:12},{default:n(()=>[v.value.length!=0?(d(),f(oe,{key:0,style:{height:"100%"}},{default:n(()=>[o(te,{gutter:[16,24]},{default:n(()=>[H()?p("",!0):(d(),f(z,{key:0,xs:24,sm:18,md:12,lg:12},{default:n(()=>[s[16]||(s[16]=C("h4",{class:"title-produce"},"SELECCIONAR CDE",-1)),o(i,{class:"w-100",value:m.value.cde_id,"onUpdate:value":s[0]||(s[0]=U=>m.value.cde_id=U),options:w(A).cdes,"show-search":"","filter-option":W,onChange:K},null,8,["value","options"])]),_:1})),o(z,{xs:24,sm:18,md:12,lg:17},{default:n(()=>[s[18]||(s[18]=C("h4",{class:"title-produce"},"¿DESEA REGISTRAR UN NUEVO SERVICIO?",-1)),o(te,{gutter:[10,0]},{default:n(()=>[o(z,{xs:17,sm:18},{default:n(()=>[o(i,{class:"w-100",value:R.value,"onUpdate:value":s[1]||(s[1]=U=>R.value=U),options:a.value},null,8,["value","options"])]),_:1}),o(z,{xs:6},{default:n(()=>[o(se,{type:"primary",onClick:g},{default:n(()=>s[17]||(s[17]=[X("REGISTRAR")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):p("",!0)]),_:1})]),_:1}),M.value?(d(),T("div",Ke,[s[19]||(s[19]=C("h4",{class:"title-produce"},"HISTORIAL",-1)),o(je,{totaladvisories:x.value,totalformalization10:D.value,totalformalization20:P.value},null,8,["totaladvisories","totalformalization10","totalformalization20"])])):p("",!0)]),C("section",null,[o(_,{title:"Regitsrar una Formalización con RUC 20",open:e.value,"onUpdate:open":s[3]||(s[3]=U=>e.value=U),placement:"right",width:"880px"},{default:n(()=>[o($e,{info:r.value,idCde:m.value.cde_id,onCloseDraw:s[2]||(s[2]=U=>(e.value=!1,B()))},null,8,["info","idCde"]),s[23]||(s[23]=C("div",{class:"steps-content"},null,-1))]),_:1},8,["open"]),o(_,{width:"600px",title:"Regitsrar Formalización con RUC 10",open:q.value,"onUpdate:open":s[5]||(s[5]=U=>q.value=U),placement:"right"},{default:n(()=>[o(Oe,{info:v.value,idCde:m.value.cde_id,onCloseDraw:s[4]||(s[4]=U=>(q.value=!1,B()))},null,8,["info","idCde"])]),_:1},8,["open"]),o(_,{width:"600px",title:"Registrar una asesoría",open:V.value,"onUpdate:open":s[7]||(s[7]=U=>V.value=U),placement:"right"},{default:n(()=>[o(Ye,{info:v.value,idCde:m.value.cde_id,onCloseDraw:s[6]||(s[6]=U=>(V.value=!1,B()))},null,8,["info","idCde"])]),_:1},8,["open"]),o(_,{width:"600",open:L.value,"onUpdate:open":s[8]||(s[8]=U=>L.value=U),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:n(()=>[o(Ie,{onCloseDraw:t,updateValues:O.value},null,8,["updateValues"])]),_:1},8,["open"])])],64)}}},oa=ie(We,[["__scopeId","data-v-a6ac5166"]]);export{oa as default};
