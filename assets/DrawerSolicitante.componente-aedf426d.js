import{u as $}from"./selectes-9c0bf513.js";import{K as h,r as y,a as G,b as u,o,q as l,w as c,c as b,e as x,d as U,F as w,B as I,h as m,s as r,L as O,t as j,i as J,y as K,m as f}from"./index-080fa3f6.js";import"./es-0bfb18f2.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";const Q={typedocument_id:{type:"iSelect",label:"Tipo de documento",name:"typedocument_id",required:!1,message:"Seleccionar tipo de documento",disabled:!0},documentnumber:{type:"iText",label:"Número de documento",name:"documentnumber",required:!1,message:"Escribe número de documento",disabled:!0},lastname:{type:"iText",label:"Apellido Paterno",name:"lastname",required:!0,message:"Escribir apellido",disabled:!1},middlename:{type:"iText",label:"Apellido Materno",name:"middlename",required:!0,message:"Escribir apellido",disabled:!1},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribir nombre",disabled:!1},city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!1},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},phone:{type:"iText",label:"Número de celular",name:"phone",required:!0,message:"Número de contacto y 9 max",max:9,disabled:!1},email:{type:"iText",label:"Correo electrónico",name:"email",required:!1,message:"Número de contacto y 9 max",email:"email",disabled:!1},birthday:{type:"iDate",label:"Fecha de nacimiento",name:"birthday",required:!0,message:"Seleccionar fecha",disabled:!1},gender_id:{type:"iSelect",label:"Género",name:"gender_id",required:!0,message:"Seleccionar tipo de documento"},sick:{type:"iSelect",label:"¿Tiene discapacidad?",name:"sick",required:!0,message:"Seleccionar un tipo"}};const W={class:"grid-profile"},X="DD/MM/YYYY",Z={__name:"DrawerSolicitante.componente",props:["updateValues"],emits:["closeDraw"],setup(N,{emit:T}){h.locale("es");const n=$();JSON.parse(localStorage.getItem("profile"));const Y=T,S=N;n.$patch({typeDocuments:n.typeDocuments}),n.$patch({cities:n.cities}),n.$patch({genders:n.genders}),n.fetchTypeDocuments(),n.fetchCities(),n.fetchGenders();const D=y(!0),g=y(!1),C=y(Q),p=y(null),a=G({typedocument_id:null,documentnumber:null,lastname:null,middlename:null,name:null,city_id:null,province_id:null,district_id:null,phone:null,email:null,gender_id:null,birthday:null,sick:null}),F=[{label:"Si",value:"yes"},{label:"No",value:"no"}],E=t=>{var s;(s=n.genders)!=null&&s.length&&(D.value=!1),t&&(a.typedocument_id=t.typedocument_id,a.documentnumber=t.documentnumber,a.lastname=t.lastname,a.middlename=t.middlename,a.name=t.name,a.city_id=t.city_id,k(t.city_id),q(t.province_id),a.province_id=t.province_id,a.district_id=t.district_id,a.phone=t.phone,a.email=t.email,a.gender_id=t.gender_id,a.birthday=t.birthday,a.sick=t.sick,t.birthday&&(p.value=h(t.birthday,"YYYY-MM-DD")))},k=t=>{a.province_id=null,a.district_id=null,n.fetchProvinces(t)},q=t=>{a.district_id=null,n.fetchDistricts(t)},v=(t,s)=>{const d=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(d)},M=async()=>{a.birthday=p.value?h(p.value).format("YYYY-MM-DD"):null;let t=a;delete t.documentnumber,delete t.typedocument_id,g.value=!0;try{const s=await K({url:`person/update/${S.updateValues.id}`,method:"PUT",data:t});f.success(s.message),Y("closeDraw",!0)}catch(s){if(s.response.status==550)return f.error("El usuario ya se encuentra registrado");f.error("Error al registrar")}finally{g.value=!1}},V=()=>{f.error("Debes de completar todos los espacios requeridos")};return(t,s)=>{const d=u("a-select"),_=u("a-form-item"),L=u("a-input"),z=u("a-date-picker"),B=u("a-button"),P=u("a-form"),A=u("a-spin");return o(),l(A,{spinning:D.value},{default:c(()=>[b(P,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:M,onFinishFailed:V},{default:c(()=>[x("div",W,[(o(!0),U(w,null,I(C.value,(e,R)=>(o(),U(w,{key:R},[e.type==="iSelect"?(o(),l(_,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[e.name=="typedocument_id"?(o(),l(d,{key:0,value:a[e.name],"onUpdate:value":i=>a[e.name]=i,options:m(n).typeDocuments,disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):r("",!0),e.name=="city_id"?(o(),l(d,{key:1,value:a[e.name],"onUpdate:value":i=>a[e.name]=i,"show-search":"",options:m(n).cities,"filter-option":v,onChange:k},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="province_id"?(o(),l(d,{key:2,value:a[e.name],"onUpdate:value":i=>a[e.name]=i,"show-search":"",options:m(n).provinces,"filter-option":v,onChange:q},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="district_id"?(o(),l(d,{key:3,value:a[e.name],"onUpdate:value":i=>a[e.name]=i,"show-search":"",options:m(n).districts,"filter-option":v},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="gender_id"?(o(),l(d,{key:4,value:a[e.name],"onUpdate:value":i=>a[e.name]=i,options:m(n).genders},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="sick"?(o(),l(d,{key:5,value:a[e.name],"onUpdate:value":i=>a[e.name]=i,options:F},null,8,["value","onUpdate:value"])):r("",!0)]),_:2},1032,["name","label","rules"])):r("",!0),e.type==="iText"?(o(),l(_,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:c(()=>[b(L,{value:a[e.name],"onUpdate:value":i=>a[e.name]=i,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):r("",!0),e.type==="iDate"?(o(),l(_,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[b(z,{locale:m(O),value:p.value,"onUpdate:value":s[0]||(s[0]=i=>p.value=i),style:{width:"100%"},format:X,placeholder:"día / mes / año"},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):r("",!0)],64))),128))]),x("div",null,j(E(S.updateValues)),1),b(_,null,{default:c(()=>[b(B,{class:"btn-produce",type:"primary","html-type":"submit",loading:g.value},{default:c(()=>[J("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},ie=H(Z,[["__scopeId","data-v-1f45e952"]]);export{ie as S};
