import{N as $,r as c,a as G,b as l,o as i,s as _,w as s,c as o,e as f,d as I,F as C,y as ae,h as S,v as m,O as te,t as A,i as D,B as V,m as B,K as ne,k as oe,L as le,S as se}from"./index-2b74dd24.js";import{u as re}from"./selectes-a99d902a.js";import"./es-950b2508.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";import{M as de}from"./MoreOutlined-cbf7fb9a.js";const ue={email:{type:"iText",label:"Correo",name:"email",required:!1,email:"email",message:"Escribe el correo del usuario",disabled:!0},documentnumber:{type:"iText",label:"Número de DNI",name:"documentnumber",required:!0,message:"Número de DNI",max:8,disabled:!1},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribe el apellido paterno"},lastname:{type:"iText",label:"Apellido paterno",name:"lastname",required:!0,message:"Escribe el apellido paterno"},middlename:{type:"iText",label:"Apellido materno",name:"middlename",required:!0,message:"Escribe el apellido paterno"},birthday:{type:"iDate",label:"Fecha de nacimiento",name:"birthday",required:!1,message:"año-mes-día",placeholder:"año-mes-día"},phone:{type:"iText",label:"Ingresar número celular",name:"phone",required:!0,message:"Escribe número de documento",disabled:!1,max:9},gender_id:{type:"iSelect",label:"Género",name:"gender_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0},cde_id:{type:"iSelect",label:"CDE",name:"cde_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0},office_id:{type:"iSelect",label:"Oficina",name:"office_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0}};const ce={class:"grid-profile"},me="DD/MM/YYYY",pe={__name:"DrawerEditarDatosAsesor",props:["record"],emits:["closeDraw"],setup(L,{emit:E}){$.locale("es");const t=re(),k=JSON.parse(localStorage.getItem("profile")),U=E;t.$patch({genders:t.genders}),t.$patch({cdes:t.cdes}),t.$patch({Offices:t.Offices}),t.$patch({roles:t.roles}),t.$patch({supervisores:t.supervisores}),t.fetchGenders(),t.fetchCdes(),t.fetchOffices(),t.fetchRoles();const y=L,N=c(!0),q=c(!1),g=c(ue),a=G({name:null,lastname:null,middlename:null,birthday:null,sick:null,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:k.id}),O=n=>{var d;n&&(a.name=n.profile_name,a.lastname=n.profile_lastname,a.middlename=n.profile_middlename,a.documentnumber=n.profile_documentnumber,a.phone=n.profile_phone,a.gender_id=n.gender_id,a.cde_id=n.cde_id,a.office_id=n.office_id,a.email=n.email,n.profile_birthday&&(a.birthday=$(n.profile_birthday,"YYYY-MM-DD"))),(d=t.genders)!=null&&d.length&&(N.value=!1)},M=n=>{const d={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0};if(n===2)t.fetchSupervisores(),g.value={...g.value,supervisor_id:d};else{const{supervisor_id:h,...v}=g.value;g.value=v}},Y=async()=>{q.value=!0;const n={name:a.name,lastname:a.lastname,middlename:a.middlename,birthday:a.birthday?$(a.birthday).format("YYYY-MM-DD"):null,sick:a.sick,phone:a.phone,gender_id:a.gender_id,cde_id:a.cde_id,office_id:a.office_id,user_id:k.id};try{const d=await V({url:`user/update/${y.record._id}`,method:"PUT",data:n});B.success(d.message),U("closeDraw")}catch(d){console.log("NOOo",d)}finally{q.value=!1}},T=()=>{B.error("Debes de completar todos los espacios requeridos")};return(n,d)=>{const h=l("a-select"),v=l("a-form-item"),R=l("a-input"),x=l("a-date-picker"),z=l("a-button"),p=l("a-form"),u=l("a-spin");return i(),_(u,{spinning:N.value},{default:s(()=>[o(p,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:Y,onFinishFailed:T},{default:s(()=>[f("div",ce,[(i(!0),I(C,null,ae(g.value,(e,w)=>(i(),I(C,{key:w},[e.type==="iSelect"?(i(),_(v,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[e.name=="gender_id"?(i(),_(h,{key:0,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:S(t).genders},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="cde_id"?(i(),_(h,{key:1,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:S(t).cdes},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="office_id"?(i(),_(h,{key:2,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:S(t).Offices},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="role_id"?(i(),_(h,{key:3,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:S(t).roles,onChange:M},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="supervisor_id"?(i(),_(h,{key:4,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:S(t).supervisores},null,8,["value","onUpdate:value","options"])):m("",!0)]),_:2},1032,["name","label","rules"])):m("",!0),e.type==="iText"?(i(),_(v,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:s(()=>[o(R,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):m("",!0),e.type==="iDate"?(i(),_(v,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[o(x,{locale:S(te),value:a[e.name],"onUpdate:value":r=>a[e.name]=r,style:{width:"100%"},format:me,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):m("",!0)],64))),128))]),f("div",null,A(O(y.record)),1),o(v,null,{default:s(()=>[o(z,{class:"btn-produce",type:"primary","html-type":"submit",loading:q.value},{default:s(()=>[D("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},_e=ie(pe,[["__scopeId","data-v-f5cfd002"]]);const fe=f("h3",{class:"title-produce"},"ASESORES DEL PROGRAMA",-1),ge=["onClick"],he={class:"paginator"},ke={__name:"AsesoresLista",setup(L){const E=c(50),t=c([]),k=c(!1),U=c(0),y=c({page:1}),N=c("user/list-asesories"),q=c(1200),g=c(window.innerHeight-100),a=c(!1),O=c(null),M=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Nombres",dataIndex:"profile_name",width:120},{title:"Apellidos",dataIndex:"lastname",width:160},{title:"Num. DNI",dataIndex:"profile_documentnumber",width:100,align:"center"},{title:"Celular",dataIndex:"profile_phone",width:100,align:"center"},{title:"CDE",dataIndex:"cde_name",width:160},{title:"Fecha Nac.",dataIndex:"profile_birthday",width:100,align:"center"},{title:"Género",dataIndex:"gender",width:120,align:"center"},{title:"Oficina",dataIndex:"office_name",width:100,align:"center"},{title:"ROL",dataIndex:"role",width:100,align:"center"},{title:"CUENTA",dataIndex:"email",width:180},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],Y=()=>{g.value=window.innerHeight-300},T=p=>{a.value=!0,O.value=p},n=()=>{a.value=!1,x()},d=G({search:""}),h=()=>{x({search:d.search})},v=()=>{d.search||x()},R=p=>{y.value.page=p,x()},x=async p=>{try{k.value=!0;const u=y.value.page===1?"":y.value,e=p?{...u,...p}:u,w=await V({url:N.value,method:"GET",params:e});t.value=w.data,U.value=w.total,E.value=w.per_page}catch(u){console.error("Error de red:",u)}finally{k.value=!1}},z=ne(()=>p=>(y.value.page-1)*E.value+p+1);return oe(()=>{x(),window.addEventListener("resize",Y),Y()}),(p,u)=>{const e=l("a-col"),w=l("a-input"),r=l("a-button"),P=l("a-input-group"),H=l("a-row"),j=l("a-menu-item"),J=l("a-menu"),K=l("a-dropdown"),X=l("a-table"),Q=l("a-tag"),W=l("a-pagination"),Z=l("a-drawer");return i(),I(C,null,[f("div",null,[fe,o(H,{style:{margin:"1rem 0"}},{default:s(()=>[o(e,{xs:24,md:12,lg:18}),o(e,{xs:24,md:12,lg:6},{default:s(()=>[o(P,{compact:""},{default:s(()=>[o(w,{value:d.search,"onUpdate:value":u[0]||(u[0]=b=>d.search=b),style:{width:"calc(100% - 80px)"},onInput:v},null,8,["value"]),o(r,{type:"primary",disabled:d.search==="",onClick:h},{default:s(()=>[D("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),o(X,{bordered:"",scroll:{x:q.value,y:g.value},class:"table-users",columns:M,"data-source":t.value,pagination:!1,loading:k.value,size:"small"},{bodyCell:s(({column:b,record:F,index:ee})=>[b.dataIndex==="idx"?(i(),I(C,{key:0},[D(A(z.value(ee)),1)],64)):m("",!0),b.dataIndex==="lastname"?(i(),I(C,{key:1},[D(A(F.profile_lastname)+" "+A(F.profile_middlename),1)],64)):m("",!0),b.dataIndex==="role"?(i(),I(C,{key:2},[D(" Asesor ")],64)):m("",!0),b.dataIndex=="actions"?(i(),_(K,{key:3,trigger:["click"]},{overlay:s(()=>[o(J,null,{default:s(()=>[o(j,null,{default:s(()=>[f("a",{onClick:ve=>T(F)},"Editar",8,ge)]),_:2},1024)]),_:2},1024)]),default:s(()=>[f("a",{class:"ant-dropdown-link",onClick:u[1]||(u[1]=le(()=>{},["prevent"]))},[o(r,{shape:"circle",icon:se(S(de)),size:"small"},null,8,["icon"])])]),_:2},1024)):m("",!0)]),_:1},8,["scroll","data-source","loading"])]),f("div",he,[f("span",null,[o(Q,{color:"blue"},{default:s(()=>[f("b",null,A(U.value),1)]),_:1}),D("Usuarios")]),o(W,{size:"small",total:U.value,pageSize:E.value,onChange:R,showSizeChanger:!1},null,8,["total","pageSize"])]),o(Z,{width:"550",open:a.value,"onUpdate:open":u[2]||(u[2]=b=>a.value=b),class:"draw",title:"Editar datos del asesor",placement:"right"},{default:s(()=>[o(_e,{onCloseDraw:n,record:O.value},null,8,["record"])]),_:1},8,["open"])],64)}}};export{ke as default};
