import{r as n,a as L,b as s,o as r,d as E,c as i,w as o,e as N,F as O,x as W,q as b,s as p,h as k,i as y,z as F,m as H,L as j,I as X,k as Z,t as z}from"./index-35c2d705.js";import"./es-36023a69.js";import{u as J}from"./selectes-6ff0a8ca.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";const Q={numberDocument:{type:"iSearch",label:"Número de documento",name:"numberDocument",required:!0,message:"Ingresar Número de documento",disabled:!1},razonSocial:{type:"iText",label:"Nombre",name:"razonSocial",required:!0,message:"Escribe nombre",disabled:!1},city_id:{type:"iSelectWrite",label:"Región del negocio",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelectWrite",label:"Provincia del negocio",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelectWrite",label:"Distrito del negocio",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!0,message:"Escribe el número de RUC",disabled:!1},actividadEconomica:{type:"iText",label:"Actividad Económica",name:"actividadEconomica",required:!0,message:"Escribe la Actividad Económica"},departamento:{type:"iText",label:"Departamento",name:"departamento",required:!0,message:"Escribe el departamento"},provincia:{type:"iText",label:"Provincia",name:"provincia",required:!0,message:"Escribe la provincia"},distrito:{type:"iText",label:"Distrito",name:"distrito",required:!0,message:"Escribe el distrito"},direccion:{type:"iText",label:"Direccion",name:"direccion",required:!0,message:"Escribe la dirección",disabled:!1}};const ee={class:"grid-mype"},ae={__name:"NuevoPlanAccion",emits:["closeDraw"],setup($,{emit:x}){const C=x,c=J();c.$patch({cities:c.cities}),c.fetchCities();const D=n(Q),_=n(!1),R=n(!1),P=[{value:1,label:"DNI"},{value:2,label:"RUC"}],a=L({}),I=()=>{a.numberDocument=a.numberDocument.replace(/\D/g,"")},w=(m,u)=>{const S=m.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return u.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(S)},A=async()=>{},h=m=>{a.province_id=null,a.district_id=null,c.fetchProvinces(m)},T=m=>{a.district_id=null,c.fetchDistricts(m)},U=async()=>{_.value=!0;const m={ruc:a.ruc,razonSocial:a.razonSocial,actividadEconomica:a.actividadEconomica,departamento:a.departamento,provincia:a.provincia,distrito:a.distrito,direccion:a.direccion};try{const u=await F({url:`mype/update-by-ruc/${props.info.id}`,method:"PUT",data:m});u.status==200&&(H.success(u.message),C("closeDraw"))}catch{console.log("Failed to update record")}finally{_.value=!1}};return(m,u)=>{const S=s("a-input"),l=s("a-form-item"),t=s("a-select"),f=s("a-input-search"),v=s("a-button"),q=s("a-form");return r(),E("div",null,[i(q,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:U},{default:o(()=>[N("div",ee,[(r(!0),E(O,null,W(D.value,(e,M)=>(r(),E(O,{key:M},[e.type==="iText"?(r(),b(l,{key:0,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:o(()=>[i(S,{value:a[e.name],"onUpdate:value":d=>a[e.name]=d,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iSelect"?(r(),b(l,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[e.name=="typeDocument"?(r(),b(t,{key:0,value:a[e.name],"onUpdate:value":d=>a[e.name]=d,options:P},null,8,["value","onUpdate:value"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iSearch"?(r(),b(l,{key:2,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[i(f,{loading:R.value,value:a[e.name],"onUpdate:value":d=>a[e.name]=d,onSearch:A,onInput:I,maxlength:a.typeDocument==1?8:11},null,8,["loading","value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iSelectWrite"?(r(),b(l,{key:3,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[e.name=="city_id"?(r(),b(t,{key:0,value:a[e.name],"onUpdate:value":d=>a[e.name]=d,"show-search":"",options:k(c).cities,"filter-option":w,onChange:h},null,8,["value","onUpdate:value","options"])):p("",!0),e.name=="province_id"?(r(),b(t,{key:1,value:a[e.name],"onUpdate:value":d=>a[e.name]=d,"show-search":"",options:k(c).provinces,"filter-option":w,onChange:T,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0),e.name=="district_id"?(r(),b(t,{key:2,value:a[e.name],"onUpdate:value":d=>a[e.name]=d,"show-search":"",options:k(c).districts,"filter-option":w,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0)],64))),128))]),i(l,null,{default:o(()=>[i(v,{class:"btn-produce",type:"primary","html-type":"submit",loading:_.value},{default:o(()=>[y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}},te=K(ae,[["__scopeId","data-v-0799472b"]]);const ne=N("h3",{class:"title-produce"},"PLANES DE ACCIÓN",-1),ie={class:"paginator"},ce={__name:"PlanesDeAccion",setup($){j.locale("es"),n(null),n(!1),n();const x=n(50),C=n([]),c=n(!1),D=n(0),_=n({page:1}),R=n("user/list-asesories"),P=n(1200),a=n(window.innerHeight-100),I=n(!1);n(null),n([{value:"si",label:"Si"},{value:"no",label:"No"}]);const w=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"CENTRO TU EMPRESA",dataIndex:"tuempresa",width:120},{title:"ASESOR",dataIndex:"lastname",width:180},{title:"REGION DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"PROVINCIA DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"DISTRITO DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"NOMBRE DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"RUC",dataIndex:"lastname",width:100,align:"center"},{title:"Genero",dataIndex:"lastname",width:80,align:"center"},{title:"Tiene alguna Discapacidad ? (SI / NO)",dataIndex:"lastname",width:120,align:"center"},{title:"COMPONENTE 1",dataIndex:"lastname",width:180},{title:"COMPONENTE 2",dataIndex:"lastname",width:180},{title:"COMPONENTE 3",dataIndex:"lastname",width:180},{title:"NÚMERO DE SESIONES REALIZADAS",dataIndex:"lastname",width:180},{title:"DÍA INICIO",dataIndex:"lastname",width:120,align:"center"},{title:"DÍA FIN",dataIndex:"lastname",width:120,align:"center"},{title:"TOTAL DE DÍAS",dataIndex:"lastname",width:120},{title:"ACTA DE COMPROMISO",dataIndex:"acta_compromiso",width:180,align:"center"},{title:"CULMINÓ EL PLAN DE ACCIÓN Y ENVIÓ CORREO",dataIndex:"envio_correo",width:180,align:"center"}],A=()=>{a.value=window.innerHeight-315},h=L({search:""}),T=()=>{u({search:h.search})},U=()=>{h.search||u()},m=l=>{_.value.page=l,u()},u=async l=>{try{c.value=!0;const t=_.value.page===1?"":_.value,f=l?{...t,...l}:t,v=await F({url:R.value,method:"GET",params:f});C.value=v.data,D.value=v.total,x.value=v.per_page}catch(t){console.error("Error de red:",t)}finally{c.value=!1}},S=X(()=>l=>(_.value.page-1)*x.value+l+1);return Z(()=>{u(),window.addEventListener("resize",A),A()}),(l,t)=>{const f=s("a-button"),v=s("a-col"),q=s("a-input"),e=s("a-input-group"),M=s("a-row"),d=s("a-table"),B=s("a-tag"),V=s("a-pagination"),Y=s("a-drawer");return r(),E("div",null,[ne,i(M,{style:{margin:"1rem 0"}},{default:o(()=>[i(v,{xs:24,md:12,lg:18},{default:o(()=>[i(f,{onClick:t[0]||(t[0]=g=>I.value=!0),type:"primary"},{default:o(()=>[y("Agregar")]),_:1})]),_:1}),i(v,{xs:24,md:12,lg:6},{default:o(()=>[i(e,{compact:""},{default:o(()=>[i(q,{value:h.search,"onUpdate:value":t[1]||(t[1]=g=>h.search=g),style:{width:"calc(100% - 80px)"},onInput:U},null,8,["value"]),i(f,{type:"primary",disabled:h.search==="",onClick:T},{default:o(()=>[y("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),i(d,{bordered:"",scroll:{x:P.value,y:a.value},class:"table-users",columns:w,"data-source":C.value,pagination:!1,loading:c.value,size:"small"},{bodyCell:o(({column:g,record:oe,index:G})=>[g.dataIndex==="idx"?(r(),E(O,{key:0},[y(z(S.value(G)),1)],64)):p("",!0),g.dataIndex==="tuempresa"?(r(),E(O,{key:1},[y(" cde Miraflores ")],64)):p("",!0)]),_:1},8,["scroll","data-source","loading"]),N("div",ie,[N("span",null,[i(B,{color:"blue"},{default:o(()=>[N("b",null,z(D.value),1)]),_:1}),y("Registros")]),i(V,{size:"small",total:D.value,pageSize:x.value,onChange:m,showSizeChanger:!1},null,8,["total","pageSize"])]),i(Y,{open:I.value,"onUpdate:open":t[3]||(t[3]=g=>I.value=g),title:"Agregar un nuevo Plan de Acción",placement:"right",width:"650"},{default:o(()=>[i(te,{onCloseDraw:t[2]||(t[2]=g=>l.handleCloseDrawopen(1))})]),_:1},8,["open"])])}}};export{ce as default};
