import{_ as q}from"./TableComponent-d678064a.js";import{l as u,r as l,a as k,j as O,X as U,a6 as g,o as _,x as H,h as M,L as V,d as z,c as i,R as I,m as B,b as S,w as c,e as b,a2 as X,y as j}from"./index-a8c64a9c.js";import{d as G}from"./downloadExcel-3ce30936.js";import{_ as J}from"./FormComponent-74ef0a6e.js";import{u as Q}from"./selectes-32342d74.js";import"./es-ea263958.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-2522ff7d.js";import"./quill.snow-ee8445a7.js";const K={key:1,class:"f-20"},W={__name:"RutaTalleresNuevo",props:["info"],emits:["closeDraw"],setup(A,{emit:w}){u.locale("es");const E=l({workshopName:{type:"iText",label:"NOMBRE DEL TALLER",name:"workshopName",required:!0,message:"Escribir el nombre del taller",disabled:!1,maxlength:250},date:{type:"iDate",label:"FECHA DEL TALLER",name:"date",required:!0,message:"Seleccionar una fecha",disabled:!1,disabledDate:o=>{const e=u().startOf("day");return o&&u(o).isBefore(e)}},hour:{type:"iText",label:"HORA DEL TALLER",name:"hour",required:!0,message:"Escribir hora",disabled:!1},link:{type:"iText",label:"ENLACE DE LA SALA",name:"link",required:!1,message:"Ingresa el link del taller",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL TALLER",name:"description",required:!1,message:"Escribir una descripción",disabled:!1},expositor:{type:"iText",label:"EXPOSITOR",name:"expositor",required:!1,message:"Ingresar un expositor",disabled:!1,maxlength:100}});JSON.parse(localStorage.getItem("profile"));const y=w,m=A,d=l(!1),p=l("CREAR"),n=k({}),s=l(!1);Q();const f=l(null),a=l({theme_id:[]}),x=o=>{console.log("handleInputEvent",o)},D=async o=>{},T=async o=>{},L=async o=>{},Y=o=>{},R=async()=>{s.value=!0;const o={workshopName:n.workshopName,date:u(n.date).format("YYYY-MM-DD"),hour:n.hour,link:n.link,description:n.description,expositor:n.expositor};try{const e=await I({url:"route-digital/store",method:"POST",data:o});e.status===200&&(B.success(e.message),C(),y("closeDraw",!0))}catch(e){console.error("Error:",e);const t=document.getElementsByClassName("ant-drawer-body")[0];t&&(t.scrollTop=0)}finally{s.value=!1}},C=()=>{n.workshopName=null,n.date=null,n.hour=null,n.link=null,n.description=null,n.expositor=null},v=async o=>{console.log("set info",o),d.value=!0;try{}catch(e){console.error("Error al cargar la información:",e)}finally{d.value=!1}};return O(()=>{m.info&&v(m.info)}),U(()=>m.info,o=>{o&&v(o)}),g("formState",n),g("loadingState",s),(o,e)=>d.value?(_(),H(M(V),{key:0,style:{color:"#00a6db"}})):(_(),z("div",K,[i(J,{fields:E.value,options:a.value,btnSaveName:p.value,onHandleInputEvent:x,resetSelect:f.value,onHandleChangeSelect:T,onHandleFocusSelect:L,onHandleBlurSelect:Y,onHandleChangeClock:D,onOnSubmit:R},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const Z={class:"advisory-table"},ee=["onClick"],ce={__name:"RutaTalleres",setup(A){const w=JSON.parse(localStorage.getItem("role"))||[],E=l([]),y=l(0),m=l(150),d=l(!1),p=l(!1),n=l("Asesorías"),s=l(!1),f=l(null),a=k({year:u("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1});l([]);const x=l([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:80},{title:"TALLER",fixed:"left",dataIndex:"workshopName",width:200},{title:"FECHA",dataIndex:"date",width:120,align:"center"},{title:"HORA",dataIndex:"hour",width:120,align:"center"},{title:"EXPOSITOR",dataIndex:"expositor",width:140},{title:"DESCRIPCIÓN",dataIndex:"description",width:400},{title:"INVITACIÓN",dataIndex:"emp_country",align:"center",width:120},{title:"TEST DE ENTRADA",dataIndex:"emp_birth",align:"center",width:120},{title:"TEST SALIDA",dataIndex:"emp_age",align:"center",width:80}]),D=()=>{f.value=null,s.value=!0},T=async e=>{try{let t=null;n.value=="Asesorias"&&(t=`advisory/delete/${e.id}`),n.value=="Formalizaciones RUC 10"&&(t=`formalization/delete-ruc-10/${e.id}`),n.value=="Formalizaciones RUC 20"&&(t=`formalization/delete-ruc-20/${e.id}`);const r=await I({url:t,method:"DELETE"});o(),B.success(r.message)}catch(t){console.error("Error de red:",t)}},L=async()=>{p.value=!0;try{const e={};a.year&&(e.year=u(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);let t=null,r=null;a.type==1&&(t="download/asesories",r="Asesorías"),a.type==2&&(t="download/formalizations-ruc10",r="Formalizaciones 10"),a.type==3&&(t="download/formalizations-ruc20",r="Formalizaciones 20"),await G(t,r,e)}catch(e){console.error("Error de red:",e)}finally{p.value=!1}},Y=async e=>{a.page=e,await o()},R=async e=>{e&&(a.page=1,await o())},C=e=>{f.value=e,a.type==1&&(s.value=!0),a.type==2&&(open2.value=!0),a.type==3&&(open3.value=!0)},v=e=>w.some(t=>e.includes(t.id)),o=async()=>{d.value=!0;try{const e={page:a.page};a.year&&(e.year=u(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);const r=await I({url:"route-digital/list",method:"GET",params:e});E.value=r.data.data,y.value=r.data.total,m.value=r.data.per_page}catch(e){console.error("Error de red:",e)}finally{d.value=!1}};return O(async()=>{await o()}),g("search",a),g("loading",d),g("loadingFile",p),(e,t)=>{const r=S("SolutionOutlined"),N=S("a-menu-item"),F=S("a-popconfirm"),$=S("a-drawer");return _(),z("div",Z,[i(q,{title:"TALLERES DE RUTA DIGITAL",new:!0,textNuevo:"NUEVO TALLER",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:x.value,titleSearch:"NOMBRE TALLER",pageSize:m.value,nameTotal:n.value,dataSource:E.value,total:y.value,onHandleNew:D,onHandleDownloadExcel:L,onHandleSearch:R,onHandlePaginator:Y},{"custom-options":c(({record:h})=>[i(N,null,{default:c(()=>[b("a",{onClick:P=>C(h)},"Editar",8,ee)]),_:2},1024),v([1,5])?(_(),H(N,{key:0},{default:c(()=>[i(F,{title:"¿Eliminar?",onConfirm:P=>T(h),class:"prod-alert",placement:"topRight"},{icon:c(()=>[i(M(X),{style:{color:"red"}})]),default:c(()=>[t[2]||(t[2]=b("a",null,"Eliminar",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)):j("",!0)]),default:c(()=>[i(r)]),_:1},8,["columns","pageSize","nameTotal","dataSource","total"]),i($,{width:"500",title:"DETALLES DEL TALLER",open:s.value,"onUpdate:open":t[1]||(t[1]=h=>s.value=h),placement:"right"},{default:c(()=>[i(W,{info:f.value,onCloseDraw:t[0]||(t[0]=h=>(s.value=!1,o()))},null,8,["info"])]),_:1},8,["open"])])}}};export{ce as default};
