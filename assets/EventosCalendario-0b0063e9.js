import{r as m,a as P,l as h,b as s,o as d,d as c,c as t,w as o,e as u,F as b,s as re,x as O,y as f,i as _,U as ie,V as de,m as B,I as $,B as ue,W as me,j as ce,p as M,h as F,Q as pe,t as D,$ as _e,H as fe}from"./index-8c375bbc.js";import"./quill.snow-ffbdeb30.js";import"./es-a0d0c42b.js";import{M as ve}from"./MoreOutlined-d45e5d7c.js";const ge={class:"grid-events"},ye={key:3,class:"grid-events-hour"},be={class:"event-all-day"},he={style:{display:"flex","margin-bottom":"1rem"}},we={__name:"DrawEventosCalendario",props:["type"],emits:["closeDraw"],setup(Q,{emit:E}){const w=m(!1),k=m([{dates:new Date}]),C={office:{type:"iSelect",label:"ÁREA DE",name:"office",required:!0,message:"",disabled:!1},title:{type:"iText",label:"TÍTULO",name:"title",required:!0,message:"",disabled:!1,max:150},date:{type:"iDate",label:"FECHA",name:"date",required:!1,message:"ssss",disabled:!1},allDay:{type:"iSwitch",label:"",name:"allDay",required:!1,message:"Adenda"},description:{type:"iTextArea",label:"DESCRIPCIÓN",name:"description",required:!1,message:"Escribe descripción del evento",max:250},nameUser:{type:"iText",label:"RESPONSABLE",name:"nameUser",required:!1,message:"",disabled:!1,max:100}},a=P({allDay:1}),N=m([{start:null,end:h().subtract(0,"day").format("YYYY-MM-DD")}]),A=g=>g==="office"?[{label:"FERIAS",value:"ferias"},{label:"RUTA DIGITAL",value:"rd"},{label:"UGGER",value:"uger"},{label:"UGO",value:"ugo"},{label:"UGSE",value:"ugse"}]:[],U=(g,n)=>{const I=g.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return n.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(I)},R=async()=>{if(!a.date)return B.error("Debes de seleccionar una fecha");const g={office:a.office,title:a.title,date:h(a.date).format("YYYY-MM-DD"),allDay:a.allDay,...a.allDay==0&&{start:h(a.hours[0]).format("HH:mm"),end:h(a.hours[1]).format("HH:mm")},description:a.description,nameUser:a.nameUser};w.value=!0;try{const n=await $({url:"event/create",method:"POST",data:g});n.status===200&&(B.success(n.message),a.title="")}catch(n){console.error("Failed to update record",n)}finally{w.value=!1}};return(g,n)=>{const I=s("a-select"),y=s("a-form-item"),V=s("a-input"),H=s("VDatePicker"),z=s("a-switch"),T=s("a-time-range-picker"),L=s("a-textarea"),q=s("a-button"),S=s("a-form");return d(),c("div",null,[t(S,{class:"form-events",layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:R},{default:o(()=>[u("div",ge,[(d(),c(b,null,re(C,(e,Y)=>(d(),c(b,{key:Y},[e.type==="iSelect"?(d(),O(y,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[t(I,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:A(e.name),"show-search":"","filter-option":U},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name","label","rules"])):f("",!0),e.type==="iText"?(d(),O(y,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[t(V,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):f("",!0),e.type==="iDate"?(d(),O(y,{key:2,name:e.name,label:e.label},{default:o(()=>[t(H,{modelValue:a[e.name],"onUpdate:modelValue":r=>a[e.name]=r,mode:"date",attributes:k.value,"disabled-dates":N.value},null,8,["modelValue","onUpdate:modelValue","attributes","disabled-dates"])]),_:2},1032,["name","label"])):f("",!0),e.type==="iSwitch"?(d(),c("div",ye,[u("div",be,[n[4]||(n[4]=u("label",{for:""},"TODO EL DÍA ",-1)),t(z,{checked:a.allDay,"onUpdate:checked":n[0]||(n[0]=r=>a.allDay=r),"checked-value":1,"un-checked-value":0},{checkedChildren:o(()=>n[2]||(n[2]=[_("Si")])),unCheckedChildren:o(()=>n[3]||(n[3]=[_("No")])),_:1},8,["checked"])]),ie(u("div",he,[u("div",null,[n[5]||(n[5]=u("label",{style:{display:"block"},for:""},"HORA DE INICIO",-1)),t(T,{"use12-hours":"",value:a.hours,"onUpdate:value":n[1]||(n[1]=r=>a.hours=r),format:"h:mm a"},null,8,["value"])])],512),[[de,a.allDay===0]])])):f("",!0),e.type==="iTextArea"?(d(),O(y,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[t(L,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,rows:4,maxlength:e.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):f("",!0)],64))),64))]),t(y,null,{default:o(()=>[t(q,{type:"primary","html-type":"submit",loading:w.value,style:{"margin-top":"1rem"}},{default:o(()=>n[6]||(n[6]=[_("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const xe={key:0},De={key:1},Ee={class:"paginator"},Oe={__name:"EventosCalendario",setup(Q){h.locale("es"),JSON.parse(localStorage.getItem("role"));const E=m(!1),w=m(null),k=m(0),C=m(50),a=m({page:0}),N=m(1200),A=m([]),U=m(!1),R=m(window.innerHeight-100),g=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"ÁREA",fixed:"left",dataIndex:"office",width:100},{title:"TÍTULO",dataIndex:"title",width:200},{title:"FECHA",dataIndex:"date",width:120,align:"center"},{title:"HORARIO",dataIndex:"hours",width:120,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description",width:240},{title:"RESPONSABLE",dataIndex:"nameUser",width:240},{title:"",dataIndex:"actions",width:30,align:"center",fixed:"right"}],n=P({search:""}),I=()=>{r(),E.value=!1},y=()=>{E.value=!0},V=()=>{let i={search:n.search};r(i)},H=()=>{n.search||r()},z=i=>h(i).format("DD/MM/YYYY"),T=i=>h(i,"HH:mm:ss").format("HH:mm"),L=i=>({ferias:"FERIAS",rd:"RUTA DIGITAL",ugse:"UGSE",uger:"UGGER",ugo:"UGO"})[i],q=i=>{a.value.page=i,r()},S=()=>{R.value=window.innerHeight-330},e=async i=>{},Y=ue(()=>i=>a.value.page*C.value+i+1),r=async i=>{try{U.value=!0;let l;l=a.value.page==0?"":a.value,l=i?{...l,...i}:l;const{data:p}=await $({url:"event/list",method:"GET",params:l});A.value=p==null?void 0:p.data,k.value=p.total,C.value=p.per_page}catch(l){console.error("Error de red:",l)}finally{U.value=!1}};return me(()=>{window.removeEventListener("resize",S)}),ce(()=>{window.addEventListener("resize",S),S(),r()}),(i,l)=>{const p=s("a-button"),j=s("router-link"),G=s("a-col"),J=s("a-input"),W=s("a-input-group"),X=s("a-row"),K=s("a-popconfirm"),Z=s("a-menu-item"),ee=s("a-menu"),ae=s("a-dropdown"),te=s("a-table"),ne=s("a-tag"),le=s("a-pagination"),oe=s("a-drawer");return d(),c(b,null,[u("div",null,[l[7]||(l[7]=u("h3",{class:"title-produce"},"EVENTOS PNTE 2025",-1)),t(X,{style:{margin:"1rem 0"}},{default:o(()=>[t(G,{xs:24,md:12,lg:18},{default:o(()=>[t(p,{type:"primary",onClick:y,class:"box-btn-add"},{default:o(()=>l[3]||(l[3]=[_(" NUEVO EVENTO ")])),_:1}),t(j,{to:"/calendario/eventos",target:"_blank",style:{"margin-left":"1rem"}},{default:o(()=>[t(p,{type:"dashed",icon:M(F(pe))},{default:o(()=>l[4]||(l[4]=[_("Ver Calendario")])),_:1},8,["icon"])]),_:1})]),_:1}),t(G,{xs:24,md:12,lg:6},{default:o(()=>[t(W,{compact:""},{default:o(()=>[t(J,{value:n.search,"onUpdate:value":l[0]||(l[0]=v=>n.search=v),style:{width:"calc(100% - 80px)"},onInput:H},null,8,["value"]),t(p,{type:"primary",disabled:n.search==="",onClick:V},{default:o(()=>l[5]||(l[5]=[_("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),t(te,{bordered:"",scroll:{x:N.value,y:R.value},class:"table-events-google",columns:g,"data-source":A.value,pagination:!1,loading:U.value,size:"small"},{bodyCell:o(({column:v,record:x,index:se})=>[v.dataIndex=="idx"?(d(),c(b,{key:0},[_(D(Y.value(se)),1)],64)):f("",!0),v.dataIndex=="date"?(d(),c(b,{key:1},[_(D(z(x.date)),1)],64)):f("",!0),v.dataIndex=="office"?(d(),c(b,{key:2},[_(D(L(x.office)),1)],64)):f("",!0),v.dataIndex=="hours"?(d(),c(b,{key:3},[x.allDay==1?(d(),c("span",xe,"Todo el día")):(d(),c("span",De,D(T(x.start))+" - "+D(T(x.end)),1))],64)):f("",!0),v.dataIndex=="actions"?(d(),O(ae,{key:4,trigger:["click"]},{overlay:o(()=>[t(ee,null,{default:o(()=>[t(Z,null,{default:o(()=>[t(K,{placement:"rightBottom",title:"¿Quieres eliminar este evento ?",onConfirm:ke=>e(x)},{icon:o(()=>[t(F(_e),{style:{color:"red"}})]),default:o(()=>[l[6]||(l[6]=u("a",null,"Eliminar",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:o(()=>[u("a",{class:"ant-dropdown-link",onClick:l[1]||(l[1]=fe(()=>{},["prevent"]))},[t(p,{shape:"circle",icon:M(F(ve)),size:"small"},null,8,["icon"])])]),_:2},1024)):f("",!0)]),_:1},8,["scroll","data-source","loading"])]),u("div",Ee,[u("span",null,[t(ne,{color:"blue"},{default:o(()=>[u("b",null,D(k.value),1)]),_:1}),l[8]||(l[8]=_("Eventos creados"))]),t(le,{size:"small",total:k.value,pageSize:C.value,onChange:q,showSizeChanger:!1},null,8,["total","pageSize"])]),t(oe,{open:E.value,"onUpdate:open":l[2]||(l[2]=v=>E.value=v),title:w.value?"Editar Evento":"NUEVO EVENTO",placement:"right",width:"450"},{default:o(()=>[t(we,{onCloseDraw:I,dataRow:w.value,type:"events"},null,8,["dataRow"])]),_:1},8,["open","title"])],64)}}};export{Oe as default};
