import{u as _e}from"./selectes-f79054a0.js";import{f as Oe,r as $e,a as Fe}from"./asesorias-112f0f38.js";import{c as o,A as Ee,L as pe,r as h,a as ye,k as we,K as qe,b as y,o as l,d as q,w as t,e as m,F as X,x as ve,q as _,h as w,s as c,t as z,M as Pe,_ as Ce,i as Y,$ as Ue,z as te,m as K,f as Te,V as Se,u as Le,y as Me,a1 as Ye,p as Ve,j as Ge}from"./index-a89c85d3.js";import"./es-abd47609.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import"./storage-e8c9dc3d.js";import{S as He}from"./DrawerSolicitante.componente-11fc3629.js";var je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};const Be=je;function xe(O){for(var R=1;R<arguments.length;R++){var u=arguments[R]!=null?Object(arguments[R]):{},E=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(E=E.concat(Object.getOwnPropertySymbols(u).filter(function(D){return Object.getOwnPropertyDescriptor(u,D).enumerable}))),E.forEach(function(D){Je(O,D,u[D])})}return O}function Je(O,R,u){return R in O?Object.defineProperty(O,R,{value:u,enumerable:!0,configurable:!0,writable:!0}):O[R]=u,O}var ge=function(R,u){var E=xe({},R,u.attrs);return o(Ee,xe({},E,{icon:Be}),null)};ge.displayName="RedoOutlined";ge.inheritAttrs=!1;const Ke=ge;const We={class:"grid-ruc20"},Qe={class:"select-notaries"},Ze={class:"name"},Xe={class:"city"},ea={class:"address"},aa="DD/MM/YYYY",ta={__name:"AllFormalizacion20",props:["info","idCde"],emits:["closeDraw"],setup(O,{emit:R}){pe.locale("es");const u=Ue({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),E=R,D=O,A=h(null),$=JSON.parse(localStorage.getItem("profile")),T=JSON.parse(localStorage.getItem("role")),a=_e(),f=h(!1),G=h(!1),H=h(!0),d=h([]),L=h(null),e=ye({});a.$patch({cities:a.cities}),a.$patch({modalities:a.modalities}),a.$patch({economicSectors:a.economicSectors}),a.$patch({comercialActivities:a.comercialActivities}),a.$patch({regimes:a.regimes}),a.$patch({typeCapital:a.typeCapital}),a.fetchEconomicSectors(),a.fetchComercialActivities(),a.fetchRegimes(),a.fetchModalities(),a.fetchTypeCapital(),a.fetchCities();const j=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}],W=g=>g&&g>pe().endOf("day"),U=g=>{if(g=="ruc"){const r=e.ruc;(r<2e10||r>20999999999)&&(e.ruc=null)}},V=g=>{(g=="ruc"||g=="montocapital")&&(e[g]=e[g].replace(/\D/g,""))},S=(g,r)=>{const C=g.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=r.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),ae=r.city.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),k=r.province.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Z=r.district.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.includes(C)||ae.includes(C)||k.includes(C)||Z.includes(C)},p=async()=>{try{G.value=!0;const g={name:L.value};(await te({url:"create/comercial-activities",method:"POST",data:g})).status==200&&(L.value=null,a.fetchComercialActivities())}catch(g){console.log(g)}finally{G.value=!1}},I=g=>{e.province_id=null,e.district_id=null,a.fetchProvinces(g)},F=g=>{e.district_id=null,a.fetchDistricts(g)},J=async()=>{try{const{data:g}=await Te({url:"public/notaries-filters",method:"GET"}),r=g.map(C=>({value:C.id,name:C.name,city:C.city.name,province:C.province.name,district:C.district.name,address:C.address}));d.value=r,H.value=!1}catch(g){console.error("Error de red:",g)}},B=(g,r)=>{const C=g.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(C)};function Q(g){A.value=Oe;const{documentnumber:r,city_id:C,province_id:s,district_id:ae,address:k}=D.info,Z=T.some(ne=>ne.id===7);e.dni=r,e.city_id=C,I(C),e.province_id=s,F(s),e.district_id=ae,e.address=k,J(),Z&&(A.value.notary_id.disabled=!0,A.value.modality_id.disabled=!0,e.modality_id=1,e.notary_id=$.notary_id)}const i=async()=>{if(f.value=!0,!D.info.id)return K.error("Error al registrar, actualiza la página");const g={codesunarp:e.codesunarp,numbernotary:e.numbernotary,address:e.address,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,regime_id:e.regime_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,modality_id:e.modality_id,notary_id:e.notary_id,user_id:$.user_id,people_id:D.info.id,nameMype:e.nameMype,dateReception:e.dateReception?pe(e.dateReception).format("YYYY-MM-DD"):null,dateTramite:e.dateTramite?pe(e.dateTramite).format("YYYY-MM-DD"):null,ruc:e.ruc,dni:e.dni,typecapital_id:e.typecapital_id,isbic:e.isbic,montocapital:e.montocapital,cde_id:D.idCde?D.idCde:null};try{const r=await te({url:"formalization/create-ruc20",method:"POST",data:g});if(r.status===200){const C={razonSocial:null,ruc:e.ruc,createdFrom:"F20"};K.success(r.message),e.codesunarp=null,e.economicsector_id=null,e.comercialactivity_id=null,e.regime_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.modality_id=null,e.nameMype=null,e.dateReception=null,e.dateTramite=null,e.notary_id=null,e.ruc=null,e.numbernotary=null,e.isbic=null,e.montocapital=null,e.typecapital_id=null,E("closeDraw",!0)}}catch(r){console.log("Error: "+r)}finally{f.value=!1}};return we(()=>{D.info&&Q(D.info)}),qe(()=>D.info,g=>{g&&Q()}),(g,r)=>{const C=y("a-select"),s=y("a-form-item"),ae=y("a-date-picker"),k=y("a-divider"),Z=y("a-input"),ne=y("a-button"),de=y("a-space"),re=y("a-input-number"),fe=y("a-form"),ce=y("a-spin");return l(),q("div",null,[o(ce,{spinning:H.value},{default:t(()=>[o(fe,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:i},{default:t(()=>[m("div",We,[(l(!0),q(X,null,ve(A.value,(n,le)=>(l(),q(X,{key:le},[n.type==="iSelect"?(l(),_(s,{key:0,class:"item-max",name:n.name,label:n.label,rules:[{required:n.required,message:n.message}]},{default:t(()=>[n.name=="regime_id"?(l(),_(C,{key:0,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,options:w(a).regimes,"show-search":"","filter-option":B},null,8,["value","onUpdate:value","options"])):c("",!0),n.name=="modality_id"?(l(),_(C,{key:1,disabled:n.disabled,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,options:w(a).modalities},null,8,["disabled","value","onUpdate:value","options"])):c("",!0),n.name=="typecapital_id"?(l(),_(C,{key:2,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,options:w(a).typeCapital},null,8,["value","onUpdate:value","options"])):c("",!0),n.name=="isbic"?(l(),_(C,{key:3,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,options:j},null,8,["value","onUpdate:value"])):c("",!0),n.name=="notary_id"?(l(),_(C,{key:4,disabled:n.disabled,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,options:d.value,"option-label-prop":"name","show-search":"","filter-option":S},{option:t(({value:v,name:ie,city:N,province:b,district:ee,address:oe})=>[m("div",Qe,[m("span",Ze,z(ie),1),m("span",Xe,z(N)+" - "+z(b)+" - "+z(ee),1),m("span",ea,z(oe),1)])]),_:2},1032,["disabled","value","onUpdate:value","options"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0),n.type==="iDate"?(l(),_(s,{key:1,name:n.name,label:n.label,rules:[{required:n.required,message:n.message}]},{default:t(()=>[o(ae,{locale:w(Pe),value:e[n.name],"onUpdate:value":v=>e[n.name]=v,style:{width:"100%"},format:aa,placeholder:"día/mes/año","disabled-date":W,disabled:n.disabled,onChange:r[0]||(r[0]=v=>e.birthday=g.birthdateDate)},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):c("",!0),n.type==="iSelectWrite"?(l(),_(s,{key:2,class:"item-max",name:n.name,label:n.label,rules:[{required:n.required,message:n.message}]},{default:t(()=>[n.name=="comercialactivity_id"?(l(),_(C,{key:0,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,"show-search":"",options:w(a).comercialActivities,"filter-option":B},{dropdownRender:t(({menuNode:v})=>[o(w(u),{vnodes:v},null,8,["vnodes"]),o(k,{style:{margin:"4px 0"}}),o(de,{style:{padding:"4px 8px"}},{default:t(()=>[o(Z,{ref_for:!0,ref:"inputRef",value:L.value,"onUpdate:value":r[1]||(r[1]=ie=>L.value=ie),placeholder:"Nueva actividad"},null,8,["value"]),o(ne,{type:"text",onClick:p,loading:G.value},{icon:t(()=>[o(w(Ce))]),default:t(()=>[Y(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):c("",!0),n.name=="economicsector_id"?(l(),_(C,{key:1,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,"show-search":"",options:w(a).economicSectors,"filter-option":B},null,8,["value","onUpdate:value","options"])):c("",!0),n.name=="city_id"?(l(),_(C,{key:2,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,"show-search":"",options:w(a).cities,"filter-option":B,onChange:I},null,8,["value","onUpdate:value","options"])):c("",!0),n.name=="province_id"?(l(),_(C,{key:3,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,"show-search":"",options:w(a).provinces,"filter-option":B,onChange:F,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0),n.name=="district_id"?(l(),_(C,{key:4,value:e[n.name],"onUpdate:value":v=>e[n.name]=v,"show-search":"",options:w(a).districts,"filter-option":B,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0),n.type==="iText"?(l(),_(s,{key:3,name:n.name,label:n.label,rules:[{required:n.required,message:n.message,type:n.email,max:n.max,min:n.min}]},{default:t(()=>[o(Z,{onInput:v=>V(n.name),value:e[n.name],"onUpdate:value":v=>e[n.name]=v,disabled:n.disabled,maxlength:n.max,placeholder:n.placeholder},null,8,["onInput","value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):c("",!0),n.type==="iNumber"?(l(),_(s,{key:4,name:n.name,label:n.label,rules:[{required:n.required,message:n.message}]},{default:t(()=>[o(re,{style:{width:"100%"},value:e[n.name],"onUpdate:value":v=>e[n.name]=v,maxlength:11,onChange:v=>U(n.name)},null,8,["value","onUpdate:value","onChange"])]),_:2},1032,["name","label","rules"])):c("",!0),n.type==="iTextLol"?(l(),_(s,{key:5,name:n.name,label:n.label,rules:[{required:n.required,message:n.message}]},{default:t(()=>[o(Z,{onInput:v=>V(n.name),value:e.dni,"onUpdate:value":r[2]||(r[2]=v=>e.dni=v),disabled:!D.documentnumber,maxlength:n.max,placeholder:n.placeholder},null,8,["onInput","value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):c("",!0),n.type==="iMoney"?(l(),_(s,{key:6,name:n.name,label:n.label,rules:[{required:n.required,message:n.message}]},{default:t(()=>[o(re,{"min:":0,style:{width:"100%"},value:e[n.name],"onUpdate:value":v=>e[n.name]=v,formatter:v=>`S/ ${v}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:v=>v.replace(/S\/\s?|(,*)/g,"")},null,8,["value","onUpdate:value","formatter","parser"])]),_:2},1032,["name","label","rules"])):c("",!0)],64))),128))]),o(s,null,{default:t(()=>[o(ne,{class:"btn-produce",type:"primary","html-type":"submit",loading:f.value},{default:t(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},oa=se(ta,[["__scopeId","data-v-2687f40d"]]);const na={class:"wrapper-booking"},ia={class:"grid-booking"},la={__name:"FormalizacionRUC10",props:["info","idCde"],emits:["closeDraw"],setup(O,{emit:R}){const u=JSON.parse(localStorage.getItem("role")),E=Ue({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),D=JSON.parse(localStorage.getItem("profile")),A=O,$=R,T=h(!1),a=h(null);h(null),h(!1);const f=_e(),G=h(!1);f.$patch({cities:f.cities}),f.$patch({provinces:f.provinces}),f.$patch({districts:f.districts}),f.$patch({modalities:f.modalities}),f.$patch({detailProcedures:f.detailProcedures}),f.$patch({economicSectors:f.economicSectors}),f.$patch({comercialActivities:f.comercialActivities}),f.fetchDetailProcedures(),f.fetchModalities(),f.fetchEconomicSectors(),f.fetchComercialActivities(),f.fetchCities();const H=h(!0),d=ye({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,address:null,user_id:D.user_id}),L=()=>{const{documentnumber:p,city_id:I,province_id:F,district_id:J,address:B}=A.info;d.dni=p,d.modality_id=u.some(Q=>Q.id===7)?1:null,d.city_id=I,j(I),d.province_id=F,W(F),d.district_id=J,d.address=B,f.cities&&(H.value=!1)},e=async()=>{try{G.value=!0;const p={name:a.value};(await te({url:"create/comercial-activities",method:"POST",data:p})).status==200&&(a.value=null,f.fetchComercialActivities())}catch(p){console.log(p)}finally{G.value=!1}},j=p=>{d.province_id=null,d.district_id=null,f.fetchProvinces(p)},W=p=>{d.district_id=null,f.fetchDistricts(p)},U=(p,I)=>{const F=p.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return I.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(F)},V=async()=>{if(T.value=!0,!A.info.id)return K.error("Error al registrar, actualiza la página");const p={dni:d.dni,detailprocedure_id:d.detailprocedure_id,modality_id:d.modality_id,economicsector_id:d.economicsector_id,comercialactivity_id:d.comercialactivity_id,city_id:d.city_id,province_id:d.province_id,district_id:d.district_id,address:d.address,ruc:d.ruc,user_id:D.user_id,people_id:A.info.id,cde_id:A.idCde?A.idCde:null};try{const I=await te({url:"formalization/create-ruc-10",method:"POST",data:p});if(I.status===200){const F={razonSocial:null,ruc:d.ruc,createdFrom:"F10"};K.success(I.message),d.detailprocedure_id=null,d.modality_id=null,d.economicsector_id=null,d.comercialactivity_id=null,d.city_id=null,d.province_id=null,d.district_id=null,d.address=null,d.ruc=null,$("closeDraw",!0)}}catch(I){console.log("Error: "+I)}finally{T.value=!1}},S=()=>{K.warning("Debes de completar todos los espacios requeridos")};return(p,I)=>{const F=y("a-select"),J=y("a-form-item"),B=y("a-input"),Q=y("a-divider"),i=y("a-button"),g=y("a-space"),r=y("a-form"),C=y("a-spin");return l(),q("div",na,[o(C,{spinning:H.value},{default:t(()=>[o(r,{layout:"vertical",model:d,name:"basic",autocomplete:"off",onFinish:V,onFinishFailed:S},{default:t(()=>[m("div",ia,[(l(!0),q(X,null,ve(w($e),(s,ae)=>(l(),q(X,{key:ae},[s.type==="iSelect"?(l(),_(J,{key:0,class:"item-max",name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:t(()=>[s.name=="detailprocedure_id"?(l(),_(F,{key:0,value:d[s.name],"onUpdate:value":k=>d[s.name]=k,options:w(f).detailProcedures},null,8,["value","onUpdate:value","options"])):c("",!0),s.name=="modality_id"?(l(),_(F,{key:1,disabled:s.disabled,value:d[s.name],"onUpdate:value":k=>d[s.name]=k,options:w(f).modalities},null,8,["disabled","value","onUpdate:value","options"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0),s.type==="iText"?(l(),_(J,{key:1,name:s.name,label:s.label,rules:[{required:s.required,message:s.message,type:s.email,max:s.max}]},{default:t(()=>[o(B,{value:d[s.name],"onUpdate:value":k=>d[s.name]=k,disabled:s.name==="dni"&&!!d[s.name],maxlength:s.max,placeholder:s.placeholder},null,8,["value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):c("",!0),s.type==="iSelectWrite"?(l(),_(J,{key:2,class:"item-max",name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:t(()=>[s.name=="comercialactivity_id"?(l(),_(F,{key:0,value:d[s.name],"onUpdate:value":k=>d[s.name]=k,"show-search":"",options:w(f).comercialActivities,"filter-option":U},{dropdownRender:t(({menuNode:k})=>[o(w(E),{vnodes:k},null,8,["vnodes"]),o(Q,{style:{margin:"4px 0"}}),o(g,{style:{padding:"4px 8px"}},{default:t(()=>[o(B,{ref_for:!0,ref:"inputRef",value:a.value,"onUpdate:value":I[0]||(I[0]=Z=>a.value=Z),placeholder:"Nueva actividad"},null,8,["value"]),o(i,{type:"text",onClick:e,loading:G.value},{icon:t(()=>[o(w(Ce))]),default:t(()=>[Y(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):c("",!0),s.name=="economicsector_id"?(l(),_(F,{key:1,value:d[s.name],"onUpdate:value":k=>d[s.name]=k,"show-search":"",options:w(f).economicSectors,"filter-option":U},null,8,["value","onUpdate:value","options"])):c("",!0),s.name=="city_id"?(l(),_(F,{key:2,value:d[s.name],"onUpdate:value":k=>d[s.name]=k,"show-search":"",options:w(f).cities,"filter-option":U,onChange:j},null,8,["value","onUpdate:value","options"])):c("",!0),s.name=="province_id"?(l(),_(F,{key:3,value:d[s.name],"onUpdate:value":k=>d[s.name]=k,"show-search":"",options:w(f).provinces,"filter-option":U,onChange:W,disabled:!d.city_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0),s.name=="district_id"?(l(),_(F,{key:4,value:d[s.name],"onUpdate:value":k=>d[s.name]=k,"show-search":"",options:w(f).districts,"filter-option":U,disabled:!d.province_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0)],64))),128))]),o(J,null,{default:t(()=>[o(i,{type:"primary",class:"btn-produce","html-type":"submit",loading:T.value},{default:t(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),m("div",null,z(L()),1)]),_:1},8,["spinning"])])}}},sa=se(la,[["__scopeId","data-v-8ce8f14c"]]);const da={class:"wrapper-booking"},ra={class:"grid-booking"},ca={__name:"AsesoriaNuevo",props:["info","idCde"],emits:["closeDraw"],setup(O,{emit:R}){JSON.parse(localStorage.getItem("role"));const u=_e(),E=JSON.parse(localStorage.getItem("profile")),D=h(!1),A=O,$=R;h(!1),h(null),h(null),u.$patch({components:u.components}),u.$patch({componentThemes:u.componentThemes}),u.$patch({modalities:u.modalities}),u.$patch({cities:u.cities}),u.$patch({economicSectors:u.economicSectors}),u.$patch({comercialActivities:u.comercialActivities}),u.fetchEconomicSectors(),u.fetchComercialActivities(),u.fetchComponents(),u.fetchModalities(),u.fetchCities(),u.fetchGenders();const T=h(!0),a=ye({cde_id:null,dni:null,economicsector_id:null,comercialactivity_id:null,component_id:null,theme_id:null,modality_id:null,ruc:null,city_id:null,province_id:null,district_id:null,observations:null,user_id:E.user_id}),f=U=>{U=="ruc"&&(a[U]=a[U].replace(/\D/g,""))},G=()=>{a.dni=A.info.documentnumber,T.value=!1},H=U=>{a.theme_id=null,u.fetchComponentThemes(U)},d=U=>{a.province_id=null,a.district_id=null,u.fetchProvinces(U)},L=U=>{a.district_id=null,u.fetchDistricts(U)},e=(U,V)=>{const S=U.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return V.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(S)},j=async()=>{if(D.value=!0,!A.info.id)return K.error("Error al registrar actualiza la página");const U={dni:a.dni,economicsector_id:a.economicsector_id,comercialactivity_id:a.comercialactivity_id,observations:a.observations,user_id:E.user_id,people_id:A.info.id,component_id:a.component_id,theme_id:a.theme_id,modality_id:a.modality_id,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,ruc:a.ruc,cde_id:A.idCde?A.idCde:null};try{const V=await te({url:"advisory/create",method:"POST",data:U});if(V.status===200){const S={razonSocial:null,ruc:a.ruc,createdFrom:"asesorias"};K.success(V.message),a.component_id=null,a.theme_id=null,a.modality_id=null,a.city_id=null,a.province_id=null,a.district_id=null,a.observations=null,a.ruc=null,a.economicsector_id=null,a.comercialactivity_id=null,$("closeDraw",!0)}}catch(V){console.log("Error: "+V)}finally{D.value=!1}},W=()=>{K.warning("Debes de completar todos los espacios requeridos")};return(U,V)=>{const S=y("a-select"),p=y("a-form-item"),I=y("a-textarea"),F=y("a-input"),J=y("a-button"),B=y("a-form"),Q=y("a-spin");return l(),q("div",da,[o(Q,{spinning:T.value},{default:t(()=>[o(B,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:j,onFinishFailed:W},{default:t(()=>[m("div",ra,[(l(!0),q(X,null,ve(w(Fe),(i,g)=>(l(),q(X,{key:g},[i.type==="iSelect"?(l(),_(p,{key:0,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:t(()=>[i.name=="modality_id"?(l(),_(S,{key:0,disabled:i.disabled,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,options:w(u).modalities},null,8,["disabled","value","onUpdate:value","options"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0),i.type==="iTextarea"?(l(),_(p,{key:1,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:t(()=>[o(I,{value:a[i.name],"onUpdate:value":r=>a[i.name]=r,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):c("",!0),i.type==="iText"?(l(),_(p,{key:2,name:i.name,label:i.label,rules:[{required:i.required,message:i.message,type:i.email,max:i.max}]},{default:t(()=>[o(F,{value:a[i.name],"onUpdate:value":r=>a[i.name]=r,maxlength:i.max,onInput:r=>f(i.name),placeholder:i.placeholder,disabled:i.name==="dni"&&!!a[i.name]},null,8,["value","onUpdate:value","maxlength","onInput","placeholder","disabled"])]),_:2},1032,["name","label","rules"])):c("",!0),i.type==="iSelectWrite"?(l(),_(p,{key:3,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:t(()=>[i.name=="city_id"?(l(),_(S,{key:0,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,"show-search":"",options:w(u).cities,"filter-option":e,onChange:d},null,8,["value","onUpdate:value","options"])):c("",!0),i.name=="province_id"?(l(),_(S,{key:1,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,"show-search":"",options:w(u).provinces,"filter-option":e,onChange:L,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0),i.name=="district_id"?(l(),_(S,{key:2,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,"show-search":"",options:w(u).districts,"filter-option":e,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0),i.name=="economicsector_id"?(l(),_(S,{key:3,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,"show-search":"",options:w(u).economicSectors,"filter-option":e},null,8,["value","onUpdate:value","options"])):c("",!0),i.name=="comercialactivity_id"?(l(),_(S,{key:4,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,"show-search":"",options:w(u).comercialActivities,"filter-option":e},null,8,["value","onUpdate:value","options"])):c("",!0),i.name=="component_id"?(l(),_(S,{key:5,disabled:i.disabled,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,"show-search":"",options:w(u).components,"filter-option":e,onChange:H},null,8,["disabled","value","onUpdate:value","options"])):c("",!0),i.name=="theme_id"?(l(),_(S,{key:6,value:a[i.name],"onUpdate:value":r=>a[i.name]=r,"show-search":"",options:w(u).componentThemes,"filter-option":e,disabled:!a.component_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0)],64))),128))]),m("div",null,z(G()),1),o(p,null,{default:t(()=>[o(J,{type:"primary",class:"btn-produce","html-type":"submit",loading:D.value},{default:t(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},ua=se(ca,[["__scopeId","data-v-88e6c83b"]]);const ma={key:0},pa={key:0},_a={key:0},va={__name:"AsesoriasHistorial",props:["totaladvisories","totalformalization10","totalformalization20"],setup(O){const R=O,u=h("1"),E=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Componente",dataIndex:"component",width:20},{title:"Tema",dataIndex:"theme",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:60},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],D=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Detalle del trámite",dataIndex:"detailprocedure",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:100},{title:"RUC",dataIndex:"ruc",width:50},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],A=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Régimen",dataIndex:"regime",width:80,align:"center"},{title:"Número solicitud constancia",dataIndex:"numbernotary",width:100},{title:"Nombre empresa",dataIndex:"mypename",width:160},{title:"RUC",dataIndex:"ruc",width:80},{title:"Modalidad",dataIndex:"modality",align:"center",width:70},{title:"Ciudad",dataIndex:"city",width:30},{title:"Provincia",dataIndex:"province",width:20},{title:"Distrito",dataIndex:"district",width:20},{title:"Dirección",dataIndex:"address",width:200}],$=T=>Se(T).format("DD/MM/YYYY HH:mm A");return(T,a)=>{const f=y("a-table"),G=y("a-card"),H=y("a-tab-pane"),d=y("a-tabs");return l(),_(d,{activeKey:u.value,"onUpdate:activeKey":a[0]||(a[0]=L=>u.value=L),type:"card",class:"box-hist"},{default:t(()=>[o(H,{key:"1",tab:"ASESORÍAS"},{default:t(()=>[o(G,null,{default:t(()=>[o(f,{columns:E,"data-source":R.totaladvisories,bordered:"",pagination:!1,size:"small",scroll:{x:1200},"expand-column-width":100},{bodyCell:t(({index:L,column:e,record:j})=>[e.dataIndex==="idx"?(l(),q("span",ma,z(L+1),1)):c("",!0),e.dataIndex==="date_start"?(l(),q(X,{key:1},[Y(z($(j.createDate)),1)],64)):c("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),o(H,{key:"2",tab:"RUC 10"},{default:t(()=>[o(G,null,{default:t(()=>[o(f,{columns:D,"data-source":R.totalformalization10,bordered:"",pagination:!1,size:"small",scroll:{x:1800},"expand-column-width":100},{bodyCell:t(({index:L,column:e,record:j})=>[e.dataIndex==="idx"?(l(),q("span",pa,z(L+1),1)):c("",!0),e.dataIndex==="date_start"?(l(),q(X,{key:1},[Y(z($(j.createDate)),1)],64)):c("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),o(H,{key:"3",tab:"RUC 20"},{default:t(()=>[o(G,null,{default:t(()=>[o(f,{columns:A,"data-source":R.totalformalization20,bordered:"",pagination:!1,size:"small",scroll:{x:2200},"expand-column-width":100},{bodyCell:t(({index:L,column:e,record:j})=>[e.dataIndex==="idx"?(l(),q("span",_a,z(L+1),1)):c("",!0),e.dataIndex==="date_start"?(l(),q(X,{key:1},[Y(z($(j.createDate)),1)],64)):c("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1},8,["activeKey"])}}},fa=se(va,[["__scopeId","data-v-01e75dfe"]]);const P=O=>(Ve("data-v-07b1ea07"),O=O(),Ge(),O),ha={class:"asesorias"},ya=P(()=>m("h3",{class:"title-produce"},"REGISTRO DE FORMALIZACIONES Y ASESORÍAS",-1)),ga=P(()=>m("br",null,null,-1)),ba={class:"wrapper-s"},xa=P(()=>m("label",{class:"label"},"Seleccione el tipo de documento",-1)),wa=P(()=>m("label",{class:"label"},"Digite el número de documento",-1)),Ca=P(()=>m("h4",{class:"title-produce"},"RESULTADO DE LA BÚSQUEDA",-1)),Ua=P(()=>m("b",{class:"box-title"},"Apellidos y nombres:",-1)),Sa=P(()=>m("b",{class:"box-title"},"Número de celular:",-1)),Ia=P(()=>m("b",{class:"box-title"},"Correo electrónico:",-1)),Da=P(()=>m("b",{class:"box-title"},"Asesorías:",-1)),ka=P(()=>m("b",{class:"box-title"},"Formalizaciones RUC 20:",-1)),za=P(()=>m("b",{class:"box-title"},"Formalizaciones RUC 10:",-1)),Aa=P(()=>m("h4",{class:"title-produce"},"SELECCIONAR CDE",-1)),Ra=P(()=>m("h4",{class:"title-produce"},"¿DESEA REGISTRAR UN NUEVO SERVICIO?",-1)),Na={key:0,class:"card-as",style:{padding:"1rem"}},Oa=P(()=>m("h4",{class:"title-produce"},"HISTORIAL",-1)),$a=P(()=>m("div",{class:"steps-content"},null,-1)),Fa={class:"pendient"},Ea={class:"info"},qa=P(()=>m("b",null,"Código SID SUNARP",-1)),Pa={class:"code-number"},Ta=P(()=>m("b",null,"Atendido por: ",-1)),La=P(()=>m("b",null,"Fecha de registro: ",-1)),Ma=P(()=>m("div",{style:{"text-align":"center"}},"NUEVO REGISTRO",-1)),Ya=[Ma],Va={__name:"AsesoriasFormalizaciones",setup(O){const R=JSON.parse(localStorage.getItem("role")),u=()=>R.some(N=>N.id===7),E=_e(),D=Le(),A=Me(),$=h(0),T=h(null),a=h(null),f=h([{value:"asesoria",label:"ASESORÍA"},{value:"ruc20",label:"RUC 20"},{value:"ruc10",label:"RUC 10"}]);E.$patch({cdes:E.cdes}),E.fetchCdes();const G=h(null),H=h(!1),d=h(null),L=h(!1),e=h(!1),j=h(!1),W=h(!1),U=h(!1),V=h(!1),S=h(""),p=h([]),I=h(!1),F=h(0),J=h(!1),B=h([]);h(null);const Q=h([]),i=h([]),g=h([]),r=h(!1),C=N=>{a.value.cde_id=N,localStorage.setItem("profile",JSON.stringify(a.value))},s=(N,b)=>{const ee=N.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return b.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(ee)},ae=()=>{v(S.value),H.value=!1},k=N=>Se(N).format("DD/MM/YYYY HH:mm A"),Z=()=>{de()},ne=()=>{S.value=S.value.replace(/\D/g,"")},de=()=>{r.value=!1,S.value="",p.value=[],B.value=[],D.push({name:"asesorias-formalizaciones"})},re=()=>{if(d.value=null,d.value=p.value,!T.value)return K.warning("Seleccionar un tipo de servicio");T.value=="asesoria"&&(V.value=!0),T.value=="ruc10"&&(U.value=!0),T.value=="ruc20"&&n()},fe=()=>{G.value=p.value,H.value=!0},ce=()=>{F.value=0,W.value=!0,e.value=!1},n=async()=>{try{J.value=!0;const N=await te({url:`formalization/list-ruc-20/${p.value.id}`,method:"GET"});if(N.length<1)return ce();j.value=N,e.value=!0}catch(N){console.log(N)}finally{J.value=!1}},le=async()=>{I.value=!0;const N=await te({url:`person/found/${$.value}/${S.value}`,method:"GET"});if(N.status==200)return p.value=N.data,ie(p.value.id),I.value=!1},v=async N=>{if(I.value=!0,!N)return K.warning("Ingresa un número de documento"),I.value=!1;if($.value==0)return K.warning("Seleccionar el tipo de documento"),I.value=!1;if($.value==1&&S.value.length<8){K.warning("El número de DNI está incompleto"),I.value=!1;return}const b=await te({url:`person/found/${$.value}/${S.value}`,method:"GET"});if(b.status==200)return p.value=b.data,ie(b.data.id),a.value=JSON.parse(localStorage.getItem("profile")),I.value=!1;if(b.status===404){const ee={type:$.value,access:"asesorias",number:S.value};D.push({name:"registrar-persona",query:ee})}},ie=async N=>{try{const{data:b}=await te({url:`historial/registers/${N}`,method:"GET"});Q.value=b.advisories,i.value=b.formalization10,g.value=b.formalization20,r.value=!0}catch(b){console.error("Error de red:",b)}};return we(()=>{A.query.type&&($.value=A.query.type,S.value=A.query.number)}),(N,b)=>{const ee=y("a-radio"),oe=y("a-tooltip"),Ie=y("a-radio-group"),De=y("a-input-search"),he=y("a-card"),M=y("a-col"),ue=y("a-row"),be=y("a-select"),ke=y("a-button"),me=y("a-drawer"),ze=y("a-tag"),Ae=y("a-spin"),Re=y("a-modal");return l(),q(X,null,[m("div",ha,[ya,ga,o(he,{class:"card-as card-gray"},{default:t(()=>[w(A).query.dni?(l(),_(w(Ke),{key:0,class:"ico-reload",onClick:Z})):c("",!0),m("div",ba,[m("div",null,[xa,o(Ie,{value:$.value,"onUpdate:value":b[0]||(b[0]=x=>$.value=x),onChange:de,class:"radio-produce"},{default:t(()=>[o(oe,{color:"cyan"},{title:t(()=>[Y("Documento Nacional de Identidad")]),default:t(()=>[o(ee,{value:"1"},{default:t(()=>[Y("DNI")]),_:1})]),_:1}),o(oe,{color:"cyan"},{title:t(()=>[Y("Carnet de Extranjería")]),default:t(()=>[o(ee,{value:"2"},{default:t(()=>[Y("CE")]),_:1})]),_:1}),o(oe,{color:"cyan"},{title:t(()=>[Y("Pasaporte")]),default:t(()=>[o(ee,{value:"3"},{default:t(()=>[Y("PAS")]),_:1})]),_:1}),o(oe,{color:"cyan"},{title:t(()=>[Y("Permiso Temporal de Permanencia")]),default:t(()=>[o(ee,{value:"4"},{default:t(()=>[Y("PTP")]),_:1})]),_:1})]),_:1},8,["value"])]),m("div",null,[wa,o(De,{"enter-button":"BUSCAR",value:S.value,"onUpdate:value":b[1]||(b[1]=x=>S.value=x),placeholder:"",loading:I.value,onSearch:v,onInput:ne,class:"search-produce",maxlength:$.value==1?8:20},null,8,["value","loading","maxlength"])])])]),_:1}),o(ue,{gutter:[16,16]},{default:t(()=>[o(M,{xs:24,sm:24,lg:12},{default:t(()=>[p.value.length!=0?(l(),_(he,{key:0},{default:t(()=>[Ca,o(w(Ye),{class:"box-icoedit",onClick:fe}),o(ue,{gutter:[0,2],class:"box-info"},{default:t(()=>[o(M,{xs:12,sm:8},{default:t(()=>[Ua]),_:1}),o(M,{xs:12,sm:12},{default:t(()=>[m("span",null,z(p.value.lastname)+" "+z(p.value.middlename)+", "+z(p.value.name),1)]),_:1}),o(M,{xs:12,sm:8},{default:t(()=>[Sa]),_:1}),o(M,{xs:12,sm:12},{default:t(()=>[m("span",null,z(p.value.phone?p.value.phone:"-"),1)]),_:1}),o(M,{xs:12,sm:8},{default:t(()=>[Ia]),_:1}),o(M,{xs:12,sm:12},{default:t(()=>[m("span",null,z(p.value.email?p.value.email:"-"),1)]),_:1}),o(M,{xs:12,sm:8},{default:t(()=>[Da]),_:1}),o(M,{xs:12,sm:12},{default:t(()=>{var x;return[m("span",null,z((x=p.value)==null?void 0:x.idadvisory.length),1)]}),_:1}),o(M,{xs:12,sm:8},{default:t(()=>[ka]),_:1}),o(M,{xs:12,sm:12},{default:t(()=>{var x;return[m("span",null,z((x=p.value)==null?void 0:x.idformalization20.length),1)]}),_:1}),o(M,{xs:12,sm:8},{default:t(()=>[za]),_:1}),o(M,{xs:12,sm:12},{default:t(()=>{var x;return[m("span",null,z((x=p.value)==null?void 0:x.idformalization10.length),1)]}),_:1})]),_:1})]),_:1})):c("",!0)]),_:1}),o(M,{xs:24,sm:24,lg:12},{default:t(()=>[p.value.length!=0?(l(),_(he,{key:0,style:{height:"100%"}},{default:t(()=>[o(ue,{gutter:[16,24]},{default:t(()=>[u()?c("",!0):(l(),_(M,{key:0,xs:24,sm:18,md:12,lg:12},{default:t(()=>[Aa,o(be,{class:"w-100",value:a.value.cde_id,"onUpdate:value":b[2]||(b[2]=x=>a.value.cde_id=x),options:w(E).cdes,"show-search":"","filter-option":s,onChange:C},null,8,["value","options"])]),_:1})),o(M,{xs:24,sm:18,md:12,lg:17},{default:t(()=>[Ra,o(ue,{gutter:[10,0]},{default:t(()=>[o(M,{xs:17,sm:18},{default:t(()=>[o(be,{class:"w-100",value:T.value,"onUpdate:value":b[3]||(b[3]=x=>T.value=x),options:f.value},null,8,["value","options"])]),_:1}),o(M,{xs:6},{default:t(()=>[o(ke,{type:"primary",onClick:re},{default:t(()=>[Y("REGISTRAR")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):c("",!0)]),_:1})]),_:1}),r.value?(l(),q("div",Na,[Oa,o(fa,{totaladvisories:Q.value,totalformalization10:i.value,totalformalization20:g.value},null,8,["totaladvisories","totalformalization10","totalformalization20"])])):c("",!0)]),m("section",null,[o(me,{title:"Regitsrar una Formalización con RUC 20",open:W.value,"onUpdate:open":b[5]||(b[5]=x=>W.value=x),placement:"right",width:"880px"},{default:t(()=>[o(oa,{info:d.value,idCde:a.value.cde_id,onCloseDraw:b[4]||(b[4]=x=>(W.value=!1,le()))},null,8,["info","idCde"]),$a]),_:1},8,["open"]),o(me,{width:"600px",title:"Regitsrar Formalización con RUC 10",open:U.value,"onUpdate:open":b[7]||(b[7]=x=>U.value=x),placement:"right"},{default:t(()=>[o(sa,{info:p.value,idCde:a.value.cde_id,onCloseDraw:b[6]||(b[6]=x=>(U.value=!1,le()))},null,8,["info","idCde"])]),_:1},8,["open"]),o(me,{width:"600px",title:"Registrar una asesoría",open:V.value,"onUpdate:open":b[9]||(b[9]=x=>V.value=x),placement:"right"},{default:t(()=>[o(ua,{info:p.value,idCde:a.value.cde_id,onCloseDraw:b[8]||(b[8]=x=>(V.value=!1,le()))},null,8,["info","idCde"])]),_:1},8,["open"]),o(Re,{open:e.value,"onUpdate:open":b[10]||(b[10]=x=>e.value=x),title:"Pendientes",closable:!0,cancelText:"Cerrar",footer:null,maskClosable:!1,width:"380px"},{default:t(()=>[o(Ae,{spinning:L.value},{default:t(()=>[(l(!0),q(X,null,ve(j.value,(x,Ne)=>(l(),q("div",{key:Ne},[m("div",Fa,[m("div",Ea,[qa,m("span",null,[m("b",Pa,[o(ze,{color:"error",style:{margin:"0"}},{default:t(()=>[Y(z(x.codesunarp),1)]),_:2},1024)])]),Ta,m("span",null,z(x.user.profile.name)+" "+z(x.user.profile.lastname),1),La,m("span",null,z(k(x.updated_at)),1)])])]))),128)),m("div",{class:"pendient pendient-btn btn-produce",onClick:ce},Ya)]),_:1},8,["spinning"])]),_:1},8,["open"]),o(me,{width:"600",open:H.value,"onUpdate:open":b[11]||(b[11]=x=>H.value=x),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:t(()=>[o(He,{onCloseDraw:ae,updateValues:G.value},null,8,["updateValues"])]),_:1},8,["open"])])],64)}}},Qa=se(Va,[["__scopeId","data-v-07b1ea07"]]);export{Qa as default};
