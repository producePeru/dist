import{r as _,j as J,k as X,o as i,d as x,e as m,n as Z,l as Q,a as ee,b as p,c as s,w as r,I as ae,J as te,F as q,f as N,M as ne,p as U,q as oe,t as re,x as c,v as b,h as L,H as le,i as y,m as S}from"./index-e79988f3.js";import{_ as se}from"./tuempresa-7c20bfb9.js";import{u as ie}from"./selectes-43282fae.js";import{F as de}from"./FormalizacionFooter-606085fa.js";import{_ as me,a as ue}from"./logo-tuempresa-c1197180.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";import"./es-31dcee15.js";import"./EnvironmentOutlined-0a367d17.js";const pe={__name:"FormalizacionHeader",setup(w){const u=_(null),v=_(!1),g=()=>{window.pageYOffset>10?v.value=!0:v.value=!1};return J(()=>{window.addEventListener("scroll",g)}),X(()=>{window.removeEventListener("scroll",g)}),(I,E)=>(i(),x("header",{class:Z(["header",{floatingNav:v.value}]),ref_key:"navBar",ref:u},E[0]||(E[0]=[m("div",{class:"container header-wrapper",style:{padding:"0"}},[m("img",{src:me,alt:"logo-produce",style:{position:"relative",top:"-8px"}}),m("img",{src:ue,alt:"logo-tu-empresa",style:{height:"50px",position:"relative",top:"8px"}})],-1)]),2))}},be=ce(pe,[["__scopeId","data-v-7635780b"]]);const fe={class:"attendance"},ve={class:"container"},_e={class:"attendance-section"},ye={class:"qr-form"},ge={key:0,class:"qr-title"},Ee={key:9},he="DD/MM/YYYY",Ce={__name:"ValoracionNotarias",setup(w){Q.locale("es");const u=ie();u.$patch({typeDocuments:u.typeDocuments}),u.$patch({economicSectors:u.economicSectors}),u.fetchEconomicSectors(),u.fetchTypeDocuments(),u.fetchGenders();const v=_(!1);_(null);const g=_(!1),I=_(!1),E=_(!1),a=ee({}),k=[{value:"si",label:"SI"},{value:"no",label:"NO"}],M=n=>{if(n==="country_id")return u.countries;if(n==="gender_id")return u.genders;if(n==="sick")return k;if(n==="typedocument_id")return u.typeDocuments},f=_({title1:{type:"iTittle",label:"DATOS DEL USUARIO"},typedocument_id:{type:"iSelect",label:"TIPO DE DOCUMENTO DE IDENTIDAD",name:"typedocument_id",required:!0,message:"Seleccionar tipo",disabled:!1},documentnumber:{type:"iSearch",label:"INGRESE NÚMERO DE IDENTIDAD",name:"documentnumber",required:!0,message:"Escribir tu número de documento",disabled:!0,max:11},nationality:{type:"iText",label:"NACIONALIDAD",name:"nationality",required:!0,message:"Escribir nacionalidad",disabled:!1,max:50},name:{type:"iText",label:"NOMBRES",name:"name",required:!0,message:"Escribir nombre",disabled:!0,max:80},lastname:{type:"iText",label:"APELLIDO PATERNO",name:"lastname",required:!0,message:"Escribir nombre",disabled:!0,max:80},middlename:{type:"iText",label:"APELLIDO MATERNO",name:"middlename",required:!0,message:"Escribir nombre",disabled:!0,max:80},phone:{type:"iText",label:"NÚMERO DE CELULAR",name:"phone",required:!1,message:"Escribe tu num. de celular",disabled:!1,max:9},email:{type:"iText",label:"CORREO ELECTRÓNICO",name:"email",required:!1,message:"Ingresar email",email:"email",disabled:!1,max:150},economicsector_id:{type:"iSelectWrite",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!1,message:"Seleccionar sector económnico",disabled:!1},title2:{type:"iTittle",label:"DATOS DEL TRAMITE"},motivo:{type:"iRadio",label:"1. EL MOTIVO DE SU VISITA ES PARA REALIZAR EL TRÁMITE DE:",name:"motivo",required:!0,message:"Escoger opción",disabled:!0,other:!1},notary:{type:"iText",label:"2. ¿CUÁL ES EL NOMBRE DE LA NOTARIA?",name:"notary",required:!0,message:"Escribir nombre de la notaría",disabled:!1,max:150},califica:{type:"iRadio",label:"3. ¿CÓMO CALIFICARÍA LA ATENCIÓN?",name:"califica",required:!0,message:"Escoger opción",disabled:!0,other:!1}}),F=(n,t)=>{if(!t)return Promise.reject("La fecha es requerida");const o=new Date,d=new Date(t);let D=o.getFullYear()-d.getFullYear();const T=o.getMonth()-d.getMonth();return(T<0||T===0&&o.getDate()<d.getDate())&&D--,D<18||D>99?Promise.reject("La edad debe estar entre 18 y 99 años"):Promise.resolve()},P=(n,t)=>{if(n.field==="phone"){const o=/^9\d{8}$/;if(t){if(!o.test(t))return Promise.reject("El número debe empezar con 9 y tener exactamente 9 dígitos")}}return Promise.resolve()},B=n=>{const t=a[n]?a[n].trim():"";a[n]=t},V=n=>{n=="typedocument_id"&&(a.documentnumber=null,a.name=null,a.lastname=null,a.middlename=null,a.typedocument_id!=1?(f.value.name.disabled=!1,f.value.lastname.disabled=!1,f.value.middlename.disabled=!1):(f.value.name.disabled=!0,f.value.lastname.disabled=!0,f.value.middlename.disabled=!0))},z=(n,t)=>{const o=a.typedocument_id;return/^\d+$/.test(t)?o===1&&t.length!==8?Promise.reject("Debe tener exactamente 8 caracteres."):o!==1&&t.length>12?Promise.reject("Debe tener exactamente 12 caracteres."):(o===1&&t.startsWith("0")&&t.length===8,Promise.resolve()):Promise.reject("Solo se permiten números.")},$=async()=>{const{typedocument_id:n,documentnumber:t}=a;if(!n||!t){S.error("El tipo de documento y el número de documento no pueden estar vacíos.");return}if(!/^\d+$/.test(t)){S.error("El número de documento solo debe contener caracteres numéricos.");return}if(n===1&&t.length!==8){S.error("El número de documento debe tener exactamente 8 caracteres para el tipo de documento DNI.");return}try{if(g.value=!0,a.typedocument_id==1){f.value.name.disabled=!0,f.value.lastname.disabled=!0,f.value.middlename.disabled=!0;const o=await N({url:`public/search-api-dni/${a.documentnumber}`,method:"GET"});o.status==200&&(a.name=o.data.name,a.lastname=o.data.lastname,a.middlename=o.data.middlename,a.nationality="PERUANO")}}catch(o){console.error("Error de red:",o),S.error("Error al procesar ese dato")}finally{g.value=!1}},A=(n,t)=>{const o=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)},O=()=>{a.typedocument_id=null,a.documentnumber=null,a.nationality=null,a.name=null,a.lastname=null,a.middlename=null,a.phone=null,a.email=null,a.economicsector_id=null,a.motivo=null,a.notary=null,a.califica=null},j=async()=>{E.value=!0;const n={typedocument_id:a.typedocument_id,documentnumber:a.documentnumber,nationality:a.nationality,name:a.name,lastname:a.lastname,middlename:a.middlename,phone:a.phone,email:a.email,economicsector_id:a.economicsector_id,motivo:a.motivo,notary:a.notary,califica:a.califica};try{const t=await N({url:"public/valorization-notary",method:"POST",data:n});t.status==200&&(v.value=!0,setTimeout(()=>{O(),v.value=!1,window.scrollTo({top:0,behavior:"smooth"})},2e3)),t.status==400&&ne.warning({title:"REGISTRO AVISO",content:U("div",{},[U("p",t.message)]),onOk(){O(),window.scrollTo({top:0,behavior:"smooth"})},class:"attendance-modal"})}catch(t){console.error("Error de red:",t)}finally{E.value=!1}};return(n,t)=>{const o=p("a-input-search"),d=p("a-form-item"),D=p("a-input"),T=p("a-date-picker"),C=p("a-select"),Y=p("a-textarea"),h=p("a-radio"),R=p("a-radio-group"),G=p("a-button"),H=p("a-form"),W=p("a-modal");return i(),x(q,null,[s(be),m("div",fe,[m("div",ve,[m("section",_e,[s(H,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:j,onKeydown:t[0]||(t[0]=ae(te(()=>{},["prevent"]),["enter"]))},{default:r(()=>[t[9]||(t[9]=m("div",{class:"qr-title-main"},[m("h2",null,"CALIFICA MI ATENCIÓN"),m("h3",null,"Centro de Desarrollo Empresarial (CDE) Agente")],-1)),m("div",ye,[(i(!0),x(q,null,oe(f.value,(e,K)=>(i(),x(q,{key:K},[e.type==="iTittle"?(i(),x("div",ge,[m("h4",null,re(e.label),1)])):c("",!0),e.type==="iSearch"?(i(),b(d,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,validator:z}]},{default:r(()=>[s(o,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,placeholder:"","enter-button":"BUSCAR",loading:g.value,maxlength:a.typedocument_id===1?8:12,onSearch:$},null,8,["value","onUpdate:value","loading","maxlength"])]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="iSearchRuc"?(i(),b(d,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max},{pattern:/^(10|15|20)\d{9,}$/,message:"El número debe comenzar con 10, 15 o 20, tener solo números, y al menos 11 caracteres"}]},{default:r(()=>[s(o,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,placeholder:"Ingresar RUC","enter-button":"BUSCAR",loading:I.value,maxlength:e.max,onSearch:n.handleSearchRUCC,disabled:e.disabled},null,8,["value","onUpdate:value","loading","maxlength","onSearch","disabled"])]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="iText"?(i(),b(d,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max},{validator:P}]},{default:r(()=>[s(D,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,maxlength:e.max,onBlur:l=>B(e.name),disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","onBlur","disabled"])]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="iDate"?(i(),b(d,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message},{validator:F,message:"La edad debe estar entre 18 y 99 años"}]},{default:r(()=>[s(T,{locale:L(le),value:a[e.name],"onUpdate:value":l=>a[e.name]=l,style:{width:"100%"},format:he,placeholder:"día/mes/año",disabled:e.disabled},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="iSelect"?(i(),b(d,{key:5,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:r(()=>[s(C,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:M(e.name),"show-search":"","filter-option":A,onChange:l=>V(e.name),disabled:e.disabled},null,8,["value","onUpdate:value","options","onChange","disabled"])]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="iTextarea"?(i(),b(d,{key:6,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:r(()=>[s(Y,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,rows:4,maxlength:e.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="iSelectWrite"?(i(),b(d,{key:7,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:r(()=>[e.name=="economicsector_id"?(i(),b(C,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:L(u).economicSectors,"filter-option":A,disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="iRadio"?(i(),b(d,{key:8,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:r(()=>[e.name=="motivo"?(i(),b(R,{key:0,class:"qr-califica",value:a[e.name],"onUpdate:value":l=>a[e.name]=l,name:e.name},{default:r(()=>[s(h,{value:"reserva",class:"qr-radio"},{default:r(()=>t[2]||(t[2]=[y("RESERVA DE NOMBRE")])),_:1}),s(h,{value:"acto",class:"qr-radio"},{default:r(()=>t[3]||(t[3]=[y("ACTO CONSTITUTIVO")])),_:1})]),_:2},1032,["value","onUpdate:value","name"])):c("",!0),e.name=="califica"?(i(),b(R,{key:1,class:"qr-califica",value:a[e.name],"onUpdate:value":l=>a[e.name]=l,name:e.name},{default:r(()=>[s(h,{value:"4",class:"qr-radio"},{default:r(()=>t[4]||(t[4]=[y("EXCELENTE")])),_:1}),s(h,{value:"3",class:"qr-radio"},{default:r(()=>t[5]||(t[5]=[y("BUENO")])),_:1}),s(h,{value:"2",class:"qr-radio"},{default:r(()=>t[6]||(t[6]=[y("REGULAR")])),_:1}),s(h,{value:"1",class:"qr-radio"},{default:r(()=>t[7]||(t[7]=[y("MALO")])),_:1})]),_:2},1032,["value","onUpdate:value","name"])):c("",!0)]),_:2},1032,["name","label","rules"])):c("",!0),e.type==="space1"?(i(),x("div",Ee)):c("",!0)],64))),128))]),s(d,null,{default:r(()=>[s(G,{type:"primary","html-type":"submit",loading:E.value,class:"attendance-btn"},{default:r(()=>t[8]||(t[8]=[y("ENVIAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])]),s(de),s(W,{open:v.value,"onUpdate:open":t[1]||(t[1]=e=>v.value=e),title:"",width:"350px",footer:"",closeIcon:" ",maskClosable:!1},{default:r(()=>t[10]||(t[10]=[m("div",{class:"qr-modal"},[m("img",{src:se,alt:"logo-tu-empresa"}),m("p",null,"Gracias por contribuir a mejorar nuestros procesos")],-1)])),_:1},8,["open"])],64)}}};export{Ce as default};
