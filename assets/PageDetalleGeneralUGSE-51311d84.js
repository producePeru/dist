import{c as n,A as ne,L as E,g as le,r as D,x as ae,P as oe,j as re,b as y,o as i,d as c,w as o,a4 as ie,y as se,i as s,e as r,t,h as b,F as C,v as N,a6 as Y,p as F,q as w,H as S}from"./index-7992612a.js";import"./es-6ddf0d13.js";import{E as de}from"./EnvironmentOutlined-4e7013a1.js";import{T as ue}from"./TeamOutlined-bcc18e35.js";var ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};const pe=ce;function W(g){for(var f=1;f<arguments.length;f++){var _=arguments[f]!=null?Object(arguments[f]):{},$=Object.keys(_);typeof Object.getOwnPropertySymbols=="function"&&($=$.concat(Object.getOwnPropertySymbols(_).filter(function(h){return Object.getOwnPropertyDescriptor(_,h).enumerable}))),$.forEach(function(h){me(g,h,_[h])})}return g}function me(g,f,_){return f in g?Object.defineProperty(g,f,{value:_,enumerable:!0,configurable:!0,writable:!0}):g[f]=_,g}var G=function(f,_){var $=W({},f,_.attrs);return n(ne,W({},$,{icon:pe}),null)};G.displayName="VerticalAlignBottomOutlined";G.inheritAttrs=!1;const fe=G;const ve={class:"info-h1"},_e={style:{"text-transform":"uppercase"}},be={style:{display:"flex","flex-wrap":"wrap"}},ye=["onClick"],ge={key:0},he={style:{width:"100%"}},ke={style:{"margin-bottom":"6px"}},we={style:{"text-transform":"capitalize"}},De={key:0},$e={key:1},Ae={key:2,class:"acciones"},Ce={style:{width:"20px"}},Oe={style:{width:"100%"}},xe={key:0},Pe={key:1},Re={class:"conv-files"},Be=["onClick"],Ee=["onClick"],Ye=["onClick"],Fe="DD/MM/YYYY",Ve={__name:"PageDetalleGeneralUGSE",setup(g){E.locale("es");const f=le.get("token"),_="https://apituempresa.soporte-pnte.com/api/",$="http://127.0.0.1:8000/api/",h=window.location.hostname=="localhost"||window.location.hostname=="127.0.0.1"?$:_,I=D(),L=D(null),M=D(!1),U=D(!1),H=ae();D([]);const P=oe(ie,{style:{fontSize:"18px"},spin:!0});D(null);const O=D(null),u=D([]),j=d=>{if(d)return E(d).format("DD-MM-YYYY")},V=async(d,e)=>{O.value=e;try{const p=await S.get(`${h}agreement/commitment-download/${d}`,{responseType:"blob",headers:{Accept:"application/json",Authorization:`Bearer ${f}`}}),v=window.URL.createObjectURL(new Blob([p.data])),k=document.createElement("a");k.href=v,k.setAttribute("download",e),document.body.appendChild(k),k.click(),document.body.removeChild(k)}catch(p){console.error("Error al descargar el archivo",p)}finally{O.value=null}},X=async d=>{L.value=d.id;try{const e=await S({url:`${h}agreement/file-download/${d.id}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${f}`}}),p=window.URL.createObjectURL(new Blob([e.data])),v=document.createElement("a");v.href=p,v.setAttribute("download",d.name),document.body.appendChild(v),v.click(),window.URL.revokeObjectURL(p),document.body.removeChild(v)}catch(e){console.error("Error downloading file:",e)}finally{L.value=null}},Z=async(d,e)=>{try{U.value=!0;const p=H.params.id,v=e?`${h}pdf/agreements-general/${p}?start=${e.start}&end=${e.end}`:`${h}pdf/agreements-general/${p}`,k=await S.get(v,{responseType:"blob",headers:{Accept:"application/json",Authorization:`Bearer ${f}`}}),z=window.URL.createObjectURL(new Blob([k.data])),A=document.createElement("a");A.href=z,A.setAttribute("download",`${d}.pdf`),document.body.appendChild(A),A.click()}catch(p){console.error("Error descargando el PDF:",p)}finally{U.value=!1}},K=async d=>{if(!Array.isArray(d)||d===null){console.warn("Invalid date array provided."),await T();return}if(d.length===2){const e={start:E(d[0]).format("YYYY/MM/DD"),end:E(d[1]).format("YYYY/MM/DD")};await T(e)}},T=async d=>{try{M.value=!0;const e=H.params.id,p=d?`/agreement/general/${e}?start=${d.start}&end=${d.end}`:`/agreement/general/${e}`,v=await se({url:p,method:"GET"});u.value=v}catch(e){console.error("Error de red:",e)}finally{M.value=!1}};return re(()=>{T()}),(d,e)=>{const p=y("router-link"),v=y("a-breadcrumb-item"),k=y("a-breadcrumb"),z=y("a-range-picker"),A=y("a-button"),ee=y("a-tooltip"),R=y("a-flex"),m=y("a-descriptions-item"),x=y("a-spin"),te=y("a-descriptions");return i(),c("section",null,[n(k,null,{default:o(()=>[n(v,null,{default:o(()=>[n(p,{to:"/admin/convenios/ugse"},{default:o(()=>e[2]||(e[2]=[s("Lista de convenios")])),_:1})]),_:1}),n(v,null,{default:o(()=>e[3]||(e[3]=[r("h4",null,"Resumen General del convenio",-1)])),_:1})]),_:1}),n(x,{spinning:M.value},{default:o(()=>{var q;return[n(R,{justify:"space-between"},{default:o(()=>[r("h1",ve,t(u.value.alliedEntity),1),n(R,{align:"center",gap:10},{default:o(()=>[r("div",null,[n(z,{value:I.value,"onUpdate:value":e[0]||(e[0]=l=>I.value=l),onChange:K,format:Fe},null,8,["value"])]),n(ee,{placement:"topLeft",title:"Descargar reporte en PDF"},{default:o(()=>[n(A,{class:"btn-pdf",onClick:e[1]||(e[1]=l=>Z(u.value.alliedEntity)),loading:U.value,type:"primary"},{default:o(()=>[r("b",null,[n(b(fe)),e[4]||(e[4]=s(" PDF "))])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),e[10]||(e[10]=r("br",null,null,-1)),n(te,{bordered:"",size:"small"},{default:o(()=>[n(m,{label:"Región"},{default:o(()=>{var l;return[s(t((l=u.value.region)==null?void 0:l.name),1)]}),_:1}),n(m,{label:"Provincia"},{default:o(()=>{var l;return[s(t((l=u.value.provincia)==null?void 0:l.name),1)]}),_:1}),n(m,{label:"Distrito"},{default:o(()=>{var l;return[s(t((l=u.value.distrito)==null?void 0:l.name),1)]}),_:1}),n(m,{label:"RUC"},{default:o(()=>[s(t(u.value.ruc),1)]),_:1}),n(m,{label:"Componente",span:2},{default:o(()=>[r("span",_e,t(u.value.components),1)]),_:1}),n(m,{label:"Inicio convenio"},{default:o(()=>[s(t(j(u.value.startDate)),1)]),_:1}),n(m,{label:"Fin convenio"},{default:o(()=>[s(t(j(u.value.endDate)),1)]),_:1}),n(m,{label:"Renovación Automática",style:{width:"200px"}},{default:o(()=>[s(t(u.value.renovation),1)]),_:1}),n(m,{label:"Punto Focal"},{default:o(()=>[s(t(u.value.focal),1)]),_:1}),n(m,{label:"Focal cargo"},{default:o(()=>[s(t(u.value.focalCargo),1)]),_:1}),n(m,{label:"Focal Num. celular"},{default:o(()=>[s(t(u.value.focalPhone),1)]),_:1}),n(m,{label:"Representante Legal"},{default:o(()=>[s(t(u.value.aliado),1)]),_:1}),n(m,{label:"Num. celular",span:2},{default:o(()=>[s(t(u.value.aliadoPhone),1)]),_:1}),n(m,{label:"Comentarios",span:3},{default:o(()=>[r("p",null,t(u.value.observations),1)]),_:1}),n(m,{label:"Archivos",span:3},{default:o(()=>[r("div",be,[(i(!0),c(C,null,N(u.value.files_agreements,(l,B)=>(i(),c("div",{class:"conv-files",key:B},[L.value!=l.id?(i(),c("a",{key:0,onClick:a=>X(l)},[n(b(Y)),s(" "+t(l.name),1)],8,ye)):(i(),F(x,{key:1,indicator:b(P),style:{"min-width":"100px"}},null,8,["indicator"]))]))),128))])]),_:1})]),_:1}),e[11]||(e[11]=r("br",null,null,-1)),((q=u.value.compromisos)==null?void 0:q.length)>=1?(i(),c("div",ge,[e[8]||(e[8]=r("br",null,null,-1)),e[9]||(e[9]=r("h4",null,"Compromisos",-1)),(i(!0),c(C,null,N(u.value.compromisos,(l,B)=>(i(),c("div",{class:"acciones-box",key:B,style:{margin:"1rem 0"}},[n(R,{gap:10},{default:o(()=>[r("b",null,t(B+1),1),r("div",he,[r("div",ke,[e[5]||(e[5]=s("Título: ")),r("b",null,t(l.title),1)]),r("div",null,[e[6]||(e[6]=s("Tipo: ")),r("span",we,t(l.type),1)]),l.meta?(i(),c("div",De,"Meta: "+t(l.meta),1)):w("",!0),l.description?(i(),c("div",$e,"Descripción: "+t(l.description),1)):w("",!0),r("div",null,"Registrado por: "+t(l.profile.name)+" "+t(l.profile.lastname)+" "+t(l.profile.middlename),1),l.acciones.length>=1?(i(),c("div",Ae,[e[7]||(e[7]=r("h4",null,"Acciones",-1)),(i(!0),c(C,null,N(l.acciones,(a,J)=>(i(),c("div",{class:"acciones-box acciones-bg",key:J},[n(R,null,{default:o(()=>[r("div",Ce,t(J+1),1),r("div",Oe,[r("div",null,"Conferencia: "+t(a.accion),1),r("div",null,"Fecha: "+t(j(a.date)),1),r("div",null,"Modalidad: "+t(a.modality=="v"?"Virtual":"Presencial"),1),a.address?(i(),c("div",xe,[n(b(de)),s(" "+t(a.address),1)])):w("",!0),r("div",null,[n(b(ue)),s(" "+t(a.participants)+" participantes ",1)]),a.details?(i(),c("div",Pe,"Detalle: "+t(a.details),1)):w("",!0),r("div",null,"Registrado por: "+t(a.profile.name)+" "+t(a.profile.lastname)+" "+t(a.profile.middlename),1),r("div",Re,[a.file1_name?(i(),c(C,{key:0},[O.value==a.file1_name?(i(),F(x,{key:0,indicator:b(P)},null,8,["indicator"])):(i(),c("a",{key:1,onClick:Q=>V(a.file1_path,a.file1_name)},[n(b(Y)),s(" "+t(a.file1_name),1)],8,Be))],64)):w("",!0),a.file2_name?(i(),c(C,{key:1},[O.value==a.file2_name?(i(),F(x,{key:0,indicator:b(P)},null,8,["indicator"])):(i(),c("a",{key:1,onClick:Q=>V(a.file2_path,a.file2_name)},[n(b(Y)),s(" "+t(a.file2_name),1)],8,Ee))],64)):w("",!0),a.file3_name?(i(),c(C,{key:2},[O.value==a.file3_name?(i(),F(x,{key:0,indicator:b(P)},null,8,["indicator"])):(i(),c("a",{key:1,onClick:Q=>V(a.file3_path,a.file3_name)},[n(b(Y)),s(" "+t(a.file3_name),1)],8,Ye))],64)):w("",!0)])])]),_:2},1024)]))),128))])):w("",!0)])]),_:2},1024)]))),128))])):w("",!0)]}),_:1},8,["spinning"])])}}};export{Ve as default};
