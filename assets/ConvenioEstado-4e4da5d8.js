import{c as n,A as me,L as F,r as f,a as ve,b as _,o as d,q as $,w as p,e as D,d as y,F as Y,x as _e,h as O,s as w,M as Ce,i as R,z as Q,m as P,k as fe,K as $e,a1 as Je,a2 as Ae,t as T,a3 as we,g as Ue,P as Me,a4 as Qe,H as ie,I as Xe,v as Ze,a5 as Oe,n as se,a6 as Ee,U as We,J as Ke,p as et,j as tt}from"./index-a89c85d3.js";import{_ as at}from"./icoexcel-1b303edf.js";import{u as Ne}from"./selectes-f79054a0.js";import"./es-abd47609.js";import{_ as Te}from"./_plugin-vue_export-helper-c27b6911.js";import{M as nt}from"./MoreOutlined-5b727beb.js";var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};const st=ot;function xe(m){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?Object(arguments[r]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(g){return Object.getOwnPropertyDescriptor(s,g).enumerable}))),i.forEach(function(g){it(m,g,s[g])})}return m}function it(m,r,s){return r in m?Object.defineProperty(m,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[r]=s,m}var ge=function(r,s){var i=xe({},r,s.attrs);return n(me,xe({},i,{icon:st}),null)};ge.displayName="CloudUploadOutlined";ge.inheritAttrs=!1;const lt=ge;var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};const dt=rt;function Ie(m){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?Object(arguments[r]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(g){return Object.getOwnPropertyDescriptor(s,g).enumerable}))),i.forEach(function(g){ct(m,g,s[g])})}return m}function ct(m,r,s){return r in m?Object.defineProperty(m,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[r]=s,m}var he=function(r,s){var i=Ie({},r,s.attrs);return n(me,Ie({},i,{icon:dt}),null)};he.displayName="MessageOutlined";he.inheritAttrs=!1;const ut=he;var pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};const mt=pt;function Se(m){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?Object(arguments[r]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(g){return Object.getOwnPropertyDescriptor(s,g).enumerable}))),i.forEach(function(g){vt(m,g,s[g])})}return m}function vt(m,r,s){return r in m?Object.defineProperty(m,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[r]=s,m}var ye=function(r,s){var i=Se({},r,s.attrs);return n(me,Se({},i,{icon:mt}),null)};ye.displayName="SaveOutlined";ye.inheritAttrs=!1;const _t=ye,ft={city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!0},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},denomination:{type:"iText",label:"Denominación",name:"denomination",required:!0,message:"Escribir la denominación",disabled:!0},alliedEntity:{type:"iText",label:"Entidad Aliada",name:"alliedEntity",required:!0,message:"Escribir la entidad aliada",disabled:!0},homeOperations:{type:"iDate",label:"Inicio de Operaciones",name:"homeOperations",required:!0,message:"Escribir el incio de las operaciones",disabled:!0},address:{type:"iText",label:"Dirección",name:"address",required:!0,message:"Escribir la dirección",disabled:!0},reference:{type:"iText",label:"Referencia",name:"reference",required:!0,message:"Escribir la referencia",disabled:!0},resolution:{type:"iText",label:"Resolución de Autorización de CDE",name:"resolution",required:!0,message:"Escribir la referencia",disabled:!0},startDate:{type:"iDate",label:"Inicio Convenio Vigente",name:"startDate",required:!0,message:"Seleccionar fecha de convenio vigente",disabled:!0},endDate:{type:"iDate",label:"Fin del convenio",name:"endDate",required:!0,message:"Seleccionar fecha fin de convenio",disabled:!0},initials:{type:"iCheckbox",label:"Entidades",name:"initials",required:!0,message:"Escribir la referencia",disabled:!0}};const gt={class:"grid-convenios"},ke="DD/MM/YYYY",ht={__name:"DrawConvenio",emits:["closeDraw"],setup(m,{emit:r}){F.locale("es");const s=JSON.parse(localStorage.getItem("profile")),i=Ne(),g=r;i.$patch({cities:i.cities}),i.$patch({provinces:i.provinces}),i.$patch({districts:i.districts}),i.$patch({agreementStatus:i.agreementStatus}),i.$patch({operationalStatus:i.operationalStatus}),i.fetchCities(),i.fetchAgreementStatus(),i.fetchOperationalStatus();const A=f(!1),M=f(!1),k=["UGO  - TU EMPRESA","TU EMPRESA - DVMYPE","DVMYPE-SG","SG-OGPPM","OGPPM-TU EMPRESA","TU EMPRESA-ALIADO"],e=ve({}),U=x=>{const l=F(e.startDate).add(1,"day").startOf("day");return F(x).startOf("day").isBefore(l,"day")},q=x=>{e.province_id=null,e.district_id=null,i.fetchProvinces(x)},V=x=>{e.district_id=null,i.fetchDistricts(x)},L=(x,l)=>{const t=x.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return l.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)},B=()=>{e.denomination=null,e.alliedEntity=null,e.homeOperations=null,e.address=null,e.reference=null,e.resolution=null,e.initials=null,e.startDate=null,e.endDate=null,e.city_id=null,e.province_id=null,e.district_id=null,e.operationalstatus_id=null,e.agreementstatus_id=null,e.created_id=s.user_id},j=async()=>{A.value=!0;const x={denomination:e.denomination,alliedEntity:e.alliedEntity,homeOperations:F(e.homeOperations).format("YYYY-MM-DD"),address:e.address,reference:e.reference,resolution:e.resolution,initials:e.initials,startDate:F(e.startDate).format("YYYY-MM-DD"),endDate:F(e.endDate).format("YYYY-MM-DD"),city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,operationalstatus_id:e.operationalstatus_id,agreementstatus_id:e.agreementstatus_id,created_id:s.user_id};try{const l=await Q({url:"agreement/create",method:"POST",data:x});l.status==200&&(P.success(l.message),g("closeDraw",!0),B())}catch(l){P.error("Se originó un error: "+l.message)}finally{A.value=!1}},N=()=>{P.error("Debes de completar todos los espacios requeridos")};return(x,l)=>{const t=_("a-input"),c=_("a-form-item"),b=_("a-select"),I=_("a-date-picker"),X=_("a-checkbox-group"),Z=_("a-button"),S=_("a-form"),W=_("a-spin");return d(),$(W,{spinning:M.value},{default:p(()=>[n(S,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:j,onFinishFailed:N},{default:p(()=>[D("div",gt,[(d(!0),y(Y,null,_e(O(ft),(a,le)=>(d(),y(Y,{key:le},[a.type==="iText"?(d(),$(c,{key:0,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,max:a.max}]},{default:p(()=>[n(t,{value:e[a.name],"onUpdate:value":E=>e[a.name]=E,maxlength:a.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):w("",!0),a.type==="iSelect"?(d(),$(c,{key:1,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[a.name=="city_id"?(d(),$(b,{key:0,value:e[a.name],"onUpdate:value":E=>e[a.name]=E,options:O(i).cities,"show-search":"","filter-option":L,onChange:q},null,8,["value","onUpdate:value","options"])):w("",!0),a.name=="province_id"?(d(),$(b,{key:1,value:e[a.name],"onUpdate:value":E=>e[a.name]=E,options:O(i).provinces,"show-search":"","filter-option":L,onChange:V,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):w("",!0),a.name=="district_id"?(d(),$(b,{key:2,value:e[a.name],"onUpdate:value":E=>e[a.name]=E,options:O(i).districts,"show-search":"","filter-option":L,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):w("",!0),a.name=="operationalstatus_id"?(d(),$(b,{key:3,value:e[a.name],"onUpdate:value":E=>e[a.name]=E,options:O(i).operationalStatus,"show-search":"","filter-option":L},null,8,["value","onUpdate:value","options"])):w("",!0),a.name=="agreementstatus_id"?(d(),$(b,{key:4,value:e[a.name],"onUpdate:value":E=>e[a.name]=E,options:O(i).agreementStatus,"show-search":"","filter-option":L},null,8,["value","onUpdate:value","options"])):w("",!0)]),_:2},1032,["name","label","rules"])):w("",!0),a.type==="iDate"?(d(),$(c,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[a.name=="endDate"?(d(),$(I,{key:0,"disabled-date":U,locale:O(Ce),disabled:!e.startDate,value:e[a.name],"onUpdate:value":E=>e[a.name]=E,style:{width:"100%"},format:ke,placeholder:"día/mes/año"},null,8,["locale","disabled","value","onUpdate:value"])):(d(),$(I,{key:1,locale:O(Ce),value:e[a.name],"onUpdate:value":E=>e[a.name]=E,style:{width:"100%"},format:ke,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"]))]),_:2},1032,["name","label","rules"])):w("",!0),a.type==="iCheckbox"?(d(),$(c,{key:3,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[n(X,{value:e[a.name],"onUpdate:value":E=>e[a.name]=E,name:"checkboxgroup",options:k,style:{display:"grid","grid-gap":".2rem"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):w("",!0)],64))),128))]),n(c,null,{default:p(()=>[n(Z,{type:"primary","html-type":"submit",loading:A.value},{default:p(()=>[R("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},yt=Te(ht,[["__scopeId","data-v-a5681a47"]]);const bt={class:"accion-icons"},Dt={key:0},Ct={key:1},wt={__name:"DrawAcciones",props:["idConvenio"],emits:["refreshTable"],setup(m,{emit:r}){const s=m,i=r,g=f([]),A=f(!0),M=f(null),k=f(""),e=f(!1);f(null);const U=ve({description:null});fe(()=>{s.idConvenio&&N(s.idConvenio)}),$e(()=>s.idConvenio,l=>{l&&N()});function q(l){M.value=l.id,k.value=l.description,we(()=>{x()})}function V(l){const t=g.value.findIndex(c=>c.id===l.id);t!==-1&&(g.value[t].description=k.value),M.value=null,B(l.id)}const L=async l=>{try{const t=await Q({url:`agreement/delete-acction/${l.id}`,method:"DELETE"});t.status==200&&(N(),P.success(t.message),i("refreshTable",!0))}catch(t){console.error("Error de red:",t)}},B=async l=>{try{const t={description:k.value},c=await Q({url:`agreement/update/${l}`,method:"PUT",data:t});c.status==200&&(P.success(c.message),N())}catch(t){console.error("Error de red:",t)}},j=async()=>{try{const l={description:U.description,agreements_id:s.idConvenio},t=await Q({url:"agreement/create-acction",method:"POST",data:l});t.status==200&&(P.success(t.message),i("refreshTable",!0),N(),U.description=null)}catch(l){console.error("Error de red:",l)}},N=async()=>{A.value=!0;try{const l=await Q({url:`agreement/list/${s.idConvenio}`,method:"GET"});l.status==200&&(g.value=l.data)}catch{}finally{A.value=!1}},x=()=>{we(()=>{const l=document.getElementById("auto-resize");l.style.height="auto",l.style.height=l.scrollHeight+"px"})};return(l,t)=>{const c=_("a-textarea"),b=_("a-spin"),I=_("a-form-item"),X=_("a-button"),Z=_("a-form");return d(),y("div",null,[n(b,{spinning:A.value},{default:p(()=>[(d(!0),y(Y,null,_e(g.value,(S,W)=>(d(),y("div",{class:"acciones",key:W},[D("div",bt,[n(O(Je),{class:"pointer ico-acc",onClick:a=>q(S)},null,8,["onClick"]),M.value===S.id?(d(),$(O(_t),{key:0,class:"pointer ico-save",onClick:a=>V(S)},null,8,["onClick"])):w("",!0),n(O(Ae),{class:"pointer ico-acc",onClick:a=>L(S)},null,8,["onClick"])]),M.value===S.id?(d(),y("div",Dt,[n(c,{value:k.value,"onUpdate:value":t[0]||(t[0]=a=>k.value=a),onInput:x,id:"auto-resize"},null,8,["value"])])):(d(),y("p",Ct,T(S.description),1))]))),128))]),_:1},8,["spinning"]),n(Z,{layout:"vertical",model:U,name:"basic",autocomplete:"off",onFinish:j},{default:p(()=>[n(I,{name:"description",label:"Registra una acción",rules:[{required:!0,message:"Escribir la descripción"}]},{default:p(()=>[n(c,{value:U.description,"onUpdate:value":t[1]||(t[1]=S=>U.description=S),maxlength:250,rows:4},null,8,["value"])]),_:1}),n(I,null,{default:p(()=>[n(X,{type:"primary","html-type":"submit",loading:e.value},{default:p(()=>[R("CREAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const Ot=D("div",{class:"agreements-file"},[D("b",null,"Formatos a subir"),D("span",null,"pdf, doc, docx, xls, xlsx, ppt, pptx"),D("span",null,"*(Máximo 20MB)")],-1),Et={class:"file-options"},xt={style:{"line-height":"1.3"}},It=["onClick"],St=["onClick"],kt={__name:"DrawFiles",props:["idConvenio"],setup(m){F.locale("es");const r=Ue.get("token"),s=m,i="https://apituempresa.soporte-pnte.com/api/",g="http://127.0.0.1:8000/api/",A=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?g:i,M=f(!1),k=f([]),e=f(null),U=f(null),q=Me(Qe,{style:{fontSize:"20px"},spin:!0});fe(()=>{s.idConvenio&&l(s.idConvenio)}),$e(()=>s.idConvenio,t=>{t&&l(t)});const V=t=>F(t).format("DD-MM-YYYY HH:mm"),L=t=>(B(t),!1),B=async t=>{const c=new FormData;c.append("file",t),c.append("agreements_id",s.idConvenio),M.value=!0;try{const{data:b}=await ie.post(`${A}agreement/file`,c,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${r}`}});b.status==200&&(P.success(b.message),l(s.idConvenio))}catch{P.error("Error al subir este tipo de archivo")}finally{M.value=!1}},j=async t=>{e.value=t.uid;try{const c=await ie({url:`${A}agreement/file-download/${t.uid}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${r}`}}),b=window.URL.createObjectURL(new Blob([c.data])),I=document.createElement("a");I.href=b,I.setAttribute("download",t.name),document.body.appendChild(I),I.click(),window.URL.revokeObjectURL(b),document.body.removeChild(I)}catch(c){console.error("Error downloading file:",c)}finally{e.value=null}},N=t=>{t.file.status!=="uploading"&&console.log(t.file,t.fileList),t.file.status==="done"?(P.success(`${t.file.name} file uploaded successfully`),k.value=t.fileList.filter(c=>c.status!=="error")):t.file.status==="error"&&(P.error(`${t.file.name} file upload failed.`),k.value=t.fileList.filter(c=>c.uid!==t.file.uid))},x=async t=>{U.value=t.uid;try{const c=await Q({url:`agreement/delete/file/${t.uid}`,method:"DELETE"});c.status==200&&(l(s.idConvenio),P.success(c.message))}catch(c){console.error("Error de red:",c)}finally{U.value=null}},l=async t=>{try{const{data:c}=await ie.get(`${A}agreement/list-files/${t}`,{headers:{Authorization:`Bearer ${r}`}});c.status===200&&(k.value=c.data.map(b=>({uid:b.id,name:b.name,status:"done",url:b.path,date:b.created_at})))}catch(c){console.error("Error fetching files:",c)}};return(t,c)=>{const b=_("a-button"),I=_("a-spin"),X=_("a-space"),Z=_("a-upload");return d(),y("div",null,[Ot,n(Z,{"file-list":k.value,name:"file",onChange:N,"custom-request":B,"before-upload":L},{itemRender:p(({file:S,actions:W})=>[n(X,{style:{margin:"0rem 0","font-size":"13px",width:"100%"}},{default:p(()=>[D("div",Et,[D("span",xt,T(S.name),1),D("span",null,T(V(S.date)),1),e.value!=S.uid?(d(),y("a",{key:0,onClick:a=>j(S)},"Descargar",8,It)):(d(),$(I,{key:1,indicator:O(q)},null,8,["indicator"])),U.value==S.uid?(d(),$(I,{key:2,indicator:O(q)},null,8,["indicator"])):(d(),y("a",{key:3,onClick:a=>x(S),style:{color:"var(--error)"}},[n(O(Ae))],8,St))])]),_:2},1024)]),default:p(()=>[n(b,{style:{"margin-bottom":".6rem"},loading:M.value},{default:p(()=>[n(O(lt)),R(" SUBIR ARCHIVO ")]),_:1},8,["loading"])]),_:1},8,["file-list"])])}}};const te=m=>(et("data-v-0b101f52"),m=m(),tt(),m),$t=te(()=>D("h3",{class:"title-produce"},"ESTADO DE CONVENIOS",-1)),At=te(()=>D("img",{width:"20",style:{margin:"-2px 0 0 0"},src:at},null,-1)),Ut={key:0,class:"table-head"},Mt=te(()=>D("span",null,"REGIÓN",-1)),Nt={class:"t-icons"},Tt={key:1,class:"table-head"},zt=te(()=>D("span",null,"DENOMINACIÓN",-1)),Rt={class:"t-icons"},Pt={key:3,style:{"line-height":"1.2",margin:"0","font-size":"12px"}},Lt={key:0,class:"list-days"},Yt={key:1,class:"list-days"},qt={key:8,class:"accion-total"},Vt={class:"accion-numb"},Ft=["onClick"],Bt=te(()=>D("a",null,"Eliminar",-1)),jt={class:"paginator"},Ht={__name:"ConvenioEstado",props:["idConvenio"],setup(m){F.locale("es"),JSON.parse(localStorage.getItem("profile")),Ne();const r=Ue.get("token"),s="https://apituempresa.soporte-pnte.com/api/",i="http://127.0.0.1:8000/api/",g=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?i:s,A=f(null),M=f(null),k=f(!1),e=f(null),U=f(0),q=f(50),V=f({page:0}),L=f(1200),B=f([]),j=f(!1),N=f(!1),x=f(!1),l=f(!1),t=f(null);f(null);const c=f(window.innerHeight-100),b=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"REGIÓN",dataIndex:"city",fixed:"left",width:120},{title:"PROVINCIA",dataIndex:"province",fixed:"left",width:120},{title:"DISTRITO",dataIndex:"district",fixed:"left",width:140},{title:"DENOMINACIÓN",dataIndex:"denomination",fixed:"left",width:150},{title:"ENTIDAD ALIADA",dataIndex:"entity",width:170},{title:"INICIO DE OPERACIONES",dataIndex:"startOperations",align:"center",width:120},{title:"DIRECCIÓN",dataIndex:"address",width:180},{title:"REFERENCIA",dataIndex:"references",width:220},{title:"RESOLUCIÓN DE AUTORIZACIÓN PARA CONDICIÓN DE CDE",dataIndex:"resolution",align:"center",width:150},{title:"ESTADO DE OPERATIVIDAD",dataIndex:"statusOperations",align:"center",width:120},{title:"ESTADO DEL CONVENIO",dataIndex:"statusConveny",align:"center",width:120},{title:"ENTIDADES",dataIndex:"entities",align:"center",width:170},{title:"INICIO CONVENIO VIGENTE",dataIndex:"startDate",align:"center",width:120},{title:"NUM. AÑOS DEL CONVENIO",dataIndex:"numbyears",align:"center",width:110},{title:"FIN DEL CONVENIO",dataIndex:"endDate",align:"center",width:120},{title:"DÍAS",dataIndex:"numbrestantes",align:"center",width:70},{title:"ACCIONES",dataIndex:"acciones",align:"center",width:100},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],I=ve({search:""}),X=()=>{let u={search:I.search};H(u)},Z=()=>{I.search||H()},S=u=>({0:"red",1:"orange",2:"green",3:"purple",4:"blue",5:"pink"})[u],W=u=>{A.value=u,H({order:u})},a=u=>{M.value=u,H({date_diff_order:u})},le=u=>{e.value=u.id,x.value=!0},E=u=>F(u).format("DD/MM/YYYY"),ze=(u,o)=>{const C=new Date(o),z=new Date(u);let J=z.getFullYear()-C.getFullYear(),G=z.getMonth()-C.getMonth(),K=z.getDate()-C.getDate();if(G<0&&(J--,G+=12),K<0){const ue=new Date(z.getFullYear(),z.getMonth(),0).getDate();K+=ue,G--}const ce=J>0?`${J} año${J>1?"s":""}`:"",ae=G>0?`${G} mes${G>1?"es":""}`:"",ne=K>0?`${K} día${K>1?"s":""}`:"";return[ce,ae,ne].filter(Boolean).join(" con ")},Re=u=>{e.value=u.id,l.value=!0},ee=(u,o)=>{const C=new Date(u),z=new Date,J=C.getTime()-z.getTime();return Math.floor(J/(1e3*3600*24))+1},Pe=u=>u<=0||u<20?"red":u<40?"#f9e717":"#11d811",Le=u=>{V.value.page=u,H()},re=()=>{c.value=window.innerHeight-320},Ye=()=>{t.value=null,N.value=!0},de=u=>{H(),u==1&&(N.value=!1),u==2&&(x.value=!1)},qe=async u=>{try{const o=await Q({url:`agreement/delete/${u.id}`,method:"DELETE"});o.status==200&&(H(),P.success(o.message))}catch(o){console.error("Error de red:",o)}},Ve=Xe(()=>u=>V.value.page*q.value+u+1),H=async u=>{try{j.value=!0;let o;o=V.value.page==0?"":V.value,o=u?{...o,...u}:o;const{data:C}=await Q({url:"agreement/list",method:"GET",params:o});B.value=C==null?void 0:C.data,U.value=C.total,q.value=C.per_page}catch(o){console.error("Error de red:",o)}finally{j.value=!1}},Fe=async()=>{k.value=!0;try{const u=await ie({url:`${g}agreement/download`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${r}`}}),o=window.URL.createObjectURL(new Blob([u.data])),C=document.createElement("a"),z="convenios.xlsx";C.href=o,C.setAttribute("download",z),document.body.appendChild(C),C.click(),window.URL.revokeObjectURL(o),document.body.removeChild(C)}catch(u){console.error("Error downloading file:",u)}finally{k.value=!1}};return Ze(()=>{window.removeEventListener("resize",re)}),fe(()=>{window.addEventListener("resize",re),re(),H()}),(u,o)=>{const C=_("a-button"),z=_("a-col"),J=_("a-input"),G=_("a-input-group"),K=_("a-row"),ce=_("a-progress"),ae=_("a-tag"),ne=_("a-menu-item"),be=_("a-popconfirm"),ue=_("a-menu"),Be=_("a-dropdown"),je=_("a-table"),He=_("a-pagination"),pe=_("a-drawer");return d(),y(Y,null,[D("div",null,[$t,n(K,{style:{margin:"1rem 0"}},{default:p(()=>[n(z,{xs:24,md:12,lg:18},{default:p(()=>[n(C,{type:"primary",onClick:Ye,style:{"margin-right":".5rem"}},{default:p(()=>[R("NUEVO")]),_:1}),n(C,{class:"btn-excel",onClick:Fe,loading:k.value,type:"primary"},{default:p(()=>[At]),_:1},8,["loading"])]),_:1}),n(z,{xs:24,md:12,lg:6},{default:p(()=>[n(G,{compact:""},{default:p(()=>[n(J,{value:I.search,"onUpdate:value":o[0]||(o[0]=h=>I.search=h),style:{width:"calc(100% - 80px)"},onInput:Z},null,8,["value"]),n(C,{type:"primary",disabled:I.search==="",onClick:X},{default:p(()=>[R("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(je,{bordered:"",scroll:{x:L.value,y:c.value},class:"table-agreements",columns:b,"data-source":B.value,pagination:!1,loading:j.value,size:"small"},{headerCell:p(({column:h})=>[h.dataIndex=="city"?(d(),y("div",Ut,[Mt,D("div",Nt,[n(O(Oe),{class:se([{arrActive:A.value=="asc"},"ii"]),onClick:o[1]||(o[1]=v=>W("asc"))},null,8,["class"]),n(O(Ee),{class:se([{arrActive:A.value=="desc"},"ii"]),onClick:o[2]||(o[2]=v=>W("desc"))},null,8,["class"])])])):w("",!0),h.dataIndex=="denomination"?(d(),y("div",Tt,[zt,D("div",Rt,[n(O(Oe),{class:se([{arrActive:M.value=="asc"},"ii"]),onClick:o[3]||(o[3]=v=>a("asc"))},null,8,["class"]),n(O(Ee),{class:se([{arrActive:M.value=="desc"},"ii"]),onClick:o[4]||(o[4]=v=>a("desc"))},null,8,["class"])])])):w("",!0)]),bodyCell:p(({column:h,record:v,index:Ge})=>[h.dataIndex=="idx"?(d(),y(Y,{key:0},[R(T(Ve.value(Ge)),1)],64)):w("",!0),h.dataIndex=="denomination"?(d(),y(Y,{key:1},[R(T(v.denomination)+" ",1),n(ce,{style:{margin:"0"},percent:ee(v.endDate,v.startDate),size:4,showInfo:!1,strokeColor:Pe(ee(v.endDate,v.startDate))},null,8,["percent","strokeColor"])],64)):w("",!0),h.dataIndex=="entities"?(d(!0),y(Y,{key:2},_e(v.entities,(oe,De)=>(d(),y("div",{key:De},[n(ae,{color:S(De),style:{margin:".2rem 0"}},{default:p(()=>[R(T(oe),1)]),_:2},1032,["color"])]))),128)):w("",!0),h.dataIndex=="numbyears"?(d(),y("p",Pt,T(ze(v.endDate,v.startDate)),1)):w("",!0),h.dataIndex=="startDate"?(d(),y(Y,{key:4},[R(T(E(v==null?void 0:v.startDate)),1)],64)):w("",!0),h.dataIndex=="startOperations"?(d(),y(Y,{key:5},[R(T(E(v==null?void 0:v.startOperations)),1)],64)):w("",!0),h.dataIndex=="endDate"?(d(),y(Y,{key:6},[R(T(E(v==null?void 0:v.endDate)),1)],64)):w("",!0),h.dataIndex=="numbrestantes"?(d(),y(Y,{key:7},[ee(v.endDate,v.startDate)>=1?(d(),y("p",Lt,T(ee(v.endDate,v.startDate))+" días faltantes",1)):(d(),y("p",Yt,T(ee(v.endDate,v.startDate))+" días vencidos",1))],64)):w("",!0),h.dataIndex=="acciones"?(d(),y("div",qt,[n(O(ut),{class:"ico-acciones",onClick:oe=>le(v)},null,8,["onClick"]),D("span",Vt,T(v.acciones.length)+" MENSAJES",1)])):w("",!0),h.dataIndex=="actions"?(d(),$(Be,{key:9,trigger:["click"]},{overlay:p(()=>[n(ue,null,{default:p(()=>[n(ne,null,{default:p(()=>[D("a",{onClick:oe=>Re(v)},"Archivos",8,Ft)]),_:2},1024),n(ne,null,{default:p(()=>[n(be,{title:"¿Seguro de eliminar?",onConfirm:oe=>qe(v)},{icon:p(()=>[n(O(We),{style:{color:"red"}})]),default:p(()=>[Bt]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:p(()=>[D("a",{class:"ant-dropdown-link",onClick:o[5]||(o[5]=Ke(()=>{},["prevent"]))},[n(C,{shape:"circle",icon:Me(O(nt)),size:"small"},null,8,["icon"])])]),_:2},1024)):w("",!0)]),_:1},8,["scroll","data-source","loading"])]),D("div",jt,[D("span",null,[n(ae,{color:"blue"},{default:p(()=>[D("b",null,T(U.value),1)]),_:1}),R("Convenios")]),n(He,{size:"small",total:U.value,pageSize:q.value,onChange:Le,showSizeChanger:!1},null,8,["total","pageSize"])]),n(pe,{open:N.value,"onUpdate:open":o[7]||(o[7]=h=>N.value=h),class:"draw-notary","root-class-name":"root-class-name",title:"Convenios",placement:"right",width:"650"},{default:p(()=>[n(yt,{onCloseDraw:o[6]||(o[6]=h=>de(1))})]),_:1},8,["open"]),n(pe,{open:x.value,"onUpdate:open":o[10]||(o[10]=h=>x.value=h),title:"Acciones",placement:"right",width:"550"},{default:p(()=>[n(wt,{idConvenio:e.value,onCloseDraw:o[8]||(o[8]=h=>de(2)),onRefreshTable:o[9]||(o[9]=h=>H())},null,8,["idConvenio"])]),_:1},8,["open"]),n(pe,{open:l.value,"onUpdate:open":o[12]||(o[12]=h=>l.value=h),title:"Cargar Archivos",placement:"right",width:"550"},{default:p(()=>[n(kt,{idConvenio:e.value,onCloseDraw:o[11]||(o[11]=h=>de(3))},null,8,["idConvenio"])]),_:1},8,["open"])],64)}}},Kt=Te(Ht,[["__scopeId","data-v-0b101f52"]]);export{Kt as default};
