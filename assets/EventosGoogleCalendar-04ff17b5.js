import{l as f,p as W,a as X,r as i,q as Z,j as ee,b as y,o as d,d as u,e as t,c as o,h as v,w as h,t as r,L as te,f as P,i as C,F as le,s as ae,v as O,x as se,y as _,z as oe,B as ne}from"./index-1ce1066d.js";import{l as re,C as ie}from"./localizedFormat-f373620e.js";import"./es-20e87183.js";import{u as de}from"./selectes-83896420.js";import{H as ue}from"./HomeOutlined-4fb2ca39.js";import{T as ce}from"./TeamOutlined-f7bf8c7f.js";import{E as ve}from"./EnvironmentOutlined-da571554.js";import{U as pe}from"./UserOutlined-9c716473.js";const me={class:"container-events"},fe={class:"filter-calendar-25"},ye={class:"filter-calendar-25-opts"},_e={class:"filter-calendar-check"},he={class:"schedule"},ge={class:"schedule-header"},ke={class:"schedule-date"},be={key:0,class:"event-time"},Ce={key:1,class:"event-time"},Me={class:"event-hour-2"},Ee={class:"title"},De={class:"event-description"},Ue=["onClick"],we={class:"modal-calendar-detail"},xe={style:{"line-height":"1.3","margin-bottom":".5rem","margin-top":"0"}},Oe=["innerHTML"],Ae={key:0},Se={style:{"margin-left":".5rem"}},Le={key:1},Re={style:{"margin-left":".5rem"}},Te={key:2},Ge={style:{"margin-left":".5rem"}},Ne={style:{"margin-left":".5rem"}},ze={key:0},Ye={style:{"margin-left":".5rem"}},Fe={key:3},Ve={style:{"margin-left":".5rem"}},Ie={key:4},Pe=["href"],Be={key:5},He=["innerHTML"],$e={class:"filter-modal"},je={style:{display:"flex","flex-direction":"column"}},at={__name:"EventosGoogleCalendar",setup(qe){f.locale("es"),f.extend(W),f.extend(re);const g=de();g.$patch({cities:g.cities}),g.fetchCities();const p=X({value1:["UGO","UGSE"]}),m=i(null),B=Z(te,{style:{fontSize:"24px"},spin:!0}),M=i(!1),k=i(null);i(!1);const s=i(null),E=i(!1),A=i(!1),S=i(null),L=i(null),R=i(new Date),D=i([]),T=i(null),b=i([]),U=i(!1),H=l=>{s.value=l,E.value=!0},G=[{label:"UGO",value:"UGO"},{label:"UGSE",value:"UGSE"}],N=(l,e)=>{const n=l.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(n)},$=l=>{if(Array.isArray(l)&&l.length>0&&l[0].id){const e=l[0].id;S.value=e,T.value!==e&&(T.value=e,console.log("onPageChange",l),Y(e))}else console.warn("⚠️ No se pudo detectar el cambio de mes.")},w=l=>({1:"#808080",red:"#f06464",3:"#fd9d0f",4:"#ffb74d",5:"#00b522",blue:"#1546b0",7:"#9c27b0",8:"#ff07d8"})[l],j=l=>({1:"Despega tu empresa",2:"Ferias",3:"Fortalece tu Mercado",4:"Mujer Produce",5:"Potencia tu Empresa",6:"Ruta Digital",7:"Otros UGSE",8:"Difusión UGO"})[l],q=l=>{if(!Array.isArray(l)||l.length===0)return"";const e=f(l[0]).locale("es").format("DD [de] MMMM"),n=l.length>1?f(l[l.length-1]).locale("es").format("DD [de] MMMM"):null;return n?`Desde: ${e} Hasta: ${n}`:`${e}`},z=async()=>{M.value=!0,await Y(S.value),await x()},x=async l=>{l&&(k.value=l.id),U.value=!0;const e={},n=f().format("YYYY-MM-DD");p.value1&&(e.office=p.value1),m.value&&(e.city_id=m.value),k.value?e.dateSelected=k.value:e.dateSelected=l?l.id:n,L.value=k.value?f(k.value).format("dddd D [de] MMMM [de] YYYY"):f(n).format("dddd D [de] MMMM [de] YYYY");try{b.value=[];const c=await P({url:"pnte/events-day",method:"GET",params:e});c.data&&Array.isArray(c.data)?b.value=c.data:console.warn("⚠️ Respuesta inesperada de la API:",c)}catch(c){console.error("❌ Error al obtener eventos:",c)}finally{U.value=!1,M.value=!1}},Y=async l=>{const e={};m.value&&(e.city_id=m.value),p.value1&&(e.office=p.value1),l&&(e.year_month=l);try{const n=await P({url:"pnte/dots",method:"GET",params:e});D.value=[],n&&Array.isArray(n)?D.value=[{key:"today",highlight:"",dates:[new Date]},...n]:console.warn("⚠️ Respuesta de API inesperada:",n)}catch(n){console.error("❌ Error al obtener eventos:",n)}};return ee(async()=>{await x()}),(l,e)=>{const n=y("VCalendar"),c=y("a-checkbox-group"),F=y("a-select"),V=y("a-button"),J=y("a-empty"),K=y("a-spin"),I=y("a-modal");return d(),u("section",me,[e[19]||(e[19]=t("h1",{class:"title-pc"},"CALENDARIO 2025",-1)),t("div",null,[o(n,{ref:"calendar",modelValue:R.value,"onUpdate:modelValue":e[0]||(e[0]=a=>R.value=a),attributes:D.value,expanded:"",locale:"es",transparent:"",borderless:"","onUpdate:pages":$,onDayclick:x},null,8,["modelValue","attributes"]),t("div",fe,[t("div",null,[e[8]||(e[8]=t("h4",{style:{display:"block"}},"FILTRAR POR",-1)),t("div",ye,[t("div",_e,[o(c,{value:p.value1,"onUpdate:value":e[1]||(e[1]=a=>p.value1=a),name:"checkboxgroup",options:G},null,8,["value"])]),o(F,{style:{width:"100%"},value:m.value,"onUpdate:value":e[2]||(e[2]=a=>m.value=a),options:v(g).cities,"show-search":"","filter-option":N,placeholder:"SELECCIONAR REGIÓN"},null,8,["value","options"]),o(V,{class:"btn-modal-filter",type:"primary",onClick:z,loading:M.value},{default:h(()=>e[7]||(e[7]=[C("BUSCAR")])),_:1},8,["loading"])])])])]),t("div",he,[t("div",ge,[e[9]||(e[9]=t("h4",null,"EVENTOS",-1)),t("span",ke,r(L.value),1)]),o(K,{indicator:v(B),spinning:U.value},{default:h(()=>[b.value.length>0?(d(!0),u(le,{key:0},ae(b.value,(a,Q)=>(d(),u("div",{key:Q,class:"event"},[a.start?(d(),u("div",Ce,[t("div",null,r(a.start),1),e[11]||(e[11]=t("br",null,null,-1)),t("div",Me,r(a.end),1)])):(d(),u("div",be,e[10]||(e[10]=[t("div",{style:{"text-align":"center","line-height":"1.2"}},"Todo el día",-1)]))),t("div",{class:"schedule-details",style:O({"border-color":w(a.dot)})},[t("small",{class:"schedule-tag",style:O({"background-color":w(a.dot)})},r(a.id_pnte),5),t("div",Ee,r(a.title),1),t("div",De,[C(r(a.descriptionparse)+" ",1),t("span",{onClick:Je=>H(a),style:{color:"#2196f3",cursor:"pointer"}},"Ver más",8,Ue)])],4)]))),128)):(d(),se(J,{key:1,class:"no-events"},{description:h(()=>e[12]||(e[12]=[t("span",{class:"no-events-span"},"No hay eventos para este día",-1)])),_:1}))]),_:1},8,["indicator","spinning"])]),o(I,{open:E.value,"onUpdate:open":e[3]||(e[3]=a=>E.value=a),title:"",footer:""},{default:h(()=>[t("div",we,[t("div",null,[t("h3",xe,r(s.value.titleComplete),1),t("small",{class:"modal-calendar-tag",style:O({"background-color":w(s.value.id_pnte)})},r(j(s.value.id_pnte)),5)]),t("div",{style:{"margin-bottom":"1rem",color:"#6c6c6c"},class:"html-format",innerHTML:s.value.descripionAll},null,8,Oe),s.value.organiza?(d(),u("div",Ae,[o(v(ue)),t("span",Se,r(s.value.organiza),1)])):_("",!0),s.value.region?(d(),u("div",Le,[o(v(ve)),t("span",Re,r(s.value.region),1)])):_("",!0),s.value.numMypes?(d(),u("div",Te,[t("span",null,[o(v(ce))]),t("span",Ge,r(s.value.numMypes),1)])):_("",!0),t("div",null,[t("div",null,[o(v(oe)),t("span",Ne,r(q(s.value.dates)),1)]),s.value.start?(d(),u("div",ze,[o(v(ne)),t("span",Ye,r(s.value.start),1),e[13]||(e[13]=C(" - ")),t("span",null,r(s.value.end),1)])):_("",!0)]),s.value.nameUser?(d(),u("div",Fe,[o(v(pe)),t("span",Ve,[C(r(s.value.nameUser)+" ",1),e[14]||(e[14]=t("small",null,"(Representante)",-1))])])):_("",!0),s.value.link?(d(),u("div",Ie,[o(v(ie)),t("a",{style:{"margin-left":".5rem"},href:s.value.link,target:"_blank",rel:"noopener noreferrer"},"Link del evento",8,Pe)])):_("",!0),s.value.resultado?(d(),u("div",Be,[e[15]||(e[15]=t("h3",null,"Resultados",-1)),t("div",{style:{color:"#6c6c6c"},class:"html-format",innerHTML:s.value.resultado},null,8,He)])):_("",!0)])]),_:1},8,["open"]),o(I,{open:A.value,"onUpdate:open":e[6]||(e[6]=a=>A.value=a),title:"",footer:"",width:"350px"},{default:h(()=>[t("div",$e,[e[18]||(e[18]=t("h3",null,"FILTRAR POR:",-1)),o(c,{value:p.value1,"onUpdate:value":e[4]||(e[4]=a=>p.value1=a),name:"checkboxgroup",options:G},null,8,["value"]),t("div",je,[e[16]||(e[16]=t("label",{style:{margin:"10px 0 6px 0","font-size":"13px"}},"REGIÓN",-1)),o(F,{allowClear:!0,value:m.value,"onUpdate:value":e[5]||(e[5]=a=>m.value=a),options:v(g).cities,"show-search":"","filter-option":N},null,8,["value","options"])]),t("pre",null,r(p.value1),1),o(V,{class:"btn-modal-filter",type:"primary",onClick:z},{default:h(()=>e[17]||(e[17]=[t("b",{style:{"font-weight":"500"}},"BUSCAR",-1)])),_:1})])]),_:1},8,["open"])])}}};export{at as default};
