import{c as n,A as me,L as F,r as h,a as ve,b as _,o as l,q as $,w as p,e as w,d as g,F as z,x as _e,h as C,s as b,M as Ce,i as N,z as Q,m as L,k as fe,K as $e,a1 as Qe,a2 as Ue,t as k,a3 as Oe,g as Me,P as Ne,a4 as Xe,H as ie,I as Ze,v as We,a5 as Ee,n as se,a6 as xe,U as Ke,J as et,p as tt,j as at}from"./index-3cc1e668.js";import{_ as nt}from"./icoexcel-1b303edf.js";import{u as Re}from"./selectes-19985054.js";import"./es-1caad6bf.js";import{_ as Te}from"./_plugin-vue_export-helper-c27b6911.js";import{M as ot}from"./MoreOutlined-546eda03.js";var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};const it=st;function Ie(m){for(var d=1;d<arguments.length;d++){var s=arguments[d]!=null?Object(arguments[d]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(y){return Object.getOwnPropertyDescriptor(s,y).enumerable}))),i.forEach(function(y){lt(m,y,s[y])})}return m}function lt(m,d,s){return d in m?Object.defineProperty(m,d,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[d]=s,m}var ge=function(d,s){var i=Ie({},d,s.attrs);return n(me,Ie({},i,{icon:it}),null)};ge.displayName="CloudUploadOutlined";ge.inheritAttrs=!1;const rt=ge;var dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};const ct=dt;function Se(m){for(var d=1;d<arguments.length;d++){var s=arguments[d]!=null?Object(arguments[d]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(y){return Object.getOwnPropertyDescriptor(s,y).enumerable}))),i.forEach(function(y){ut(m,y,s[y])})}return m}function ut(m,d,s){return d in m?Object.defineProperty(m,d,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[d]=s,m}var he=function(d,s){var i=Se({},d,s.attrs);return n(me,Se({},i,{icon:ct}),null)};he.displayName="MessageOutlined";he.inheritAttrs=!1;const pt=he;var mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};const vt=mt;function ke(m){for(var d=1;d<arguments.length;d++){var s=arguments[d]!=null?Object(arguments[d]):{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(y){return Object.getOwnPropertyDescriptor(s,y).enumerable}))),i.forEach(function(y){_t(m,y,s[y])})}return m}function _t(m,d,s){return d in m?Object.defineProperty(m,d,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[d]=s,m}var ye=function(d,s){var i=ke({},d,s.attrs);return n(me,ke({},i,{icon:vt}),null)};ye.displayName="SaveOutlined";ye.inheritAttrs=!1;const ft=ye,gt={city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!0},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},denomination:{type:"iText",label:"Denominación",name:"denomination",required:!0,message:"Escribir la denominación",disabled:!0},alliedEntity:{type:"iText",label:"Entidad Aliada",name:"alliedEntity",required:!0,message:"Escribir la entidad aliada",disabled:!0},homeOperations:{type:"iDate",label:"Inicio de Operaciones",name:"homeOperations",required:!0,message:"Escribir el incio de las operaciones",disabled:!0},address:{type:"iText",label:"Dirección",name:"address",required:!0,message:"Escribir la dirección",disabled:!0},reference:{type:"iText",label:"Referencia",name:"reference",required:!0,message:"Escribir la referencia",disabled:!0},resolution:{type:"iText",label:"Resolución de Autorización de CDE",name:"resolution",required:!0,message:"Escribir la referencia",disabled:!0},startDate:{type:"iDate",label:"Inicio Convenio Vigente",name:"startDate",required:!0,message:"Seleccionar fecha de convenio vigente",disabled:!0},endDate:{type:"iDate",label:"Fin del convenio",name:"endDate",required:!0,message:"Seleccionar fecha fin de convenio",disabled:!0},initials:{type:"iCheckbox",label:"Entidades",name:"initials",required:!0,message:"Escribir la referencia",disabled:!0}};const ht={class:"grid-convenios"},Ae="DD/MM/YYYY",yt={__name:"DrawConvenio",emits:["closeDraw"],setup(m,{emit:d}){F.locale("es");const s=JSON.parse(localStorage.getItem("profile")),i=Re(),y=d;i.$patch({cities:i.cities}),i.$patch({provinces:i.provinces}),i.$patch({districts:i.districts}),i.$patch({agreementStatus:i.agreementStatus}),i.$patch({operationalStatus:i.operationalStatus}),i.fetchCities(),i.fetchAgreementStatus(),i.fetchOperationalStatus();const U=h(!1),R=h(!1),A=["UGO  - TU EMPRESA","TU EMPRESA - DVMYPE","DVMYPE-SG","SG-OGPPM","OGPPM-TU EMPRESA","TU EMPRESA-ALIADO"],e=ve({}),M=E=>{const r=F(e.startDate).add(1,"day").startOf("day");return F(E).startOf("day").isBefore(r,"day")},q=E=>{e.province_id=null,e.district_id=null,i.fetchProvinces(E)},V=E=>{e.district_id=null,i.fetchDistricts(E)},Y=(E,r)=>{const t=E.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)},B=()=>{e.denomination=null,e.alliedEntity=null,e.homeOperations=null,e.address=null,e.reference=null,e.resolution=null,e.initials=null,e.startDate=null,e.endDate=null,e.city_id=null,e.province_id=null,e.district_id=null,e.operationalstatus_id=null,e.agreementstatus_id=null,e.created_id=s.user_id},j=async()=>{U.value=!0;const E={denomination:e.denomination,alliedEntity:e.alliedEntity,homeOperations:F(e.homeOperations).format("YYYY-MM-DD"),address:e.address,reference:e.reference,resolution:e.resolution,initials:e.initials,startDate:F(e.startDate).format("YYYY-MM-DD"),endDate:F(e.endDate).format("YYYY-MM-DD"),city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,operationalstatus_id:e.operationalstatus_id,agreementstatus_id:e.agreementstatus_id,created_id:s.user_id};try{const r=await Q({url:"agreement/create",method:"POST",data:E});r.status==200&&(L.success(r.message),y("closeDraw",!0),B())}catch(r){L.error("Se originó un error: "+r.message)}finally{U.value=!1}},T=()=>{L.error("Debes de completar todos los espacios requeridos")};return(E,r)=>{const t=_("a-input"),c=_("a-form-item"),D=_("a-select"),x=_("a-date-picker"),X=_("a-checkbox-group"),Z=_("a-button"),S=_("a-form"),W=_("a-spin");return l(),$(W,{spinning:R.value},{default:p(()=>[n(S,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:j,onFinishFailed:T},{default:p(()=>[w("div",ht,[(l(!0),g(z,null,_e(C(gt),(a,le)=>(l(),g(z,{key:le},[a.type==="iText"?(l(),$(c,{key:0,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,max:a.max}]},{default:p(()=>[n(t,{value:e[a.name],"onUpdate:value":O=>e[a.name]=O,maxlength:a.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):b("",!0),a.type==="iSelect"?(l(),$(c,{key:1,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[a.name=="city_id"?(l(),$(D,{key:0,value:e[a.name],"onUpdate:value":O=>e[a.name]=O,options:C(i).cities,"show-search":"","filter-option":Y,onChange:q},null,8,["value","onUpdate:value","options"])):b("",!0),a.name=="province_id"?(l(),$(D,{key:1,value:e[a.name],"onUpdate:value":O=>e[a.name]=O,options:C(i).provinces,"show-search":"","filter-option":Y,onChange:V,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):b("",!0),a.name=="district_id"?(l(),$(D,{key:2,value:e[a.name],"onUpdate:value":O=>e[a.name]=O,options:C(i).districts,"show-search":"","filter-option":Y,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):b("",!0),a.name=="operationalstatus_id"?(l(),$(D,{key:3,value:e[a.name],"onUpdate:value":O=>e[a.name]=O,options:C(i).operationalStatus,"show-search":"","filter-option":Y},null,8,["value","onUpdate:value","options"])):b("",!0),a.name=="agreementstatus_id"?(l(),$(D,{key:4,value:e[a.name],"onUpdate:value":O=>e[a.name]=O,options:C(i).agreementStatus,"show-search":"","filter-option":Y},null,8,["value","onUpdate:value","options"])):b("",!0)]),_:2},1032,["name","label","rules"])):b("",!0),a.type==="iDate"?(l(),$(c,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[a.name=="endDate"?(l(),$(x,{key:0,"disabled-date":M,locale:C(Ce),disabled:!e.startDate,value:e[a.name],"onUpdate:value":O=>e[a.name]=O,style:{width:"100%"},format:Ae,placeholder:"día/mes/año"},null,8,["locale","disabled","value","onUpdate:value"])):(l(),$(x,{key:1,locale:C(Ce),value:e[a.name],"onUpdate:value":O=>e[a.name]=O,style:{width:"100%"},format:Ae,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"]))]),_:2},1032,["name","label","rules"])):b("",!0),a.type==="iCheckbox"?(l(),$(c,{key:3,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[n(X,{value:e[a.name],"onUpdate:value":O=>e[a.name]=O,name:"checkboxgroup",options:A,style:{display:"grid","grid-gap":".2rem"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):b("",!0)],64))),128))]),n(c,null,{default:p(()=>[n(Z,{type:"primary","html-type":"submit",loading:U.value},{default:p(()=>[N("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},bt=Te(yt,[["__scopeId","data-v-a5681a47"]]);const Dt={class:"accion-icons"},wt={key:0},Ct={key:1},Ot={__name:"DrawAcciones",props:["idConvenio"],emits:["refreshTable"],setup(m,{emit:d}){const s=m,i=d,y=h([]),U=h(!0),R=h(null),A=h(""),e=h(!1);h(null);const M=ve({description:null});fe(()=>{s.idConvenio&&T(s.idConvenio)}),$e(()=>s.idConvenio,r=>{r&&T()});function q(r){R.value=r.id,A.value=r.description,Oe(()=>{E()})}function V(r){const t=y.value.findIndex(c=>c.id===r.id);t!==-1&&(y.value[t].description=A.value),R.value=null,B(r.id)}const Y=async r=>{try{const t=await Q({url:`agreement/delete-acction/${r.id}`,method:"DELETE"});t.status==200&&(T(),L.success(t.message),i("refreshTable",!0))}catch(t){console.error("Error de red:",t)}},B=async r=>{try{const t={description:A.value},c=await Q({url:`agreement/update/${r}`,method:"PUT",data:t});c.status==200&&(L.success(c.message),T())}catch(t){console.error("Error de red:",t)}},j=async()=>{try{const r={description:M.description,agreements_id:s.idConvenio},t=await Q({url:"agreement/create-acction",method:"POST",data:r});t.status==200&&(L.success(t.message),i("refreshTable",!0),T(),M.description=null)}catch(r){console.error("Error de red:",r)}},T=async()=>{U.value=!0;try{const r=await Q({url:`agreement/list/${s.idConvenio}`,method:"GET"});r.status==200&&(y.value=r.data)}catch{}finally{U.value=!1}},E=()=>{Oe(()=>{const r=document.getElementById("auto-resize");r.style.height="auto",r.style.height=r.scrollHeight+"px"})};return(r,t)=>{const c=_("a-textarea"),D=_("a-spin"),x=_("a-form-item"),X=_("a-button"),Z=_("a-form");return l(),g("div",null,[n(D,{spinning:U.value},{default:p(()=>[(l(!0),g(z,null,_e(y.value,(S,W)=>(l(),g("div",{class:"acciones",key:W},[w("div",Dt,[n(C(Qe),{class:"pointer ico-acc",onClick:a=>q(S)},null,8,["onClick"]),R.value===S.id?(l(),$(C(ft),{key:0,class:"pointer ico-save",onClick:a=>V(S)},null,8,["onClick"])):b("",!0),n(C(Ue),{class:"pointer ico-acc",onClick:a=>Y(S)},null,8,["onClick"])]),R.value===S.id?(l(),g("div",wt,[n(c,{value:A.value,"onUpdate:value":t[0]||(t[0]=a=>A.value=a),onInput:E,id:"auto-resize"},null,8,["value"])])):(l(),g("p",Ct,k(S.description),1))]))),128))]),_:1},8,["spinning"]),n(Z,{layout:"vertical",model:M,name:"basic",autocomplete:"off",onFinish:j},{default:p(()=>[n(x,{name:"description",label:"Registra una acción",rules:[{required:!0,message:"Escribir la descripción"}]},{default:p(()=>[n(c,{value:M.description,"onUpdate:value":t[1]||(t[1]=S=>M.description=S),maxlength:250,rows:4},null,8,["value"])]),_:1}),n(x,null,{default:p(()=>[n(X,{type:"primary","html-type":"submit",loading:e.value},{default:p(()=>[N("CREAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const Et=w("div",{class:"agreements-file"},[w("b",null,"Formatos a subir"),w("span",null,"pdf, doc, docx, xls, xlsx, ppt, pptx"),w("span",null,"*(Máximo 20MB)")],-1),xt={class:"file-options"},It={style:{"line-height":"1.3"}},St=["onClick"],kt=["onClick"],At={__name:"DrawFiles",props:["idConvenio"],setup(m){F.locale("es");const d=Me.get("token"),s=m,i="https://apituempresa.soporte-pnte.com/api/",y="http://127.0.0.1:8000/api/",U=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?y:i,R=h(!1),A=h([]),e=h(null),M=h(null),q=Ne(Xe,{style:{fontSize:"20px"},spin:!0});fe(()=>{s.idConvenio&&r(s.idConvenio)}),$e(()=>s.idConvenio,t=>{t&&r(t)});const V=t=>F(t).format("DD-MM-YYYY HH:mm"),Y=t=>(B(t),!1),B=async t=>{const c=new FormData;c.append("file",t),c.append("agreements_id",s.idConvenio),R.value=!0;try{const{data:D}=await ie.post(`${U}agreement/file`,c,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${d}`}});D.status==200&&(L.success(D.message),r(s.idConvenio))}catch{L.error("Error al subir este tipo de archivo")}finally{R.value=!1}},j=async t=>{e.value=t.uid;try{const c=await ie({url:`${U}agreement/file-download/${t.uid}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${d}`}}),D=window.URL.createObjectURL(new Blob([c.data])),x=document.createElement("a");x.href=D,x.setAttribute("download",t.name),document.body.appendChild(x),x.click(),window.URL.revokeObjectURL(D),document.body.removeChild(x)}catch(c){console.error("Error downloading file:",c)}finally{e.value=null}},T=t=>{t.file.status!=="uploading"&&console.log(t.file,t.fileList),t.file.status==="done"?(L.success(`${t.file.name} file uploaded successfully`),A.value=t.fileList.filter(c=>c.status!=="error")):t.file.status==="error"&&(L.error(`${t.file.name} file upload failed.`),A.value=t.fileList.filter(c=>c.uid!==t.file.uid))},E=async t=>{M.value=t.uid;try{const c=await Q({url:`agreement/delete/file/${t.uid}`,method:"DELETE"});c.status==200&&(r(s.idConvenio),L.success(c.message))}catch(c){console.error("Error de red:",c)}finally{M.value=null}},r=async t=>{try{const{data:c}=await ie.get(`${U}agreement/list-files/${t}`,{headers:{Authorization:`Bearer ${d}`}});c.status===200&&(A.value=c.data.map(D=>({uid:D.id,name:D.name,status:"done",url:D.path,date:D.created_at})))}catch(c){console.error("Error fetching files:",c)}};return(t,c)=>{const D=_("a-button"),x=_("a-spin"),X=_("a-space"),Z=_("a-upload");return l(),g("div",null,[Et,n(Z,{"file-list":A.value,name:"file",onChange:T,"custom-request":B,"before-upload":Y},{itemRender:p(({file:S,actions:W})=>[n(X,{style:{margin:"0rem 0","font-size":"13px",width:"100%"}},{default:p(()=>[w("div",xt,[w("span",It,k(S.name),1),w("span",null,k(V(S.date)),1),e.value!=S.uid?(l(),g("a",{key:0,onClick:a=>j(S)},"Descargar",8,St)):(l(),$(x,{key:1,indicator:C(q)},null,8,["indicator"])),M.value==S.uid?(l(),$(x,{key:2,indicator:C(q)},null,8,["indicator"])):(l(),g("a",{key:3,onClick:a=>E(S),style:{color:"var(--error)"}},[n(C(Ue))],8,kt))])]),_:2},1024)]),default:p(()=>[n(D,{style:{"margin-bottom":".6rem"},loading:R.value},{default:p(()=>[n(C(rt)),N(" SUBIR ARCHIVO ")]),_:1},8,["loading"])]),_:1},8,["file-list"])])}}};const te=m=>(tt("data-v-672153f4"),m=m(),at(),m),$t=te(()=>w("h3",{class:"title-produce"},"ESTADO DE CONVENIOS",-1)),Ut=te(()=>w("img",{width:"20",style:{margin:"-2px 0 0 0"},src:nt},null,-1)),Mt={key:0,class:"table-head"},Nt=te(()=>w("span",null,"REGIÓN",-1)),Rt={class:"t-icons"},Tt={key:1,class:"table-head"},zt=te(()=>w("span",null,"DENOMINACIÓN",-1)),Pt={class:"t-icons"},Lt={key:8,style:{"line-height":"1.2",margin:"0","font-size":"12px"}},Yt={key:0,class:"list-days"},qt={key:1,class:"list-days"},Vt={key:11,class:"accion-total"},Ft={class:"accion-numb"},Bt=["onClick"],jt=te(()=>w("a",null,"Eliminar",-1)),Ht={class:"paginator"},Gt={__name:"ConvenioEstado",props:["idConvenio"],setup(m){F.locale("es"),JSON.parse(localStorage.getItem("profile")),Re();const d=Me.get("token"),s="https://apituempresa.soporte-pnte.com/api/",i="http://127.0.0.1:8000/api/",y=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?i:s,U=h(null),R=h(null),A=h(!1),e=h(null),M=h(0),q=h(50),V=h({page:0}),Y=h(1200),B=h([]),j=h(!1),T=h(!1),E=h(!1),r=h(!1),t=h(null);h(null);const c=h(window.innerHeight-100),D=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"REGIÓN",fixed:"left",dataIndex:"region",width:120},{title:"PROVINCIA",fixed:"left",dataIndex:"provincia",width:120},{title:"DISTRITO",fixed:"left",dataIndex:"district",width:140},{title:"DENOMINACIÓN",dataIndex:"denomination",fixed:"left",width:150},{title:"ENTIDAD ALIADA",dataIndex:"alliedEntity",width:170},{title:"INICIO DE OPERACIONES",dataIndex:"inicioperaciones",align:"center",width:120},{title:"DIRECCIÓN",dataIndex:"address",width:180},{title:"REFERENCIA",dataIndex:"reference",width:220},{title:"ASESORES EMPRESARIALES ASIGNADOS",dataIndex:"districtxx",align:"center",width:125},{title:"RESOLUCIÓN DE AUTORIZACIÓN PARA CONDICIÓN DE CDE",dataIndex:"resolution",align:"center",width:150},{title:"ESTADO DE OPERATIVIDAD",dataIndex:"operatividad",align:"center",width:120},{title:"ESTADO DEL CONVENIO",dataIndex:"convenio",align:"center",width:120},{title:"ENTIDADES",dataIndex:"entidades",align:"center",width:170},{title:"INICIO CONVENIO VIGENTE",dataIndex:"startDate",align:"center",width:120},{title:"NUM. AÑOS DEL CONVENIO",dataIndex:"numbyears",align:"center",width:110},{title:"FIN DEL CONVENIO",dataIndex:"endDate",align:"center",width:120},{title:"DÍAS",dataIndex:"numbrestantes",align:"center",width:70},{title:"ACCIONES",dataIndex:"acciones",align:"center",width:100},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],x=ve({search:""}),X=()=>{let u={search:x.search};H(u)},Z=()=>{x.search||H()},S=u=>({0:"red",1:"orange",2:"green",3:"purple",4:"blue",5:"pink"})[u],W=u=>{U.value=u,H({order:u})},a=u=>{R.value=u,H({date_diff_order:u})},le=u=>{e.value=u.id,E.value=!0},O=u=>F(u).format("DD/MM/YYYY"),ze=(u,o)=>{const I=new Date(o),P=new Date(u);let J=P.getFullYear()-I.getFullYear(),G=P.getMonth()-I.getMonth(),K=P.getDate()-I.getDate();if(G<0&&(J--,G+=12),K<0){const ue=new Date(P.getFullYear(),P.getMonth(),0).getDate();K+=ue,G--}const ce=J>0?`${J} año${J>1?"s":""}`:"",ae=G>0?`${G} mes${G>1?"es":""}`:"",ne=K>0?`${K} día${K>1?"s":""}`:"";return[ce,ae,ne].filter(Boolean).join(" con ")},Pe=u=>{e.value=u.id,r.value=!0},ee=(u,o)=>{const I=new Date(u),P=new Date,J=I.getTime()-P.getTime();return Math.floor(J/(1e3*3600*24))+1},Le=u=>u<=0||u<20?"red":u<40?"#f9e717":"#11d811",Ye=u=>{V.value.page=u,H()},re=()=>{c.value=window.innerHeight-320},qe=()=>{t.value=null,T.value=!0},de=u=>{H(),u==1&&(T.value=!1),u==2&&(E.value=!1)},Ve=async u=>{try{const o=await Q({url:`agreement/delete/${u.id}`,method:"DELETE"});o.status==200&&(H(),L.success(o.message))}catch(o){console.error("Error de red:",o)}},Fe=Ze(()=>u=>V.value.page*q.value+u+1),H=async u=>{try{j.value=!0;let o;o=V.value.page==0?"":V.value,o=u?{...o,...u}:o;const{data:I}=await Q({url:"agreement/list",method:"GET",params:o});B.value=I.data,M.value=I.total,q.value=I.per_page}catch(o){console.error("Error de red:",o)}finally{j.value=!1}},Be=async()=>{A.value=!0;try{const u=await ie({url:`${y}agreement/download`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${d}`}}),o=window.URL.createObjectURL(new Blob([u.data])),I=document.createElement("a"),P="convenios.xlsx";I.href=o,I.setAttribute("download",P),document.body.appendChild(I),I.click(),window.URL.revokeObjectURL(o),document.body.removeChild(I)}catch(u){console.error("Error downloading file:",u)}finally{A.value=!1}};return We(()=>{window.removeEventListener("resize",re)}),fe(()=>{window.addEventListener("resize",re),re(),H()}),(u,o)=>{const I=_("a-button"),P=_("a-col"),J=_("a-input"),G=_("a-input-group"),K=_("a-row"),ce=_("a-progress"),ae=_("a-tag"),ne=_("a-menu-item"),be=_("a-popconfirm"),ue=_("a-menu"),je=_("a-dropdown"),He=_("a-table"),Ge=_("a-pagination"),pe=_("a-drawer");return l(),g(z,null,[w("div",null,[$t,n(K,{style:{margin:"1rem 0"}},{default:p(()=>[n(P,{xs:24,md:12,lg:18},{default:p(()=>[n(I,{type:"primary",onClick:qe,style:{"margin-right":".5rem"}},{default:p(()=>[N("NUEVO")]),_:1}),n(I,{class:"btn-excel",onClick:Be,loading:A.value,type:"primary"},{default:p(()=>[Ut]),_:1},8,["loading"])]),_:1}),n(P,{xs:24,md:12,lg:6},{default:p(()=>[n(G,{compact:""},{default:p(()=>[n(J,{value:x.search,"onUpdate:value":o[0]||(o[0]=f=>x.search=f),style:{width:"calc(100% - 80px)"},onInput:Z},null,8,["value"]),n(I,{type:"primary",disabled:x.search==="",onClick:X},{default:p(()=>[N("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(He,{bordered:"",scroll:{x:Y.value,y:c.value},class:"table-agreements",columns:D,"data-source":B.value,pagination:!1,loading:j.value,size:"small"},{headerCell:p(({column:f})=>[f.dataIndex=="region"?(l(),g("div",Mt,[Nt,w("div",Rt,[n(C(Ee),{class:se([{arrActive:U.value=="asc"},"ii"]),onClick:o[1]||(o[1]=v=>W("asc"))},null,8,["class"]),n(C(xe),{class:se([{arrActive:U.value=="desc"},"ii"]),onClick:o[2]||(o[2]=v=>W("desc"))},null,8,["class"])])])):b("",!0),f.dataIndex=="denomination"?(l(),g("div",Tt,[zt,w("div",Pt,[n(C(Ee),{class:se([{arrActive:R.value=="asc"},"ii"]),onClick:o[3]||(o[3]=v=>a("asc"))},null,8,["class"]),n(C(xe),{class:se([{arrActive:R.value=="desc"},"ii"]),onClick:o[4]||(o[4]=v=>a("desc"))},null,8,["class"])])])):b("",!0)]),bodyCell:p(({column:f,record:v,index:Je})=>{var De;return[f.dataIndex=="idx"?(l(),g(z,{key:0},[N(k(Fe.value(Je)),1)],64)):b("",!0),f.dataIndex=="region"?(l(),g(z,{key:1},[N(k(v.region.name),1)],64)):b("",!0),f.dataIndex=="provincia"?(l(),g(z,{key:2},[N(k(v.provincia.name),1)],64)):b("",!0),f.dataIndex=="district"?(l(),g(z,{key:3},[N(k((De=v.distrito)==null?void 0:De.name),1)],64)):b("",!0),f.dataIndex=="denomination"?(l(),g(z,{key:4},[N(k(v.denomination)+" ",1),n(ce,{style:{margin:"0"},percent:ee(v.endDate,v.startDate),size:4,showInfo:!1,strokeColor:Le(ee(v.endDate,v.startDate))},null,8,["percent","strokeColor"])],64)):b("",!0),f.dataIndex=="inicioperaciones"?(l(),g(z,{key:5},[N(k(O(v==null?void 0:v.homeOperations)),1)],64)):b("",!0),f.dataIndex=="entidades"?(l(!0),g(z,{key:6},_e(v.initials,(oe,we)=>(l(),g("div",{key:we},[n(ae,{color:S(we),style:{margin:".2rem 0"}},{default:p(()=>[N(k(oe),1)]),_:2},1032,["color"])]))),128)):b("",!0),f.dataIndex=="startDate"?(l(),g(z,{key:7},[N(k(O(v==null?void 0:v.startDate)),1)],64)):b("",!0),f.dataIndex=="numbyears"?(l(),g("p",Lt,k(ze(v.endDate,v.startDate)),1)):b("",!0),f.dataIndex=="endDate"?(l(),g(z,{key:9},[N(k(O(v==null?void 0:v.endDate)),1)],64)):b("",!0),f.dataIndex=="numbrestantes"?(l(),g(z,{key:10},[ee(v.endDate,v.startDate)>=1?(l(),g("p",Yt,k(ee(v.endDate,v.startDate))+" días faltantes",1)):(l(),g("p",qt,k(ee(v.endDate,v.startDate))+" días vencidos",1))],64)):b("",!0),f.dataIndex=="acciones"?(l(),g("div",Vt,[n(C(pt),{class:"ico-acciones",onClick:oe=>le(v)},null,8,["onClick"]),w("span",Ft,k(v.acciones.length)+" MENSAJES",1)])):b("",!0),f.dataIndex=="actions"?(l(),$(je,{key:12,trigger:["click"]},{overlay:p(()=>[n(ue,null,{default:p(()=>[n(ne,null,{default:p(()=>[w("a",{onClick:oe=>Pe(v)},"Archivos",8,Bt)]),_:2},1024),n(ne,null,{default:p(()=>[n(be,{title:"¿Seguro de eliminar?",onConfirm:oe=>Ve(v)},{icon:p(()=>[n(C(Ke),{style:{color:"red"}})]),default:p(()=>[jt]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:p(()=>[w("a",{class:"ant-dropdown-link",onClick:o[5]||(o[5]=et(()=>{},["prevent"]))},[n(I,{shape:"circle",icon:Ne(C(ot)),size:"small"},null,8,["icon"])])]),_:2},1024)):b("",!0)]}),_:1},8,["scroll","data-source","loading"])]),w("div",Ht,[w("span",null,[n(ae,{color:"blue"},{default:p(()=>[w("b",null,k(M.value),1)]),_:1}),N("Convenios")]),n(Ge,{size:"small",total:M.value,pageSize:q.value,onChange:Ye,showSizeChanger:!1},null,8,["total","pageSize"])]),n(pe,{open:T.value,"onUpdate:open":o[7]||(o[7]=f=>T.value=f),class:"draw-notary","root-class-name":"root-class-name",title:"Convenios",placement:"right",width:"650"},{default:p(()=>[n(bt,{onCloseDraw:o[6]||(o[6]=f=>de(1))})]),_:1},8,["open"]),n(pe,{open:E.value,"onUpdate:open":o[10]||(o[10]=f=>E.value=f),title:"Acciones",placement:"right",width:"550"},{default:p(()=>[n(Ot,{idConvenio:e.value,onCloseDraw:o[8]||(o[8]=f=>de(2)),onRefreshTable:o[9]||(o[9]=f=>H())},null,8,["idConvenio"])]),_:1},8,["open"]),n(pe,{open:r.value,"onUpdate:open":o[12]||(o[12]=f=>r.value=f),title:"Cargar Archivos",placement:"right",width:"550"},{default:p(()=>[n(At,{idConvenio:e.value,onCloseDraw:o[11]||(o[11]=f=>de(3))},null,8,["idConvenio"])]),_:1},8,["open"])],64)}}},ea=Te(Gt,[["__scopeId","data-v-672153f4"]]);export{ea as default};
