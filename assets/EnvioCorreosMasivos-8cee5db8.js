import{r as ye,u as he,F as ve}from"./xlsx-1ec352bc.js";import{an as pe,af as me,r as L,a as ge,b as K,o as H,d as U,e as b,c as O,w as C,F as be,v as _e,s as Y,i as N,m as Se,h as Q,j as J,t as ke}from"./index-480b1345.js";import{q as Oe,Q as xe}from"./quill.snow-cad3fe8c.js";import{M as we}from"./MailOutlined-339ef35a.js";var x={},Ae=function(c){return Ee(c)&&!Re(c)};function Ee(s){return!!s&&typeof s=="object"}function Re(s){var c=Object.prototype.toString.call(s);return c==="[object RegExp]"||c==="[object Date]"||Te(s)}var Be=typeof Symbol=="function"&&Symbol.for,qe=Be?Symbol.for("react.element"):60103;function Te(s){return s.$$typeof===qe}function Me(s){return Array.isArray(s)?[]:{}}function j(s,c){return c.clone!==!1&&c.isMergeableObject(s)?_(Me(s),s,c):s}function Pe(s,c,l){return s.concat(c).map(function(y){return j(y,l)})}function De(s,c,l){var y={};return l.isMergeableObject(s)&&Object.keys(s).forEach(function(h){y[h]=j(s[h],l)}),Object.keys(c).forEach(function(h){!l.isMergeableObject(c[h])||!s[h]?y[h]=j(c[h],l):y[h]=_(s[h],c[h],l)}),y}function _(s,c,l){l=l||{},l.arrayMerge=l.arrayMerge||Pe,l.isMergeableObject=l.isMergeableObject||Ae;var y=Array.isArray(c),h=Array.isArray(s),f=y===h;return f?y?l.arrayMerge(s,c,l):De(s,c,l):j(c,l)}_.all=function(c,l){if(!Array.isArray(c))throw new Error("first argument should be an array");return c.reduce(function(y,h){return _(y,h,l)},{})};var je=_;const Ie=Object.freeze(Object.defineProperty({__proto__:null,default:je},Symbol.toStringTag,{value:"Module"})),Le=pe(Ie);var w={},A={},E={},Z;function S(){if(Z)return E;Z=1,Object.defineProperty(E,"__esModule",{value:!0});var s=function(){function f(v,d){for(var u=0;u<d.length;u++){var n=d[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,n.key,n)}}return function(v,d,u){return d&&f(v.prototype,d),u&&f(v,u),v}}(),c=g();l(c);function l(f){return f&&f.__esModule?f:{default:f}}function y(f,v){if(!(f instanceof v))throw new TypeError("Cannot call a class as a function")}var h=function(){function f(v){y(this,f),this.formatter=v}return s(f,[{key:"onCreate",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onUpdate",value:function(){}}]),f}();return E.default=h,E}var R={},X={};Object.defineProperty(X,"__esModule",{value:!0});var He=function(){function s(c,l){for(var y=0;y<l.length;y++){var h=l[y];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}return function(c,l,y){return l&&s(c.prototype,l),y&&s(c,y),c}}();function F(s,c,l){return c in s?Object.defineProperty(s,c,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[c]=l,s}function Ue(s,c){if(!(s instanceof c))throw new TypeError("Cannot call a class as a function")}var z="left",$="center",V="right",Ce=function(){function s(c){var l=this,y;Ue(this,s),this.applyStyle=c.aligner.applyStyle,this.alignAttribute=c.attribute,this.alignments=(y={},F(y,z,{name:z,icon:c.icons.left,apply:function(f){l.setAlignment(f,z),l.setStyle(f,"inline","left","0 1em 1em 0")}}),F(y,$,{name:$,icon:c.icons.center,apply:function(f){l.setAlignment(f,$),l.setStyle(f,"block",null,"auto")}}),F(y,V,{name:V,icon:c.icons.right,apply:function(f){l.setAlignment(f,V),l.setStyle(f,"inline","right","0 0 1em 1em")}}),y)}return He(s,[{key:"getAlignments",value:function(){var l=this;return Object.keys(this.alignments).map(function(y){return l.alignments[y]})}},{key:"clear",value:function(l){l.removeAttribute(this.alignAttribute),this.setStyle(l,null,null,null)}},{key:"isAligned",value:function(l,y){return l.getAttribute(this.alignAttribute)===y.name}},{key:"setAlignment",value:function(l,y){l.setAttribute(this.alignAttribute,y)}},{key:"setStyle",value:function(l,y,h,f){this.applyStyle&&(l.style.setProperty("display",y),l.style.setProperty("float",h),l.style.setProperty("margin",f))}}]),s}();X.default=Ce;var ee={},te;function de(){if(te)return ee;te=1;var s=g();c(s);function c(l){return l&&l.__esModule?l:{default:l}}return ee}var B={},ne;function Ne(){if(ne)return B;ne=1,Object.defineProperty(B,"__esModule",{value:!0});var s=function(){function f(v,d){for(var u=0;u<d.length;u++){var n=d[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,n.key,n)}}return function(v,d,u){return d&&f(v.prototype,d),u&&f(v,u),v}}();de();var c=g();l(c);function l(f){return f&&f.__esModule?f:{default:f}}function y(f,v){if(!(f instanceof v))throw new TypeError("Cannot call a class as a function")}var h=function(){function f(){y(this,f),this.toolbar=null,this.buttons=[]}return s(f,[{key:"create",value:function(d,u){var n=document.createElement("div");return n.classList.add(d.options.align.toolbar.mainClassName),this.addToolbarStyle(d,n),this.addButtons(d,n,u),this.toolbar=n,this.toolbar}},{key:"destroy",value:function(){this.toolbar=null,this.buttons=[]}},{key:"getElement",value:function(){return this.toolbar}},{key:"addToolbarStyle",value:function(d,u){d.options.align.toolbar.mainStyle&&Object.assign(u.style,d.options.align.toolbar.mainStyle)}},{key:"addButtonStyle",value:function(d,u,n){n.options.align.toolbar.buttonStyle&&(Object.assign(d.style,n.options.align.toolbar.buttonStyle),u>0&&(d.style.borderLeftWidth="0")),n.options.align.toolbar.svgStyle&&Object.assign(d.children[0].style,n.options.align.toolbar.svgStyle)}},{key:"addButtons",value:function(d,u,n){var o=this;n.getAlignments().forEach(function(r,e){var t=document.createElement("span");t.classList.add(d.options.align.toolbar.buttonClassName),t.innerHTML=r.icon,t.addEventListener("click",function(){o.onButtonClick(t,d,r,n)}),o.preselectButton(t,r,d,n),o.addButtonStyle(t,e,d),o.buttons.push(t),u.appendChild(t)})}},{key:"preselectButton",value:function(d,u,n,o){if(n.currentSpec){var r=n.currentSpec.getTargetElement();r&&o.isAligned(r,u)&&this.selectButton(n,d)}}},{key:"onButtonClick",value:function(d,u,n,o){if(u.currentSpec){var r=u.currentSpec.getTargetElement();r&&this.clickButton(d,r,u,n,o)}}},{key:"clickButton",value:function(d,u,n,o,r){var e=this;this.buttons.forEach(function(t){e.deselectButton(n,t)}),r.isAligned(u,o)?n.options.align.toolbar.allowDeselect?r.clear(u):this.selectButton(n,d):(this.selectButton(n,d),o.apply(u)),n.update()}},{key:"selectButton",value:function(d,u){u.classList.add("is-selected"),d.options.align.toolbar.addButtonSelectStyle&&u.style.setProperty("filter","invert(20%)")}},{key:"deselectButton",value:function(d,u){u.classList.remove("is-selected"),d.options.align.toolbar.addButtonSelectStyle&&u.style.removeProperty("filter")}}]),f}();return B.default=h,B}var re;function Fe(){if(re)return R;re=1,Object.defineProperty(R,"__esModule",{value:!0});var s=function(){function t(i,a){for(var p=0;p<a.length;p++){var m=a[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}return function(i,a,p){return a&&t(i.prototype,a),p&&t(i,p),i}}(),c=S(),l=u(c),y=g();u(y);var h=X,f=u(h);de();var v=Ne(),d=u(v);function u(t){return t&&t.__esModule?t:{default:t}}function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function o(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i&&(typeof i=="object"||typeof i=="function")?i:t}function r(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}var e=function(t){r(i,t);function i(a){n(this,i);var p=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,a));return p.aligner=new f.default(a.options.align),p.toolbar=new d.default,p}return s(i,[{key:"onCreate",value:function(){var p=this.toolbar.create(this.formatter,this.aligner);this.formatter.overlay.appendChild(p)}},{key:"onDestroy",value:function(){var p=this.toolbar.getElement();p&&(this.formatter.overlay.removeChild(p),this.toolbar.destroy())}}]),i}(l.default);return R.default=e,R}var q={},ie;function ze(){if(ie)return q;ie=1,Object.defineProperty(q,"__esModule",{value:!0});var s=function(){function n(o,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}return function(o,r,e){return r&&n(o.prototype,r),e&&n(o,e),o}}(),c=S(),l=h(c),y=g();h(y);function h(n){return n&&n.__esModule?n:{default:n}}function f(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function v(n,o){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o&&(typeof o=="object"||typeof o=="function")?o:n}function d(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof o);n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(n,o):n.__proto__=o)}var u=function(n){d(o,n);function o(r){f(this,o);var e=v(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,r));return e.onMouseDown=function(t){if(t.target instanceof HTMLElement&&(e.dragHandle=t.target,e.setCursor(e.dragHandle.style.cursor),!!e.formatter.currentSpec)){var i=e.formatter.currentSpec.getTargetElement();if(i){var a=i.getBoundingClientRect();e.dragStartX=t.clientX,e.preDragWidth=a.width,e.targetRatio=a.height/a.width,document.addEventListener("mousemove",e.onDrag),document.addEventListener("mouseup",e.onMouseUp)}}},e.onDrag=function(t){if(e.formatter.currentSpec){var i=e.formatter.currentSpec.getTargetElement();if(i){var a=t.clientX-e.dragStartX,p=0;e.dragHandle===e.topLeftHandle||e.dragHandle===e.bottomLeftHandle?p=Math.round(e.preDragWidth-a):p=Math.round(e.preDragWidth+a);var m=e.targetRatio*p;i.setAttribute("width",""+p),i.setAttribute("height",""+m),e.formatter.update()}}},e.onMouseUp=function(){e.setCursor(""),document.removeEventListener("mousemove",e.onDrag),document.removeEventListener("mouseup",e.onMouseUp)},e.topLeftHandle=e.createHandle("top-left","nwse-resize"),e.topRightHandle=e.createHandle("top-right","nesw-resize"),e.bottomRightHandle=e.createHandle("bottom-right","nwse-resize"),e.bottomLeftHandle=e.createHandle("bottom-left","nesw-resize"),e.dragHandle=null,e.dragStartX=0,e.preDragWidth=0,e.targetRatio=0,e}return s(o,[{key:"onCreate",value:function(){this.formatter.overlay.appendChild(this.topLeftHandle),this.formatter.overlay.appendChild(this.topRightHandle),this.formatter.overlay.appendChild(this.bottomRightHandle),this.formatter.overlay.appendChild(this.bottomLeftHandle),this.repositionHandles(this.formatter.options.resize.handleStyle)}},{key:"onDestroy",value:function(){this.setCursor(""),this.formatter.overlay.removeChild(this.topLeftHandle),this.formatter.overlay.removeChild(this.topRightHandle),this.formatter.overlay.removeChild(this.bottomRightHandle),this.formatter.overlay.removeChild(this.bottomLeftHandle)}},{key:"createHandle",value:function(e,t){var i=document.createElement("div");return i.classList.add(this.formatter.options.resize.handleClassName),i.setAttribute("data-position",e),i.style.cursor=t,this.formatter.options.resize.handleStyle&&Object.assign(i.style,this.formatter.options.resize.handleStyle),i.addEventListener("mousedown",this.onMouseDown),i}},{key:"repositionHandles",value:function(e){var t="0px",i="0px";e&&(e.width&&(t=-parseFloat(e.width)/2+"px"),e.height&&(i=-parseFloat(e.height)/2+"px")),Object.assign(this.topLeftHandle.style,{left:t,top:i}),Object.assign(this.topRightHandle.style,{right:t,top:i}),Object.assign(this.bottomRightHandle.style,{right:t,bottom:i}),Object.assign(this.bottomLeftHandle.style,{left:t,bottom:i})}},{key:"setCursor",value:function(e){if(document.body&&(document.body.style.cursor=e),this.formatter.currentSpec){var t=this.formatter.currentSpec.getOverlayElement();t&&(t.style.cursor=e)}}}]),o}(l.default);return q.default=u,q}var T={},oe;function $e(){if(oe)return T;oe=1,Object.defineProperty(T,"__esModule",{value:!0});var s=function(){function o(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}return function(r,e,t){return e&&o(r.prototype,e),t&&o(r,t),r}}(),c=Oe,l=f(c),y=S(),h=f(y);function f(o){return o&&o.__esModule?o:{default:o}}function v(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function d(o,r){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:o}function u(o,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);o.prototype=Object.create(r&&r.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(o,r):o.__proto__=r)}var n=function(o){u(r,o);function r(){var e,t,i,a;v(this,r);for(var p=arguments.length,m=Array(p),k=0;k<p;k++)m[k]=arguments[k];return a=(t=(i=d(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(m))),i),i.onKeyUp=function(W){if(i.formatter.currentSpec&&(W.keyCode===46||W.keyCode===8)){var G=l.default.find(i.formatter.currentSpec.getTargetElement());G&&G.deleteAt(0),i.formatter.hide()}},t),d(i,a)}return s(r,[{key:"onCreate",value:function(){document.addEventListener("keyup",this.onKeyUp,!0),this.formatter.quill.root.addEventListener("input",this.onKeyUp,!0)}},{key:"onDestroy",value:function(){document.removeEventListener("keyup",this.onKeyUp),this.formatter.quill.root.removeEventListener("input",this.onKeyUp)}}]),r}(h.default);return T.default=n,T}var ae;function I(){if(ae)return A;ae=1,Object.defineProperty(A,"__esModule",{value:!0});var s=function(){function e(t,i){for(var a=0;a<i.length;a++){var p=i[a];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(t,p.key,p)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),c=g();n(c);var l=S();n(l);var y=Fe(),h=n(y),f=ze(),v=n(f),d=$e(),u=n(d);function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t){o(this,e),this.formatter=t}return s(e,[{key:"init",value:function(){}},{key:"getActions",value:function(){return[h.default,v.default,u.default]}},{key:"getTargetElement",value:function(){return null}},{key:"getOverlayElement",value:function(){return this.getTargetElement()}},{key:"setSelection",value:function(){this.formatter.quill.setSelection(null)}},{key:"onHide",value:function(){}}]),e}();return A.default=r,A}var M={},le;function Ve(){if(le)return M;le=1,Object.defineProperty(M,"__esModule",{value:!0});var s=function(){function n(o,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}return function(o,r,e){return r&&n(o.prototype,r),e&&n(o,e),o}}(),c=I(),l=h(c),y=g();h(y);function h(n){return n&&n.__esModule?n:{default:n}}function f(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function v(n,o){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o&&(typeof o=="object"||typeof o=="function")?o:n}function d(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof o);n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(n,o):n.__proto__=o)}var u=function(n){d(o,n);function o(r){f(this,o);var e=v(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,r));return e.onClick=function(t){var i=t.target;!(i instanceof HTMLElement)||i.tagName!=="IMG"||(e.img=i,e.formatter.show(e))},e.img=null,e}return s(o,[{key:"init",value:function(){this.formatter.quill.root.addEventListener("click",this.onClick)}},{key:"getTargetElement",value:function(){return this.img}},{key:"onHide",value:function(){this.img=null}}]),o}(l.default);return M.default=u,M}var P={},D={},ue;function Xe(){if(ue)return D;ue=1,Object.defineProperty(D,"__esModule",{value:!0});var s=function(){function r(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}}(),c=I(),l=h(c),y=g();h(y);function h(r){return r&&r.__esModule?r:{default:r}}function f(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function v(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function d(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var u="data-blot-formatter-unclickable-bound",n="blot-formatter__proxy-image",o=function(r){d(e,r);function e(t,i){f(this,e);var a=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.onTextChange=function(){Array.from(document.querySelectorAll(a.selector+":not(["+u+"])")).forEach(function(p){p.setAttribute(u,"true"),p.addEventListener("mouseenter",a.onMouseEnter)})},a.onMouseEnter=function(p){var m=p.target;m instanceof HTMLElement&&(a.nextUnclickable=m,a.repositionProxyImage(a.nextUnclickable))},a.onProxyImageClick=function(){a.unclickable=a.nextUnclickable,a.nextUnclickable=null,a.formatter.show(a),a.hideProxyImage()},a.selector=i,a.unclickable=null,a.nextUnclickable=null,a}return s(e,[{key:"init",value:function(){document.body&&document.body.appendChild(this.createProxyImage()),this.hideProxyImage(),this.proxyImage.addEventListener("click",this.onProxyImageClick),this.formatter.quill.on("text-change",this.onTextChange)}},{key:"getTargetElement",value:function(){return this.unclickable}},{key:"getOverlayElement",value:function(){return this.unclickable}},{key:"onHide",value:function(){this.hideProxyImage(),this.nextUnclickable=null,this.unclickable=null}},{key:"createProxyImage",value:function(){var i=document.createElement("canvas"),a=i.getContext("2d");return a.globalAlpha=0,a.fillRect(0,0,1,1),this.proxyImage=document.createElement("img"),this.proxyImage.src=i.toDataURL("image/png"),this.proxyImage.classList.add(n),Object.assign(this.proxyImage.style,{position:"absolute",margin:"0"}),this.proxyImage}},{key:"hideProxyImage",value:function(){Object.assign(this.proxyImage.style,{display:"none"})}},{key:"repositionProxyImage",value:function(i){var a=i.getBoundingClientRect();Object.assign(this.proxyImage.style,{display:"block",left:a.left+window.pageXOffset+"px",top:a.top+window.pageYOffset+"px",width:a.width+"px",height:a.height+"px"})}}]),e}(l.default);return D.default=o,D}var ce;function We(){if(ce)return P;ce=1,Object.defineProperty(P,"__esModule",{value:!0});var s=Xe(),c=y(s),l=g();y(l);function y(u){return u&&u.__esModule?u:{default:u}}function h(u,n){if(!(u instanceof n))throw new TypeError("Cannot call a class as a function")}function f(u,n){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:u}function v(u,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);u.prototype=Object.create(n&&n.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(u,n):u.__proto__=n)}var d=function(u){v(n,u);function n(o){return h(this,n),f(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,o,"iframe.ql-video"))}return n}(c.default);return P.default=d,P}var se;function Ge(){if(se)return w;se=1,Object.defineProperty(w,"__esModule",{value:!0});var s=I();f(s);var c=Ve(),l=f(c),y=We(),h=f(y);function f(d){return d&&d.__esModule?d:{default:d}}var v={specs:[l.default,h.default],overlay:{className:"blot-formatter__overlay",style:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"}},align:{attribute:"data-align",aligner:{applyStyle:!0},icons:{left:`
        <svg viewbox="0 0 18 18">
          <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>
          <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>
          <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>
        </svg>
      `,center:`
        <svg viewbox="0 0 18 18">
           <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
          <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>
          <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>
        </svg>
      `,right:`
        <svg viewbox="0 0 18 18">
          <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
          <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>
          <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>
        </svg>
      `},toolbar:{allowDeselect:!0,mainClassName:"blot-formatter__toolbar",mainStyle:{position:"absolute",top:"-12px",right:"0",left:"0",height:"0",minWidth:"100px",font:"12px/1.0 Arial, Helvetica, sans-serif",textAlign:"center",color:"#333",boxSizing:"border-box",cursor:"default",zIndex:"1"},buttonClassName:"blot-formatter__toolbar-button",addButtonSelectStyle:!0,buttonStyle:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"},svgStyle:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"}}},resize:{handleClassName:"blot-formatter__resize-handle",handleStyle:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"}}};return w.default=v,w}var fe;function g(){if(fe)return x;fe=1,Object.defineProperty(x,"__esModule",{value:!0});var s=function(){function r(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}}(),c=Le,l=d(c),y=Ge(),h=d(y),f=S();d(f);var v=I();d(v);function d(r){return r&&r.__esModule?r:{default:r}}function u(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(e,t){return t},o=function(){function r(e){var t=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u(this,r),this.onClick=function(){t.hide()},this.quill=e,this.options=(0,l.default)(h.default,i,{arrayMerge:n}),this.currentSpec=null,this.actions=[],this.overlay=document.createElement("div"),this.overlay.classList.add(this.options.overlay.className),this.options.overlay.style&&Object.assign(this.overlay.style,this.options.overlay.style),document.execCommand("enableObjectResizing",!1,"false"),this.quill.root.parentNode.style.position=this.quill.root.parentNode.style.position||"relative",this.quill.root.addEventListener("click",this.onClick),this.specs=this.options.specs.map(function(a){return new a(t)}),this.specs.forEach(function(a){return a.init()})}return s(r,[{key:"show",value:function(t){this.currentSpec=t,this.currentSpec.setSelection(),this.setUserSelect("none"),this.quill.root.parentNode.appendChild(this.overlay),this.repositionOverlay(),this.createActions(t)}},{key:"hide",value:function(){this.currentSpec&&(this.currentSpec.onHide(),this.currentSpec=null,this.quill.root.parentNode.removeChild(this.overlay),this.overlay.style.setProperty("display","none"),this.setUserSelect(""),this.destroyActions())}},{key:"update",value:function(){this.repositionOverlay(),this.actions.forEach(function(t){return t.onUpdate()})}},{key:"createActions",value:function(t){var i=this;this.actions=t.getActions().map(function(a){var p=new a(i);return p.onCreate(),p})}},{key:"destroyActions",value:function(){this.actions.forEach(function(t){return t.onDestroy()}),this.actions=[]}},{key:"repositionOverlay",value:function(){if(this.currentSpec){var t=this.currentSpec.getOverlayElement();if(t){var i=this.quill.root.parentNode,a=t.getBoundingClientRect(),p=i.getBoundingClientRect();Object.assign(this.overlay.style,{display:"block",left:a.left-p.left-1+i.scrollLeft+"px",top:a.top-p.top+i.scrollTop+"px",width:a.width+"px",height:a.height+"px"})}}}},{key:"setUserSelect",value:function(t){var i=this,a=["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"];a.forEach(function(p){i.quill.root.style.setProperty(p,t),document.documentElement&&document.documentElement.style.setProperty(p,t)})}}]),r}();return x.default=o,x}var Ke=g();const Ye=me(Ke);const Qe={class:"email-wrapper"},Je={class:"email-list"},rt={__name:"EnvioCorreosMasivos",setup(s){const c=L(!1),l=L([]),y=L([]),h={name:"blotFormatter",module:Ye,options:{}},f=ge({message:""}),v=async u=>{const n=["xls","xlsx"],o=u.name.split(".").pop().toLowerCase();if(!n.includes(o))return alert("Por favor, sube un archivo en formato Excel (.xls o .xlsx)."),!1;const r=new FileReader;return r.onload=e=>{const t=new Uint8Array(e.target.result),i=ye(t,{type:"array"}),a=i.Sheets[i.SheetNames[0]],p=he.sheet_to_json(a);y.value=p.map(m=>m.Email).filter(m=>!!m)},r.readAsArrayBuffer(u),!1},d=async()=>{c.value=!0;const u={emails:y.value,message:f.message};try{const n=await Se({url:"automatic/send-emails",method:"POST",data:u});n.status==200&&(Q.success(n.message),y.value=[])}catch(n){Q.error("error"),console.log("error",n)}finally{c.value=!1}};return(u,n)=>{const o=K("a-button"),r=K("a-upload");return H(),U("section",null,[n[4]||(n[4]=b("h3",{class:"title-produce"},"ENVIAR CORREOS MASIVOS",-1)),b("div",Qe,[b("div",null,[O(r,{"before-upload":v,"file-list":l.value,"show-upload-list":!1,accept:".xls,.xlsx"},{default:C(()=>[O(o,{type:"primary",icon:Y(N(ve)),style:{"background-color":"#006e37"}},{default:C(()=>n[1]||(n[1]=[J(" SELECCIONAR LISTA ")])),_:1},8,["icon"])]),_:1},8,["file-list"]),b("div",Je,[n[2]||(n[2]=b("h4",null,"Correos seleccionados:",-1)),b("ul",null,[(H(!0),U(be,null,_e(y.value,(e,t)=>(H(),U("li",{key:t},ke(e),1))),128))])]),O(o,{onClick:d,loading:c.value,class:"email-btn-send",type:"primary",icon:Y(N(we))},{default:C(()=>n[3]||(n[3]=[J("ENVIAR")])),_:1},8,["loading","icon"])]),b("div",null,[O(N(xe),{class:"email-quill-editor",content:f.message,"onUpdate:content":n[0]||(n[0]=e=>f.message=e),modules:h,toolbar:"full",contentType:"html"},null,8,["content"])])])])}}};export{rt as default};
