import{l as F,u as ie,g as re,r as o,a as de,G as ue,Z as ce,j as pe,b as l,o as s,d as g,e as c,c as n,w as t,i as p,F as I,R as M,x as m,y as r,t as w,h as b,a2 as me,O as fe,q as _e,m as ge}from"./index-153e5230.js";import{_ as ve}from"./NuevaFeria-4dce091d.js";import{u as ye}from"./selectes-8c8b7c6b.js";import"./es-65e5a49a.js";import{C as Ie}from"./CloudOutlined-db4740af.js";import{M as we}from"./MoreOutlined-5e6486ed.js";import"./quill.snow-d83aed1a.js";const xe={key:1},he=["onClick"],Ee=["onClick"],ke={class:"paginator"},Oe={__name:"IndexFerias",props:["idConvenio"],setup(Ce){F.locale("es");const L=ie(),$=JSON.parse(localStorage.getItem("role"))||[];ye(),re.get("token");const v=o(!1),x=o(null);o(!1),o(null);const k=o(0),C=o(50),h=o({page:0}),B=o(1200),N=o([]),R=o(!1);o(!1),o(!1),o(!1),o(!1),o(null);const O=o(window.innerHeight-100),U=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"FERIA",fixed:"left",dataIndex:"title",width:280},{title:"LINK",dataIndex:"slug",width:100,align:"center"},{title:"META MYPES",dataIndex:"metaMypes",width:120,align:"center"},{title:"INSCRITOS",dataIndex:"countMypes",width:120,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"DÍAS RESTANTES",dataIndex:"dateDiff",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"CREADO POR",dataIndex:"profile",width:170},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],y=de({search:""}),D=a=>$.some(e=>a.includes(e.id)),V=()=>{_(),v.value=!1},P=a=>{x.value=a,v.value=!0},G=()=>{x.value=null,v.value=!0},T=a=>{const e=F().startOf("day"),f=F(a).startOf("day").diff(e,"days");return f<=-1?f:f===0?1:f},H=()=>{let a={search:y.search};_(a)},j=()=>{y.search||_()},q=a=>{console.log("Inscriptos"),L.push(`/admin/ferias/inscritos/${a.slug}`)},Q=a=>{h.value.page=a,_()},A=()=>{O.value=window.innerHeight-320},Y=async a=>{try{const e=await M({url:`agreement/delete/${a.id}`,method:"DELETE"});e.status==200&&(_(),ge.success(e.message))}catch(e){console.error("Error de red:",e)}},Z=ue(()=>a=>h.value.page*C.value+a+1),_=async a=>{try{R.value=!0;let e;e=h.value.page==0?"":h.value,e=a?{...e,...a}:e;const{data:d}=await M({url:"fair/list",method:"GET",params:e});N.value=d==null?void 0:d.data,k.value=d.total,C.value=d.per_page}catch(e){console.error("Error de red:",e)}finally{R.value=!1}};return ce(()=>{window.removeEventListener("resize",A)}),pe(()=>{window.addEventListener("resize",A),A(),_()}),(a,e)=>{const d=l("a-button"),f=l("a-col"),J=l("a-input"),K=l("a-input-group"),X=l("a-row"),W=l("router-link"),E=l("a-tag"),S=l("a-menu-item"),ee=l("a-popconfirm"),te=l("a-menu"),ae=l("a-dropdown"),ne=l("a-table"),oe=l("a-pagination"),le=l("a-drawer");return s(),g(I,null,[c("div",null,[e[9]||(e[9]=c("h3",{class:"title-produce"},"FERIAS EMPRESARIALES",-1)),n(X,{style:{margin:"1rem 0"}},{default:t(()=>[n(f,{xs:24,md:12,lg:18},{default:t(()=>[D([5,10,11])?(s(),m(d,{key:0,type:"primary",onClick:G,style:{"margin-right":".5rem"}},{default:t(()=>e[3]||(e[3]=[p("NUEVA FERIA")])),_:1})):r("",!0)]),_:1}),n(f,{xs:24,md:12,lg:6},{default:t(()=>[n(K,{compact:""},{default:t(()=>[n(J,{value:y.search,"onUpdate:value":e[0]||(e[0]=u=>y.search=u),style:{width:"calc(100% - 80px)"},onInput:j},null,8,["value"]),n(d,{type:"primary",disabled:y.search==="",onClick:H},{default:t(()=>e[4]||(e[4]=[p("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(ne,{bordered:"",scroll:{x:B.value,y:O.value},class:"table-fairs",columns:U,"data-source":N.value,pagination:!1,loading:R.value,size:"small"},{bodyCell:t(({column:u,record:i,index:se})=>[u.dataIndex=="idx"?(s(),g(I,{key:0},[p(w(Z.value(se)),1)],64)):r("",!0),u.dataIndex=="title"?(s(),g(I,{key:1},[p(w(i.title)+" ▪ "+w(i.subTitle),1)],64)):r("",!0),u.dataIndex=="slug"?(s(),m(W,{key:2,to:`/feria/${i.slug}`,target:"_blank"},{default:t(()=>[n(b(Ie),{class:"fair-link"})]),_:2},1032,["to"])):r("",!0),u.dataIndex=="modality"?(s(),g(I,{key:3},[i.modality=="p"?(s(),m(E,{key:0,color:"blue"},{default:t(()=>e[5]||(e[5]=[p("PRESENCIAL")])),_:1})):r("",!0),i.modality=="v"?(s(),m(E,{key:1,color:"orange"},{default:t(()=>e[6]||(e[6]=[p("VIRTUAL")])),_:1})):r("",!0)],64)):r("",!0),u.dataIndex=="dateDiff"?(s(),g(I,{key:4},[T(i.endDate2)<0?(s(),m(E,{key:0,color:"red"},{default:t(()=>e[7]||(e[7]=[p(" FINALIZADO ")])),_:1})):(s(),g("span",xe,w(T(i.endDate2)),1))],64)):r("",!0),u.dataIndex=="actions"?(s(),m(ae,{key:5,trigger:["click"]},{overlay:t(()=>[n(te,null,{default:t(()=>[D([5,10,11])?(s(),m(S,{key:0},{default:t(()=>[c("a",{onClick:z=>P(i)},"Editar",8,he)]),_:2},1024)):r("",!0),n(S,null,{default:t(()=>[c("a",{onClick:z=>q(i)},"Inscritos",8,Ee)]),_:2},1024),D([5,10,11])?(s(),m(S,{key:1},{default:t(()=>[n(ee,{placement:"rightBottom",title:`¿Quieres eliminar ${i.title} ?`,onConfirm:z=>Y(i)},{icon:t(()=>[n(b(me),{style:{color:"red"}})]),default:t(()=>[e[8]||(e[8]=c("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):r("",!0)]),_:2},1024)]),default:t(()=>[c("a",{class:"ant-dropdown-link",onClick:e[1]||(e[1]=fe(()=>{},["prevent"]))},[n(d,{shape:"circle",icon:_e(b(we)),size:"small"},null,8,["icon"])])]),_:2},1024)):r("",!0)]),_:1},8,["scroll","data-source","loading"])]),c("div",ke,[c("span",null,[n(E,{color:"blue"},{default:t(()=>[c("b",null,w(k.value),1)]),_:1}),e[10]||(e[10]=p("Ferias Empresariales"))]),n(oe,{size:"small",total:k.value,pageSize:C.value,onChange:Q,showSizeChanger:!1},null,8,["total","pageSize"])]),n(le,{open:v.value,"onUpdate:open":e[2]||(e[2]=u=>v.value=u),title:x.value?"EDITAR FERIA":"REGISTRAR FERIA",placement:"right",width:"650"},{default:t(()=>[n(ve,{onCloseDraw:V,dataRow:x.value},null,8,["dataRow"])]),_:1},8,["open","title"])],64)}}};export{Oe as default};
