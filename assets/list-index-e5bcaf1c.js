import{_ as F}from"./TableComponent-e8cf154c.js";import{l as h,r as l,a as k,j as Y,X as U,a6 as g,o as x,d as T,c,R as A,m as H,b as R,w as u,t as $,y as q,e as O,h as B,a2 as G}from"./index-090a7eb2.js";import{_ as V}from"./FormComponent-5afc0e87.js";import{u as j}from"./selectes-aed7cdee.js";import"./es-3d6d3309.js";import"./downloadExcel-8c161ba6.js";import{g as z}from"./usePermissions-57a5556b.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-85ff2ff3.js";import"./vue-quill.esm-bundler-f7c30ead.js";import"./quill.snow-3e231189.js";/* empty css                                                      */const Q={class:"usuarios-pnte"},J={__name:"UsuariosPrograma",props:["info"],emits:["closeDraw"],setup(P,{emit:y}){h.locale("es");const f=l({dni:{type:"iInputSearch",label:"DNI",name:"dni",required:!0,message:"Ingrese el DNI",disabled:!1,rules:[{validator:(e,n)=>{if(!n)return Promise.reject(new Error("Escribe número de documento"));const i=String(n).trim();return/^\d{8}$/.test(i)?Promise.resolve():Promise.reject(new Error("DNI incorrecto."))},trigger:["change","blur"]}]},name:{type:"iText",label:"NOMBRE",name:"name",required:!0,message:"Ingrese el nombre",disabled:!1},lastname:{type:"iText",label:"APELLIDO PATERNO",name:"lastname",required:!0,message:"Ingrese el apellido paterno",disabled:!1},middlename:{type:"iText",label:"APELLIDO MATERNO",name:"middlename",required:!0,message:"Ingrese el apellido materno",disabled:!1},phone:{type:"iText",label:"NÚMERO DE CELULAR",name:"phone",required:!0,message:"Ingrese el número de celular",disabled:!1},birthday:{type:"iDate",label:"FECHA DE NACIMIENTO",name:"birthday",required:!1,message:"Seleccione la fecha de nacimiento",disabled:!1},gender_id:{type:"iSelect",label:"GÉNERO",name:"gender_id",required:!0,message:"Seleccione el género",disabled:!1},office_id:{type:"iSelect",label:"OFICINA",name:"office_id",required:!0,message:"Seleccione la Oficina",disabled:!1},cde_id:{type:"iSelect",label:"CDE",name:"cde_id",required:!0,message:"Seleccione la CDE",disabled:!1}});JSON.parse(localStorage.getItem("profile"));const v=y,p=P,_=l("GUARDAR"),a=k({}),d=l(!1),t=j(),s=l(null),o=l({gender_id:[],office_id:[],cde_id:[]}),E=e=>{console.log("handleInputEvent",e)},w=async e=>{e=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),f.value.dateTramite.disabled=!1)},C=async e=>{console.log("handleChangeSelect",e)},I=async e=>{e=="gender_id"&&(await t.fetchGenders(),o.value.gender_id=t.genders),e=="office_id"&&(await t.fetchOffices(),o.value.office_id=t.Offices),e=="cde_id"&&(await t.fetchCdes(),o.value.cde_id=t.cdes)},N=e=>{},D=async()=>{d.value=!0;const e={ruc:a.ruc,comercialName:a.comercialName,socialReason:a.socialReason,economicsector_id:a.economicsector_id,comercialactivity_id:a.comercialactivity_id,city_id:a.city_id,typedocument_id:a.typedocument_id,documentnumber:a.documentnumber,lastname:a.lastname,middlename:a.middlename,name:a.name,gender_id:a.gender_id,phone:a.phone,email:a.email,birthday:h(a.birthday).format("YYYY-MM-DD HH:mm"),positionCompany:a.positionCompany,instagram:a.instagram,facebook:a.facebook,web:a.web};try{const n=await A({url:`fair/sed-update-data-user/${p.info.id}`,method:"PUT",data:e});n.status===200&&(H.success(n.message),b(),v("closeDraw",!0))}catch(n){console.error("Error:",n);const i=document.getElementsByClassName("ant-drawer-body")[0];i&&(i.scrollTop=0)}finally{d.value=!1}},b=()=>{a.nameEvent=null,a.city_id=null,a.place=null,a.modality_id=null,a.dates=null,a.hours=null,a.description=null},r=async e=>{e&&(a.ruc=e.ruc,a.comercialName=e.comercialName,a.socialReason=e.socialReason,await t.fetchEconomicSectors(),o.value.economicsector_id=t.economicSectors,a.economicsector_id=e.economicsector.id,await t.fetchComercialActivities(),o.value.comercialactivity_id=t.comercialActivities,a.comercialactivity_id=e.comercialactivity.id,await t.fetchCities(),o.value.city_id=t.cities,a.city_id=e.city.id,await t.fetchTypeDocuments(),o.value.typedocument_id=t.typeDocuments,a.typedocument_id=e.typedocument.id,a.documentnumber=e.documentnumber,a.lastname=e.lastname,a.middlename=e.middlename,a.name=e.name,await t.fetchGenders(),o.value.gender_id=t.genders,a.gender_id=e.gender.id,a.sick=e.sick,a.phone=e.phone,a.email=e.email,e.birthday&&(a.birthday=h(e.birthday,"YYYY-MM-DD")),a.positionCompany=e.positionCompany,a.facebook=e.facebook,a.instagram=e.instagram,a.web=e.web)};return Y(()=>{p.info&&r(p.info)}),U(()=>p.info,e=>{e?r(e):b()}),g("formState",a),g("loadingState",d),(e,n)=>(x(),T("div",Q,[c(V,{fields:f.value,options:o.value,btnSaveName:_.value,onHandleInputEvent:E,resetSelect:s.value,onHandleChangeSelect:C,onHandleFocusSelect:I,onHandleBlurSelect:N,onHandleChangeClock:w,onOnSubmit:D},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const X={class:"advisory-table"},K={key:0},W=["onClick"],Z=["onClick"],ue={__name:"list-index",setup(P){const y=l([]),f=l(0),v=l(150),p=l({}),_=l(!1),a=l(!1),d=l(null),t=l(!1),s=k({year:h("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),o=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"DNI",dataIndex:"dni",fixed:"left",width:100,align:"center"},{title:"NOMBRES",dataIndex:"name",width:160},{title:"APELLIDOS",dataIndex:"fullname",width:160},{title:"CORREO PNTE",dataIndex:"email",width:240},{title:"CELULAR",dataIndex:"phone",width:100,align:"center"},{title:"FECHA NACIMIENTO",dataIndex:"birthday",width:100,align:"center"},{title:"OFICINA",dataIndex:"office_name",width:120,align:"center"},{title:"CDE",dataIndex:"cde_name",width:140},{title:"CORREO PERSONAL",dataIndex:"personalemail",width:240},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],E=e=>{d.value=e,_.value=!0},w=()=>{r(),_.value=!1},C=()=>{d.value=null,_.value=!0},I=async e=>{try{const n=await A({url:`attendance/delete/${e.id}`,method:"DELETE"});n.status==200&&(r(),H.success(n.message))}catch(n){console.error("Error de red:",n)}},N=async()=>{t.value=!0;try{}catch(e){console.error("Error de red:",e)}finally{t.value=!1}},D=async e=>{s.page=e,await r()},b=async e=>{e&&(s.page=1,await r())},r=async()=>{try{a.value=!0;const e={page:s.page};s.year&&(e.year=h(s.year).format("YYYY")),s.name&&(e.name=s.name);const i=await A({url:"user/list",method:"GET",params:e});y.value=i.data.data,f.value=i.data.total,v.value=i.data.per_page}catch(e){console.error("Error de red:",e)}finally{a.value=!1}};return Y(async()=>{p.value=await z("usuarios-lista"),await r()}),g("search",s),g("loading",a),g("loadingFile",t),(e,n)=>{const i=R("a-menu-item"),L=R("a-popconfirm"),M=R("a-drawer");return x(),T("div",X,[c(F,{title:"LISTA EQUIPO PNTE",nameTotal:"Personal PNTE",titleSearch:"FILTRAR POR NÚMERO DE DNI",placeholderSearch:"Buscar",textNuevo:"NUEVO REGISTRO",new:!0,columns:o,pageSize:v.value,dataSource:y.value,total:f.value,btnUpdate:!0,permisos:p.value,onHandleNew:C,onHandleDownloadExcel:N,onHandleSearch:b,onHandleCallFetchData:r,onHandlePaginator:D},{"data-cell":u(({column:m,record:S})=>[m.dataIndex=="type_activity"?(x(),T("span",K,$(S.pnte),1)):q("",!0)]),"custom-options":u(({record:m})=>[c(i,null,{default:u(()=>[O("a",{onClick:S=>E(m)},"Editar",8,W)]),_:2},1024),c(i,null,{default:u(()=>[O("a",{onClick:S=>E(m)},"Cambiar de contraseña",8,Z)]),_:2},1024),c(i,null,{default:u(()=>[c(L,{placement:"rightBottom",title:`¿Quieres eliminar ${m.title} ?`,onConfirm:S=>I(m)},{icon:u(()=>[c(B(G),{style:{color:"red"}})]),default:u(()=>[n[1]||(n[1]=O("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:1},8,["pageSize","dataSource","total","permisos"]),c(M,{open:_.value,"onUpdate:open":n[0]||(n[0]=m=>_.value=m),title:d.value?"EDITAR DATOS":"NUEVO REGISTRO",placement:"right",width:"550"},{default:u(()=>[c(J,{onCloseDraw:w,dataRow:d.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{ue as default};
