import{_ as Ce}from"./FormComponent-16accc52.js";import{u as ne}from"./selectes-75823ef3.js";import{c as i,A as we,l as te,r as m,a as ue,j as de,U as me,a6 as ye,o as u,d as L,f as Ie,N as K,b as y,w as o,e as h,F as J,s as ge,h as N,x as S,y as _,P as Ee,i as M,a7 as De,m as H,t as W,a2 as Re,u as Ne,E as Ae,a8 as Ue}from"./index-cc9eac84.js";import"./es-e5d57d23.js";import"./storage-0cea2812.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as Oe}from"./DrawerSolicitante.componente-dfe1f6f4.js";import"./quill.snow-4b47fb0e.js";/* empty css             */var Te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};const qe=Te;function be(D){for(var A=1;A<arguments.length;A++){var I=arguments[A]!=null?Object(arguments[A]):{},b=Object.keys(I);typeof Object.getOwnPropertySymbols=="function"&&(b=b.concat(Object.getOwnPropertySymbols(I).filter(function(P){return Object.getOwnPropertyDescriptor(I,P).enumerable}))),b.forEach(function(P){ze(D,P,I[P])})}return D}function ze(D,A,I){return A in D?Object.defineProperty(D,A,{value:I,enumerable:!0,configurable:!0,writable:!0}):D[A]=I,D}var pe=function(A,I){var b=be({},A,I.attrs);return i(we,be({},b,{icon:qe}),null)};pe.displayName="RedoOutlined";pe.inheritAttrs=!1;const ke=pe;const Pe={class:"f-20"},Fe={__name:"AllFormalizacion20",props:["info","idCde"],emits:["closeDraw"],setup(D,{emit:A}){te.locale("es");const I=m({ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(l,w)=>{if(!w)return Promise.resolve();const U=w.toString();return U.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):U.startsWith("20")?Promise.resolve():Promise.reject(new Error('El número de RUC debe comenzar con "20"'))},trigger:"change"}]},nameMype:{type:"iText",label:"NOMBRE EMPRESA",name:"nameMype",required:!0,message:"Escribir nombre de la empresa",disabled:!1},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!0,message:"Escribir la dirección del negocio",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},regime_id:{type:"iSelect",label:"RÉGIMEN SOCIETARIO",name:"regime_id",required:!0,message:"Seleccionar el régimen societario",disabled:!1},economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},numbernotary:{type:"iText",label:"NÚM. SOLICITUD CONSTANCIA",name:"numbernotary",required:!0,message:"Escribir número de solicitud de constancia",disabled:!1,maxlength:8,rules:[{validator:(l,w)=>w?w.length!==8?Promise.reject(new Error("El número debe tener exactamente 8 dígitos")):Promise.resolve():Promise.reject(new Error("El número de notaría es requerido")),trigger:"change"}]},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},notary_id:{type:"iSelectNotary",label:"NOTARÍA",name:"notary_id",required:!0,message:"Seleccionar una notaría",disabled:!1},dateReception:{type:"iDate",label:"FECHA DE RECEPCION PNTE",name:"dateReception",required:!0,disabled:!1,disabledDate:l=>!1},dateTramite:{type:"iDate",label:"FEC. TRÁMITE SID SUNARP-SUNAT",name:"dateTramite",required:!0,disabled:!0,disabledDate:l=>a.dateReception&&l&&te(l).isBefore(te(a.dateReception))},isbic:{type:"iSelect",label:"¿ES UNA SOCIEDAD BIC?",name:"isbic",required:!1,message:"Buscar BIC",disabled:!1},montocapital:{type:"iMoney",label:"MONTO DE CAPITAL SOCIAL",name:"montocapital",required:!1,message:"Escribir el Monto de capital social",disabled:!1},typecapital_id:{type:"iSelect",label:"TIPO DE APORTE DE CAPITAL",name:"typecapital_id",required:!1,message:"Seleccionar BIC",disabled:!1}}),b=JSON.parse(localStorage.getItem("profile")),P=A,r=D,O=m("REGISTRAR"),a=ue({}),R=m(!1),e=ne(),G=m(null),f=m({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[]}),n=l=>{console.log("handleInputEvent",l)},F=async l=>{l=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),I.value.dateTramite.disabled=!1)},x=async l=>{l=="city_id"&&(await e.fetchProvinces(a.city_id),f.value.province_id=e.provinces,I.value.province_id.disabled=!1),l=="province_id"&&(await e.fetchDistricts(a.province_id),f.value.district_id=e.districts,I.value.district_id.disabled=!1)},k=async l=>{console.log("handleFocusSelect",l),l=="city_id"&&(await e.fetchCities(),a.city_id=null,a.province_id=null,a.district_id=null,f.value.province_id=[],f.value.city_id=e.cities),l=="province_id"&&(a.province_id=null,a.district_id=null,f.value.district_id=[]),l=="modality_id"&&(await e.fetchModalities(),f.value.modality_id=e.modalities),l=="regime_id"&&(await e.fetchRegimes(),f.value.regime_id=e.regimes),l=="economicsector_id"&&(await e.fetchEconomicSectors(),f.value.economicsector_id=e.economicSectors),l=="comercialactivity_id"&&(await e.fetchComercialActivities(),f.value.comercialactivity_id=e.comercialActivities),l=="notary_id"&&s(),l=="isbic"&&q(),l=="typecapital_id"&&(await e.fetchTypeCapital(),f.value.typecapital_id=e.typeCapital)},B=l=>{},q=()=>{f.value.isbic=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}]},s=async()=>{try{const{data:l}=await Ie({url:"public/notaries-filters",method:"GET"}),w=l.map(U=>({value:U.id,name:U.name,city:U.city.name,province:U.province.name,district:U.district.name,address:U.address}));f.value.notary_id=w}catch(l){console.error("Error de red:",l)}},C=async()=>{R.value=!0;const l={ruc:a.ruc,nameMype:a.nameMype,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,address:a.address,modality_id:a.modality_id,regime_id:a.regime_id,economicsector_id:a.economicsector_id,numbernotary:a.numbernotary,comercialactivity_id:a.comercialactivity_id,notary_id:a.notary_id,dateReception:te(a.dateReception).format("YYYY-MM-DD"),dateTramite:te(a.dateTramite).format("YYYY-MM-DD"),isbic:a.isbic,montocapital:a.montocapital,typecapital_id:a.typecapital_id,user_id:a.user_id,people_id:a.people_id,dni:a.dni,cde_id:a.cde_id};try{(await K({url:"formalization/create-ruc20",method:"POST",data:l})).status===200&&(p(),P("closeDraw",!0))}catch(w){console.error("Error:",w);const U=document.getElementsByClassName("ant-drawer-body")[0];U&&(U.scrollTop=0)}finally{R.value=!1}},p=()=>{a.ruc=null,a.nameMype=null,a.city_id=null,a.province_id=null,a.district_id=null,a.address=null,a.modality_id=null,a.regime_id=null,a.economicsector_id=null,a.numbernotary=null,a.comercialactivity_id=null,a.notary_id=null,a.dateReception=null,a.dateTramite=null,a.isbic=null,a.montocapital=null,a.typecapital_id=null},v=async l=>{l&&(a.user_id=b.user_id,a.people_id=l.id,a.dni=b.documentnumber,a.cde_id=b.cde_id,a.address=l.address,await e.fetchCities(),f.value.city_id=e.cities,a.city_id=l.city_id,await e.fetchProvinces(a.city_id),f.value.province_id=e.provinces,I.value.province_id.disabled=!1,a.province_id=l.province_id,await e.fetchDistricts(a.province_id),f.value.district_id=e.districts,I.value.district_id.disabled=!1,a.district_id=l.district_id)};return de(()=>{r.info&&v(r.info)}),me(()=>r.info,l=>{l&&v(l)}),ye("formState",a),ye("loadingState",R),(l,w)=>(u(),L("div",Pe,[i(Ce,{fields:I.value,options:f.value,btnSaveName:O.value,onHandleInputEvent:n,resetSelect:G.value,onHandleChangeSelect:x,onHandleFocusSelect:k,onHandleBlurSelect:B,onHandleChangeClock:F,onOnSubmit:C},null,8,["fields","options","btnSaveName","resetSelect"])]))}},ce=JSON.parse(localStorage.getItem("role")),$e={dni:{type:"iText",label:"Número de documento de identidad",name:"dni",required:!0,message:"Escribir número de documento",disabled:!1,placeholder:"Número documento"},economicsector_id:{type:"iSelectWrite",label:"Sector económico",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelectWrite",label:"Actividad comercial",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},detailprocedure_id:{type:"iSelect",label:"Detalle del trámite",name:"detailprocedure_id",required:!0,message:"Seleccionar detalle del trámite",disabled:!1},modality_id:{type:"iSelect",label:"Modalidad de atención",name:"modality_id",required:!0,message:"Seleccionar modalidad de atención",disabled:!!ce.some(D=>D.id===7)},ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!0,message:"Escribir el número de RUC",disabled:!1,max:11},city_id:{type:"iSelectWrite",label:"Región del negocio",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelectWrite",label:"Provincia del Negocio",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelectWrite",label:"Distrito del Negocio",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},address:{type:"iText",label:"Direccion del Negocio",name:"address",required:!0,message:"Escribir la direccion del Negocio",disabled:!1}},Me={dni:{type:"iText",label:"Número de documento",name:"dni",required:!0,message:"Escribir número de documento",disabled:!1,placeholder:"Número documento"},economicsector_id:{type:"iSelectWrite",label:"Sector económico",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelectWrite",label:"Actividad comercial",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},component_id:{type:"iSelectWrite",label:"Componente",name:"component_id",required:!0,message:"Seleccionar un componente",disabled:!!ce.some(D=>D.id===7)},theme_id:{type:"iSelectWrite",label:"Tema del componente",name:"theme_id",required:!0,message:"Seleccionar un tema del componente",disabled:!1},modality_id:{type:"iSelect",label:"Modalidad de atención",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!!ce.some(D=>D.id===7)},ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!1,message:"Escribir número de RUC",disabled:!1,placeholder:"Número de RUC (Opcional)",max:11,min:11},city_id:{type:"iSelectWrite",label:"Región del negocio",name:"city_id",required:!0,message:"Seleccionar departamento",disabled:!1},province_id:{type:"iSelectWrite",label:"Provincia del Negocio",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelectWrite",label:"Distrito del Negocio",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},observations:{type:"iTextarea",label:"Nro de Reserva / Observaciones",name:"observations",required:!1,message:"Seleccionar tipo de documento",disabled:!1}};const Le={class:"wrapper-booking"},Ge={class:"grid-booking"},Be={__name:"FormalizacionRUC10",props:["info","idCde"],emits:["closeDraw"],setup(D,{emit:A}){const I=JSON.parse(localStorage.getItem("role")),b=De({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),P=JSON.parse(localStorage.getItem("profile")),r=D,O=A,a=m(!1),R=m(null);m(null),m(!1);const e=ne(),G=m(!1);e.$patch({cities:e.cities}),e.$patch({provinces:e.provinces}),e.$patch({districts:e.districts}),e.$patch({modalities:e.modalities}),e.$patch({detailProcedures:e.detailProcedures}),e.$patch({economicSectors:e.economicSectors}),e.$patch({comercialActivities:e.comercialActivities}),e.fetchDetailProcedures(),e.fetchModalities(),e.fetchEconomicSectors(),e.fetchComercialActivities(),e.fetchCities();const f=m(!0),n=ue({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,address:null,user_id:P.user_id}),F=async()=>{try{G.value=!0;const p={name:R.value};(await K({url:"create/comercial-activities",method:"POST",data:p})).status==200&&(R.value=null,e.fetchComercialActivities())}catch(p){console.log(p)}finally{G.value=!1}},x=p=>{n.province_id=null,n.district_id=null,e.fetchProvinces(p)},k=p=>{n.district_id=null,e.fetchDistricts(p)},B=(p,v)=>{const l=p.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return v.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(l)},q=async()=>{if(a.value=!0,!r.info.id)return H.error("Error al registrar, actualiza la página");const p={dni:n.dni,detailprocedure_id:n.detailprocedure_id,modality_id:n.modality_id,economicsector_id:n.economicsector_id,comercialactivity_id:n.comercialactivity_id,city_id:n.city_id,province_id:n.province_id,district_id:n.district_id,address:n.address,ruc:n.ruc,user_id:P.user_id,people_id:r.info.id,cde_id:r.idCde?r.idCde:null};try{const v=await K({url:"formalization/create-ruc-10",method:"POST",data:p});if(v.status===200){const l={razonSocial:null,ruc:n.ruc,createdFrom:"F10"};H.success(v.message),n.detailprocedure_id=null,n.modality_id=null,n.economicsector_id=null,n.comercialactivity_id=null,n.city_id=null,n.province_id=null,n.district_id=null,n.address=null,n.ruc=null,O("closeDraw",!0)}}catch(v){console.log("Error: "+v)}finally{a.value=!1}},s=()=>{H.warning("Debes de completar todos los espacios requeridos")};function C(){const{documentnumber:p,city_id:v,province_id:l,district_id:w,address:U}=r.info,Y=I.some(j=>j.id===7);n.dni=p,n.city_id=v,x(v),n.province_id=l,k(l),n.district_id=w,n.address=U,Y&&(n.modality_id=1),n.district_id&&setTimeout(()=>{f.value=!1},1500)}return de(()=>{r.info&&C(r.info)}),me(()=>r.info,p=>{p&&C()}),(p,v)=>{const l=y("a-select"),w=y("a-form-item"),U=y("a-input"),Y=y("a-divider"),j=y("a-button"),d=y("a-space"),Z=y("a-form"),E=y("a-spin");return u(),L("div",Le,[i(E,{spinning:f.value},{default:o(()=>[i(Z,{layout:"vertical",model:n,name:"basic",autocomplete:"off",onFinish:q,onFinishFailed:s},{default:o(()=>[h("div",Ge,[(u(!0),L(J,null,ge(N($e),(c,ae)=>(u(),L(J,{key:ae},[c.type==="iSelect"?(u(),S(w,{key:0,class:"item-max",name:c.name,label:c.label,rules:[{required:c.required,message:c.message}]},{default:o(()=>[c.name=="detailprocedure_id"?(u(),S(l,{key:0,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,options:N(e).detailProcedures},null,8,["value","onUpdate:value","options"])):_("",!0),c.name=="modality_id"?(u(),S(l,{key:1,disabled:c.disabled,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,options:N(e).modalities},null,8,["disabled","value","onUpdate:value","options"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0),c.type==="iText"?(u(),S(w,{key:1,name:c.name,label:c.label,rules:[{required:c.required,message:c.message,type:"string",max:c.max},...c.name==="ruc"?[{validator:(T,Q,X)=>{Q?/^(10|15|17)\d{9}$/.test(Q)?X():X(new Error("El RUC debe comenzar con 10, 15 o 17 y tener 11 caracteres en total")):X()}}]:[]]},{default:o(()=>[i(U,{value:n[c.name],"onUpdate:value":T=>n[c.name]=T,disabled:c.name==="dni"&&!!n[c.name],maxlength:c.max,placeholder:c.placeholder},null,8,["value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):_("",!0),c.type==="iSelectWrite"?(u(),S(w,{key:2,class:"item-max",name:c.name,label:c.label,rules:[{required:c.required,message:c.message}]},{default:o(()=>[c.name=="comercialactivity_id"?(u(),S(l,{key:0,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).comercialActivities,"filter-option":B},{dropdownRender:o(({menuNode:T})=>[i(N(b),{vnodes:T},null,8,["vnodes"]),i(Y,{style:{margin:"4px 0"}}),i(d,{style:{padding:"4px 8px"}},{default:o(()=>[i(U,{ref_for:!0,ref:"inputRef",value:R.value,"onUpdate:value":v[0]||(v[0]=Q=>R.value=Q),placeholder:"Nueva actividad"},null,8,["value"]),i(j,{type:"text",onClick:F,loading:G.value},{icon:o(()=>[i(N(Ee))]),default:o(()=>[v[1]||(v[1]=M(" Agregar "))]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):_("",!0),c.name=="economicsector_id"?(u(),S(l,{key:1,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).economicSectors,"filter-option":B},null,8,["value","onUpdate:value","options"])):_("",!0),c.name=="city_id"?(u(),S(l,{key:2,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).cities,"filter-option":B,onChange:x},null,8,["value","onUpdate:value","options"])):_("",!0),c.name=="province_id"?(u(),S(l,{key:3,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).provinces,"filter-option":B,onChange:k,disabled:!n.city_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0),c.name=="district_id"?(u(),S(l,{key:4,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).districts,"filter-option":B,disabled:!n.province_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0)],64))),128))]),i(w,null,{default:o(()=>[i(j,{type:"primary",class:"btn-produce","html-type":"submit",loading:a.value},{default:o(()=>v[2]||(v[2]=[M("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},We=se(Be,[["__scopeId","data-v-84400cbe"]]);const He={class:"wrapper-booking"},Ye={class:"grid-booking"},je={__name:"AsesoriaNuevo",props:["info","idCde"],emits:["closeDraw"],setup(D,{emit:A}){const I=JSON.parse(localStorage.getItem("role")),b=D,P=A,r=ne(),O=JSON.parse(localStorage.getItem("profile")),a=m(!1);m(!1),m(null),m(null),r.$patch({components:r.components}),r.$patch({componentThemes:r.componentThemes}),r.$patch({modalities:r.modalities}),r.$patch({cities:r.cities}),r.$patch({economicSectors:r.economicSectors}),r.$patch({comercialActivities:r.comercialActivities}),r.fetchEconomicSectors(),r.fetchComercialActivities(),r.fetchComponents(),r.fetchModalities(),r.fetchCities();const R=m(!0),e=ue({cde_id:null,dni:null,economicsector_id:null,comercialactivity_id:null,component_id:null,theme_id:null,modality_id:null,ruc:null,city_id:null,province_id:null,district_id:null,observations:null,user_id:O.user_id}),G=s=>{s=="ruc"&&(e[s]=e[s].replace(/\D/g,""))},f=s=>{e.theme_id=null,r.fetchComponentThemes(s)},n=s=>{e.province_id=null,e.district_id=null,r.fetchProvinces(s)},F=s=>{e.district_id=null,r.fetchDistricts(s)},x=(s,C)=>{const p=s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return C.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(p)},k=async()=>{if(a.value=!0,!b.info.id)return H.error("Error al registrar actualiza la página");const s={dni:e.dni,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,observations:e.observations,user_id:O.user_id,people_id:b.info.id,component_id:e.component_id,theme_id:e.theme_id,modality_id:e.modality_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,ruc:e.ruc,cde_id:b.idCde?b.idCde:null};try{const C=await K({url:"advisory/create",method:"POST",data:s});if(C.status===200){const p={razonSocial:null,ruc:e.ruc,createdFrom:"asesorias"};H.success(C.message),e.component_id=null,e.theme_id=null,e.modality_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.observations=null,e.ruc=null,e.economicsector_id=null,e.comercialactivity_id=null,P("closeDraw",!0)}}catch(C){console.log("Error: "+C)}finally{a.value=!1}},B=()=>{H.warning("Debes de completar todos los espacios requeridos")};function q(){const{documentnumber:s,city_id:C,province_id:p,district_id:v}=b.info,l=I.some(w=>w.id===7);e.dni=s,e.city_id=C,n(C),e.province_id=p,F(p),e.district_id=v,l&&(r.fetchComponentThemes(4),e.component_id=4,e.modality_id=1),e.district_id&&setTimeout(()=>{R.value=!1},1500)}return de(()=>{b.info&&q(b.info)}),me(()=>b.info,s=>{s&&q()}),(s,C)=>{const p=y("a-select"),v=y("a-form-item"),l=y("a-textarea"),w=y("a-input"),U=y("a-button"),Y=y("a-form"),j=y("a-spin");return u(),L("div",He,[i(j,{spinning:R.value},{default:o(()=>[i(Y,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:k,onFinishFailed:B},{default:o(()=>[h("div",Ye,[(u(!0),L(J,null,ge(N(Me),(d,Z)=>(u(),L(J,{key:Z},[d.type==="iSelect"?(u(),S(v,{key:0,class:"item-max",name:d.name,label:d.label,rules:[{required:d.required,message:d.message}]},{default:o(()=>[d.name=="modality_id"?(u(),S(p,{key:0,disabled:d.disabled,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,options:N(r).modalities},null,8,["disabled","value","onUpdate:value","options"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0),d.type==="iTextarea"?(u(),S(v,{key:1,name:d.name,label:d.label,rules:[{required:d.required,message:d.message}]},{default:o(()=>[i(l,{value:e[d.name],"onUpdate:value":E=>e[d.name]=E,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):_("",!0),d.type==="iText"?(u(),S(v,{key:2,name:d.name,label:d.label,rules:[{required:d.required,message:d.message,type:d.email,max:d.max}]},{default:o(()=>[i(w,{value:e[d.name],"onUpdate:value":E=>e[d.name]=E,maxlength:d.max,onInput:E=>G(d.name),placeholder:d.placeholder,disabled:d.name==="dni"&&!!e[d.name]},null,8,["value","onUpdate:value","maxlength","onInput","placeholder","disabled"])]),_:2},1032,["name","label","rules"])):_("",!0),d.type==="iSelectWrite"?(u(),S(v,{key:3,class:"item-max",name:d.name,label:d.label,rules:[{required:d.required,message:d.message}]},{default:o(()=>[d.name=="city_id"?(u(),S(p,{key:0,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,"show-search":"",options:N(r).cities,"filter-option":x,onChange:n},null,8,["value","onUpdate:value","options"])):_("",!0),d.name=="province_id"?(u(),S(p,{key:1,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,"show-search":"",options:N(r).provinces,"filter-option":x,onChange:F,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0),d.name=="district_id"?(u(),S(p,{key:2,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,"show-search":"",options:N(r).districts,"filter-option":x,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0),d.name=="economicsector_id"?(u(),S(p,{key:3,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,"show-search":"",options:N(r).economicSectors,"filter-option":x},null,8,["value","onUpdate:value","options"])):_("",!0),d.name=="comercialactivity_id"?(u(),S(p,{key:4,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,"show-search":"",options:N(r).comercialActivities,"filter-option":x},null,8,["value","onUpdate:value","options"])):_("",!0),d.name=="component_id"?(u(),S(p,{key:5,disabled:d.disabled,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,"show-search":"",options:N(r).components,"filter-option":x,onChange:f},null,8,["disabled","value","onUpdate:value","options"])):_("",!0),d.name=="theme_id"?(u(),S(p,{key:6,value:e[d.name],"onUpdate:value":E=>e[d.name]=E,"show-search":"",options:N(r).componentThemes,"filter-option":x,disabled:!e.component_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0)],64))),128))]),i(v,null,{default:o(()=>[i(U,{type:"primary",class:"btn-produce","html-type":"submit",loading:a.value},{default:o(()=>C[0]||(C[0]=[M("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},Ve=se(je,[["__scopeId","data-v-7d34e3f3"]]);const Je={key:0},Ke={key:0},Qe={key:0},Ze={__name:"AsesoriasHistorial",props:["totaladvisories","totalformalization10","totalformalization20"],setup(D){const A=D,I=m("1"),b=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Componente",dataIndex:"component",width:20},{title:"Tema",dataIndex:"theme",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:60},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],P=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Detalle del trámite",dataIndex:"detailprocedure",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:100},{title:"RUC",dataIndex:"ruc",width:50},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],r=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Régimen",dataIndex:"regime",width:80,align:"center"},{title:"Número solicitud constancia",dataIndex:"numbernotary",width:100},{title:"Nombre empresa",dataIndex:"mypename",width:160},{title:"RUC",dataIndex:"ruc",width:80},{title:"Modalidad",dataIndex:"modality",align:"center",width:70},{title:"Ciudad",dataIndex:"city",width:30},{title:"Provincia",dataIndex:"province",width:20},{title:"Distrito",dataIndex:"district",width:20},{title:"Dirección",dataIndex:"address",width:200}],O=a=>Re(a).format("DD/MM/YYYY HH:mm A");return(a,R)=>{const e=y("a-table"),G=y("a-card"),f=y("a-tab-pane"),n=y("a-tabs");return u(),S(n,{activeKey:I.value,"onUpdate:activeKey":R[0]||(R[0]=F=>I.value=F),type:"card",class:"box-hist"},{default:o(()=>[i(f,{key:"1",tab:"ASESORÍAS"},{default:o(()=>[i(G,null,{default:o(()=>[i(e,{columns:b,"data-source":A.totaladvisories,bordered:"",pagination:!1,size:"small",scroll:{x:1200},"expand-column-width":100},{bodyCell:o(({index:F,column:x,record:k})=>[x.dataIndex==="idx"?(u(),L("span",Je,W(F+1),1)):_("",!0),x.dataIndex==="date_start"?(u(),L(J,{key:1},[M(W(O(k.createDate)),1)],64)):_("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),i(f,{key:"2",tab:"RUC 10"},{default:o(()=>[i(G,null,{default:o(()=>[i(e,{columns:P,"data-source":A.totalformalization10,bordered:"",pagination:!1,size:"small",scroll:{x:1800},"expand-column-width":100},{bodyCell:o(({index:F,column:x,record:k})=>[x.dataIndex==="idx"?(u(),L("span",Ke,W(F+1),1)):_("",!0),x.dataIndex==="date_start"?(u(),L(J,{key:1},[M(W(O(k.createDate)),1)],64)):_("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),i(f,{key:"3",tab:"RUC 20"},{default:o(()=>[i(G,null,{default:o(()=>[i(e,{columns:r,"data-source":A.totalformalization20,bordered:"",pagination:!1,size:"small",scroll:{x:2200},"expand-column-width":100},{bodyCell:o(({index:F,column:x,record:k})=>[x.dataIndex==="idx"?(u(),L("span",Qe,W(F+1),1)):_("",!0),x.dataIndex==="date_start"?(u(),L(J,{key:1},[M(W(O(k.createDate)),1)],64)):_("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1},8,["activeKey"])}}},Xe=se(Ze,[["__scopeId","data-v-01e75dfe"]]);const et={class:"asesorias"},tt={class:"wrapper-s"},at={key:0,class:"card-as",style:{padding:"1rem"}},it={__name:"AsesoriasFormalizaciones",setup(D){const A=JSON.parse(localStorage.getItem("role")),I=()=>A.some($=>$.id===7||$.id===13),b=ne(),P=Ne(),r=Ae(),O=m(0),a=m(null),R=m(null),e=m([{value:"asesoria",label:"ASESORÍA"},{value:"ruc20",label:"RUC 20"},{value:"ruc10",label:"RUC 10"}]);b.$patch({cdes:b.cdes}),b.fetchCdes();const G=m(null),f=m(!1),n=m(null);m(!1);const F=m(!1);m(!1);const x=m(!1),k=m(!1),B=m(!1),q=m(""),s=m([]),C=m(!1),p=m(0);m(!1);const v=m([]);m(null);const l=m([]),w=m([]),U=m([]),Y=m(!1),j=$=>{R.value.cde_id=$,localStorage.setItem("profile",JSON.stringify(R.value))},d=($,t)=>{const V=$.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(V)},Z=()=>{_e(q.value),f.value=!1},E=()=>{ae()},c=()=>{q.value=q.value.replace(/\D/g,"")},ae=()=>{Y.value=!1,q.value="",s.value=[],v.value=[],P.push({name:"asesorias-formalizaciones"})},T=()=>{if(n.value=null,n.value=s.value,!a.value)return H.warning("Seleccionar un tipo de servicio");a.value=="asesoria"&&(B.value=!0),a.value=="ruc10"&&(k.value=!0),a.value=="ruc20"&&X()},Q=()=>{const $={id:s.value.id,typedocument_id:s.value.typedocument_id,document:s.value.documentnumber,lastname:s.value.lastname,middlename:s.value.middlename,name:s.value.name,country_id:s.value.country_id,city_id:s.value.city_id,province_id:s.value.province_id,district_id:s.value.district_id,address:s.value.address,birthday:s.value.birthday,phone:s.value.phone,email:s.value.email,gender_id:s.value.gender_id,sick:s.value.sick,hasSoon:s.value.hasSoon};G.value=$,f.value=!0},X=()=>{p.value=0,x.value=!0,F.value=!1},ie=async()=>{C.value=!0;const $=await K({url:`person/found/${O.value}/${q.value}`,method:"GET"});if($.status==200)return s.value=$.data,ve(s.value.id),C.value=!1},_e=async $=>{if(C.value=!0,!$)return H.warning("Ingresa un número de documento"),C.value=!1;if(O.value==0)return H.warning("Seleccionar el tipo de documento"),C.value=!1;if(O.value==1&&q.value.length<8){H.warning("El número de DNI está incompleto"),C.value=!1;return}const t=await K({url:`person/found/${O.value}/${q.value}`,method:"GET"});if(t.status==200)return s.value=t.data,ve(t.data.id),R.value=JSON.parse(localStorage.getItem("profile")),C.value=!1;if(t.status===404){const V={type:O.value,access:"asesorias",number:q.value};P.push({name:"registrar-persona",query:V})}},ve=async $=>{try{const{data:t}=await K({url:`historial/registers/${$}`,method:"GET"});l.value=t.advisories,w.value=t.formalization10,U.value=t.formalization20,Y.value=!0}catch(t){console.error("Error de red:",t)}};return de(()=>{r.query.type&&(O.value=r.query.type,q.value=r.query.number)}),($,t)=>{const V=y("a-radio"),ee=y("a-tooltip"),he=y("a-radio-group"),Se=y("a-input-search"),re=y("a-card"),z=y("a-col"),oe=y("a-row"),fe=y("a-select"),xe=y("a-button"),le=y("a-drawer");return u(),L(J,null,[h("div",et,[t[32]||(t[32]=h("h3",{class:"title-produce"},"REGISTRO DE FORMALIZACIONES Y ASESORÍAS",-1)),t[33]||(t[33]=h("br",null,null,-1)),i(re,{class:"card-as card-gray"},{default:o(()=>[N(r).query.dni?(u(),S(N(ke),{key:0,class:"ico-reload",onClick:E})):_("",!0),h("div",tt,[h("div",null,[t[19]||(t[19]=h("label",{class:"label"},"Seleccione el tipo de documento",-1)),i(he,{value:O.value,"onUpdate:value":t[0]||(t[0]=g=>O.value=g),onChange:ae,class:"radio-produce"},{default:o(()=>[i(ee,{color:"cyan"},{title:o(()=>t[11]||(t[11]=[M("Documento Nacional de Identidad")])),default:o(()=>[i(V,{value:"1"},{default:o(()=>t[12]||(t[12]=[M("DNI")])),_:1})]),_:1}),i(ee,{color:"cyan"},{title:o(()=>t[13]||(t[13]=[M("Carnet de Extranjería")])),default:o(()=>[i(V,{value:"2"},{default:o(()=>t[14]||(t[14]=[M("CE")])),_:1})]),_:1}),i(ee,{color:"cyan"},{title:o(()=>t[15]||(t[15]=[M("Pasaporte")])),default:o(()=>[i(V,{value:"3"},{default:o(()=>t[16]||(t[16]=[M("PAS")])),_:1})]),_:1}),i(ee,{color:"cyan"},{title:o(()=>t[17]||(t[17]=[M("Permiso Temporal de Permanencia")])),default:o(()=>[i(V,{value:"4"},{default:o(()=>t[18]||(t[18]=[M("PTP")])),_:1})]),_:1})]),_:1},8,["value"])]),h("div",null,[t[20]||(t[20]=h("label",{class:"label"},"Digite el número de documento",-1)),i(Se,{"enter-button":"BUSCAR",value:q.value,"onUpdate:value":t[1]||(t[1]=g=>q.value=g),placeholder:"",loading:C.value,onSearch:_e,onInput:c,class:"search-produce",maxlength:O.value==1?8:20},null,8,["value","loading","maxlength"])])])]),_:1}),i(oe,{gutter:[16,16]},{default:o(()=>[i(z,{xs:24,sm:24,lg:12},{default:o(()=>[s.value.length!=0?(u(),S(re,{key:0},{default:o(()=>[t[27]||(t[27]=h("h4",{class:"title-produce"},"RESULTADO DE LA BÚSQUEDA",-1)),i(N(Ue),{class:"box-icoedit",onClick:Q}),i(oe,{gutter:[0,2],class:"box-info"},{default:o(()=>[i(z,{xs:12,sm:8},{default:o(()=>t[21]||(t[21]=[h("b",{class:"box-title"},"Apellidos y nombres:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>[h("span",null,W(s.value.lastname)+" "+W(s.value.middlename)+", "+W(s.value.name),1)]),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[22]||(t[22]=[h("b",{class:"box-title"},"Número de celular:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>[h("span",null,W(s.value.phone?s.value.phone:"-"),1)]),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[23]||(t[23]=[h("b",{class:"box-title"},"Correo electrónico:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>[h("span",null,W(s.value.email?s.value.email:"-"),1)]),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[24]||(t[24]=[h("b",{class:"box-title"},"Asesorías:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>{var g;return[h("span",null,W((g=s.value)==null?void 0:g.idadvisory.length),1)]}),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[25]||(t[25]=[h("b",{class:"box-title"},"Formalizaciones RUC 20:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>{var g;return[h("span",null,W((g=s.value)==null?void 0:g.idformalization20.length),1)]}),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[26]||(t[26]=[h("b",{class:"box-title"},"Formalizaciones RUC 10:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>{var g;return[h("span",null,W((g=s.value)==null?void 0:g.idformalization10.length),1)]}),_:1})]),_:1})]),_:1})):_("",!0)]),_:1}),i(z,{xs:24,sm:24,lg:12},{default:o(()=>[s.value.length!=0?(u(),S(re,{key:0,style:{height:"100%"}},{default:o(()=>[i(oe,{gutter:[16,24]},{default:o(()=>[I()?_("",!0):(u(),S(z,{key:0,xs:24,sm:18,md:12,lg:12},{default:o(()=>[t[28]||(t[28]=h("h4",{class:"title-produce"},"SELECCIONAR CDE",-1)),i(fe,{class:"w-100",value:R.value.cde_id,"onUpdate:value":t[2]||(t[2]=g=>R.value.cde_id=g),options:N(b).cdes,"show-search":"","filter-option":d,onChange:j},null,8,["value","options"])]),_:1})),i(z,{xs:24,sm:18,md:12,lg:17},{default:o(()=>[t[30]||(t[30]=h("h4",{class:"title-produce"},"¿DESEA REGISTRAR UN NUEVO SERVICIO?",-1)),i(oe,{gutter:[10,0]},{default:o(()=>[i(z,{xs:17,sm:18},{default:o(()=>[i(fe,{class:"w-100",value:a.value,"onUpdate:value":t[3]||(t[3]=g=>a.value=g),options:e.value},null,8,["value","options"])]),_:1}),i(z,{xs:6},{default:o(()=>[i(xe,{type:"primary",onClick:T},{default:o(()=>t[29]||(t[29]=[M("REGISTRAR")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1}),Y.value?(u(),L("div",at,[t[31]||(t[31]=h("h4",{class:"title-produce"},"HISTORIAL",-1)),i(Xe,{totaladvisories:l.value,totalformalization10:w.value,totalformalization20:U.value},null,8,["totaladvisories","totalformalization10","totalformalization20"])])):_("",!0)]),h("section",null,[i(le,{title:"Regitsrar una Formalización con RUC 20",open:x.value,"onUpdate:open":t[5]||(t[5]=g=>x.value=g),placement:"right",width:"500px"},{default:o(()=>[i(Fe,{info:n.value,idCde:R.value.cde_id,onCloseDraw:t[4]||(t[4]=g=>(x.value=!1,ie()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(le,{width:"600px",title:"Regitsrar Formalización con RUC 10",open:k.value,"onUpdate:open":t[7]||(t[7]=g=>k.value=g),placement:"right"},{default:o(()=>[i(We,{info:s.value,idCde:R.value.cde_id,onCloseDraw:t[6]||(t[6]=g=>(k.value=!1,ie()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(le,{width:"600px",title:"Registrar una asesoría",open:B.value,"onUpdate:open":t[9]||(t[9]=g=>B.value=g),placement:"right"},{default:o(()=>[i(Ve,{info:s.value,idCde:R.value.cde_id,onCloseDraw:t[8]||(t[8]=g=>(B.value=!1,ie()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(le,{width:"600",open:f.value,"onUpdate:open":t[10]||(t[10]=g=>f.value=g),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:o(()=>[i(Oe,{onCloseDraw:Z,info:G.value},null,8,["info"])]),_:1},8,["open"])])],64)}}},pt=se(it,[["__scopeId","data-v-c71f4fcb"]]);export{pt as default};
