import{_ as O}from"./icoexcel-a1d0882d.js";import{r as t,g as P,E as j,L as G,n as H,b as s,o as a,d as h,e as l,c as m,w as o,i as J,s as n,F as y,U as X,G as Y,h as $,j as r,x as _}from"./index-ffd0116b.js";const q=l("h3",null,"LISTA DE MYPE",-1),K={class:"w-search"},Q=l("img",{width:"20",style:{"margin-right":"6px"},src:O},null,-1),W={class:"paginator"},Z={key:0,class:"full-spin"},ne={__name:"MypesRD",setup(ee){const C="https://apituempresa.soporte-pnte.com/api/v1",b="http://127.0.0.1:8000/api/v1",D=window.location.hostname=="127.0.0.1"?b:C,i=t(!1),c=t(null),N=P.get("token"),v=t([]),g=t(!1),A=t(1200);t("");const w=t(0),I=t(window.innerHeight-100),x=()=>{I.value=window.innerHeight-300};j(()=>{window.removeEventListener("resize",x)});const z=G(X,{style:{fontSize:"40px"},spin:!0}),E=t({page:1}),R=[{title:"RUC",dataIndex:"ruc",fixed:"left",width:120},{title:"Razón social",dataIndex:"socialReason",fixed:"left",width:250},{title:"Rubro",dataIndex:"category",width:200},{title:"Tipo",dataIndex:"type",align:"center",width:140},{title:"Departamento",dataIndex:"department",width:140},{title:"Distrito",dataIndex:"district",width:130},{title:"Nombres y Apellidos",dataIndex:"nameComplete",width:300},{title:"DNI",dataIndex:"dniNumber",align:"center",width:120},{title:"Sexo",dataIndex:"sex",align:"center",width:130},{title:"Teléfono",dataIndex:"phone",align:"center",width:130},{title:"Email",dataIndex:"email",width:300}],S=e=>{E.value.page=e,f()},U=()=>{let e=document.createElement("input");e.type="file",e.accept=".xls, .xlsx",e.onchange=d=>{c.value=d.target.files[0],B()},e.click()},B=()=>{if(!c.value){alert("Por favor selecciona un archivo Excel.");return}i.value=!0;const e=new FormData;e.append("file",c.value),Y.post(`${D}/import-excel`,e,{headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${N}`}}).then(()=>{L()}).catch(d=>{console.error("Error al subir el archivo",d)}).finally(()=>{c.value=null})},L=()=>setInterval(()=>v.value.length<1?f():i.value=!1,6e3),f=async()=>{try{g.value=!0;const e=await $({url:"/mype",method:"GET",params:E.value});v.value=e.data,w.value=e.meta.total}catch(e){console.error("Error de red:",e)}finally{g.value=!1}};return H(()=>{f(),window.addEventListener("resize",x),x()}),(e,d)=>{const M=s("a-button"),u=s("a-tag"),T=s("a-table"),F=s("a-pagination"),V=s("a-spin");return a(),h(y,null,[l("div",null,[q,l("div",K,[l("div",null,[m(M,{onClick:U,loading:i.value},{default:o(()=>[Q,r(" SUBIR EXCEL ")]),_:1},8,["loading"])])]),m(T,{bordered:"",class:"ant-table-striped",sticky:"",scroll:{x:A.value,y:I.value},columns:R,"data-source":v.value,pagination:!1,loading:g.value,size:"small"},{bodyCell:o(({column:k,record:p})=>[k.dataIndex=="type"?(a(),h(y,{key:0},[p.type=="NATURAL"?(a(),_(u,{key:0,color:"success"},{default:o(()=>[r("Natural")]),_:1})):n("",!0),p.type=="JURIDICA"?(a(),_(u,{key:1,color:"error"},{default:o(()=>[r("Jurídica")]),_:1})):n("",!0)],64)):n("",!0),k.dataIndex=="sex"?(a(),h(y,{key:1},[p.sex=="MASCULINO"?(a(),_(u,{key:0,color:"blue"},{default:o(()=>[r("Masculino")]),_:1})):n("",!0),p.sex=="FEMENINO"?(a(),_(u,{key:1,color:"pink"},{default:o(()=>[r("Femenino")]),_:1})):n("",!0)],64)):n("",!0)]),_:1},8,["scroll","data-source","loading"])]),l("div",W,[m(F,{size:"small",pageSize:50,total:w.value,onChange:S,showSizeChanger:!1},null,8,["total"])]),i.value?(a(),h("div",Z,[m(V,{indicator:J(z),spinning:i.value},null,8,["indicator","spinning"])])):n("",!0)],64)}}};export{ne as default};
