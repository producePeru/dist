import{r as a,u as oe,s as le,T as se,j as ie,b as c,o as l,d,e as _,c as s,h as b,w as p,F as r,J as C,i as m,t as u,q as i,p as R,$ as de,I as re,G as ue,m as ce}from"./index-518b448a.js";import{u as pe}from"./selectes-9c154f1c.js";import"./asesorias-581a11a2.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";import{S as _e}from"./DrawerSolicitante.componente-b2d48e85.js";import{M as ve}from"./MoreOutlined-f8cca501.js";import"./es-2e1f889a.js";const fe={class:"filters-dig"},he=["onClick"],ge=["onClick"],xe=["onClick"],ye={class:"paginator"},F=20,we={__name:"SolicitudesLista",setup(Ie){const h=pe();h.$patch({cdes:h.cdes}),h.fetchCdes();const g=a(!1),z=a(null);a(!1),a(!1),a(!1),a(0),a(!1);const E=a(!1);a(!1),a("solicitante"),a(5);const S=a([]),y=a(!1),D=a(0),T=oe(),x=a({page:1});a("");const w=a("formalization/digital-list");a([]);const N=a(null),U=a(1200),A=a(window.innerHeight-100),I=()=>{A.value=window.innerHeight-300};le(()=>{window.removeEventListener("resize",I)});const V=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Apellidos",dataIndex:"lastName",fixed:"left",width:150},{title:"Nombres",dataIndex:"name",fixed:"left",width:150},{title:"DNI",dataIndex:"number_document",align:"center",width:90},{title:"Departamento",dataIndex:"department",width:140},{title:"Provincia",dataIndex:"province",width:140},{title:"Distrito",dataIndex:"district",width:140},{title:"CDE Atención",dataIndex:"cde",width:140},{title:"Celular",dataIndex:"phone",width:100},{title:"Correo",dataIndex:"email",width:200},{title:"Atendido",dataIndex:"statu",align:"center",width:100},{title:"Reserva de nombre",dataIndex:"reserva",align:"center",width:160},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],B=e=>{z.value=e.people,g.value=!0},M=()=>{v(),g.value=!1},O=a([{value:1,label:"Aprobado"},{value:2,label:"Desaprobado"},{value:3,label:"Pendiente"}]),P=e=>{x.value.page=e,v()},q=async e=>{const t={type:e.people.typedocument_id,number:e.people.documentnumber,formalizaciondigital:e.id};T.push({name:"asesorias-formalizaciones",query:t})},G=e=>{if(e!=1e3){w.value=`/formalization-digital?department=${e}`,v();return}w.value="/formalization-digital",v()},H=async e=>{const t={booking:e};await C({url:`/formalization-digital-status/${E.value.documentnumber}`,method:"PATCH",data:t})},Q=e=>{E.value=e},j=async e=>{try{const t=await C({url:`formalization/delete/${e.id}`,method:"DELETE"});t.status==200&&(v(),ce.success(t.message))}catch(t){console.error("Error de red:",t)}},v=async()=>{try{y.value=!0;let e=x.value.page==1?"":x.value;const{data:t}=await C({url:w.value,method:"GET",params:e});S.value=t.data,D.value=t.total}catch(e){console.error("Error de red:",e)}finally{y.value=!1}},J=se(()=>e=>(x.value.page-1)*F+e+1);return ie(()=>{v(),window.addEventListener("resize",I),I()}),(e,t)=>{const L=c("a-select"),X=c("a-checkbox"),Y=c("a-button"),k=c("a-menu-item"),Z=c("a-popconfirm"),K=c("a-menu"),W=c("a-dropdown"),ee=c("a-table"),te=c("a-pagination"),ae=c("a-drawer");return l(),d(r,null,[_("div",null,[t[4]||(t[4]=_("h3",null,"SOLICITUDES DE FORMALIZACIÓN DIGITAL",-1)),_("div",fe,[s(L,{value:N.value,"onUpdate:value":t[0]||(t[0]=o=>N.value=o),placeholder:"Filtrar por CDES",options:b(h).cdes,onChange:G},null,8,["value","options"])]),s(ee,{bordered:"",scroll:{x:U.value,y:A.value},class:"ant-table-striped",columns:V,"data-source":S.value,pagination:!1,loading:y.value,size:"small"},{bodyCell:p(({column:o,record:n,index:ne})=>{var $;return[o.dataIndex=="idx"?(l(),d(r,{key:0},[m(u(J.value(ne)),1)],64)):i("",!0),o.dataIndex=="lastName"?(l(),d(r,{key:1},[m(u(n.people.lastname)+" "+u(n.people.middle),1)],64)):i("",!0),o.dataIndex=="name"?(l(),d(r,{key:2},[m(u(n.people.name),1)],64)):i("",!0),o.dataIndex=="number_document"?(l(),d(r,{key:3},[m(u(n.people.documentnumber),1)],64)):i("",!0),o.dataIndex=="department"?(l(),d(r,{key:4},[m(u(n.people.city.name),1)],64)):i("",!0),o.dataIndex=="province"?(l(),d(r,{key:5},[m(u(n.people.province.name),1)],64)):i("",!0),o.dataIndex=="district"?(l(),d(r,{key:6},[m(u(n.people.district.name),1)],64)):i("",!0),o.dataIndex=="phone"?(l(),d(r,{key:7},[m(u(n.people.phone),1)],64)):i("",!0),o.dataIndex=="email"?(l(),d(r,{key:8},[m(u(n.people.email),1)],64)):i("",!0),o.dataIndex=="cde"?(l(),d(r,{key:9},[m(u(($=n.cde)==null?void 0:$.name),1)],64)):i("",!0),o.dataIndex=="statu"?(l(),R(X,{key:10,checked:n.attended!=0,disabled:""},null,8,["checked"])):i("",!0),o.dataIndex=="reserva"?(l(),d("div",{key:11,onClick:f=>Q(n)},[s(L,{disabled:n.attended==0,value:n.status,"onUpdate:value":f=>n.status=f,placeholder:"Escoger el proceso",style:{width:"90%"},options:O.value,onChange:H},null,8,["disabled","value","onUpdate:value","options"])],8,he)):i("",!0),o.dataIndex=="actions"?(l(),R(W,{key:12,trigger:["click"]},{overlay:p(()=>[s(K,null,{default:p(()=>[s(k,null,{default:p(()=>[_("a",{onClick:f=>q(n)},"Formalizar",8,ge)]),_:2},1024),s(k,null,{default:p(()=>[_("a",{onClick:f=>B(n)},"Editar datos",8,xe)]),_:2},1024),s(k,null,{default:p(()=>[s(Z,{title:"¿Eliminar?",onConfirm:f=>j(n)},{icon:p(()=>[s(b(de),{style:{color:"red"}})]),default:p(()=>[t[3]||(t[3]=_("a",null,"Quitar de la lista",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:p(()=>[_("a",{class:"ant-dropdown-link",onClick:t[1]||(t[1]=re(()=>{},["prevent"]))},[s(Y,{shape:"circle",icon:ue(b(ve)),size:"small"},null,8,["icon"])])]),_:2},1024)):i("",!0)]}),_:1},8,["scroll","data-source","loading"])]),_("div",ye,[s(te,{size:"small",total:D.value,pageSize:F,onChange:P,showSizeChanger:!1},null,8,["total"])]),s(ae,{open:g.value,"onUpdate:open":t[2]||(t[2]=o=>g.value=o),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:p(()=>[s(_e,{onCloseDraw:M,updateValues:z.value},null,8,["updateValues"])]),_:1},8,["open"])],64)}}},Ne=me(we,[["__scopeId","data-v-69e04d44"]]);export{Ne as default};
