import{r as u,l as X,u as Y,a as ee,D as w,n as ae,b as c,o as l,d as g,e as D,t as te,i as ne,B as i,c as _,w as p,F as k,f as U,h as C,m as q,v as le,s as m,j as se,p as oe,k as re}from"./index-da4b24a2.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";const ie={document_type:{type:"iSelect",label:"Tipo de documento",name:"document_type",required:!0,message:"Seleccionar tipo de documento",disabled:!0},number_document:{type:"iSearch",label:"Ingresar número",name:"number_document",required:!0,message:"Escribe número de documento",disabled:!0},last_name:{type:"iText",label:"Apellido Paterno",name:"last_name",required:!0,message:"Escribir apellido",disabled:!1},middle_name:{type:"iText",label:"Apellido Materno",name:"middle_name",required:!0,message:"Escribir apellido",disabled:!1},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribir nombre",disabled:!1},department:{type:"iSelect",label:"Departamento",name:"department",required:!1,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelect",label:"Provincia",name:"province",required:!1,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelect",label:"Distrito",name:"district",required:!1,message:"Seleccionar distrito",disabled:!1},phone:{type:"iText",label:"Número Telefónico del contacto",name:"phone",required:!1,message:"Número de contacto y 9 max",max:9,disabled:!1},email:{type:"iText",label:"Correo electrónico",name:"email",required:!1,message:"Número de contacto y 9 max",email:"email",disabled:!1}};const ue=v=>(oe("data-v-8b070d92"),v=v(),re(),v),ce={class:"uppercase"},me=ue(()=>D("br",null,null,-1)),pe={key:1,class:"agreement-wrapper"},be={class:"grid-item"},_e={__name:"ActualizarPersona",setup(v){const r=u(ie),y=X(),S=Y(),A=u(!0),I=u(!1),x=u(!1),T=u([]),h=u([]),b=u([]),F=[{label:"DNI",value:"dni"},{label:"CE",value:"ce"},{label:"PAS",value:"pas"},{label:"PTP",value:"ptp"}],e=ee({document_type:"dni",number_document:null,last_name:null,middle_name:null,name:null,department:null,province:null,district:null,phone:null,email:null,created_by:w,update_by:w,post:y.query.access}),E=()=>{e.document_type=null,e.number_document=null,e.last_name=null,e.middle_name=null,e.name=null,e.department=null,e.province=null,e.district=null,e.phone=null,e.email=null},B=()=>{r.value.document_type.disabled=!0,r.value.number_document.disabled=!0,r.value.name.disabled=!0,r.value.department.disabled=!0,r.value.province.disabled=!0,r.value.district.disabled=!0,r.value.phone.disabled=!0,r.value.email.disabled=!0},R=()=>{e.number_document=e.number_document.replace(/\D/g,"")},G=async()=>{},z=t=>{E(),B(),e.document_type=t},V=(t,n)=>{e.province=null,e.district=null,h.value=[],b.value=[],N(n.value)},$=(t,n)=>{e.district=null,b.value=[],P(n.value)},L=()=>{const t=y.query.access;t==1&&S.push("/admin/asesorias/supervisores"),t==2&&S.push("/admin/asesorias/asesores"),t==3&&S.push("/admin/asesorias/solicitantes")},M=async()=>{try{const{data:t}=await U({url:"/departaments",method:"GET"});let n=t.map(d=>({label:d.label,value:d.id}));T.value=[...T.value,...n]}catch(t){console.log(t)}},N=async t=>{try{const{data:n}=await U({url:`/province/${t}`,method:"GET"});let d=n.map(o=>({label:o.label,value:o.id}));h.value=[...h.value,...d]}catch(n){console.log(n)}},P=async t=>{try{const{data:n}=await U({url:`/district/${t}`,method:"GET"});let d=n.map(o=>({label:o.label,value:o.id}));b.value=[...b.value,...d]}catch(n){console.log(n)}},j=async()=>{const t=e;x.value=!0;try{await C({url:"/new-person",method:"POST",data:t})&&(E(),L(),q.success("Usuario actualizado exitosamente."))}catch(n){if(n.response.status==550)return q.error("El usuario ya se encuentra registrado");q.error("Error al registrar")}finally{x.value=!1}},O=()=>{q.error("Debes de completar todos los espacios requeridos")},Z=async()=>{try{const{data:t}=await C({url:`/person-by-dni/${y.query.dni}`,method:"GET"});N(t.department),P(t.province),e.document_type=t.document_type,e.number_document=t.number_document,e.last_name=t.last_name,e.middle_name=t.middle_name,e.name=t.name,e.department=t.department,e.province=t.province,e.district=t.district,e.phone=t.phone,e.email=t.email,A.value=!1}catch(t){console.error("Error de red:",t)}};return ae(()=>{M(),Z()}),(t,n)=>{const d=c("a-spin"),o=c("a-select"),f=c("a-form-item"),H=c("a-input-search"),J=c("a-input"),K=c("a-button"),Q=c("a-form");return l(),g(k,null,[D("h3",ce,"ACTUALIZAR "+te(ne(y).query.rol),1),me,A.value?(l(),i(d,{key:0})):(l(),g("div",pe,[_(Q,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:j,onFinishFailed:O},{default:p(()=>[D("div",be,[(l(!0),g(k,null,le(r.value,(a,W)=>(l(),g(k,{key:W},[a.type==="iSelect"?(l(),i(f,{key:0,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[a.name=="document_type"?(l(),i(o,{key:0,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:F,disabled:a.disabled,onChange:z},null,8,["value","onUpdate:value","disabled"])):m("",!0),a.name=="department"?(l(),i(o,{key:1,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:T.value,onChange:V,disabled:a.disabled},null,8,["value","onUpdate:value","options","disabled"])):m("",!0),a.name=="province"?(l(),i(o,{key:2,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:h.value,onChange:$,disabled:a.disabled},null,8,["value","onUpdate:value","options","disabled"])):m("",!0),a.name=="district"?(l(),i(o,{key:3,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:b.value,disabled:a.disabled},null,8,["value","onUpdate:value","options","disabled"])):m("",!0)]),_:2},1032,["name","label","rules"])):m("",!0),a.type==="iSearch"?(l(),i(f,{key:1,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:p(()=>[_(H,{maxlength:15,loading:I.value,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,"enter-button":"",onSearch:G,onInput:R,disabled:a.disabled},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):m("",!0),a.type==="iText"?(l(),i(f,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,type:a.email,max:a.max}]},{default:p(()=>[_(J,{value:e[a.name],"onUpdate:value":s=>e[a.name]=s,disabled:a.disabled},null,8,["value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):m("",!0)],64))),128))]),_(f,null,{default:p(()=>[_(K,{type:"primary","html-type":"submit",loading:x.value},{default:p(()=>[se("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]))],64)}}},he=de(_e,[["__scopeId","data-v-8b070d92"]]);export{he as default};
