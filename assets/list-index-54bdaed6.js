import{_ as Q}from"./TableComponent-21fe80cc.js";import{r as s,u as J,a as Z,l as D,j as K,a6 as x,b as p,o as r,d as v,c as l,w as o,R as Y,f as W,t as X,y as d,F as R,x as y,i as h,e as E,h as ee,a2 as ae,m as O}from"./index-9c6c0fd4.js";import{_ as te}from"./EventosUgo-7c8fb972.js";import{d as ne}from"./downloadExcel-e357f153.js";import{g as oe}from"./usePermissions-ab66ce69.js";import"./es-17530f10.js";import"./icoexcel-1b303edf.js";import"./selectes-cfeac481.js";import"./MoreOutlined-cbbd903c.js";const se={class:"advisory-table"},re={key:0},le=["href"],ie=["onClick"],de=["onClick"],Ee={__name:"list-index",setup(ce){JSON.parse(localStorage.getItem("role"));const C=s([]),S=s(0),N=s(150),_=s({}),m=s(!1);J();const I=s(!1),g=s(null),w=s(!1),A=s([]),a=Z({year:D("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),b=[{title:"ASESOR",dataIndex:"asesor",fixed:"left",width:180},{title:"DESCRIPCIÓN",dataIndex:"description",width:450},{title:"NOMBRE DE LA ACTIVIDAD",dataIndex:"title",width:220},{title:"INSCRITOS",dataIndex:"attendance_list_count",width:100,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:150},{title:"DISTRITO",dataIndex:"district",width:150},{title:"LUGAR",dataIndex:"address",width:180},{title:"FECHA CREACIÓN",dataIndex:"created_at",width:140,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],F=s([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]),V=e=>{g.value=e,m.value=!0},L=()=>{c(),m.value=!1},M=()=>{g.value=null,m.value=!0},U=async e=>{try{const t=await Y({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(c(),O.success(t.message))}catch(t){console.error("Error de red:",t)}},$=async e=>{try{const t=await Y({url:`attendance/event-finally/${e.id}`,method:"PUT"});t.status==200&&(c(),O.success(t.message))}catch(t){console.error("Error de red:",t)}},B=async()=>{w.value=!0;try{const e={};a.year&&(e.year=D(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor),await ne("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{w.value=!1}},G=async e=>{a.page=e,await c()},H=async e=>{e&&(a.page=1,await c())},c=async()=>{try{I.value=!0;const e={page:a.page};a.year&&(e.year=D(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor);const i=await Y({url:"attendance/list",method:"GET",params:e});C.value=i.data.data,S.value=i.data.total,N.value=i.data.per_page}catch(e){console.error("Error de red:",e)}finally{I.value=!1}},P=async()=>{try{const e=await W({url:"select/asesores",method:"GET"});e.status==200&&(A.value=e.data)}catch{console.log("Failed to delete")}};return K(async()=>{_.value=await oe("eventos-ugo-lista"),await c(),await P()}),x("search",a),x("loading",I),x("loadingFile",w),(e,t)=>{const i=p("a-tag"),f=p("a-menu-item"),z=p("router-link"),j=p("a-popconfirm"),q=p("a-drawer");return r(),v("div",se,[l(Q,{title:"LISTA EVENTOS UGO",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:b,othersList:F.value,titleSearch:"BUSCAR POR EVENTO",pageSize:N.value,nameTotal:"Eventos UGO",asesoresList:A.value,dataSource:C.value,total:S.value,btnUpdate:!0,onHandleNew:M,onHandleDownloadExcel:B,onHandleSearch:H,permisos:_.value,onHandleCallFetchData:c,onHandlePaginator:G,btnImport:!0},{"data-cell":o(({column:n,record:u})=>[n.dataIndex=="type_activity"?(r(),v("span",re,X(u.pnte),1)):d("",!0),n.dataIndex=="modality"?(r(),v(R,{key:1},[u.modality=="p"?(r(),y(i,{key:0,color:"blue"},{default:o(()=>t[1]||(t[1]=[h("PRESENCIAL")])),_:1})):d("",!0),u.modality=="v"?(r(),y(i,{key:1,color:"orange"},{default:o(()=>t[2]||(t[2]=[h("VIRTUAL")])),_:1})):d("",!0)],64)):d("",!0),n.dataIndex=="dateDiff"?(r(),v(R,{key:2},[u.finally?(r(),y(i,{key:0,color:"red"},{default:o(()=>t[3]||(t[3]=[h(" FINALIZADO ")])),_:1})):d("",!0)],64)):d("",!0)]),"custom-options":o(({record:n})=>{var u,k;return[l(f,null,{default:o(()=>[E("a",{href:n.eventsoffice_id===3?`https://inscripcion.soporte-pnte.com/fortalece-tu-mercado/${n.slug}`:`/asistencias/${n.slug}`,target:"_blank"}," Ver Link ",8,le)]),_:2},1024),l(f,null,{default:o(()=>[l(z,{to:`inscritos/${n.slug}`},{default:o(()=>t[4]||(t[4]=[h("Inscritos")])),_:2},1032,["to"])]),_:2},1024),l(f,null,{default:o(()=>[E("a",{onClick:T=>V(n)},"Editar",8,ie)]),_:2},1024),(u=_.value)!=null&&u.can_finish?(r(),y(f,{key:0},{default:o(()=>[E("span",{style:{color:"#ff4d4f"},onClick:T=>$(n)},"Finalizar",8,de)]),_:2},1024)):d("",!0),(k=_.value)!=null&&k.can_delete?(r(),y(f,{key:1},{default:o(()=>[l(j,{placement:"rightBottom",title:`¿Quieres eliminar ${n.title} ?`,onConfirm:T=>U(n)},{icon:o(()=>[l(ee(ae),{style:{color:"red"}})]),default:o(()=>[t[5]||(t[5]=E("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):d("",!0)]}),_:1},8,["othersList","pageSize","asesoresList","dataSource","total","permisos"]),l(q,{open:m.value,"onUpdate:open":t[0]||(t[0]=n=>m.value=n),title:g.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD",placement:"right",width:"550"},{default:o(()=>[l(te,{onCloseDraw:L,dataRow:g.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{Ee as default};
