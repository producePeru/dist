import{g as o,e as ie,f as re,x as de,l as ue,r as l,o as s,a5 as I,a6 as c,a as n,w as t,L as f,F as h,c as p,aa as r,a8 as A,u as N,I as ce,h as pe}from"./quill-blot-formatter-a5546f64.js";import{_ as me}from"./NuevaFeria-9f292127.js";import{d as F,u as fe,a as _e,e as M,Q as ge,m as ve}from"./index-6c585ad7.js";import{u as Ie}from"./selectes-7997193c.js";import"./es-404c064e.js";import{C as ye}from"./CloudOutlined-87f15e29.js";import{M as we}from"./MoreOutlined-50e846f4.js";const xe={key:1},he=["onClick"],Ee=["onClick"],Ce={class:"paginator"},be={__name:"IndexFerias",props:["idConvenio"],setup(ke){F.locale("es");const T=fe(),$=JSON.parse(localStorage.getItem("role"))||[];Ie(),_e.get("token");const g=o(!1),y=o(null);o(!1),o(null);const E=o(0),C=o(50),w=o({page:0}),B=o(1200),O=o([]),k=o(!1);o(!1),o(!1),o(!1),o(!1),o(null);const b=o(window.innerHeight-100),V=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"FERIA",fixed:"left",dataIndex:"title",width:200},{title:"LINK",dataIndex:"slug",width:100,align:"center"},{title:"META MYPES",dataIndex:"metaMypes",width:120,align:"center"},{title:"INSCRITOS",dataIndex:"countMypes",width:120,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"DÍAS RESTANTES",dataIndex:"dateDiff",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:150},{title:"DISTRITO",dataIndex:"district",width:150},{title:"CREADO POR",dataIndex:"profile",width:170},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],v=ie({search:""}),D=a=>$.some(e=>a.includes(e.id)),P=()=>{_(),g.value=!1},U=a=>{y.value=a,g.value=!0},H=()=>{y.value=null,g.value=!0},z=a=>{const e=F().startOf("day"),m=F(a).startOf("day").diff(e,"days");return m<=-1?m:m===0?1:m},Q=()=>{let a={search:v.search};_(a)},G=()=>{v.search||_()},Y=a=>{console.log("Inscriptos"),T.push(`/admin/ferias/inscritos/${a.slug}`)},j=a=>{w.value.page=a,_()},S=()=>{b.value=window.innerHeight-320},q=async a=>{try{const e=await M({url:`agreement/delete/${a.id}`,method:"DELETE"});e.status==200&&(_(),ve.success(e.message))}catch(e){console.error("Error de red:",e)}},J=re(()=>a=>w.value.page*C.value+a+1),_=async a=>{try{k.value=!0;let e;e=w.value.page==0?"":w.value,e=a?{...e,...a}:e;const{data:i}=await M({url:"fair/list",method:"GET",params:e});O.value=i==null?void 0:i.data,E.value=i.total,C.value=i.per_page}catch(e){console.error("Error de red:",e)}finally{k.value=!1}};return de(()=>{window.removeEventListener("resize",S)}),ue(()=>{window.addEventListener("resize",S),S(),_()}),(a,e)=>{const i=l("a-button"),m=l("a-col"),K=l("a-input"),X=l("a-input-group"),Z=l("a-row"),W=l("router-link"),x=l("a-tag"),R=l("a-menu-item"),ee=l("a-popconfirm"),te=l("a-menu"),ae=l("a-dropdown"),ne=l("a-table"),oe=l("a-pagination"),le=l("a-drawer");return s(),I(h,null,[c("div",null,[e[9]||(e[9]=c("h3",{class:"title-produce"},"FERIAS EMPRESARIALES",-1)),n(Z,{style:{margin:"1rem 0"}},{default:t(()=>[n(m,{xs:24,md:12,lg:18},{default:t(()=>[D([5,10,11])?(s(),p(i,{key:0,type:"primary",onClick:H,style:{"margin-right":".5rem"}},{default:t(()=>e[3]||(e[3]=[f("NUEVA FERIA")])),_:1})):r("",!0)]),_:1}),n(m,{xs:24,md:12,lg:6},{default:t(()=>[n(X,{compact:""},{default:t(()=>[n(K,{value:v.search,"onUpdate:value":e[0]||(e[0]=d=>v.search=d),style:{width:"calc(100% - 80px)"},onInput:G},null,8,["value"]),n(i,{type:"primary",disabled:v.search==="",onClick:Q},{default:t(()=>e[4]||(e[4]=[f("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(ne,{bordered:"",scroll:{x:B.value,y:b.value},class:"table-fairs",columns:V,"data-source":O.value,pagination:!1,loading:k.value,size:"small"},{bodyCell:t(({column:d,record:u,index:se})=>[d.dataIndex=="idx"?(s(),I(h,{key:0},[f(A(J.value(se)),1)],64)):r("",!0),d.dataIndex=="slug"?(s(),p(W,{key:1,to:`/feria/${u.slug}`,target:"_blank"},{default:t(()=>[n(N(ye),{class:"fair-link"})]),_:2},1032,["to"])):r("",!0),d.dataIndex=="modality"?(s(),I(h,{key:2},[u.modality=="p"?(s(),p(x,{key:0,color:"blue"},{default:t(()=>e[5]||(e[5]=[f("PRESENCIAL")])),_:1})):r("",!0),u.modality=="v"?(s(),p(x,{key:1,color:"orange"},{default:t(()=>e[6]||(e[6]=[f("VIRTUAL")])),_:1})):r("",!0)],64)):r("",!0),d.dataIndex=="dateDiff"?(s(),I(h,{key:3},[z(u.endDate2)<0?(s(),p(x,{key:0,color:"red"},{default:t(()=>e[7]||(e[7]=[f(" FINALIZADO ")])),_:1})):(s(),I("span",xe,A(z(u.endDate2)),1))],64)):r("",!0),d.dataIndex=="actions"?(s(),p(ae,{key:4,trigger:["click"]},{overlay:t(()=>[n(te,null,{default:t(()=>[D([5,10,11])?(s(),p(R,{key:0},{default:t(()=>[c("a",{onClick:L=>U(u)},"Editar",8,he)]),_:2},1024)):r("",!0),n(R,null,{default:t(()=>[c("a",{onClick:L=>Y(u)},"Inscritos",8,Ee)]),_:2},1024),D([5,10,11])?(s(),p(R,{key:1},{default:t(()=>[n(ee,{placement:"rightBottom",title:`¿Quieres eliminar ${u.title} ?`,onConfirm:L=>q(u)},{icon:t(()=>[n(N(ge),{style:{color:"red"}})]),default:t(()=>[e[8]||(e[8]=c("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):r("",!0)]),_:2},1024)]),default:t(()=>[c("a",{class:"ant-dropdown-link",onClick:e[1]||(e[1]=ce(()=>{},["prevent"]))},[n(i,{shape:"circle",icon:pe(N(we)),size:"small"},null,8,["icon"])])]),_:2},1024)):r("",!0)]),_:1},8,["scroll","data-source","loading"])]),c("div",Ce,[c("span",null,[n(x,{color:"blue"},{default:t(()=>[c("b",null,A(E.value),1)]),_:1}),e[10]||(e[10]=f("Ferias Empresariales"))]),n(oe,{size:"small",total:E.value,pageSize:C.value,onChange:j,showSizeChanger:!1},null,8,["total","pageSize"])]),n(le,{open:g.value,"onUpdate:open":e[2]||(e[2]=d=>g.value=d),title:y.value?"Editar Feria":"Nueva Feria",placement:"right",width:"650"},{default:t(()=>[n(me,{onCloseDraw:P,dataRow:y.value},null,8,["dataRow"])]),_:1},8,["open","title"])],64)}}};export{be as default};
