import{_ as K,a as Z}from"./EditarAsesoria-a99f0a7b.js";import{l as f,r as c,a as q,j as F,T as H,a5 as w,o as P,x as k,h as V,L as $,d as z,c as E,K as U,f as j,b as G,w as L,e as Q}from"./index-cc0124c1.js";import{d as X}from"./downloadExcel-092afab9.js";import{_ as J}from"./FormComponent-555efea9.js";import{u as W}from"./selectes-df222431.js";import"./es-82ab1b78.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-e98d8e08.js";const ee={key:1,class:"f-20"},ie={__name:"EditarFormalizacionRUC10",props:["info"],emits:["closeDraw"],setup(Y,{emit:D}){f.locale("es");const s=c({economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},detailprocedure_id:{type:"iSelect",label:"DETALLE DEL TRÁMITE",name:"detailprocedure_id",required:!0,message:"Seleccionar el detalle del trámite",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!1},ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(r,p)=>{if(!p)return Promise.resolve();const t=p.toString();return t.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):["10","15"].includes(t.substring(0,2))?Promise.resolve():Promise.reject(new Error("El RUC debe empezar con 10 o 15"))},trigger:"change"}]},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!1,message:"Seleccionar tipo de documento",disabled:!1}}),O=JSON.parse(localStorage.getItem("profile")),C=D,u=Y,_=c(!0),h=c("ACTUALIZAR"),e=q({}),v=c(!1),i=W(),l=c(null),a=c({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[],component_id:[],theme_id:[],detailprocedure_id:[]}),I=r=>{console.log("handleInputEvent",r)},b=async r=>{r=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),s.value.dateTramite.disabled=!1)},N=async r=>{r=="city_id"&&(await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,s.value.province_id.disabled=!1),r=="province_id"&&(await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,s.value.district_id.disabled=!1)},R=async r=>{console.log("handleFocusSelect",r),r=="city_id"&&(await i.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,a.value.province_id=[],a.value.city_id=i.cities),r=="province_id"&&(e.province_id=null,e.district_id=null,a.value.district_id=[]),r=="regime_id"&&(await i.fetchRegimes(),a.value.regime_id=i.regimes),r=="economicsector_id"&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors),r=="comercialactivity_id"&&(await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities),r=="detailprocedure_id"&&(await i.fetchDetailProcedures(),a.value.detailprocedure_id=i.detailProcedures)},x=r=>{},M=async()=>{v.value=!0;const r={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,detailprocedure_id:e.detailprocedure_id,modality_id:e.modality_id,ruc:e.ruc,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,updated_by:O.user_id};try{(await U({url:`formalization/update-ruc-10/${u.info.id}`,method:"PUT",data:r})).status===200&&(A(),C("closeDraw",!0))}catch(p){console.error("Error:",p);const t=document.getElementsByClassName("ant-drawer-body")[0];t&&(t.scrollTop=0)}finally{v.value=!1}},A=()=>{e.economicsector_id=null,e.comercialactivity_id=null,e.detailprocedure_id=null,e.modality_id=null,e.ruc=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null},T=async r=>{_.value=!0;try{r&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors,e.economicsector_id=r.econimic_sector_id,await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities,e.comercialactivity_id=r.activity_comercial_id,await i.fetchDetailProcedures(),a.value.detailprocedure_id=i.detailProcedures,e.detailprocedure_id=r.detailprocedure_id,await i.fetchModalities(),a.value.modality_id=i.modalities,e.modality_id=r.modality_id,e.ruc=r.ruc,e.address=r.address,await i.fetchCities(),a.value.city_id=i.cities,e.city_id=r.city_id,await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,s.value.province_id.disabled=!1,e.province_id=r.province_id,await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,s.value.district_id.disabled=!1,e.district_id=r.district_id)}catch(p){console.error("Error al cargar la información:",p)}finally{_.value=!1}};return F(()=>{u.info&&T(u.info)}),H(()=>u.info,r=>{r&&T(r)}),w("formState",e),w("loadingState",v),(r,p)=>_.value?(P(),k(V($),{key:0,style:{color:"#00a6db"}})):(P(),z("div",ee,[E(J,{fields:s.value,options:a.value,btnSaveName:h.value,onHandleInputEvent:I,resetSelect:l.value,onHandleChangeSelect:N,onHandleFocusSelect:R,onHandleBlurSelect:x,onHandleChangeClock:b,onOnSubmit:M},null,8,["fields","options","btnSaveName","resetSelect"])]))}},te={key:1,class:"f-20"},ae={__name:"EditarFormalizacionRUC20",props:["info"],emits:["closeDraw"],setup(Y,{emit:D}){f.locale("es");const s=c({ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(t,n)=>{if(!n)return Promise.resolve();const m=n.toString();return m.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):m.startsWith("20")?Promise.resolve():Promise.reject(new Error('El número de RUC debe comenzar con "20"'))},trigger:"change"}]},nameMype:{type:"iText",label:"NOMBRE EMPRESA",name:"nameMype",required:!0,message:"Escribir nombre de la empresa",disabled:!1},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!0,message:"Escribir la dirección del negocio",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},regime_id:{type:"iSelect",label:"RÉGIMEN SOCIETARIO",name:"regime_id",required:!0,message:"Seleccionar el régimen societario",disabled:!1},economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},numbernotary:{type:"iNumber",label:"NÚM. SOLICITUD CONSTANCIA",name:"numbernotary",required:!0,message:"Escribir número de solicitud de constancia",disabled:!1,maxlength:8,rules:[{validator:(t,n)=>n?n.toString().length!==8?Promise.reject(new Error("El número debe tener exactamente 8 dígitos")):Promise.resolve():Promise.reject(new Error("El número de notaría es requerido")),trigger:"change"}]},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},notary_id:{type:"iSelectNotary",label:"NOTARÍA",name:"notary_id",required:!0,message:"Seleccionar una notaría",disabled:!1},dateReception:{type:"iDate",label:"FECHA DE RECEPCION PNTE",name:"dateReception",required:!0,disabled:!1,disabledDate:t=>!1},dateTramite:{type:"iDate",label:"FEC. TRÁMITE SID SUNARP-SUNAT",name:"dateTramite",required:!0,disabled:!1,disabledDate:t=>e.dateReception&&t&&f(t).isBefore(f(e.dateReception))},isbic:{type:"iSelect",label:"¿ES UNA SOCIEDAD BIC?",name:"isbic",required:!1,message:"Buscar BIC",disabled:!1},montocapital:{type:"iMoney",label:"MONTO DE CAPITAL SOCIAL",name:"montocapital",required:!1,message:"Escribir el Monto de capital social",disabled:!1},typecapital_id:{type:"iSelect",label:"TIPO DE APORTE DE CAPITAL",name:"typecapital_id",required:!1,message:"Seleccionar BIC",disabled:!1}}),O=JSON.parse(localStorage.getItem("profile")),C=D,u=Y,_=c(!0),h=c("REGISTRAR"),e=q({}),v=c(!1),i=W(),l=c(null),a=c({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[]}),I=t=>{console.log("handleInputEvent",t)},b=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),s.value.dateTramite.disabled=!1)},N=async t=>{t=="city_id"&&(await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,s.value.province_id.disabled=!1),t=="province_id"&&(await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,s.value.district_id.disabled=!1)},R=async t=>{console.log("handleFocusSelect",t),t=="city_id"&&(await i.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,a.value.province_id=[],a.value.city_id=i.cities),t=="province_id"&&(e.province_id=null,e.district_id=null,a.value.district_id=[]),t=="modality_id"&&(await i.fetchModalities(),a.value.modality_id=i.modalities),t=="regime_id"&&(await i.fetchRegimes(),a.value.regime_id=i.regimes),t=="economicsector_id"&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors),t=="comercialactivity_id"&&(await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities),t=="notary_id"&&A(),t=="isbic"&&M(),t=="typecapital_id"&&(await i.fetchTypeCapital(),a.value.typecapital_id=i.typeCapital)},x=t=>{},M=()=>{a.value.isbic=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}]},A=async()=>{try{const{data:t}=await j({url:"public/notaries-filters",method:"GET"}),n=t.map(m=>({value:m.id,name:m.name,city:m.city.name,province:m.province.name,district:m.district.name,address:m.address}));a.value.notary_id=n}catch(t){console.error("Error de red:",t)}},T=async()=>{v.value=!0;const t={ruc:e.ruc,nameMype:e.nameMype,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,modality_id:e.modality_id,regime_id:e.regime_id,economicsector_id:e.economicsector_id,numbernotary:e.numbernotary,comercialactivity_id:e.comercialactivity_id,notary_id:e.notary_id,dateReception:f(e.dateReception).format("YYYY-MM-DD"),dateTramite:f(e.dateTramite).format("YYYY-MM-DD"),isbic:e.isbic,montocapital:e.montocapital,typecapital_id:e.typecapital_id,user_id:e.user_id,people_id:e.people_id,dni:e.dni,userupdated_id:O.user_id};try{(await U({url:`formalization/update-ruc-20/${u.info.id}`,method:"PUT",data:t})).status===200&&(r(),C("closeDraw",!0))}catch(n){console.error("Error:",n);const m=document.getElementsByClassName("ant-drawer-body")[0];m&&(m.scrollTop=0)}finally{v.value=!1}},r=()=>{e.ruc=null,e.nameMype=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.modality_id=null,e.regime_id=null,e.economicsector_id=null,e.numbernotary=null,e.comercialactivity_id=null,e.notary_id=null,e.dateReception=null,e.dateTramite=null,e.isbic=null,e.montocapital=null,e.typecapital_id=null},p=async t=>{_.value=!0;try{t&&(e.ruc=t.ruc,e.nameMype=t.name_mype,await i.fetchCities(),a.value.city_id=i.cities,e.city_id=t.city_id,await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,s.value.province_id.disabled=!1,e.province_id=t.province_id,await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,s.value.district_id.disabled=!1,e.district_id=t.district_id,e.address=t.address,await i.fetchModalities(),a.value.modality_id=i.modalities,e.modality_id=t.modality_id,await i.fetchRegimes(),a.value.regime_id=i.regimes,e.regime_id=t.regime_id,await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors,e.economicsector_id=t.econimic_sector_id,e.numbernotary=t.num_solicitud,await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities,e.comercialactivity_id=t.activity_comercial_id,A(),e.notary_id=t.notary_id,e.dateReception=t.date_reception?f(t.date_reception,"DD/MM/YYYY"):null,e.dateTramite=t.date_tramite?f(t.date_tramite,"DD/MM/YYYY"):null,e.isbic=t.bic,e.montocapital=t.monto_capital,await i.fetchTypeCapital(),a.value.typecapital_id=i.typeCapital,e.typecapital_id=t.typecapital_id)}catch(n){console.error("Error al cargar la información:",n)}finally{_.value=!1}};return F(()=>{u.info&&p(u.info)}),H(()=>u.info,t=>{t&&p(t)}),w("formState",e),w("loadingState",v),(t,n)=>_.value?(P(),k(V($),{key:0,style:{color:"#00a6db"}})):(P(),z("div",te,[E(J,{fields:s.value,options:a.value,btnSaveName:h.value,onHandleInputEvent:I,resetSelect:l.value,onHandleChangeSelect:N,onHandleFocusSelect:R,onHandleBlurSelect:x,onHandleChangeClock:b,onOnSubmit:T},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const le={class:"advisory-table"},re=["onClick"],pe={__name:"AsesoriasLista",setup(Y){JSON.parse(localStorage.getItem("role"));const D=c([]),s=c(0),O=c(150),C=c(!1),u=c(!1),_=c("Asesorías"),h=c(!1),e=c(!1),v=c(!1),i=c(null),l=q({year:f("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1}),a=c([]),I=c([]),b=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:80},{title:"FECHA",fixed:"left",dataIndex:"date",width:100,align:"center"},{title:"ASESOR",dataIndex:"asesor",width:200},{title:"SOLICITANTE APELLIDO PATERNO",dataIndex:"emp_lastname",width:150},{title:"SOLICITANTE APELLIDO MATERNO",dataIndex:"emp_middlename",width:150},{title:"SOLICITANTE NONBRE",dataIndex:"emp_name",width:150},{title:"TIPO DOCUMENTO",dataIndex:"emp_document_type",width:100,align:"center"},{title:"NÚMERO DE DOCUMENTO",dataIndex:"emp_document_number",align:"center",width:140},{title:"PAÍS",dataIndex:"emp_country",align:"center",width:120},{title:"FEC. NAC",dataIndex:"emp_birth",align:"center",width:120},{title:"EDAD",dataIndex:"emp_age",align:"center",width:80},{title:"GÉNERO",dataIndex:"emp_gender",width:80,align:"center"},{title:"DISCAPACIDAD",dataIndex:"emp_discapabilities",width:120,align:"center"},{title:"HIJOS",dataIndex:"emp_soons",width:80,align:"center"},{title:"CELULAR",dataIndex:"emp_phone",width:120,align:"center"},{title:"EMAIL",dataIndex:"emp_email",width:200},{title:"CIUDAD",dataIndex:"city",width:120,align:"center"},{title:"PROVINCIA",dataIndex:"province",width:140,align:"center"},{title:"DISTRITO",dataIndex:"district",width:140,align:"center"},{title:"RUC",dataIndex:"ruc",width:120,align:"center"}],N=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_service",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"COMPONENTE",dataIndex:"component",width:140,align:"center"},{title:"TEMA",dataIndex:"theme",width:200},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"OBSERVACIONES",dataIndex:"observations",width:200},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],R=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"DETALLE DEL TRÁMITE",dataIndex:"detail_tramit",width:180},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],x=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"FECHA DE RECEPCIÓN",dataIndex:"date_reception",width:160,align:"center"},{title:"FECHA DE TRÁMITE",dataIndex:"date_tramite",width:160,align:"center"},{title:"TIPO DE RÉGIMEN",dataIndex:"type_regimen",width:150,align:"center"},{title:"BIC",dataIndex:"bic",width:50,align:"center"},{title:"NÚMERO DE SOLICITUD",dataIndex:"num_solicitud",width:160,align:"center"},{title:"NOTARÍA",dataIndex:"notaria",width:200},{title:"TIPO DE APORTE",dataIndex:"type_aporte",width:160,align:"center"},{title:"MONTO CAPITAL",dataIndex:"monto_capital",width:160,align:"center"},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],M=()=>{console.log("handleNew...")},A=async()=>{u.value=!0;try{const d={paginate:!1};l.year&&(d.year=f(l.year).format("YYYY")),l.range&&(d.dateStart=l.range[0].format("YYYY/MM/DD"),d.dateEnd=l.range[1].format("YYYY/MM/DD")),l.asesor&&(d.asesor=l.asesor),l.name&&(d.name=l.name);let o=null,g=null,S=null;l.type==1&&(o="historial/advisories/filters",g="download/asesories",S="Asesorías"),l.type==2&&(o="historial/formalizations-10/filters",g="download/formalizations-ruc10",S="Formalizaciones 10"),l.type==3&&(o="historial/formalizations-20/filters",g="download/formalizations-ruc20",S="Formalizaciones 20");const B=(await U({url:o,method:"GET",params:d})).data;await X(g,S,B)}catch(d){console.error("Error de red:",d)}finally{u.value=!1}},T=async d=>{l.page=d,await n()},r=async d=>{d&&(l.page=1,await n())},p=d=>{i.value=d,l.type==1&&(h.value=!0),l.type==2&&(e.value=!0),l.type==3&&(v.value=!0)},t=()=>{l.type==1&&(I.value=[...b,...N],_.value="Asesorias"),l.type==2&&(I.value=[...b,...R],_.value="Formalizaciones RUC 10"),l.type==3&&(I.value=[...b,...x],_.value="Formalizaciones RUC 20")},n=async()=>{C.value=!0,t();try{const d={page:l.page};l.year&&(d.year=f(l.year).format("YYYY")),l.range&&(d.dateStart=l.range[0].format("YYYY/MM/DD"),d.dateEnd=l.range[1].format("YYYY/MM/DD")),l.asesor&&(d.asesor=l.asesor),l.name&&(d.name=l.name);let o=null;l.type==1&&(o="historial/advisories/filters"),l.type==2&&(o="historial/formalizations-10/filters"),l.type==3&&(o="historial/formalizations-20/filters");const g=await U({url:o,method:"GET",params:d});D.value=g.data.data,s.value=g.data.total,O.value=g.data.per_page}catch(d){console.error("Error de red:",d)}finally{C.value=!1}},m=async()=>{try{const d=await j({url:"select/asesores-report",method:"GET"});d.status==200&&(a.value=d.data)}catch{console.log("Failed to delete")}};return F(async()=>{await n(),await m()}),w("search",l),w("loading",C),w("loadingFile",u),(d,o)=>{const g=G("a-menu-item"),S=G("a-drawer");return P(),z("div",le,[E(K,{title:`REPORTE GENERAL - ${_.value}`,new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",tipoformalizacion:!0,searchYear:!0,rangeDate:!0,columns:I.value,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:O.value,nameTotal:_.value,asesoresList:a.value,dataSource:D.value,total:s.value,onHandleNew:M,onHandleDownloadExcel:A,onHandleSearch:r,onHandlePaginator:T},{"custom-options":L(({record:y})=>[E(g,null,{default:L(()=>[Q("a",{onClick:B=>p(y)},"Editar",8,re)]),_:2},1024)]),_:1},8,["title","columns","pageSize","nameTotal","asesoresList","dataSource","total"]),E(S,{width:"500",title:"EDITAR ASESORÍA",open:h.value,"onUpdate:open":o[1]||(o[1]=y=>h.value=y),placement:"right"},{default:L(()=>[E(Z,{info:i.value,onCloseDraw:o[0]||(o[0]=y=>(h.value=!1,n()))},null,8,["info"])]),_:1},8,["open"]),E(S,{width:"550",title:"Editar Formalización RUC 10",open:e.value,"onUpdate:open":o[3]||(o[3]=y=>e.value=y),placement:"right"},{default:L(()=>[E(ie,{info:i.value,onCloseDraw:o[2]||(o[2]=y=>(e.value=!1,n()))},null,8,["info"])]),_:1},8,["open"]),E(S,{width:"550",title:"Editar Formalización RUC 20",open:v.value,"onUpdate:open":o[5]||(o[5]=y=>v.value=y),placement:"right"},{default:L(()=>[E(ae,{info:i.value,onCloseDraw:o[4]||(o[4]=y=>(v.value=!1,n()))},null,8,["info"])]),_:1},8,["open"])])}}};export{pe as default};
