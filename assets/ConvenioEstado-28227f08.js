import{D as Z,r,a as ee,k as W,S as ae,b as l,o as s,s as w,w as o,c as n,e as A,d as b,F as V,y as me,h as $,v as h,E as ce,I as J,m as q,a5 as Se,a8 as ve,t as j,i as P,a7 as ue,g as _e,H as fe,L as Ue,B as ie,Q as Ae,x as Oe,Z as Te,R as $e,p as Re,j as Ne}from"./index-5fd26e4c.js";import{u as ge}from"./selectes-b1dc16fb.js";import"./es-1738796d.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import{S as Le}from"./SaveOutlined-60cc01f5.js";import{C as Pe}from"./CloudUploadOutlined-82bceb37.js";import{M as qe}from"./MessageOutlined-f7ca1855.js";import{M as ze}from"./MoreOutlined-e9e32f5c.js";const Fe={alliedEntity:{type:"iText",label:"Entidad Aliada",name:"alliedEntity",required:!0,message:"Escribir la entidad aliada",disabled:!0,max:100},ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!0,message:"El RUC debe tener exactamente 11 caracteres.",disabled:!0,min:11,max:11},component:{type:"iSelect",label:"Componente",name:"components",required:!0,message:"Seleccionar un componente",disabled:!0},city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!0},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},startDate:{type:"iDate",label:"Inicio Convenio Vigente",name:"startDate",required:!0,message:"Seleccionar fecha de convenio vigente",disabled:!0},years:{type:"iSelect",label:"Años del convenio",name:"years",required:!0,message:"Seleccionar años",disabled:!1},aliado:{type:"iText",label:"REPRESENTANTE LEGAL - NOMBRES",name:"aliado",required:!0,message:"Escribir los nombres y apellidos",disabled:!0,max:100},aliadoPhone:{type:"iNumber",label:"REPRESENTANTE LEGAL - CELULAR",name:"aliadoPhone",required:!0,message:"Escribir el número",disabled:!0,max:9},focal:{type:"iText",label:"PUNTO FOCAL - NOMBRES",name:"focal",required:!0,message:"Escribir datos del punto focal",disabled:!0,max:100},focalCargo:{type:"iText",label:"PUNTO FOCAL - CARGO",name:"focalCargo",required:!0,message:"Escribir cargo del Punto Focal",disabled:!0,max:50},focalPhone:{type:"iNumber",label:"PUNTO FOCAL - NUM. CELULAR",name:"focalPhone",required:!0,message:"Escribir el número de telf.",disabled:!0,max:9},renovation:{type:"iSwitch",label:"Renovación Automática",name:"renovation",required:!1,message:"Seleccionar",disabled:!0},observations:{type:"iTextarea",label:"Comentarios",name:"observations",required:!1,message:"Seleccionar",disabled:!1}};const Me={class:"grid-convenios"},Ye={key:6},Be={key:0},Ve={key:1},pe="DD/MM/YYYY",Ge={__name:"DrawConvenioUGSE",props:["idConvenio"],emits:["closeDraw"],setup(N,{emit:E}){Z.locale("es");const f=JSON.parse(localStorage.getItem("profile")),y=ge(),T=E,k=N;y.$patch({cities:y.cities}),y.$patch({provinces:y.provinces}),y.$patch({districts:y.districts}),y.fetchCities();const C=r(!1),I=r(!1),a=ee({}),D=[{value:1,label:"1 Año"},{value:2,label:"2 Años"},{value:3,label:"3 Años"},{value:4,label:"4 Años"},{value:5,label:"5 Años"},{value:6,label:"6 Años"},{value:7,label:"7 Años"},{value:8,label:"8 Años"},{value:9,label:"9 Años"},{value:10,label:"10 Años"}],S=[{value:"financiamiento",label:"Acceso en Financiamiento"},{value:"desarrollo",label:"Desarrollo Productivo"},{value:"digitalizacion",label:"Digitalización"},{value:"formalizacion",label:"Formalización"},{value:"gestion",label:"Gestión Empresarial"}],z=t=>{const d=a[t]?a[t].trim():"";a[t]=d},M=t=>{const d=Z(a.startDate).add(1,"day").startOf("day");return Z(t).startOf("day").isBefore(d,"day")},F=t=>{a.province_id=null,a.district_id=null,y.fetchProvinces(t)},Y=t=>{a.district_id=null,y.fetchDistricts(t)},x=(t,d)=>{const g=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return d.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(g)},B=()=>{["city_id","province_id","district_id","alliedEntity","ruc","components","startDate","years","aliado","aliadoPhone","focal","focalCargo","focalPhone","endDate","observations"].forEach(d=>{a[d]=null}),a.created_id=f.user_id},u=async()=>{C.value=!0;const t={city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,alliedEntity:a.alliedEntity,ruc:a.ruc,components:a.components,startDate:Z(a.startDate).format("YYYY-MM-DD"),years:a.years,aliado:a.aliado,aliadoPhone:a.aliadoPhone,focal:a.focal,focalCargo:a.focalCargo,focalPhone:a.focalPhone,renovation:a.renovation,endDate:Z(a.startDate).add(a.years,"year").format("YYYY-MM-DD"),observations:a.observations,created_id:f.user_id,entity:"ugse"};try{const d=k.idConvenio?"PUT":"POST",g=k.idConvenio?`agreement/update-values/${k.idConvenio.id}`:"agreement/create-ugse",O=await J({url:g,method:d,data:t});O.status==200&&(q.success(O.message),T("closeDraw",!0),B())}catch(d){q.error("Se originó un error: "+d.message)}finally{C.value=!1}},p=()=>{q.error("Por favor corrige los valores con errores")},i=async t=>{t.id&&(a.city_id=t.city_id,F(t.city_id),a.province_id=t.province_id,Y(t.province_id),a.district_id=t.district_id,a.ruc=t.ruc,a.components=t.components,a.startDate=Z(t.startDate,"YYYY-MM-DD"),a.years=t.years,a.aliado=t.aliado,a.aliadoPhone=t.aliadoPhone,a.focal=t.focal,a.focalCargo=t.focalCargo,a.focalPhone=t.focalPhone,a.observations=t.observations,a.alliedEntity=t.entity)};return W(()=>{k.idConvenio?i(k.idConvenio):(a.city_id=15,F(15))}),ae(()=>k.idConvenio,t=>{t?i(t):B()}),(t,d)=>{const g=l("a-input"),O=l("a-form-item"),R=l("a-input-number"),U=l("a-select"),G=l("a-date-picker"),Q=l("a-switch"),te=l("a-textarea"),ne=l("a-button"),H=l("a-form"),c=l("a-spin");return s(),w(c,{spinning:I.value},{default:o(()=>[n(H,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:u,onFinishFailed:p},{default:o(()=>[A("div",Me,[(s(!0),b(V,null,me($(Fe),(e,L)=>(s(),b(V,{key:L},[e.type==="iText"?(s(),w(O,{key:0,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max},...e.name==="ruc"?[{type:"string",len:11,message:e.message},{pattern:/^\d{11}$/,message:"El RUC debe ser numérico."},{pattern:/^(10|15|20)\d{9}$/,message:"El RUC debe empezar con 10, 15 o 20."}]:[]]},{default:o(()=>[n(g,{value:a[e.name],"onUpdate:value":_=>a[e.name]=_,maxlength:e.max,onBlur:_=>z(e.name)},null,8,["value","onUpdate:value","maxlength","onBlur"])]),_:2},1032,["name","label","rules"])):h("",!0),e.type==="iNumber"?(s(),w(O,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[n(R,{value:a[e.name],"onUpdate:value":_=>a[e.name]=_,maxlength:e.max,style:{width:"100%"}},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):h("",!0),e.type==="iSelect"?(s(),w(O,{key:2,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[e.name=="city_id"?(s(),w(U,{key:0,value:a[e.name],"onUpdate:value":_=>a[e.name]=_,options:$(y).cities,"show-search":"","filter-option":x,onChange:F},null,8,["value","onUpdate:value","options"])):h("",!0),e.name=="province_id"?(s(),w(U,{key:1,value:a[e.name],"onUpdate:value":_=>a[e.name]=_,options:$(y).provinces,"show-search":"","filter-option":x,onChange:Y,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):h("",!0),e.name=="district_id"?(s(),w(U,{key:2,value:a[e.name],"onUpdate:value":_=>a[e.name]=_,options:$(y).districts,"show-search":"","filter-option":x,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):h("",!0),e.name=="years"?(s(),w(U,{key:3,value:a[e.name],"onUpdate:value":_=>a[e.name]=_,options:D,"show-search":"","filter-option":x},null,8,["value","onUpdate:value"])):h("",!0),e.name=="components"?(s(),w(U,{key:4,value:a[e.name],"onUpdate:value":_=>a[e.name]=_,options:S,"show-search":"","filter-option":x},null,8,["value","onUpdate:value"])):h("",!0)]),_:2},1032,["name","label","rules"])):h("",!0),e.type==="iDate"?(s(),w(O,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[e.name=="endDate"?(s(),w(G,{key:0,"disabled-date":M,locale:$(ce),disabled:!a.startDate,value:a[e.name],"onUpdate:value":_=>a[e.name]=_,style:{width:"100%"},format:pe,placeholder:"día/mes/año"},null,8,["locale","disabled","value","onUpdate:value"])):(s(),w(G,{key:1,locale:$(ce),value:a[e.name],"onUpdate:value":_=>a[e.name]=_,style:{width:"100%"},format:pe,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"]))]),_:2},1032,["name","label","rules"])):h("",!0),e.type==="iSwitch"?(s(),w(O,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[n(Q,{checked:a[e.name],"onUpdate:checked":_=>a[e.name]=_,"checked-children":"si","un-checked-children":"",checkedValue:1,unCheckedValue:0},null,8,["checked","onUpdate:checked"])]),_:2},1032,["name","label","rules"])):h("",!0),e.type==="iTextarea"?(s(),w(O,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[n(te,{value:a[e.name],"onUpdate:value":_=>a[e.name]=_,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):h("",!0),e.type==="iSpace"?(s(),b("span",Ye)):h("",!0)],64))),128))]),n(O,null,{default:o(()=>[n(ne,{type:"primary","html-type":"submit",loading:C.value},{default:o(()=>[N.idConvenio?(s(),b("span",Be,"ACTUALIZAR")):(s(),b("span",Ve,"GUARDAR"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},He=he(Ge,[["__scopeId","data-v-e60b5333"]]);const je={class:"accion-icons"},Ze={key:0},Je={key:1},Qe={__name:"DrawAcciones",props:["idConvenio"],emits:["refreshTable"],setup(N,{emit:E}){const f=N,y=E,T=r([]),k=r(!0),C=r(null),I=r(""),a=r(!1);r(null);const D=ee({description:null});W(()=>{f.idConvenio&&x(f.idConvenio)}),ae(()=>f.idConvenio,u=>{u&&x()});function S(u){C.value=u.id,I.value=u.description,ue(()=>{B()})}function z(u){const p=T.value.findIndex(i=>i.id===u.id);p!==-1&&(T.value[p].description=I.value),C.value=null,F(u.id)}const M=async u=>{try{const p=await J({url:`agreement/delete-acction/${u.id}`,method:"DELETE"});p.status==200&&(x(),q.success(p.message),y("refreshTable",!0))}catch(p){console.error("Error de red:",p)}},F=async u=>{try{const p={description:I.value},i=await J({url:`agreement/update/${u}`,method:"PUT",data:p});i.status==200&&(q.success(i.message),x())}catch(p){console.error("Error de red:",p)}},Y=async()=>{try{const u={description:D.description,agreements_id:f.idConvenio},p=await J({url:"agreement/create-acction",method:"POST",data:u});p.status==200&&(q.success(p.message),y("refreshTable",!0),x(),D.description=null)}catch(u){console.error("Error de red:",u)}},x=async()=>{k.value=!0;try{const u=await J({url:`agreement/list/${f.idConvenio}`,method:"GET"});u.status==200&&(T.value=u.data)}catch{}finally{k.value=!1}},B=()=>{ue(()=>{const u=document.getElementById("auto-resize");u.style.height="auto",u.style.height=u.scrollHeight+"px"})};return(u,p)=>{const i=l("a-textarea"),t=l("a-spin"),d=l("a-form-item"),g=l("a-button"),O=l("a-form");return s(),b("div",null,[n(t,{spinning:k.value},{default:o(()=>[(s(!0),b(V,null,me(T.value,(R,U)=>(s(),b("div",{class:"acciones",key:U},[A("div",je,[n($(Se),{class:"pointer ico-acc",onClick:G=>S(R)},null,8,["onClick"]),C.value===R.id?(s(),w($(Le),{key:0,class:"pointer ico-save",onClick:G=>z(R)},null,8,["onClick"])):h("",!0),n($(ve),{class:"pointer ico-acc",onClick:G=>M(R)},null,8,["onClick"])]),C.value===R.id?(s(),b("div",Ze,[n(i,{value:I.value,"onUpdate:value":p[0]||(p[0]=G=>I.value=G),onInput:B,id:"auto-resize"},null,8,["value"])])):(s(),b("p",Je,j(R.description),1))]))),128))]),_:1},8,["spinning"]),n(O,{layout:"vertical",model:D,name:"basic",autocomplete:"off",onFinish:Y},{default:o(()=>[n(d,{name:"description",label:"Registra una acción",rules:[{required:!0,message:"Escribir la descripción"}]},{default:o(()=>[n(i,{value:D.description,"onUpdate:value":p[1]||(p[1]=R=>D.description=R),maxlength:250,rows:4},null,8,["value"])]),_:1}),n(d,null,{default:o(()=>[n(g,{type:"primary","html-type":"submit",loading:a.value},{default:o(()=>[P("CREAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const Xe={__name:"DrawObservations",props:["idConvenio"],emits:["refreshTable"],setup(N,{emit:E}){const f=N,y=E;r([]);const T=r(!0);r(null),r("");const k=r(!1);r(null);const C=ee({description:null});W(()=>{f.idConvenio&&a(f.idConvenio)}),ae(()=>f.idConvenio,D=>{D&&a()});const I=async()=>{k.value=!0;try{const D={observations:C.description},S=await J({url:`agreement/update-values/${f.idConvenio.id}`,method:"PUT",data:D});S.status==200&&(q.success(S.message),y("refreshTable",!0))}catch(D){console.error("Error de red:",D)}finally{k.value=!1}},a=async()=>{C.description=f.idConvenio.observations,C.description!=null&&(T.value=!1)};return(D,S)=>{const z=l("a-textarea"),M=l("a-form-item"),F=l("a-button"),Y=l("a-form"),x=l("a-spin");return s(),b("div",null,[n(x,{spinning:T.value},{default:o(()=>[n(Y,{layout:"vertical",model:C,name:"basic",autocomplete:"off",onFinish:I},{default:o(()=>[n(M,{name:"description",label:"Orbservaciones",rules:[{required:!0,message:"Escribir la descripción"}]},{default:o(()=>[n(z,{value:C.description,"onUpdate:value":S[0]||(S[0]=B=>C.description=B),rows:6},null,8,["value"])]),_:1}),n(M,null,{default:o(()=>[n(F,{type:"primary","html-type":"submit",loading:k.value},{default:o(()=>[P("ACTUALIZAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}};const Ke=A("div",{class:"agreements-file"},[A("b",null,"Formatos a subir"),A("span",null,"pdf, doc, docx, xls, xlsx, ppt, pptx"),A("span",null,"*(Máximo 20MB)")],-1),We={class:"file-options"},ea={style:{"line-height":"1.3"}},aa=["onClick"],ta=["onClick"],na={__name:"DrawFiles",props:["idConvenio"],setup(N){Z.locale("es");const E=_e.get("token"),f=N,y="https://apituempresa.soporte-pnte.com/api/",T="http://127.0.0.1:8000/api/",k=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?T:y,C=r(!1),I=r([]),a=r(null),D=r(null),S=r(!1),z=fe(Ue,{style:{fontSize:"20px"},spin:!0});W(()=>{f.idConvenio&&p(f.idConvenio)}),ae(()=>f.idConvenio,i=>{i&&p(i)});const M=i=>Z(i).format("DD-MM-YYYY HH:mm"),F=i=>(Y(i),!1),Y=async i=>{const t=new FormData;t.append("file",i),t.append("agreements_id",f.idConvenio),C.value=!0;try{const{data:d}=await ie.post(`${k}agreement/file`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${E}`}});d.status==200&&(q.success(d.message),p(f.idConvenio))}catch{q.error("Error al subir este tipo de archivo")}finally{C.value=!1}},x=async i=>{a.value=i.uid;try{const t=await ie({url:`${k}agreement/file-download/${i.uid}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${E}`}}),d=window.URL.createObjectURL(new Blob([t.data])),g=document.createElement("a");g.href=d,g.setAttribute("download",i.name),document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(d),document.body.removeChild(g)}catch(t){console.error("Error downloading file:",t)}finally{a.value=null}},B=i=>{i.file.status!=="uploading"&&console.log(i.file,i.fileList),i.file.status==="done"?(q.success(`${i.file.name} file uploaded successfully`),I.value=i.fileList.filter(t=>t.status!=="error")):i.file.status==="error"&&(q.error(`${i.file.name} file upload failed.`),I.value=i.fileList.filter(t=>t.uid!==i.file.uid))},u=async i=>{D.value=i.uid;try{const t=await J({url:`agreement/delete/file/${i.uid}`,method:"DELETE"});t.status==200&&(p(f.idConvenio),q.success(t.message))}catch(t){console.error("Error de red:",t)}finally{D.value=null}},p=async i=>{S.value=!0;try{const{data:t}=await ie.get(`${k}agreement/list-files/${i}`,{headers:{Authorization:`Bearer ${E}`}});t.status===200&&(I.value=t.data.map(d=>({uid:d.id,name:d.name,status:"done",url:d.path,date:d.created_at})))}catch(t){console.error("Error fetching files:",t)}finally{S.value=!1}};return(i,t)=>{const d=l("a-button"),g=l("a-spin"),O=l("a-space"),R=l("a-upload");return s(),w(g,{spinning:S.value},{default:o(()=>[Ke,n(R,{"file-list":I.value,name:"file",onChange:B,"custom-request":Y,"before-upload":F},{itemRender:o(({file:U,actions:G})=>[n(O,{style:{margin:"0rem 0","font-size":"13px",width:"100%"}},{default:o(()=>[A("div",We,[A("span",ea,j(U.name),1),A("span",null,j(M(U.date)),1),a.value!=U.uid?(s(),b("a",{key:0,onClick:Q=>x(U)},"Descargar",8,aa)):(s(),w(g,{key:1,indicator:$(z)},null,8,["indicator"])),D.value==U.uid?(s(),w(g,{key:2,indicator:$(z)},null,8,["indicator"])):(s(),b("a",{key:3,onClick:Q=>u(U),style:{color:"var(--error)"}},[n($(ve))],8,ta))])]),_:2},1024)]),default:o(()=>[n(d,{style:{"margin-bottom":".6rem"},loading:C.value},{default:o(()=>[n($(Pe)),P(" SUBIR ARCHIVO ")]),_:1},8,["loading"])]),_:1},8,["file-list"])]),_:1},8,["spinning"])}}};const ye=N=>(Re("data-v-aa613e3f"),N=N(),Ne(),N),oa=ye(()=>A("h3",{class:"title-produce"},"CONVENIOS UGSE",-1)),sa={key:0,class:"list-days"},ia={key:1,class:"list-days"},la=["onClick"],ra=["onClick"],da=ye(()=>A("a",null,"Eliminar",-1)),ca={class:"paginator"},ua={__name:"ConvenioEstado",props:["idConvenio"],setup(N){Z.locale("es"),JSON.parse(localStorage.getItem("profile")),ge(),_e.get("token"),r(null),r(null),r(!1);const E=r(null),f=r(0),y=r(50),T=r({page:0}),k=r(1200),C=r([]),I=r(!1),a=r(!1),D=r(!1),S=r(!1),z=r(!1),M=r(!1);r(null),r(null);const F=r(window.innerHeight-100),Y=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"ENTIDAD ALIADA",dataIndex:"entity",fixed:"left",width:220},{title:"RUC",dataIndex:"ruc",width:100},{title:"INICIO DE CONVENIO VIGENTE",dataIndex:"startDate",align:"center",width:180},{title:"N° DE AÑOS VIGENTE",dataIndex:"years",width:120,align:"center"},{title:"FIN DEL CONVENIO",dataIndex:"endDate",align:"center",width:180},{title:"ESTADO",dataIndex:"status",align:"center",width:150},{title:"FECHA RESTANTE",dataIndex:"numbrestantes",align:"center",width:140},{title:"OBSERVACIONES",dataIndex:"observations",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:150},{title:"DISTRITO",dataIndex:"district",width:150},{title:"COMPONENTE",dataIndex:"components",align:"center",width:120},{title:"PUNTO FOCAL",dataIndex:"focal",align:"center",width:150},{title:"PUNTO FOCAL TELF.",dataIndex:"focalPhone",align:"center",width:140},{title:"ALIADO",dataIndex:"aliado",align:"center",width:150},{title:"ALIADO TELF.",dataIndex:"aliadoPhone",align:"center",width:120},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],x=ee({search:""}),B=()=>{let c={search:x.search};H(c)},u=()=>{x.search||H()},p=c=>{E.value=c,a.value=!0},i=c=>{E.value=c,S.value=!0},t=c=>Z(c).format("DD/MM/YYYY"),d=c=>{E.value=c.id,z.value=!0},g=(c,e)=>{const L=new Date(c),_=new Date,oe=L.getTime()-_.getTime();return Math.floor(oe/(1e3*3600*24))+1},O=c=>c<=0||c<20?"red":c<40?"#f9e717":"#11d811",R=c=>{T.value.page=c,H()},U=()=>{F.value=window.innerHeight-320},G=()=>{E.value=null,a.value=!0},Q=c=>{H(),c==1&&(a.value=!1,E.value=null),c==2&&(D.value=!1),c==4&&(S.value=!1),E.value=null},te=async c=>{try{const e=await J({url:`agreement/delete/${c.id}`,method:"DELETE"});e.status==200&&(H(),q.success(e.message))}catch(e){console.error("Error de red:",e)}},ne=Ae(()=>c=>T.value.page*y.value+c+1),H=async c=>{try{I.value=!0;let e;e=T.value.page==0?"":T.value,e=c?{...e,...c}:e;const{data:L}=await J({url:"agreement/list/ugse",method:"GET",params:e});C.value=L==null?void 0:L.data,f.value=L.total,y.value=L.per_page}catch(e){console.error("Error de red:",e)}finally{I.value=!1}};return Oe(()=>{window.removeEventListener("resize",U)}),W(()=>{window.addEventListener("resize",U),U(),H()}),(c,e)=>{const L=l("a-button"),_=l("a-col"),oe=l("a-input"),le=l("a-input-group"),be=l("a-row"),re=l("a-tag"),Ce=l("a-progress"),X=l("a-menu-item"),de=l("router-link"),De=l("a-popconfirm"),we=l("a-menu"),xe=l("a-dropdown"),Ee=l("a-table"),ke=l("a-pagination"),K=l("a-drawer");return s(),b(V,null,[A("div",null,[oa,n(be,{style:{margin:"1rem 0"}},{default:o(()=>[n(_,{xs:24,md:12,lg:18},{default:o(()=>[n(L,{type:"primary",onClick:G,style:{"margin-right":".5rem"}},{default:o(()=>[P("NUEVO")]),_:1})]),_:1}),n(_,{xs:24,md:12,lg:6},{default:o(()=>[n(le,{compact:""},{default:o(()=>[n(oe,{value:x.search,"onUpdate:value":e[0]||(e[0]=m=>x.search=m),style:{width:"calc(100% - 80px)"},onInput:u},null,8,["value"]),n(L,{type:"primary",disabled:x.search==="",onClick:B},{default:o(()=>[P("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(Ee,{bordered:"",scroll:{x:k.value,y:F.value},class:"table-agreements-ugse",columns:Y,"data-source":C.value,pagination:!1,loading:I.value,size:"small"},{headerCell:o(({column:m})=>[]),bodyCell:o(({column:m,record:v,index:Ie})=>[m.dataIndex=="idx"?(s(),b(V,{key:0},[P(j(ne.value(Ie)),1)],64)):h("",!0),m.dataIndex=="externo"?(s(),b(V,{key:1},[v.external==1?(s(),w(re,{key:0,color:"cyan"},{default:o(()=>[P("Externo")]),_:1})):h("",!0)],64)):h("",!0),m.dataIndex=="startOperations"?(s(),b(V,{key:2},[P(j(t(v.startOperations)),1)],64)):h("",!0),m.dataIndex=="startDate"?(s(),b(V,{key:3},[P(j(t(v==null?void 0:v.startDate)),1)],64)):h("",!0),m.dataIndex=="endDate"?(s(),b(V,{key:4},[P(j(t(v==null?void 0:v.endDate)),1)],64)):h("",!0),m.dataIndex=="numbrestantes"?(s(),b(V,{key:5},[g(v.endDate,v.startDate)>=1?(s(),b("p",sa,j(g(v.endDate,v.startDate))+" días faltantes",1)):(s(),b("p",ia,j(g(v.endDate,v.startDate))+" días vencidos",1))],64)):h("",!0),m.dataIndex=="status"?(s(),w(Ce,{key:6,style:{margin:"0"},percent:g(v.endDate,v.startDate),size:4,showInfo:!1,strokeColor:O(g(v.endDate,v.startDate))},null,8,["percent","strokeColor"])):h("",!0),m.dataIndex=="observations"?(s(),b(V,{key:7},[v!=null&&v.observations?(s(),w($(qe),{key:0,class:"observation-icon",onClick:se=>i(v)},null,8,["onClick"])):h("",!0)],64)):h("",!0),m.dataIndex=="actions"?(s(),w(xe,{key:8,trigger:["click"]},{overlay:o(()=>[n(we,null,{default:o(()=>[n(X,null,{default:o(()=>[A("a",{onClick:se=>d(v)},"Archivos",8,la)]),_:2},1024),n(X,null,{default:o(()=>[n(de,{to:`/admin/convenios/ugse/compromisos/${v.id}/${v.entity}`},{default:o(()=>[P("Compromisos")]),_:2},1032,["to"])]),_:2},1024),n(X,null,{default:o(()=>[n(de,{to:`/admin/convenios/ugse/detalle-general/${v.id}`},{default:o(()=>[P("Resumen")]),_:2},1032,["to"])]),_:2},1024),n(X,null,{default:o(()=>[A("a",{onClick:se=>p(v)},"Editar",8,ra)]),_:2},1024),n(X,null,{default:o(()=>[n(De,{title:"¿Seguro de eliminar?",onConfirm:se=>te(v)},{icon:o(()=>[n($(Te),{style:{color:"red"}})]),default:o(()=>[da]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:o(()=>[A("a",{class:"ant-dropdown-link",onClick:e[1]||(e[1]=$e(()=>{},["prevent"]))},[n(L,{shape:"circle",icon:fe($(ze)),size:"small"},null,8,["icon"])])]),_:2},1024)):h("",!0)]),_:1},8,["scroll","data-source","loading"])]),A("div",ca,[A("span",null,[n(re,{color:"blue"},{default:o(()=>[A("b",null,j(f.value),1)]),_:1}),P("Convenios")]),n(ke,{size:"small",total:f.value,pageSize:y.value,onChange:R,showSizeChanger:!1},null,8,["total","pageSize"])]),n(K,{open:a.value,"onUpdate:open":e[3]||(e[3]=m=>a.value=m),"root-class-name":"root-class-name",title:"Convenios",placement:"right",width:"650"},{default:o(()=>[n(He,{idConvenio:E.value,onCloseDraw:e[2]||(e[2]=m=>Q(1))},null,8,["idConvenio"])]),_:1},8,["open"]),n(K,{open:D.value,"onUpdate:open":e[6]||(e[6]=m=>D.value=m),title:"Acciones",placement:"right",width:"550"},{default:o(()=>[n(Qe,{idConvenio:E.value,onCloseDraw:e[4]||(e[4]=m=>Q(2)),onRefreshTable:e[5]||(e[5]=m=>H())},null,8,["idConvenio"])]),_:1},8,["open"]),n(K,{open:z.value,"onUpdate:open":e[8]||(e[8]=m=>z.value=m),title:"Cargar Archivos",placement:"right",width:"550"},{default:o(()=>[n(na,{idConvenio:E.value,onCloseDraw:e[7]||(e[7]=m=>Q(3))},null,8,["idConvenio"])]),_:1},8,["open"]),n(K,{open:S.value,"onUpdate:open":e[11]||(e[11]=m=>S.value=m),title:"Observaciones",placement:"right",width:"550"},{default:o(()=>[n(Xe,{idConvenio:E.value,onCloseDraw:e[9]||(e[9]=m=>Q(4)),onRefreshTable:e[10]||(e[10]=m=>H())},null,8,["idConvenio"])]),_:1},8,["open"]),n(K,{open:M.value,"onUpdate:open":e[12]||(e[12]=m=>M.value=m),title:"Compromisos",placement:"right",width:"90%"},null,8,["open"])],64)}}},ba=he(ua,[["__scopeId","data-v-aa613e3f"]]);export{ba as default};
