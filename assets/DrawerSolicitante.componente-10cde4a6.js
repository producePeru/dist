import{u as R}from"./selectes-f74fa27c.js";import{K as h,r as b,a as $,b as c,o,q as s,w as m,c as _,e as q,d as x,F as U,x as G,h as u,s as l,L as I,t as O,i as j,z as J,m as y}from"./index-65e669a4.js";import"./es-207283b4.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";const H={typedocument_id:{type:"iSelect",label:"Tipo de documento",name:"typedocument_id",required:!1,message:"Seleccionar tipo de documento",disabled:!0},documentnumber:{type:"iText",label:"Número de documento",name:"documentnumber",required:!1,message:"Escribe número de documento",disabled:!0},lastname:{type:"iText",label:"Apellido Paterno",name:"lastname",required:!0,message:"Escribir apellido",disabled:!1},middlename:{type:"iText",label:"Apellido Materno",name:"middlename",required:!0,message:"Escribir apellido",disabled:!1},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribir nombre",disabled:!1},city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!1},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},phone:{type:"iText",label:"Número de celular",name:"phone",required:!0,message:"Número de contacto y 9 max",max:9,disabled:!1},email:{type:"iText",label:"Correo electrónico",name:"email",required:!1,message:"Escribir un email",email:"email",disabled:!1},birthday:{type:"iDate",label:"Fecha de nacimiento",name:"birthday",required:!0,message:"Seleccionar fecha",disabled:!1},gender_id:{type:"iSelect",label:"Género",name:"gender_id",required:!0,message:"Seleccionar tipo de documento"},sick:{type:"iSelect",label:"¿Tiene discapacidad?",name:"sick",required:!0,message:"Seleccionar un tipo"}};const Q={class:"grid-profile"},W="DD/MM/YYYY",X={__name:"DrawerSolicitante.componente",props:["updateValues"],emits:["closeDraw"],setup(w,{emit:N}){h.locale("es");const n=R();JSON.parse(localStorage.getItem("profile"));const T=N,v=w;n.$patch({typeDocuments:n.typeDocuments}),n.$patch({cities:n.cities}),n.$patch({genders:n.genders}),n.fetchTypeDocuments(),n.fetchCities(),n.fetchGenders();const S=b(!0),f=b(!1),Y=b(H);b(null);const e=$({typedocument_id:null,documentnumber:null,lastname:null,middlename:null,name:null,city_id:null,province_id:null,district_id:null,phone:null,email:null,gender_id:null,birthday:null,sick:null}),C=[{label:"Si",value:"yes"},{label:"No",value:"no"}],F=t=>{var r;t&&(e.typedocument_id=t.typedocument_id,e.documentnumber=t.documentnumber,e.lastname=t.lastname,e.middlename=t.middlename,e.name=t.name,e.city_id=t.city_id,k(t.city_id),D(t.province_id),e.province_id=t.province_id,e.district_id=t.district_id,e.phone=t.phone,e.email=t.email,e.gender_id=t.gender_id,e.sick=t.sick,t.birthday&&(e.birthday=h(t.birthday,"YYYY-MM-DD"))),(r=n.genders)!=null&&r.length&&(S.value=!1)},k=t=>{e.province_id=null,e.district_id=null,n.fetchProvinces(t)},D=t=>{e.district_id=null,n.fetchDistricts(t)},g=(t,r)=>{const d=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(d)},E=async()=>{let t={lastname:e.lastname,middlename:e.middlename,name:e.name,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,phone:e.phone,email:e.email,gender_id:e.gender_id,birthday:e.birthday?h(e.birthday).format("YYYY-MM-DD"):null,sick:e.sick};f.value=!0;try{const r=await J({url:`person/update/${v.updateValues.id}`,method:"PUT",data:t});y.success(r.message),T("closeDraw",!0)}catch(r){if(r.response.status==550)return y.error("El usuario ya se encuentra registrado");y.error("Error al registrar")}finally{f.value=!1}},M=()=>{y.error("Debes de completar todos los espacios requeridos")};return(t,r)=>{const d=c("a-select"),p=c("a-form-item"),V=c("a-input"),z=c("a-date-picker"),L=c("a-button"),P=c("a-form"),A=c("a-spin");return o(),s(A,{spinning:S.value},{default:m(()=>[_(P,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:E,onFinishFailed:M},{default:m(()=>[q("div",Q,[(o(!0),x(U,null,G(Y.value,(a,B)=>(o(),x(U,{key:B},[a.type==="iSelect"?(o(),s(p,{key:0,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:m(()=>[a.name=="typedocument_id"?(o(),s(d,{key:0,value:e[a.name],"onUpdate:value":i=>e[a.name]=i,options:u(n).typeDocuments,disabled:a.disabled},null,8,["value","onUpdate:value","options","disabled"])):l("",!0),a.name=="city_id"?(o(),s(d,{key:1,value:e[a.name],"onUpdate:value":i=>e[a.name]=i,"show-search":"",options:u(n).cities,"filter-option":g,onChange:k},null,8,["value","onUpdate:value","options"])):l("",!0),a.name=="province_id"?(o(),s(d,{key:2,value:e[a.name],"onUpdate:value":i=>e[a.name]=i,"show-search":"",options:u(n).provinces,"filter-option":g,onChange:D},null,8,["value","onUpdate:value","options"])):l("",!0),a.name=="district_id"?(o(),s(d,{key:3,value:e[a.name],"onUpdate:value":i=>e[a.name]=i,"show-search":"",options:u(n).districts,"filter-option":g},null,8,["value","onUpdate:value","options"])):l("",!0),a.name=="gender_id"?(o(),s(d,{key:4,value:e[a.name],"onUpdate:value":i=>e[a.name]=i,options:u(n).genders},null,8,["value","onUpdate:value","options"])):l("",!0),a.name=="sick"?(o(),s(d,{key:5,value:e[a.name],"onUpdate:value":i=>e[a.name]=i,options:C},null,8,["value","onUpdate:value"])):l("",!0)]),_:2},1032,["name","label","rules"])):l("",!0),a.type==="iText"?(o(),s(p,{key:1,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,type:a.email}]},{default:m(()=>[_(V,{value:e[a.name],"onUpdate:value":i=>e[a.name]=i,maxlength:a.max,disabled:a.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):l("",!0),a.type==="iDate"?(o(),s(p,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:m(()=>[_(z,{locale:u(I),value:e[a.name],"onUpdate:value":i=>e[a.name]=i,style:{width:"100%"},format:W,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):l("",!0)],64))),128))]),q("div",null,O(F(v.updateValues)),1),_(p,null,{default:m(()=>[_(L,{class:"btn-produce",type:"primary","html-type":"submit",loading:f.value},{default:m(()=>[j("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},ne=K(X,[["__scopeId","data-v-0197c537"]]);export{ne as S};
