import{l as Ue,r as g,a as H,b as c,o as l,x as h,w as s,e as x,d as w,F as k,s as we,h as N,y as r,c as i,M as ke,t as b,i as v,R as q,m as F,j as me,X as pe,G as xe,O as Ie,q as Ae}from"./index-0aedff4c.js";import{f as Ce}from"./actualizarUsuario-3eaca126.js";import{u as Se}from"./selectes-c677f6ab.js";import"./es-64ac2704.js";import{_ as De}from"./_plugin-vue_export-helper-c27b6911.js";import{M as Pe}from"./MoreOutlined-0db2c277.js";const Ee={class:"grid-profile"},Re="YYYY-MM-DD",Oe={__name:"EditarPerfil.componente",props:["updateUser"],emits:["closeDraw"],setup(z,{emit:P}){Ue.locale("es");const a=Se(),E=JSON.parse(localStorage.getItem("profile")),A=P;a.$patch({genders:a.genders}),a.$patch({cdes:a.cdes}),a.$patch({Offices:a.Offices}),a.$patch({roles:a.roles}),a.$patch({supervisores:a.supervisores}),a.fetchGenders(),a.fetchCdes(),a.fetchOffices(),a.fetchRoles();const C=z,I=g(!1),m=g(Ce),S=g(null),t=H({name:null,lastname:null,middlename:null,birthday:null,sick:null,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:E.id}),f=o=>{o&&(t.name=o.profile.name,t.lastname=o.profile.lastname,t.middlename=o.profile.middlename,t.birthday=o.profile.birthday,t.sick=o.profile.sick,t.phone=o.profile.phone,t.gender_id=o.profile.gender_id,t.cde_id=o.profile.cde_id,t.office_id=o.profile.office_id,t.email=o.email)},p=o=>{const y={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0};if(o===2)a.fetchSupervisores(),m.value={...m.value,supervisor_id:y};else{const{supervisor_id:R,...D}=m.value;m.value=D}},T=async()=>{I.value=!0;let o=t;delete o.email;try{const y=await q({url:`user/update/${C.updateUser.profile.id}`,method:"PUT",data:o});F.success(y.message),A("closeDraw",!0)}catch{F.error("No se pudo registrar este usuario")}finally{I.value=!1}},L=()=>{F.error("Debes de completar todos los espacios requeridos")};return(o,y)=>{const R=c("a-select"),D=c("a-form-item"),V=c("a-input"),Y=c("a-date-picker"),B=c("a-button"),O=c("a-form");return l(),h(O,{layout:"vertical",model:t,name:"basic",autocomplete:"off",onFinish:T,onFinishFailed:L},{default:s(()=>[x("div",Ee,[(l(!0),w(k,null,we(m.value,(e,j)=>(l(),w(k,{key:j},[e.type==="iSelect"?(l(),h(D,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[e.name=="gender_id"?(l(),h(R,{key:0,value:t[e.name],"onUpdate:value":n=>t[e.name]=n,options:N(a).genders},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="cde_id"?(l(),h(R,{key:1,value:t[e.name],"onUpdate:value":n=>t[e.name]=n,options:N(a).cdes},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="office_id"?(l(),h(R,{key:2,value:t[e.name],"onUpdate:value":n=>t[e.name]=n,options:N(a).Offices},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="role_id"?(l(),h(R,{key:3,value:t[e.name],"onUpdate:value":n=>t[e.name]=n,options:N(a).roles,onChange:p},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="supervisor_id"?(l(),h(R,{key:4,value:t[e.name],"onUpdate:value":n=>t[e.name]=n,options:N(a).supervisores},null,8,["value","onUpdate:value","options"])):r("",!0)]),_:2},1032,["name","label","rules"])):r("",!0),e.type==="iText"?(l(),h(D,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:s(()=>[i(V,{value:t[e.name],"onUpdate:value":n=>t[e.name]=n,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):r("",!0),e.type==="iDate"?(l(),h(D,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[i(Y,{locale:N(ke),value:S.value,"onUpdate:value":y[0]||(y[0]=n=>S.value=n),style:{width:"100%"},format:Re},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):r("",!0)],64))),128))]),x("div",null,b(f(C.updateUser)),1),i(D,null,{default:s(()=>[i(B,{class:"btn-produce",type:"primary","html-type":"submit",loading:I.value},{default:s(()=>y[1]||(y[1]=[v("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])}}},Ne=De(Oe,[["__scopeId","data-v-3578053d"]]);const Le={__name:"DrawAdministrarVistasUsuario",props:["idUser"],emits:["closeDraw"],setup(z,{emit:P}){const a=z,E=P,A=g(!0),C=g(!1),I=[{label:"Inicio",value:"inicio"},{label:"Drive Principal",value:"drive"},{label:"Drive Carpetas",value:"drive-mis-carpetas"},{label:"Drive Archivos",value:"drive-mis-archivos"},{label:"Drive Subir Archivo",value:"drive-subir-archivo"},{label:"formalizaciones - Principal",value:"asesorias"},{label:"AF - Registro",value:"asesorias-formalizaciones"},{label:"AF - Reportes",value:"asesorias-listado"},{label:"AF - Solicitantes",value:"solicitantes"},{label:"AF - Notarias",value:"notarias"},{label:"RUTA DIGITAL UGO PRINCIPAL",value:"ruta-digital-principal"},{label:"Registro de Ruta Digital UGO",value:"ruta-digital-registro"},{label:"PLANES DE ACCIÓN",value:"planes-accion-principal"},{label:"Registro Planes de Acción UGO",value:"planes-accion"},{label:"Convenios Principal",value:"convenios"},{label:"Convenios UGO",value:"estado-convenio-ugo"},{label:"Convenios UGSE",value:"estado-convenio-ugse"},{label:"Ferias Principal",value:"ferias"},{label:"Ferias Empresariales",value:"ferias-empresariales"},{label:"Ferias Participantes",value:"ferias-inscritos"},{label:"Asistencias Principal",value:"asistencia"},{label:"Asistencias UGO Listas",value:"asistencia-lista"},{label:"Asistencias UGO Usuarios",value:"asistencia-inscritos"},{label:"Calendario Principal",value:"calendario"},{label:"Eventos PNTE",value:"calendario-eventos"},{label:"Reserva de sala",value:"calendario-salas"},{label:"USUARIOS PRINCIPAL",value:"usuarios"},{label:"Nuevo usuario",value:"usuarios-nuevo"},{label:"Asesor - Notario",value:"asesor-externo-notario"},{label:"Lista usuarios",value:"usuarios-lista"},{label:"Asesores",value:"asesores"},{label:"Creación de usuarios",value:"nuevo-registro"},{label:"Config. Principal",value:"configuraciones"},{label:"Config. Token API",value:"tokens"},{label:"CDEs",value:"cdes"},{label:"Correos Masivos",value:"correos-masivos"},{label:"SED Principal",value:"sed"},{label:"SED MYPE",value:"sed-listado"},{label:"PP03 Principal",value:"pp03"},{label:"PP03 Listado",value:"pp03-listado"}];me(()=>{a.idUser&&t(a.idUser)});const m=H({indeterminate:!0,checkAll:!1,checkedList:[]});pe(()=>m.checkedList,f=>{m.indeterminate=!!f.length&&f.length<I.length,m.checkAll=f.length===I.length}),pe(()=>a.idUser,f=>{f&&t()});const S=async()=>{C.value=!0;const f={views:m.checkedList};try{const p=await q({url:`user/views/${a.idUser.id}`,method:"PUT",data:f});if(p.status==403)return F.error(p.message);F.success(p.message),E("closeDraw",!0)}catch{F.error("No se pudo registrar este usuario")}finally{C.value=!1}},t=async()=>{A.value=!0;try{const{data:f}=await q({url:`user/views/${a.idUser.id}`,method:"GET"});m.checkedList=f}catch(f){console.log("Error",f)}finally{A.value=!1}};return(f,p)=>{const T=c("a-checkbox-group"),L=c("a-spin"),o=c("a-button");return l(),w(k,null,[i(L,{spinning:A.value},{default:s(()=>[i(T,{value:m.checkedList,"onUpdate:value":p[0]||(p[0]=y=>m.checkedList=y),options:I,class:"views-list"},null,8,["value"])]),_:1},8,["spinning"]),p[2]||(p[2]=x("br",null,null,-1)),p[3]||(p[3]=x("br",null,null,-1)),i(o,{type:"primary","html-type":"submit",loading:C.value,onClick:S},{default:s(()=>p[1]||(p[1]=[v("GUARDAR")])),_:1},8,["loading"])],64)}}};const Ge=["onClick"],Fe=["onClick"],Te={class:"paginator"},Be={__name:"ListaUsuarios",setup(z){const P=g(null),a=g(!1),E=g(!1),A=g(50),C=g([]),I=g(!1),m=g(0),S=g({page:1}),t=g("user/list"),f=g(1200),p=g(window.innerHeight-100),T=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"DNI",dataIndex:"documentnumber",fixed:"left",width:80},{title:"Nombres",dataIndex:"name",width:120},{title:"Apellidos",dataIndex:"lastname",width:120},{title:"Correo",dataIndex:"email",width:200},{title:"Celular",dataIndex:"phone",width:100,align:"center"},{title:"Fecha Nac.",dataIndex:"birthday",width:100,align:"center"},{title:"Oficina",dataIndex:"office",width:120,align:"center"},{title:"CDE",dataIndex:"cde",width:140},{title:"ROL",dataIndex:"role",width:160},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],L=()=>{p.value=window.innerHeight-300},o=H({search:""}),y=()=>{let n={search:o.search};O(n)},R=()=>{o.search||O()},D=()=>{O(),a.value=!1,E.value=!1},V=n=>{S.value.page=n,O()},Y=n=>{P.value=n,a.value=!0},B=n=>{P.value=n,E.value=!0},O=async n=>{try{I.value=!0;const u=S.value.page===1?"":S.value,M=n?{...u,...n}:u,{data:$}=await q({url:t.value,method:"GET",params:M});C.value=$.data,m.value=$.total,A.value=$.per_page}catch(u){console.error("Error de red:",u)}finally{I.value=!1}},e=xe(()=>n=>(S.value.page-1)*A.value+n+1);me(()=>{O(),window.addEventListener("resize",L),L()});const j=()=>{console.log("Drawer state changed")};return(n,u)=>{const M=c("a-col"),$=c("a-input"),X=c("a-button"),ve=c("a-input-group"),fe=c("a-row"),G=c("a-tag"),J=c("a-menu-item"),_e=c("a-menu"),ge=c("a-dropdown"),be=c("a-table"),he=c("a-pagination"),K=c("a-drawer");return l(),w(k,null,[x("div",null,[u[6]||(u[6]=x("h3",{class:"title-produce"},"USUARIOS DEL PROGRAMA PNTE",-1)),i(fe,{style:{margin:"1rem 0"}},{default:s(()=>[i(M,{xs:24,md:12,lg:18}),i(M,{xs:24,md:12,lg:6},{default:s(()=>[i(ve,{compact:""},{default:s(()=>[i($,{value:o.search,"onUpdate:value":u[0]||(u[0]=_=>o.search=_),style:{width:"calc(100% - 80px)"},onInput:R},null,8,["value"]),i(X,{type:"primary",disabled:o.search==="",onClick:y},{default:s(()=>u[4]||(u[4]=[v("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),i(be,{bordered:"",scroll:{x:f.value,y:p.value},class:"table-users",columns:T,"data-source":C.value,pagination:!1,loading:I.value,size:"small"},{bodyCell:s(({column:_,record:d,index:ye})=>{var Q,W,Z,ee,ae,te,le,ne,se,oe,ie,re,ue,de,ce;return[_.dataIndex==="idx"?(l(),w(k,{key:0},[v(b(e.value(ye)),1)],64)):r("",!0),_.dataIndex=="documentnumber"?(l(),w(k,{key:1},[v(b((Q=d.profile)==null?void 0:Q.documentnumber),1)],64)):r("",!0),_.dataIndex=="name"?(l(),w(k,{key:2},[v(b((W=d.profile)==null?void 0:W.name),1)],64)):r("",!0),_.dataIndex=="lastname"?(l(),w(k,{key:3},[v(b((Z=d.profile)==null?void 0:Z.lastname)+" "+b((ee=d.profile)==null?void 0:ee.middlename),1)],64)):r("",!0),_.dataIndex=="phone"?(l(),w(k,{key:4},[v(b((ae=d.profile)!=null&&ae.phone?(te=d.profile)==null?void 0:te.phone:"🔒"),1)],64)):r("",!0),_.dataIndex=="birthday"?(l(),w(k,{key:5},[v(b((le=d.profile)!=null&&le.birthday?(ne=d.profile)==null?void 0:ne.birthday:"🔒"),1)],64)):r("",!0),_.dataIndex=="office"?(l(),w(k,{key:6},[((se=d.profile)==null?void 0:se.office.name)=="UGSE"?(l(),h(G,{key:0,color:"blue"},{default:s(()=>{var U;return[v(b((U=d.profile)==null?void 0:U.office.name),1)]}),_:2},1024)):r("",!0),((oe=d.profile)==null?void 0:oe.office.name)=="UGO"?(l(),h(G,{key:1,color:"orange"},{default:s(()=>{var U;return[v(b((U=d.profile)==null?void 0:U.office.name),1)]}),_:2},1024)):r("",!0),((ie=d.profile)==null?void 0:ie.office.name)=="DE"?(l(),h(G,{key:2,color:"green"},{default:s(()=>{var U;return[v(b((U=d.profile)==null?void 0:U.office.name),1)]}),_:2},1024)):r("",!0),((re=d.profile)==null?void 0:re.office.name)=="UGEER"?(l(),h(G,{key:3,color:"gray"},{default:s(()=>{var U;return[v(b((U=d.profile)==null?void 0:U.office.name),1)]}),_:2},1024)):r("",!0),((ue=d.profile)==null?void 0:ue.office.id)==5?(l(),h(G,{key:4,color:"blue"},{default:s(()=>u[5]||(u[5]=[v("Asesor Notaría ")])),_:1})):r("",!0)],64)):r("",!0),_.dataIndex=="cde"?(l(),w(k,{key:7},[v(b((de=d.profile)==null?void 0:de.cde.name),1)],64)):r("",!0),_.dataIndex=="role"?(l(),w(k,{key:8},[v(b((ce=d.roles[0])==null?void 0:ce.name),1)],64)):r("",!0),_.dataIndex=="actions"?(l(),h(ge,{key:9,trigger:["click"]},{overlay:s(()=>[i(_e,null,{default:s(()=>[i(J,null,{default:s(()=>[x("a",{onClick:U=>Y(d)},"Editar",8,Ge)]),_:2},1024),i(J,null,{default:s(()=>[x("a",{onClick:U=>B(d)},"Vistas",8,Fe)]),_:2},1024)]),_:2},1024)]),default:s(()=>[x("a",{class:"ant-dropdown-link",onClick:u[1]||(u[1]=Ie(()=>{},["prevent"]))},[i(X,{shape:"circle",icon:Ae(N(Pe)),size:"small"},null,8,["icon"])])]),_:2},1024)):r("",!0)]}),_:1},8,["scroll","data-source","loading"])]),x("div",Te,[x("span",null,[i(G,{color:"blue"},{default:s(()=>[x("b",null,b(m.value),1)]),_:1}),u[7]||(u[7]=v("Usuarios"))]),i(he,{size:"small",total:m.value,pageSize:A.value,onChange:V,showSizeChanger:!1},null,8,["total","pageSize"])]),i(K,{width:"550",open:a.value,"onUpdate:open":u[2]||(u[2]=_=>a.value=_),class:"draw-notary",title:"Editar Perfil",placement:"right",onAfterOpenChange:j},{default:s(()=>[i(Ne,{updateUser:P.value,onCloseDraw:D},null,8,["updateUser"])]),_:1},8,["open"]),i(K,{width:"450",open:E.value,"onUpdate:open":u[3]||(u[3]=_=>E.value=_),class:"draw-notary",title:"ADMINISTRAR VISTAS",placement:"right"},{default:s(()=>[i(Le,{idUser:P.value,onCloseDraw:D},null,8,["idUser"])]),_:1},8,["open"])],64)}}};export{Be as default};
