import{r as t,G as L,l as V,b as i,o as a,d as _,e as o,c as h,w as l,h as O,s as n,F as f,L as P,H as G,n as J,i as c,B as m}from"./index-72f6f2ec.js";const X="/assets/icoexcel-cd314d3c.png";const Y=o("h3",null,"LISTA DE MYPE",-1),j={class:"w-search"},q=o("img",{width:"20",style:{"margin-right":"6px"},src:X},null,-1),H={class:"paginator"},$={key:0,class:"full-spin"},W={__name:"MypesRD",setup(K){const E="http://apituempresa.soporte-pnte.com/api/v1",k="http://127.0.0.1:8000/api/v1",C=window.location.hostname=="127.0.0.1"?k:E,s=t(!1),r=t(null),v=t([]),x=t(!1),b=t(1200);t("");const y=t(0),D=t(null),N=L(P,{style:{fontSize:"40px"},spin:!0}),I=t({page:1}),R=[{title:"RUC",dataIndex:"ruc",fixed:"left",width:120},{title:"Razón social",dataIndex:"socialReason",width:250},{title:"Rubro",dataIndex:"category",width:200},{title:"Tipo",dataIndex:"type",align:"center",width:140},{title:"Departamento",dataIndex:"department",width:140},{title:"Distrito",dataIndex:"district",width:130},{title:"Nombres y Apellidos",dataIndex:"nameComplete",width:300},{title:"DNI",dataIndex:"dniNumber",align:"center",width:120},{title:"Sexo",dataIndex:"sex",align:"center",width:130},{title:"Teléfono",dataIndex:"phone",align:"center",width:130},{title:"Email",dataIndex:"email",width:300}],S=e=>{I.value.page=e,g()},A=()=>{let e=document.createElement("input");e.type="file",e.accept=".xls, .xlsx",e.onchange=d=>{r.value=d.target.files[0],U()},e.click()},U=()=>{if(!r.value){alert("Por favor selecciona un archivo Excel.");return}s.value=!0;const e=new FormData;e.append("file",r.value),G.post(`${C}/import-excel`,e,{headers:{Accept:"application/json","Content-Type":"multipart/form-data"}}).then(()=>{B()}).catch(d=>{console.error("Error al subir el archivo",d)}).finally(()=>{r.value=null})},B=()=>setInterval(()=>v.value.length<1?g():s.value=!1,3e3),g=async()=>{try{x.value=!0;const e=await J({url:"/mype",method:"GET",params:I.value});v.value=e.data,y.value=e.meta.total}catch(e){console.error("Error de red:",e)}finally{x.value=!1}};return V(g),(e,d)=>{const M=i("a-button"),u=i("a-tag"),T=i("a-table"),z=i("a-pagination"),F=i("a-spin");return a(),_(f,null,[o("div",null,[Y,o("div",j,[o("div",null,[h(M,{onClick:A,loading:s.value},{default:l(()=>[q,c(" SUBIR EXCEL ")]),_:1},8,["loading"])])]),h(T,{bordered:"",class:"ant-table-striped",scroll:{x:b.value,y:D.value},columns:R,"data-source":v.value,pagination:!1,loading:x.value,size:"small"},{bodyCell:l(({column:w,record:p})=>[w.dataIndex=="type"?(a(),_(f,{key:0},[p.type=="NATURAL"?(a(),m(u,{key:0,color:"success"},{default:l(()=>[c("Natural")]),_:1})):n("",!0),p.type=="JURIDICA"?(a(),m(u,{key:1,color:"error"},{default:l(()=>[c("Jurídica")]),_:1})):n("",!0)],64)):n("",!0),w.dataIndex=="sex"?(a(),_(f,{key:1},[p.sex=="MASCULINO"?(a(),m(u,{key:0,color:"blue"},{default:l(()=>[c("Masculino")]),_:1})):n("",!0),p.sex=="FEMENINO"?(a(),m(u,{key:1,color:"pink"},{default:l(()=>[c("Femenino")]),_:1})):n("",!0)],64)):n("",!0)]),_:1},8,["scroll","data-source","loading"])]),o("div",H,[h(z,{size:"small",pageSize:50,total:y.value,onChange:S,showSizeChanger:!1},null,8,["total"])]),s.value?(a(),_("div",$,[h(F,{indicator:O(N),spinning:s.value},null,8,["indicator","spinning"])])):n("",!0)],64)}}};export{W as default};
