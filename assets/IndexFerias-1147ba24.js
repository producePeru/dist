import{_ as G}from"./TableComponent-e1949cbb.js";import{c as y,A as z,r as o,j as U,X as B,b as M,o as S,d as w,w as h,h as q,e as x,y as L,K as J,l as D,a as $,a6 as C,R as j,m as Q,u as Z,x as X,F as K,i as H,t as P}from"./index-3a0984cb.js";import{_ as W}from"./FormComponent-7b5fa9fb.js";import{u as ee}from"./selectes-153bcc17.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";import"./es-91ce1409.js";import{d as te}from"./downloadExcel-1ba513e3.js";import{C as le}from"./CloudUploadOutlined-973c0a8e.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-8e875470.js";import"./quill.snow-461e4e79.js";var ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"};const ne=ie;function k(m){for(var d=1;d<arguments.length;d++){var s=arguments[d]!=null?Object(arguments[d]):{},g=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(g=g.concat(Object.getOwnPropertySymbols(s).filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable}))),g.forEach(function(n){se(m,n,s[n])})}return m}function se(m,d,s){return d in m?Object.defineProperty(m,d,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[d]=s,m}var V=function(d,s){var g=k({},d,s.attrs);return y(z,k({},g,{icon:ne}),null)};V.displayName="FileImageOutlined";V.inheritAttrs=!1;const re=V;const oe={class:"clearfix"},de={key:0},ce=["src"],me={__name:"UpImage",props:{acceptFormats:{type:Array,default:()=>["image/jpeg","image/png","image/jpg","image/gif","image/webp"]},maxImages:{type:Number,default:1},imageLoad:{type:Object,default:()=>null}},emits:["uploadSuccess"],setup(m,{emit:d}){const s=m,g=d,n=o([]),O=o(!1),e=o(""),u=o(""),b=i=>new Promise((r,_)=>{const p=new FileReader;p.readAsDataURL(i),p.onload=()=>r(p.result),p.onerror=c=>_(c)}),t=async i=>{var r;!i.url&&!i.preview&&(i.preview=await b(i.originFileObj)),e.value=i.url||i.preview,O.value=!0,u.value=i.name||((r=i.url)==null?void 0:r.substring(i.url.lastIndexOf("/")+1))},F=()=>{O.value=!1,u.value=""},E=i=>s.acceptFormats.includes(i.type)?n.value.length<s.maxImages:(alert("Formato de imagen no permitido."),!1),Y=async({file:i,onSuccess:r,onError:_})=>{const p=new FormData;p.append("file",i),p.append("from_origin","feria");try{const l=(await J.post("http://127.0.0.1:8000/api/image/upload-image",p,{headers:{"Content-Type":"multipart/form-data"}})).data;if(l.status===200){const f={id:l.data.id};g("uploadSuccess",f)}const a={uid:i.uid,name:i.name,status:"done",url:l.thumb};n.value=[a],r(l,i)}catch(c){console.error(c),_(c)}},R=async i=>{};function T(i){const r=i.name||"imagen-cargada",_={uid:"-1",name:r,status:"done",url:i.url};n.value=[_],e.value=i.url,u.value=r}return U(()=>{s.imageLoad&&T(s.imageLoad)}),B(()=>s.imageLoad,i=>{i?T(i):(n.value=[],e.value="",u.value="")}),(i,r)=>{const _=M("a-upload"),p=M("a-modal");return S(),w("div",oe,[y(_,{"file-list":n.value,"onUpdate:fileList":r[0]||(r[0]=c=>n.value=c),"custom-request":Y,"before-upload":E,"on-remove":R,accept:m.acceptFormats.join(","),"list-type":"picture-card",onPreview:t},{default:h(()=>[n.value.length<s.maxImages?(S(),w("div",de,[y(q(re)),r[1]||(r[1]=x("div",{style:{"margin-top":"8px"}},"Cargar",-1))])):L("",!0)]),_:1},8,["file-list","accept"]),y(p,{open:O.value,title:u.value,footer:null,onCancel:F},{default:h(()=>[x("img",{alt:"example",style:{width:"100%"},src:e.value},null,8,ce)]),_:1},8,["open","title"])])}}},ue=ae(me,[["__scopeId","data-v-2af5f06b"]]);const pe={class:"fairs"},fe={key:0},ge={__name:"DrawerFeria",props:["info"],emits:["closeDraw"],setup(m,{emit:d}){D.locale("es");const s=o({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},subTitle:{type:"iText",label:"SUBTÍTULO DEL EVENTO (Opcional)",name:"subTitle",required:!1,message:"Escribir subtítulo del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},fairtype_id:{type:"iSelect",label:"TIPO DE FERIA",name:"fairtype_id",required:!0,message:"Seleccionar tipo de Feria",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},place:{type:"iText",label:"LUGAR DEL EVENTO",name:"place",required:!1,message:"Escribir nombre del evento",disabled:!1,placeholder:""},hours:{type:"iText",label:"HORARIO",name:"hours",required:!1,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm"},messageImgBanner:{type:"iLabel",label:"IMAGEN PARA EL BANER",name:"messageImgBanner"},imgBanner:{type:"iSlot",name:"iSlotOptions"},messageEndForm:{type:"iLabel",label:"CONFIGURACIÓN DE MENSAJES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE DE CIERRE DE INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const g=d,n=m,O=o("GUARDAR"),e=$({}),u=o(!1),b=o(null),t=ee(),F=o(null),E=o({city_id:[],fairtype_id:[],modality_id:[]}),Y=()=>n.info?{name:n.info.image.name,url:n.info.image.url}:null,R=a=>{},T=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),s.value.dateTramite.disabled=!1)},i=async a=>{b.value=a.id},r=async a=>{a=="city_id"&&(await t.fetchCitiesNational(),e.city_id=null,E.value.city_id=t.citiesNational),a=="fairtype_id"&&(await t.fetchFairTypes(),E.value.fairtype_id=t.fairTypes),a=="modality_id"&&(await t.fetchModalities(),E.value.modality_id=t.modalities)},_=a=>{},p=async()=>{u.value=!0;const a={title:e.title,subTitle:e.subTitle,description:e.description,fairtype_id:e.fairtype_id,modality_id:e.modality_id,startDate:D(e.dates.start).format("YYYY-MM-DD"),endDate:D(e.dates.end).format("YYYY-MM-DD"),metaMypes:e.metaMypes,city_id:e.city_id,place:e.place,hours:e.hours,msgEndForm:e.msgEndForm,msgSendEmail:e.msgSendEmail,image_id:b.value};try{const f=n.info?`fair/update/${n.info.id}`:"fair/create",v=n.info?"PUT":"POST",A=await j({url:f,method:v,data:a});A.status===200&&(Q.success(A.message),c(),g("closeDraw",!0))}catch(f){console.error("Error:",f);const v=document.getElementsByClassName("ant-drawer-body")[0];v&&(v.scrollTop=0)}finally{u.value=!1}},c=()=>{e.title=null,e.subTitle=null,e.description="</p>",e.fairtype_id=null,e.modality_id=null,e.dates=null,e.metaMypes=null,e.city_id=null,e.place=null,e.hours=null,e.msgEndForm="</p>",e.msgSendEmail="</p>"},l=async a=>{a&&(e.title=a.title,e.subTitle=a.subTitle,e.description=a.description,await t.fetchFairTypes(),E.value.fairtype_id=t.fairTypes,e.fairtype_id=a.fairtype_id,await t.fetchModalities(),E.value.modality_id=t.modalities,e.modality_id=a.modality_id,e.dates={start:D(a.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:D(a.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.metaMypes=a.metaMypes,await t.fetchCitiesNational(),E.value.city_id=t.citiesNational,e.city_id=a.city_id,e.place=a.place,e.hours=a.hours,e.msgEndForm=a.msgEndForm||"</p>",e.msgSendEmail=a.msgSendEmail||"</p>")};return U(()=>{n.info&&l(n.info)}),B(()=>n.info,a=>{a?l(a):c()}),C("formState",e),C("loadingState",u),(a,f)=>(S(),w("div",pe,[y(W,{fields:s.value,options:E.value,btnSaveName:O.value,onHandleInputEvent:R,resetSelect:F.value,onHandleFocusSelect:r,onHandleBlurSelect:_,onHandleChangeClock:T,onOnSubmit:p},{default:h(({field:v})=>[v.name=="iSlotOptions"?(S(),w("div",fe,[y(ue,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:i,imageLoad:Y()},null,8,["imageLoad"])])):L("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const ye={class:"advisory-table"},Ee={key:0,style:{"line-height":"1.5"}},_e={key:1},ve=["onClick"],he=["onClick"],Re={__name:"IndexFerias",setup(m){JSON.parse(localStorage.getItem("role"));const d=o([]),s=o(0),g=o(150),n=o(!1);o(!1);const O=Z(),e=o(!1),u=o(null),b=o(!1),t=$({year:D("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),F=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:200},{title:"SUB TÍTULO DEL EVENTO",dataIndex:"subTitle",width:200},{title:"TIPO DE FERIA",dataIndex:"fairtype_name",width:150,align:"center"},{title:"MODALIDAD",dataIndex:"modality_name",width:140,align:"center"},{title:"FECHAS",dataIndex:"date",width:160,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:120,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:120,align:"center"},{title:"REGIÓN",dataIndex:"city_name",width:150,align:"center"},{title:"LUGAR",dataIndex:"place",width:150,align:"center"},{title:"HORARIO",dataIndex:"hours",width:150,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description3",width:360},{title:"MENSAJE DE FINALIZACIÓN",dataIndex:"msgEndForm3",width:360},{title:"MENSAJE DE ENVÍO CORREO",dataIndex:"msgSendEmail3",width:360},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],E=o([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]),Y=l=>{O.push(`/admin/ferias/inscritos/${l.slug}`)},R=l=>{u.value=l,n.value=!0},T=()=>{c(),n.value=!1},i=()=>{u.value=null,n.value=!0},r=async()=>{b.value=!0;try{const l={};t.year&&(l.year=D(t.year).format("YYYY")),t.range&&(l.dateStart=t.range[0].format("YYYY/MM/DD"),l.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(l.name=t.name),t.orderby&&(l.orderby=t.orderby),t.asesor&&(l.asesor=t.asesor),await te("download/attendance-ugo","eventos-ugo",l)}catch(l){console.error("Error de red:",l)}finally{b.value=!1}},_=async l=>{t.page=l,await c()},p=async l=>{l&&(t.page=1,await c())},c=async()=>{try{e.value=!0;const l={page:t.page};t.year&&(l.year=D(t.year).format("YYYY")),t.range&&(l.dateStart=t.range[0].format("YYYY/MM/DD"),l.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(l.name=t.name),t.orderby&&(l.orderby=t.orderby);const f=await j({url:"fair/list",method:"GET",params:l});d.value=f.data.data,s.value=f.data.total,g.value=f.data.per_page}catch(l){console.error("Error de red:",l)}finally{e.value=!1}};return U(async()=>{await c()}),C("search",t),C("loading",e),C("loadingFile",b),(l,a)=>{const f=M("router-link"),v=M("a-menu-item"),A=M("a-drawer");return S(),w("div",ye,[y(G,{title:"LISTA DE EVENTOS",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:F,othersList:E.value,titleSearch:"BUSCAR POR EVENTO",pageSize:g.value,nameTotal:"Eventos PP03",dataSource:d.value,total:s.value,onHandleNew:i,onHandleDownloadExcel:r,onHandleSearch:p,onHandlePaginator:_},{"data-cell":h(({column:N,record:I})=>[N.dataIndex=="link"?(S(),X(f,{key:0,to:`/feria/${I.slug}`,target:"_blank"},{default:h(()=>[y(q(le),{style:{"font-size":"18px"}})]),_:2},1032,["to"])):L("",!0),N.dataIndex=="date"?(S(),w(K,{key:1},[I.startDate!=I.endDate?(S(),w("span",Ee,[a[1]||(a[1]=x("b",null,"Desde:",-1)),H(" "+P(I.dateStartFormat)+" ",1),a[2]||(a[2]=x("b",null,"Hasta:",-1)),H(" "+P(I.dateEndFormat),1)])):(S(),w("span",_e,P(I.dateStartFormat),1))],64)):L("",!0)]),"custom-options":h(({record:N})=>[y(v,null,{default:h(()=>[x("a",{onClick:I=>Y(N)},"Inscritos",8,ve)]),_:2},1024),y(v,null,{default:h(()=>[x("a",{onClick:I=>R(N)},"Editar",8,he)]),_:2},1024)]),_:1},8,["othersList","pageSize","dataSource","total"]),y(A,{open:n.value,"onUpdate:open":a[0]||(a[0]=N=>n.value=N),title:u.value?"EDITAR REGISTRO":"REGISTRAR UN EVENTO",placement:"right",width:"550"},{default:h(()=>[y(ge,{onCloseDraw:T,info:u.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Re as default};
