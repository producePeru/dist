import{_ as Q}from"./icoexcel-1b303edf.js";import{l as W,E as ee,u as te,g as ae,r as o,a as ne,G as oe,Z as le,j as se,b as l,o as N,d as k,e as i,c as a,w as s,i as _,F as U,R as re,h as ie,a7 as de,t as E,y as ce,K as ue}from"./index-7e9acb77.js";import"./es-9e9e6cdd.js";const pe={class:"title-produce"},me={style:{color:"var(--secondary)"}},ge={class:"paginator"},xe={__name:"inscritos-index",props:["idConvenio"],setup(_e){W.locale("es");const I=ee();te();const L=JSON.parse(localStorage.getItem("role"))||[],T=ae.get("token"),z="https://apituempresa.soporte-pnte.com/api/",B="http://127.0.0.1:8000/api/",b=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?B:z;L.some(t=>t.id===10||t.id===11||t.id===5);const y=o(""),C=o(null),R=o(!1);o(null);const v=o(!1),w=o(0),f=o(50),p=o({page:0}),M=o(1200),O=o([]),h=o(!1);o(!1);const S=o(window.innerHeight-100),$=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"REGISTRADO",dataIndex:"created_at",fixed:"left",width:120,align:"center"},{title:"APELLIDOS",dataIndex:"lastname",fixed:"left",width:160},{title:"NOMBRES ",dataIndex:"name",width:160,fixed:"left"},{title:"TIPO DOCUMENTO",dataIndex:"typedocument",width:100,align:"center"},{title:"NÚMERO DE DOCUMENTO",dataIndex:"documentnumber",align:"center",width:140},{title:"CELULAR",dataIndex:"phone",width:150,align:"center"},{title:"CORREO",dataIndex:"email",align:"center",width:140},{title:"GÉNERO",dataIndex:"gender",align:"center",width:100},{title:"DISCAPACIDAD",dataIndex:"sick",align:"center",width:120},{title:"RUC",dataIndex:"ruc",align:"center",width:120},{title:"SECTOR ECONÓMICO",dataIndex:"economicsector",align:"center",width:140},{title:"ACTIVIDAD COMERCIAL",dataIndex:"comercialActivity",align:"center",width:200}],d=ne({search:""}),A=()=>{let t={search:d.search};m(t)},G=()=>{d.search||m()},F=t=>{p.value.page=t,m()},x=()=>{S.value=window.innerHeight-320},P=oe(()=>t=>p.value.page*f.value+t+1),m=async t=>{try{h.value=!0;let e;e=p.value.page==0?"":p.value,e=t?{...e,...t}:e;const c=I.params.slug,r=await re({url:`attendance/applicants/${c}`,method:"GET",params:e});y.value=r.nameEvent,C.value=r.typeEvent;const n=r.data;O.value=n==null?void 0:n.data,w.value=n.total,f.value=n.per_page}catch(e){console.error("Error de red:",e)}finally{h.value=!1}},V=async()=>{v.value=!0;try{const t=I.params.slug;let e=null;C.value==3?e=`${b}download/attendance-mercado/${t}`:e=`${b}download/attendance/${t}`;const c=await ue({url:e,method:"GET",responseType:"blob",headers:{Authorization:`Bearer ${T}`}}),r=window.URL.createObjectURL(new Blob([c.data])),n=document.createElement("a"),g=`${t}.xlsx`;n.href=r,n.setAttribute("download",g),document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(r),document.body.removeChild(n)}catch(t){console.error("Error downloading file:",t)}finally{v.value=!1}};return le(()=>{window.removeEventListener("resize",x)}),se(()=>{window.addEventListener("resize",x),x(),m()}),(t,e)=>{const c=l("router-link"),r=l("a-breadcrumb-item"),n=l("a-breadcrumb"),g=l("a-button"),D=l("a-col"),j=l("a-input"),H=l("a-input-group"),q=l("a-row"),J=l("a-table"),K=l("a-tag"),X=l("a-pagination"),Y=l("a-drawer");return N(),k(U,null,[i("div",null,[a(n,null,{default:s(()=>[a(r,null,{default:s(()=>[a(c,{to:"/admin/eventos-ugo/lista"},{default:s(()=>[a(ie(de)),e[2]||(e[2]=i("span",{class:"fs-13"},"Atrás",-1))]),_:1})]),_:1}),a(r,null,{default:s(()=>[i("h3",pe,[e[3]||(e[3]=_("REGISTRO DE ASISTENCIA - ")),i("span",me,E(y.value),1)])]),_:1})]),_:1}),a(q,{style:{margin:"1rem 0"}},{default:s(()=>[a(D,{xs:24,md:12,lg:18},{default:s(()=>[e[5]||(e[5]=i("span",null,null,-1)),a(g,{class:"btn-excel",onClick:V,loading:v.value,type:"primary"},{default:s(()=>e[4]||(e[4]=[i("img",{width:"20",style:{margin:"-2px 0 0 0"},src:Q},null,-1)])),_:1},8,["loading"])]),_:1}),a(D,{xs:24,md:12,lg:6},{default:s(()=>[a(H,{compact:""},{default:s(()=>[a(j,{onPressEnter:A,value:d.search,"onUpdate:value":e[0]||(e[0]=u=>d.search=u),style:{width:"calc(100% - 80px)"},onInput:G,placeholder:"Buscar por NOMBRE, DNI o RUC"},null,8,["value"]),a(g,{type:"primary",disabled:d.search==="",onClick:A},{default:s(()=>e[6]||(e[6]=[_("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),a(J,{bordered:"",scroll:{x:M.value,y:S.value},class:"table-agreements-ugse",columns:$,"data-source":O.value,pagination:!1,loading:h.value,size:"small"},{bodyCell:s(({column:u,record:ve,index:Z})=>[u.dataIndex=="idx"?(N(),k(U,{key:0},[_(E(P.value(Z)),1)],64)):ce("",!0)]),_:1},8,["scroll","data-source","loading"])]),i("div",ge,[i("span",null,[a(K,{color:"blue"},{default:s(()=>[i("b",null,E(w.value),1)]),_:1}),e[7]||(e[7]=_("Inscritos"))]),a(X,{size:"small",total:w.value,pageSize:f.value,onChange:F,showSizeChanger:!1},null,8,["total","pageSize"])]),a(Y,{open:R.value,"onUpdate:open":e[1]||(e[1]=u=>R.value=u),title:"Nueva Feria",placement:"right",width:"650"},null,8,["open"])],64)}}};export{xe as default};
