import{c as i,A as ce,L as H,r as g,a as xe,b as h,o as s,q as $,w as v,e as C,d as f,F as N,x as ue,h as O,s as w,M as ye,i as R,z as Q,m as Y,k as pe,K as Ie,a0 as Te,a1 as Se,t as I,a2 as be,g as ke,N as Ae,a3 as Le,H as ae,I as Ye,v as qe,a4 as Ve,n as De,a5 as Fe,R as je,J as Be,p as He,j as Ge}from"./index-06cb9dfe.js";import{_ as Je}from"./icoexcel-1b303edf.js";import{u as $e}from"./selectes-de8c5c4f.js";import"./es-52b9c26f.js";import{_ as Ue}from"./_plugin-vue_export-helper-c27b6911.js";import{M as Qe}from"./MoreOutlined-b45d3f74.js";var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};const Ze=Xe;function we(c){for(var l=1;l<arguments.length;l++){var a=arguments[l]!=null?Object(arguments[l]):{},n=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(y){return Object.getOwnPropertyDescriptor(a,y).enumerable}))),n.forEach(function(y){We(c,y,a[y])})}return c}function We(c,l,a){return l in c?Object.defineProperty(c,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):c[l]=a,c}var me=function(l,a){var n=we({},l,a.attrs);return i(ce,we({},n,{icon:Ze}),null)};me.displayName="CloudUploadOutlined";me.inheritAttrs=!1;const Ke=me;var et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};const tt=et;function Ce(c){for(var l=1;l<arguments.length;l++){var a=arguments[l]!=null?Object(arguments[l]):{},n=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(y){return Object.getOwnPropertyDescriptor(a,y).enumerable}))),n.forEach(function(y){at(c,y,a[y])})}return c}function at(c,l,a){return l in c?Object.defineProperty(c,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):c[l]=a,c}var ve=function(l,a){var n=Ce({},l,a.attrs);return i(ce,Ce({},n,{icon:tt}),null)};ve.displayName="MessageOutlined";ve.inheritAttrs=!1;const nt=ve;var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};const it=ot;function Oe(c){for(var l=1;l<arguments.length;l++){var a=arguments[l]!=null?Object(arguments[l]):{},n=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(y){return Object.getOwnPropertyDescriptor(a,y).enumerable}))),n.forEach(function(y){st(c,y,a[y])})}return c}function st(c,l,a){return l in c?Object.defineProperty(c,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):c[l]=a,c}var _e=function(l,a){var n=Oe({},l,a.attrs);return i(ce,Oe({},n,{icon:it}),null)};_e.displayName="SaveOutlined";_e.inheritAttrs=!1;const lt=_e,rt={city_id:{type:"iSelect",label:"Región",name:"city_id",required:!0,message:"Seleccionar una región",disabled:!0},province_id:{type:"iSelect",label:"Provincia",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"Distrito",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},denomination:{type:"iText",label:"Denominación",name:"denomination",required:!0,message:"Escribir la denominación",disabled:!0},alliedEntity:{type:"iText",label:"Entidad Aliada",name:"alliedEntity",required:!0,message:"Escribir la entidad aliada",disabled:!0},homeOperations:{type:"iDate",label:"Inicio de Operaciones",name:"homeOperations",required:!0,message:"Escribir el incio de las operaciones",disabled:!0},address:{type:"iText",label:"Dirección",name:"address",required:!0,message:"Escribir la dirección",disabled:!0},reference:{type:"iText",label:"Referencia",name:"reference",required:!0,message:"Escribir la referencia",disabled:!0},resolution:{type:"iText",label:"Resolución de Autorización de CDE",name:"resolution",required:!0,message:"Escribir la referencia",disabled:!0},startDate:{type:"iDate",label:"Inicio Convenio Vigente",name:"startDate",required:!0,message:"Seleccionar fecha de convenio vigente",disabled:!0},endDate:{type:"iDate",label:"Fin del convenio",name:"endDate",required:!0,message:"Seleccionar fecha fin de convenio",disabled:!0},initials:{type:"iCheckbox",label:"Entidades",name:"initials",required:!0,message:"Escribir la referencia",disabled:!0}};const dt={class:"grid-convenios"},Ee="DD/MM/YYYY",ct={__name:"DrawConvenio",emits:["closeDraw"],setup(c,{emit:l}){H.locale("es");const a=JSON.parse(localStorage.getItem("profile")),n=$e(),y=l;n.$patch({cities:n.cities}),n.$patch({provinces:n.provinces}),n.$patch({districts:n.districts}),n.$patch({agreementStatus:n.agreementStatus}),n.$patch({operationalStatus:n.operationalStatus}),n.fetchCities(),n.fetchAgreementStatus(),n.fetchOperationalStatus();const S=g(!1),U=g(!1),z=["UGO  - TU EMPRESA","TU EMPRESA - DVMYPE","DVMYPE-SG","SG-OGPPM","OGPPM-TU EMPRESA","TU EMPRESA-ALIADO"],e=xe({}),q=r=>{const u=H(e.startDate).add(1,"day").startOf("day");return H(r).startOf("day").isBefore(u,"day")},P=r=>{e.province_id=null,e.district_id=null,n.fetchProvinces(r)},X=r=>{e.district_id=null,n.fetchDistricts(r)},T=(r,u)=>{const o=r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return u.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)},j=()=>{e.denomination=null,e.alliedEntity=null,e.homeOperations=null,e.address=null,e.reference=null,e.resolution=null,e.initials=null,e.startDate=null,e.endDate=null,e.city_id=null,e.province_id=null,e.district_id=null,e.operationalstatus_id=null,e.agreementstatus_id=null,e.created_id=a.user_id},M=async()=>{S.value=!0;const r={denomination:e.denomination,alliedEntity:e.alliedEntity,homeOperations:H(e.homeOperations).format("YYYY-MM-DD"),address:e.address,reference:e.reference,resolution:e.resolution,initials:e.initials,startDate:H(e.startDate).format("YYYY-MM-DD"),endDate:H(e.endDate).format("YYYY-MM-DD"),city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,operationalstatus_id:e.operationalstatus_id,agreementstatus_id:e.agreementstatus_id,created_id:a.user_id};try{const u=await Q({url:"agreement/create",method:"POST",data:r});u.status==200&&(Y.success(u.message),y("closeDraw",!0),j())}catch(u){Y.error("Se originó un error: "+u.message)}finally{S.value=!1}},V=()=>{Y.error("Debes de completar todos los espacios requeridos")};return(r,u)=>{const o=h("a-input"),m=h("a-form-item"),b=h("a-select"),k=h("a-date-picker"),Z=h("a-checkbox-group"),A=h("a-button"),L=h("a-form"),G=h("a-spin");return s(),$(G,{spinning:U.value},{default:v(()=>[i(L,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:M,onFinishFailed:V},{default:v(()=>[C("div",dt,[(s(!0),f(N,null,ue(O(rt),(t,oe)=>(s(),f(N,{key:oe},[t.type==="iText"?(s(),$(m,{key:0,name:t.name,label:t.label,rules:[{required:t.required,message:t.message,max:t.max}]},{default:v(()=>[i(o,{value:e[t.name],"onUpdate:value":E=>e[t.name]=E,maxlength:t.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):w("",!0),t.type==="iSelect"?(s(),$(m,{key:1,class:"item-max",name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:v(()=>[t.name=="city_id"?(s(),$(b,{key:0,value:e[t.name],"onUpdate:value":E=>e[t.name]=E,options:O(n).cities,"show-search":"","filter-option":T,onChange:P},null,8,["value","onUpdate:value","options"])):w("",!0),t.name=="province_id"?(s(),$(b,{key:1,value:e[t.name],"onUpdate:value":E=>e[t.name]=E,options:O(n).provinces,"show-search":"","filter-option":T,onChange:X,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):w("",!0),t.name=="district_id"?(s(),$(b,{key:2,value:e[t.name],"onUpdate:value":E=>e[t.name]=E,options:O(n).districts,"show-search":"","filter-option":T,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):w("",!0),t.name=="operationalstatus_id"?(s(),$(b,{key:3,value:e[t.name],"onUpdate:value":E=>e[t.name]=E,options:O(n).operationalStatus,"show-search":"","filter-option":T},null,8,["value","onUpdate:value","options"])):w("",!0),t.name=="agreementstatus_id"?(s(),$(b,{key:4,value:e[t.name],"onUpdate:value":E=>e[t.name]=E,options:O(n).agreementStatus,"show-search":"","filter-option":T},null,8,["value","onUpdate:value","options"])):w("",!0)]),_:2},1032,["name","label","rules"])):w("",!0),t.type==="iDate"?(s(),$(m,{key:2,name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:v(()=>[t.name=="endDate"?(s(),$(k,{key:0,"disabled-date":q,locale:O(ye),disabled:!e.startDate,value:e[t.name],"onUpdate:value":E=>e[t.name]=E,style:{width:"100%"},format:Ee,placeholder:"día/mes/año"},null,8,["locale","disabled","value","onUpdate:value"])):(s(),$(k,{key:1,locale:O(ye),value:e[t.name],"onUpdate:value":E=>e[t.name]=E,style:{width:"100%"},format:Ee,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"]))]),_:2},1032,["name","label","rules"])):w("",!0),t.type==="iCheckbox"?(s(),$(m,{key:3,name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:v(()=>[i(Z,{value:e[t.name],"onUpdate:value":E=>e[t.name]=E,name:"checkboxgroup",options:z,style:{display:"grid","grid-gap":".2rem"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):w("",!0)],64))),128))]),i(m,null,{default:v(()=>[i(A,{type:"primary","html-type":"submit",loading:S.value},{default:v(()=>[R("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}},ut=Ue(ct,[["__scopeId","data-v-a5681a47"]]);const pt={class:"accion-icons"},mt={key:0},vt={key:1},_t={__name:"DrawAcciones",props:["idConvenio"],emits:["closeDraw"],setup(c,{emit:l}){const a=c,n=g([]),y=g(!0),S=g(null),U=g(""),z=g(!1);g(null);const e=xe({description:null});pe(()=>{a.idConvenio&&M(a.idConvenio)}),Ie(()=>a.idConvenio,r=>{r&&M()});function q(r){S.value=r.id,U.value=r.description,be(()=>{V()})}function P(r){const u=n.value.findIndex(o=>o.id===r.id);u!==-1&&(n.value[u].description=U.value),S.value=null,T(r.id)}const X=async r=>{try{const u=await Q({url:`agreement/delete-acction/${r.id}`,method:"DELETE"});u.status==200&&(M(),Y.success(u.message))}catch(u){console.error("Error de red:",u)}},T=async r=>{try{const u={description:U.value},o=await Q({url:`agreement/update/${r}`,method:"PUT",data:u});o.status==200&&(Y.success(o.message),M())}catch(u){console.error("Error de red:",u)}},j=async()=>{try{const r={description:e.description,agreements_id:a.idConvenio},u=await Q({url:"agreement/create-acction",method:"POST",data:r});u.status==200&&(Y.success(u.message),M(),e.description=null)}catch(r){console.error("Error de red:",r)}},M=async()=>{y.value=!0;try{const r=await Q({url:`agreement/list/${a.idConvenio}`,method:"GET"});r.status==200&&(n.value=r.data)}catch{}finally{y.value=!1}},V=()=>{be(()=>{const r=document.getElementById("auto-resize");r.style.height="auto",r.style.height=r.scrollHeight+"px"})};return(r,u)=>{const o=h("a-textarea"),m=h("a-spin"),b=h("a-form-item"),k=h("a-button"),Z=h("a-form");return s(),f("div",null,[i(m,{spinning:y.value},{default:v(()=>[(s(!0),f(N,null,ue(n.value,(A,L)=>(s(),f("div",{class:"acciones",key:L},[C("div",pt,[i(O(Te),{class:"pointer ico-acc",onClick:G=>q(A)},null,8,["onClick"]),S.value===A.id?(s(),$(O(lt),{key:0,class:"pointer ico-save",onClick:G=>P(A)},null,8,["onClick"])):w("",!0),i(O(Se),{class:"pointer ico-acc",onClick:G=>X(A)},null,8,["onClick"])]),S.value===A.id?(s(),f("div",mt,[i(o,{value:U.value,"onUpdate:value":u[0]||(u[0]=G=>U.value=G),onInput:V,id:"auto-resize"},null,8,["value"])])):(s(),f("p",vt,I(A.description),1))]))),128))]),_:1},8,["spinning"]),i(Z,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:j},{default:v(()=>[i(b,{name:"description",label:"Registra una acción",rules:[{required:!0,message:"Escribir la descripción"}]},{default:v(()=>[i(o,{value:e.description,"onUpdate:value":u[1]||(u[1]=A=>e.description=A),maxlength:250,rows:4},null,8,["value"])]),_:1}),i(b,null,{default:v(()=>[i(k,{type:"primary","html-type":"submit",loading:z.value},{default:v(()=>[R("CREAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const ft=C("div",{class:"agreements-file"},[C("b",null,"Formatos a subir"),C("span",null,"pdf, doc, docx, xls, xlsx, ppt, pptx"),C("span",null,"*(Máximo 20MB)")],-1),gt={class:"file-options"},ht={style:{"line-height":"1.3"}},yt=["onClick"],bt=["onClick"],Dt={__name:"DrawFiles",props:["idConvenio"],setup(c){H.locale("es");const l=ke.get("token"),a=c,n="https://apituempresa.soporte-pnte.com/api/",y="http://127.0.0.1:8000/api/",S=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?y:n,U=g(!1),z=g([]),e=g(null),q=g(null),P=Ae(Le,{style:{fontSize:"20px"},spin:!0});pe(()=>{a.idConvenio&&u(a.idConvenio)}),Ie(()=>a.idConvenio,o=>{o&&u(o)});const X=o=>H(o).format("DD-MM-YYYY HH:mm"),T=o=>(j(o),!1),j=async o=>{const m=new FormData;m.append("file",o),m.append("agreements_id",a.idConvenio),U.value=!0;try{const{data:b}=await ae.post(`${S}agreement/file`,m,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${l}`}});b.status==200&&(Y.success(b.message),u(a.idConvenio))}catch{Y.error("Error al subir este tipo de archivo")}finally{U.value=!1}},M=async o=>{e.value=o.uid;try{const m=await ae({url:`${S}agreement/file-download/${o.uid}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${l}`}}),b=window.URL.createObjectURL(new Blob([m.data])),k=document.createElement("a");k.href=b,k.setAttribute("download",o.name),document.body.appendChild(k),k.click(),window.URL.revokeObjectURL(b),document.body.removeChild(k)}catch(m){console.error("Error downloading file:",m)}finally{e.value=null}},V=o=>{o.file.status!=="uploading"&&console.log(o.file,o.fileList),o.file.status==="done"?(Y.success(`${o.file.name} file uploaded successfully`),z.value=o.fileList.filter(m=>m.status!=="error")):o.file.status==="error"&&(Y.error(`${o.file.name} file upload failed.`),z.value=o.fileList.filter(m=>m.uid!==o.file.uid))},r=async o=>{q.value=o.uid;try{const m=await Q({url:`agreement/delete/file/${o.uid}`,method:"DELETE"});m.status==200&&(u(a.idConvenio),Y.success(m.message))}catch(m){console.error("Error de red:",m)}finally{q.value=null}},u=async o=>{try{const{data:m}=await ae.get(`${S}agreement/list-files/${o}`,{headers:{Authorization:`Bearer ${l}`}});m.status===200&&(z.value=m.data.map(b=>({uid:b.id,name:b.name,status:"done",url:b.path,date:b.created_at})))}catch(m){console.error("Error fetching files:",m)}};return(o,m)=>{const b=h("a-button"),k=h("a-spin"),Z=h("a-space"),A=h("a-upload");return s(),f("div",null,[ft,i(A,{"file-list":z.value,name:"file",onChange:V,"custom-request":j,"before-upload":T},{itemRender:v(({file:L,actions:G})=>[i(Z,{style:{margin:"0rem 0","font-size":"13px",width:"100%"}},{default:v(()=>[C("div",gt,[C("span",ht,I(L.name),1),C("span",null,I(X(L.date)),1),e.value!=L.uid?(s(),f("a",{key:0,onClick:t=>M(L)},"Descargar",8,yt)):(s(),$(k,{key:1,indicator:O(P)},null,8,["indicator"])),q.value==L.uid?(s(),$(k,{key:2,indicator:O(P)},null,8,["indicator"])):(s(),f("a",{key:3,onClick:t=>r(L),style:{color:"var(--error)"}},[i(O(Se))],8,bt))])]),_:2},1024)]),default:v(()=>[i(b,{style:{"margin-bottom":".6rem"},loading:U.value},{default:v(()=>[i(O(Ke)),R(" SUBIR ARCHIVO ")]),_:1},8,["loading"])]),_:1},8,["file-list"])])}}};const ne=c=>(He("data-v-4cbae06c"),c=c(),Ge(),c),wt=ne(()=>C("h3",{class:"title-produce"},"ESTADO DE CONVENIOS",-1)),Ct={class:"filters"},Ot=ne(()=>C("img",{width:"20",style:{margin:"-2px 0 0 0"},src:Je},null,-1)),Et={key:0,class:"table-head"},xt=ne(()=>C("span",null,"REGIÓN",-1)),It={class:"t-icons"},St={key:8,style:{"line-height":"1.2",margin:"0","font-size":"12px"}},kt={key:0,class:"list-days"},At={key:1,class:"list-days"},$t={key:11,class:"accion-total"},Ut={class:"accion-numb"},Mt=["onClick"],Nt=ne(()=>C("a",null,"Eliminar",-1)),Rt={class:"paginator"},zt={__name:"ConvenioEstado",props:["idConvenio"],setup(c){H.locale("es"),JSON.parse(localStorage.getItem("profile")),$e();const l=ke.get("token"),a="https://apituempresa.soporte-pnte.com/api/",n="http://127.0.0.1:8000/api/",y=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?n:a,S=g(null),U=g(!1),z=g(null),e=g(0),q=g(0),P=g({page:0}),X=g(1200),T=g([]),j=g(!1),M=g(!1),V=g(!1),r=g(!1),u=g(null);g(null);const o=g(window.innerHeight-100),m=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"REGIÓN",fixed:"left",dataIndex:"region",width:120},{title:"PROVINCIA",fixed:"left",dataIndex:"provincia",width:120},{title:"DISTRITO",fixed:"left",dataIndex:"district",width:140},{title:"DENOMINACIÓN",dataIndex:"denomination",fixed:"left",width:150},{title:"ENTIDAD ALIADA",dataIndex:"alliedEntity",width:170},{title:"INICIO DE OPERACIONES",dataIndex:"inicioperaciones",align:"center",width:120},{title:"DIRECCIÓN",dataIndex:"address",width:180},{title:"REFERENCIA",dataIndex:"reference",width:220},{title:"ASESORES EMPRESARIALES ASIGNADOS",dataIndex:"districtxx",align:"center",width:125},{title:"RESOLUCIÓN DE AUTORIZACIÓN PARA CONDICIÓN DE CDE",dataIndex:"resolution",align:"center",width:150},{title:"ESTADO DE OPERATIVIDAD",dataIndex:"operatividad",align:"center",width:120},{title:"ESTADO DEL CONVENIO",dataIndex:"convenio",align:"center",width:120},{title:"ENTIDADES",dataIndex:"entidades",align:"center",width:170},{title:"INICIO CONVENIO VIGENTE",dataIndex:"startDate",align:"center",width:120},{title:"NUM. AÑOS DEL CONVENIO",dataIndex:"numbyears",align:"center",width:110},{title:"FIN DEL CONVENIO",dataIndex:"endDate",align:"center",width:120},{title:"DÍAS",dataIndex:"numbrestantes",align:"center",width:70},{title:"ACCIONES",dataIndex:"acciones",align:"center",width:100},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],b=p=>({0:"red",1:"orange",2:"green",3:"purple",4:"blue",5:"pink"})[p],k=p=>{S.value=p,K({order:p})},Z=p=>{z.value=p.id,V.value=!0},A=p=>H(p).format("DD/MM/YYYY"),L=(p,d)=>{const x=new Date(d),F=new Date(p);let J=F.getFullYear()-x.getFullYear(),B=F.getMonth()-x.getMonth(),W=F.getDate()-x.getDate();if(B<0&&(J--,B+=12),W<0){const ee=new Date(F.getFullYear(),F.getMonth(),0).getDate();W+=ee,B--}const le=J>0?`${J} año${J>1?"s":""}`:"",re=B>0?`${B} mes${B>1?"es":""}`:"",de=W>0?`${W} día${W>1?"s":""}`:"";return[le,re,de].filter(Boolean).join(" con ")},G=p=>{z.value=p.id,r.value=!0},t=(p,d)=>{const x=new Date(p),F=new Date,J=x.getTime()-F.getTime();return Math.floor(J/(1e3*3600*24))+1},oe=p=>p<=0||p<20?"red":p<40?"#f9e717":"#11d811",E=p=>{P.value.page=p,K()},ie=()=>{o.value=window.innerHeight-320},Me=()=>{u.value=null,M.value=!0},se=p=>{K(),p==1&&(M.value=!1),p==2&&(V.value=!1)},Ne=async p=>{try{const d=await Q({url:`agreement/delete/${p.id}`,method:"DELETE"});d.status==200&&(K(),Y.success(d.message))}catch(d){console.error("Error de red:",d)}},Re=Ye(()=>p=>((P.value.page==0?1:P.value.page)-1)*q.value+p+1),K=async p=>{try{j.value=!0;let d;d=P.value.page==0?"":P.value,d=p?{...d,...p}:d;const{data:x}=await Q({url:"agreement/list",method:"GET",params:d});T.value=x.data,e.value=x.total,q.value=50}catch(d){console.error("Error de red:",d)}finally{j.value=!1}},ze=async()=>{U.value=!0;try{const p=await ae({url:`${y}agreement/download`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${l}`}}),d=window.URL.createObjectURL(new Blob([p.data])),x=document.createElement("a"),F="convenios.xlsx";x.href=d,x.setAttribute("download",F),document.body.appendChild(x),x.click(),window.URL.revokeObjectURL(d),document.body.removeChild(x)}catch(p){console.error("Error downloading file:",p)}finally{U.value=!1}};return qe(()=>{window.removeEventListener("resize",ie)}),pe(()=>{window.addEventListener("resize",ie),ie(),K()}),(p,d)=>{const x=h("a-button"),F=h("a-progress"),J=h("a-tag"),B=h("a-menu-item"),W=h("a-popconfirm"),le=h("a-menu"),re=h("a-dropdown"),de=h("a-table"),fe=h("a-pagination"),ee=h("a-drawer");return s(),f(N,null,[C("div",null,[wt,C("div",Ct,[i(x,{type:"primary",onClick:Me,style:{"margin-right":".5rem"}},{default:v(()=>[R("NUEVO")]),_:1}),i(x,{class:"btn-excel",onClick:ze,loading:U.value,type:"primary"},{default:v(()=>[Ot]),_:1},8,["loading"])]),i(de,{bordered:"",scroll:{x:X.value,y:o.value},class:"table-agreements",columns:m,"data-source":T.value,pagination:!1,loading:j.value,size:"small"},{headerCell:v(({column:D})=>[D.dataIndex=="region"?(s(),f("div",Et,[xt,C("div",It,[i(O(Ve),{class:De([{arrActive:S.value=="asc"},"ii"]),onClick:d[0]||(d[0]=_=>k("asc"))},null,8,["class"]),i(O(Fe),{class:De([{arrActive:S.value=="desc"},"ii"]),onClick:d[1]||(d[1]=_=>k("desc"))},null,8,["class"])])])):w("",!0)]),bodyCell:v(({column:D,record:_,index:Pe})=>{var ge;return[D.dataIndex=="idx"?(s(),f(N,{key:0},[R(I(Re.value(Pe)),1)],64)):w("",!0),D.dataIndex=="region"?(s(),f(N,{key:1},[R(I(_.region.name),1)],64)):w("",!0),D.dataIndex=="provincia"?(s(),f(N,{key:2},[R(I(_.provincia.name),1)],64)):w("",!0),D.dataIndex=="district"?(s(),f(N,{key:3},[R(I((ge=_.distrito)==null?void 0:ge.name),1)],64)):w("",!0),D.dataIndex=="denomination"?(s(),f(N,{key:4},[R(I(_.denomination)+" ",1),i(F,{style:{margin:"0"},percent:t(_.endDate,_.startDate),size:4,showInfo:!1,strokeColor:oe(t(_.endDate,_.startDate))},null,8,["percent","strokeColor"])],64)):w("",!0),D.dataIndex=="inicioperaciones"?(s(),f(N,{key:5},[R(I(A(_==null?void 0:_.homeOperations)),1)],64)):w("",!0),D.dataIndex=="entidades"?(s(!0),f(N,{key:6},ue(_.initials,(te,he)=>(s(),f("div",{key:he},[i(J,{color:b(he),style:{margin:".2rem 0"}},{default:v(()=>[R(I(te),1)]),_:2},1032,["color"])]))),128)):w("",!0),D.dataIndex=="startDate"?(s(),f(N,{key:7},[R(I(A(_==null?void 0:_.startDate)),1)],64)):w("",!0),D.dataIndex=="numbyears"?(s(),f("p",St,I(L(_.endDate,_.startDate)),1)):w("",!0),D.dataIndex=="endDate"?(s(),f(N,{key:9},[R(I(A(_==null?void 0:_.endDate)),1)],64)):w("",!0),D.dataIndex=="numbrestantes"?(s(),f(N,{key:10},[t(_.endDate,_.startDate)>=1?(s(),f("p",kt,I(t(_.endDate,_.startDate))+" días faltantes",1)):(s(),f("p",At,I(t(_.endDate,_.startDate))+" días vencidos",1))],64)):w("",!0),D.dataIndex=="acciones"?(s(),f("div",$t,[i(O(nt),{class:"ico-acciones",onClick:te=>Z(_)},null,8,["onClick"]),C("span",Ut,I(_.acciones.length)+" MENSAJES",1)])):w("",!0),D.dataIndex=="actions"?(s(),$(re,{key:12,trigger:["click"]},{overlay:v(()=>[i(le,null,{default:v(()=>[i(B,null,{default:v(()=>[C("a",{onClick:te=>G(_)},"Archivos",8,Mt)]),_:2},1024),i(B,null,{default:v(()=>[i(W,{title:"¿Seguro de eliminar?",onConfirm:te=>Ne(_)},{icon:v(()=>[i(O(je),{style:{color:"red"}})]),default:v(()=>[Nt]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:v(()=>[C("a",{class:"ant-dropdown-link",onClick:d[2]||(d[2]=Be(()=>{},["prevent"]))},[i(x,{shape:"circle",icon:Ae(O(Qe)),size:"small"},null,8,["icon"])])]),_:2},1024)):w("",!0)]}),_:1},8,["scroll","data-source","loading"])]),C("div",Rt,[C("span",null,[i(J,{color:"blue"},{default:v(()=>[C("b",null,I(e.value),1)]),_:1}),R("Convenios")]),i(fe,{size:"small",total:e.value,pageSize:q.value,onChange:E,showSizeChanger:!1},null,8,["total","pageSize"])]),i(ee,{open:M.value,"onUpdate:open":d[4]||(d[4]=D=>M.value=D),class:"draw-notary","root-class-name":"root-class-name",title:"Convenios",placement:"right",width:"650"},{default:v(()=>[i(ut,{onCloseDraw:d[3]||(d[3]=D=>se(1))})]),_:1},8,["open"]),i(ee,{open:V.value,"onUpdate:open":d[6]||(d[6]=D=>V.value=D),title:"Acciones",placement:"right",width:"550"},{default:v(()=>[i(_t,{idConvenio:z.value,onCloseDraw:d[5]||(d[5]=D=>se(2))},null,8,["idConvenio"])]),_:1},8,["open"]),i(ee,{open:r.value,"onUpdate:open":d[8]||(d[8]=D=>r.value=D),title:"Cargar Archivos",placement:"right",width:"550"},{default:v(()=>[i(Dt,{idConvenio:z.value,onCloseDraw:d[7]||(d[7]=D=>se(3))},null,8,["idConvenio"])]),_:1},8,["open"])],64)}}},Ft=Ue(zt,[["__scopeId","data-v-4cbae06c"]]);export{Ft as default};
