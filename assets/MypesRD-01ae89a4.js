import{_ as V}from"./icoexcel-1b303edf.js";import{r as a,g as H,s as O,P as j,j as q,b as r,o as n,d as m,e as l,c as v,w as i,h as J,q as o,F as y,a4 as X,H as Y,y as $,i as d,p as g}from"./index-e0613bd6.js";const G={class:"w-search"},K={class:"paginator"},Q={key:0,class:"full-spin"},te={__name:"MypesRD",setup(W){const C="https://apituempresa.soporte-pnte.com/api/",b="http://127.0.0.1:8000/api/",D=window.location.hostname=="127.0.0.1"?b:C,s=a(!1),c=a(null),N=H.get("token"),f=a([]),x=a(!1),A=a(1200);a("");const w=a(0),I=a(window.innerHeight-100),h=()=>{I.value=window.innerHeight-300};O(()=>{window.removeEventListener("resize",h)});const z=j(X,{style:{fontSize:"40px"},spin:!0}),k=a({page:1}),R=[{title:"RUC",dataIndex:"ruc",fixed:"left",width:120},{title:"Razón social",dataIndex:"socialReason",fixed:"left",width:250},{title:"Rubro",dataIndex:"category",width:200},{title:"Tipo",dataIndex:"type",align:"center",width:140},{title:"Departamento",dataIndex:"department",width:140},{title:"Distrito",dataIndex:"district",width:130},{title:"Nombres y Apellidos",dataIndex:"nameComplete",width:300},{title:"DNI",dataIndex:"dniNumber",align:"center",width:120},{title:"Sexo",dataIndex:"sex",align:"center",width:130},{title:"Teléfono",dataIndex:"phone",align:"center",width:130},{title:"Email",dataIndex:"email",width:300}],S=e=>{k.value.page=e,_()},U=()=>{let e=document.createElement("input");e.type="file",e.accept=".xls, .xlsx",e.onchange=t=>{c.value=t.target.files[0],B()},e.click()},B=()=>{if(!c.value){alert("Por favor selecciona un archivo Excel.");return}s.value=!0;const e=new FormData;e.append("file",c.value),Y.post(`${D}/import-excel`,e,{headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${N}`}}).then(()=>{L()}).catch(t=>{console.error("Error al subir el archivo",t)}).finally(()=>{c.value=null})},L=()=>setInterval(()=>f.value.length<1?_():s.value=!1,6e3),_=async()=>{try{x.value=!0;const e=await $({url:"/mype",method:"GET",params:k.value});f.value=e.data,w.value=e.meta.total}catch(e){console.error("Error de red:",e)}finally{x.value=!1}};return q(()=>{_(),window.addEventListener("resize",h),h()}),(e,t)=>{const M=r("a-button"),u=r("a-tag"),T=r("a-table"),F=r("a-pagination"),P=r("a-spin");return n(),m(y,null,[l("div",null,[t[5]||(t[5]=l("h3",null,"LISTA DE MYPE",-1)),l("div",G,[l("div",null,[v(M,{onClick:U,loading:s.value},{default:i(()=>t[0]||(t[0]=[l("img",{width:"20",style:{"margin-right":"6px"},src:V},null,-1),d(" SUBIR EXCEL ")])),_:1},8,["loading"])])]),v(T,{bordered:"",class:"ant-table-striped",sticky:"",scroll:{x:A.value,y:I.value},columns:R,"data-source":f.value,pagination:!1,loading:x.value,size:"small"},{bodyCell:i(({column:E,record:p})=>[E.dataIndex=="type"?(n(),m(y,{key:0},[p.type=="NATURAL"?(n(),g(u,{key:0,color:"success"},{default:i(()=>t[1]||(t[1]=[d("Natural")])),_:1})):o("",!0),p.type=="JURIDICA"?(n(),g(u,{key:1,color:"error"},{default:i(()=>t[2]||(t[2]=[d("Jurídica")])),_:1})):o("",!0)],64)):o("",!0),E.dataIndex=="sex"?(n(),m(y,{key:1},[p.sex=="MASCULINO"?(n(),g(u,{key:0,color:"blue"},{default:i(()=>t[3]||(t[3]=[d("Masculino")])),_:1})):o("",!0),p.sex=="FEMENINO"?(n(),g(u,{key:1,color:"pink"},{default:i(()=>t[4]||(t[4]=[d("Femenino")])),_:1})):o("",!0)],64)):o("",!0)]),_:1},8,["scroll","data-source","loading"])]),l("div",K,[v(F,{size:"small",pageSize:50,total:w.value,onChange:S,showSizeChanger:!1},null,8,["total"])]),s.value?(n(),m("div",Q,[v(P,{indicator:J(z),spinning:s.value},null,8,["indicator","spinning"])])):o("",!0)],64)}}};export{te as default};
