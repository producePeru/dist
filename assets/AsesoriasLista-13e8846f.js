import{r as D,a as ve,b as w,o as i,d as h,c,w as r,e as S,F as k,x as fe,h as C,q as g,s as n,t as m,i as x,z as K,m as W,K as M,y as We,L as Ze,Y as Qe,Z as Ke,f as Xe,g as ea,v as aa,H as ta,k as ia,n as _e,G as oa,Q as na,I as la,M as sa,p as da,j as ra}from"./index-65e669a4.js";import{_ as ca}from"./icoexcel-1b303edf.js";import"./es-207283b4.js";import{u as ne}from"./selectes-f74fa27c.js";import{a as ua,r as ma,f as pa}from"./asesorias-edbbf36e.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";import{M as _a}from"./MoreOutlined-c763702c.js";const va={class:"wrapper-booking"},fa={class:"grid-booking"},ya={__name:"EditarAsesoria",props:["info"],emits:["closeDraw"],setup(G,{emit:H}){const p=ne(),O=JSON.parse(localStorage.getItem("profile")),u=D(!1),E=G,B=H;p.$patch({components:p.components}),p.$patch({componentThemes:p.componentThemes}),p.$patch({modalities:p.modalities}),p.$patch({cities:p.cities}),p.$patch({economicSectors:p.economicSectors}),p.$patch({comercialActivities:p.comercialActivities}),p.fetchEconomicSectors(),p.fetchComercialActivities(),p.fetchComponents(),p.fetchComponentThemes(),p.fetchModalities(),p.fetchCities();const _=D(!0),e=ve({observations:null,user_id:O.user_id,people_id:null,component_id:null,theme_id:null,modality_id:null,city_id:null,province_id:null,district_id:null}),V=()=>{p.cities&&(_.value=!1),e.economicsector_id=E.info.economicsector_id,e.comercialactivity_id=E.info.comercialactivity_id,e.ruc=E.info.ruc,e.component_id=E.info.component_id,y(E.info.component_id),e.theme_id=E.info.theme_id,e.modality_id=E.info.modality_id,e.city_id=E.info.city_id,P(E.info.city_id),e.province_id=E.info.province_id,t(E.info.province_id),e.district_id=E.info.district_id,e.observations=E.info.observations},y=z=>{e.theme_id=null,p.fetchComponentThemes(z)},P=z=>{e.province_id=null,e.district_id=null,p.fetchProvinces(z)},t=z=>{e.district_id=null,p.fetchDistricts(z)},L=(z,$)=>{const N=z.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return $.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(N)},j=z=>{z=="ruc"&&(e[z]=e[z].replace(/\D/g,""))},q=async()=>{u.value=!0;const z={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,ruc:e.ruc,observations:e.observations,component_id:e.component_id,theme_id:e.theme_id,modality_id:e.modality_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,updated_by:O.user_id};try{const $=await K({url:`advisory/update/${E.info.id}`,method:"PUT",data:z});$.status===200&&(W.success($.message),e.component_id=null,e.theme_id=null,e.modality_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.observations=null,B("closeDraw",!0))}catch($){console.log("Error: "+$)}finally{u.value=!1}},v=()=>{W.warning("Debes de completar todos los espacios requeridos")};return(z,$)=>{const N=w("a-select"),F=w("a-form-item"),T=w("a-textarea"),Z=w("a-input"),U=w("a-button"),o=w("a-form"),R=w("a-spin");return i(),h("div",va,[c(R,{spinning:_.value},{default:r(()=>[c(o,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:q,onFinishFailed:v},{default:r(()=>[S("div",fa,[(i(!0),h(k,null,fe(C(ua),(a,Q)=>(i(),h(k,{key:Q},[a.type==="iSelect"?(i(),g(F,{key:0,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:r(()=>[a.name=="modality_id"?(i(),g(N,{key:0,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,options:C(p).modalities},null,8,["value","onUpdate:value","options"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),a.type==="iTextarea"?(i(),g(F,{key:1,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:r(()=>[c(T,{value:e[a.name],"onUpdate:value":A=>e[a.name]=A,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):n("",!0),a.type==="iText"?(i(),g(F,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,type:a.email,max:a.max}]},{default:r(()=>[c(Z,{value:e[a.name],"onUpdate:value":A=>e[a.name]=A,maxlength:a.max,onInput:A=>j(a.name),placeholder:a.placeholder},null,8,["value","onUpdate:value","maxlength","onInput","placeholder"])]),_:2},1032,["name","label","rules"])):n("",!0),a.type==="iSelectWrite"?(i(),g(F,{key:3,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:r(()=>[a.name=="theme_id"?(i(),g(N,{key:0,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,"show-search":"",options:C(p).componentThemes,"filter-option":L,disabled:!e.component_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),a.name=="city_id"?(i(),g(N,{key:1,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,"show-search":"",options:C(p).cities,"filter-option":L,onChange:P},null,8,["value","onUpdate:value","options"])):n("",!0),a.name=="province_id"?(i(),g(N,{key:2,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,"show-search":"",options:C(p).provinces,"filter-option":L,onChange:t,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),a.name=="district_id"?(i(),g(N,{key:3,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,"show-search":"",options:C(p).districts,"filter-option":L,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),a.name=="component_id"?(i(),g(N,{key:4,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,options:C(p).components,onChange:y},null,8,["value","onUpdate:value","options"])):n("",!0),a.name=="economicsector_id"?(i(),g(N,{key:5,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,"show-search":"",options:C(p).economicSectors,"filter-option":L},null,8,["value","onUpdate:value","options"])):n("",!0),a.name=="comercialactivity_id"?(i(),g(N,{key:6,value:e[a.name],"onUpdate:value":A=>e[a.name]=A,"show-search":"",options:C(p).comercialActivities,"filter-option":L},null,8,["value","onUpdate:value","options"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0)],64))),128))]),S("div",null,m(V()),1),c(F,null,{default:r(()=>[c(U,{type:"primary",class:"btn-produce","html-type":"submit",loading:u.value},{default:r(()=>[x("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},ha=le(ya,[["__scopeId","data-v-fe1afd70"]]);const ga={class:"wrapper-booking"},ba={class:"grid-booking"},xa={__name:"EditarFormalizacionRUC10",props:["info"],emits:["closeDraw"],setup(G,{emit:H}){const p=D(!0),O=JSON.parse(localStorage.getItem("profile")),u=G,E=H,B=D(!1),_=ne();_.$patch({cities:_.cities}),_.$patch({provinces:_.provinces}),_.$patch({districts:_.districts}),_.$patch({modalities:_.modalities}),_.$patch({detailProcedures:_.detailProcedures}),_.$patch({economicSectors:_.economicSectors}),_.$patch({comercialActivities:_.comercialActivities}),_.fetchDetailProcedures(),_.fetchModalities(),_.fetchEconomicSectors(),_.fetchComercialActivities(),_.fetchCities();const e=ve({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,user_id:O.user_id}),V=()=>{e.detailprocedure_id=u.info.detailprocedure_id,e.modality_id=u.info.modality_id,e.economicsector_id=u.info.economicsector_id,e.comercialactivity_id=u.info.comercialactivity_id,e.city_id=u.info.city_id,P(u.info.city_id),e.province_id=u.info.province_id,t(u.info.province_id),e.district_id=u.info.district_id,e.ruc=u.info.ruc,e.address=u.info.address,_.cities&&(p.value=!1)},y=v=>{v=="ruc"&&(e[v]=e[v].replace(/\D/g,""))},P=v=>{e.province_id=null,e.district_id=null,_.fetchProvinces(v)},t=v=>{e.district_id=null,_.fetchDistricts(v)},L=(v,z)=>{const $=v.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return z.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes($)},j=async()=>{B.value=!0;const v={detailprocedure_id:e.detailprocedure_id,modality_id:e.modality_id,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,ruc:e.ruc,updated_by:O.user_id};try{const z=await K({url:`formalization/update-ruc-10/${u.info.id}`,method:"PUT",data:v});z.status===200&&(W.success(z.message),e.detailprocedure_id=null,e.modality_id=null,e.economicsector_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.ruc=null,E("closeDraw",!0))}catch(z){console.log("Error: "+z)}finally{B.value=!1}},q=()=>{W.warning("Debes de completar todos los espacios requeridos")};return(v,z)=>{const $=w("a-select"),N=w("a-form-item"),F=w("a-input"),T=w("a-button"),Z=w("a-form"),U=w("a-spin");return i(),h("div",ga,[c(U,{spinning:p.value},{default:r(()=>[c(Z,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:j,onFinishFailed:q},{default:r(()=>[S("div",ba,[(i(!0),h(k,null,fe(C(ma),(o,R)=>(i(),h(k,{key:R},[o.type==="iSelect"?(i(),g(N,{key:0,class:"item-max",name:o.name,label:o.label,rules:[{required:o.required,message:o.message}]},{default:r(()=>[o.name=="detailprocedure_id"?(i(),g($,{key:0,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:C(_).detailProcedures},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="modality_id"?(i(),g($,{key:1,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:C(_).modalities},null,8,["value","onUpdate:value","options"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),o.type==="iText"?(i(),g(N,{key:1,name:o.name,label:o.label,rules:[{required:o.required,message:o.message,type:o.email,max:o.max}]},{default:r(()=>[c(F,{value:e[o.name],"onUpdate:value":a=>e[o.name]=a,disabled:o.disabled,maxlength:o.max,onInput:a=>y(o.name)},null,8,["value","onUpdate:value","disabled","maxlength","onInput"])]),_:2},1032,["name","label","rules"])):n("",!0),o.type==="iSelectWrite"?(i(),g(N,{key:2,class:"item-max",name:o.name,label:o.label,rules:[{required:o.required,message:o.message}]},{default:r(()=>[o.name=="economicsector_id"?(i(),g($,{key:0,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:C(_).economicSectors},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="comercialactivity_id"?(i(),g($,{key:1,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:C(_).comercialActivities},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="city_id"?(i(),g($,{key:2,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,"show-search":"",options:C(_).cities,"filter-option":L,onChange:P},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="province_id"?(i(),g($,{key:3,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,"show-search":"",options:C(_).provinces,"filter-option":L,onChange:t,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),o.name=="district_id"?(i(),g($,{key:4,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,"show-search":"",options:C(_).districts,"filter-option":L,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0)],64))),128))]),S("div",null,m(V()),1),c(N,null,{default:r(()=>[c(T,{type:"primary",class:"btn-produce","html-type":"submit",loading:B.value},{default:r(()=>[x("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},wa=le(xa,[["__scopeId","data-v-4855a03a"]]);const Ia={class:"wrapper-booking"},ka={class:"grid-booking"},Ca={class:"select-notaries"},Ua={class:"name"},Da={class:"city"},Sa={class:"address"},za="DD/MM/YYYY",Ra={__name:"EditarFormalizacionRUC20",props:["info"],emits:["closeDraw"],setup(G,{emit:H}){M.locale("es");const p=Ke({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}});We();const O=JSON.parse(localStorage.getItem("profile")),u=G,E=H,B=D(!1),_=D(null);D(null);const e=D(!0),V=D(!1),y=ne(),P=D(null);y.$patch({cities:y.cities}),y.$patch({modalities:y.modalities}),y.$patch({economicSectors:y.economicSectors}),y.$patch({comercialActivities:y.comercialActivities}),y.$patch({regimes:y.regimes}),y.fetchEconomicSectors(),y.fetchComercialActivities(),y.fetchRegimes(),y.fetchModalities(),y.fetchCities();const t=ve({city_id:null,province_id:null,district_id:null,address:null,modality_id:null,nameMype:null,ruc:null,economicsector_id:null,comercialactivity_id:null,regime_id:null,numbernotary:null,notary_id:null,dateReception:null,dateTramite:null}),L=U=>{U=="ruc"&&(t[U]=t[U].replace(/\D/g,""))},j=()=>{var U;t.city_id=u.info.city_id,z(u.info.city_id),t.province_id=u.info.province_id,$(u.info.province_id),t.district_id=u.info.district_id,t.address=u.info.address,t.modality_id=u.info.modality_id,t.nameMype=u.info.nameMype,t.ruc=u.info.ruc,t.economicsector_id=u.info.economicsector_id,t.comercialactivity_id=u.info.comercialactivity_id,t.regime_id=u.info.regime_id,t.numbernotary=u.info.numbernotary,t.notary_id=u.info.notary_id,u.info.dateReception&&(t.dateReception=M(u.info.dateReception,"YYYY-MM-DD")),u.info.dateTramite&&(t.dateTramite=M(u.info.dateTramite,"YYYY-MM-DD")),(U=y.regimes)!=null&&U.length&&(e.value=!1)},q=(U,o)=>{const R=U.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=o.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Q=o.city.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),A=o.province.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),X=o.district.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.includes(R)||Q.includes(R)||A.includes(R)||X.includes(R)},v=async()=>{try{B.value=!0;const U={name:_.value};(await K({url:"create/comercial-activities",method:"POST",data:U})).status==200&&(_.value=null,y.fetchComercialActivities())}catch(U){console.log(U)}finally{B.value=!1}},z=U=>{t.province_id=null,t.district_id=null,y.fetchProvinces(U),N()},$=U=>{t.district_id=null,y.fetchDistricts(U)},N=async()=>{try{const U={city_id:t.city_id},{data:o}=await Xe({url:"public/notaries-filters",method:"GET"});P.value=null;const R=o.map(a=>({value:a.id,name:a.name,city:a.city.name,province:a.province.name,district:a.district.name,address:a.address}));P.value=R}catch(U){console.error("Error de red:",U)}},F=(U,o)=>{const R=U.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return o.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(R)},T=async()=>{V.value=!0;const U={city_id:t.city_id,province_id:t.province_id,district_id:t.district_id,address:t.address,modality_id:t.modality_id,nameMype:t.nameMype,ruc:t.ruc,economicsector_id:t.economicsector_id,comercialactivity_id:t.comercialactivity_id,regime_id:t.regime_id,numbernotary:t.numbernotary,notary_id:t.notary_id,dateReception:t.dateReception?M(t.dateReception).format("YYYY-MM-DD"):null,dateTramite:t.dateTramite?M(t.dateTramite).format("YYYY-MM-DD"):null,userupdated_id:O.user_id};try{const o=await K({url:`formalization/update-ruc-20/${u.info.id}`,method:"PUT",data:U});o.status===200&&(W.success(o.message),t.codesunarp=null,t.economicsector_id=null,t.comercialactivity_id=null,t.regime_id=null,t.city_id=null,t.province_id=null,t.district_id=null,t.address=null,t.modality_id=null,t.nameMype=null,t.dateReception=null,t.dateTramite=null,t.notary_id=null,t.ruc=null,t.numbernotary=null,E("closeDraw",!0))}catch(o){console.log("Error: "+o)}finally{V.value=!1}},Z=()=>{W.warning("Debes de completar todos los espacios requeridos")};return(U,o)=>{const R=w("a-select"),a=w("a-form-item"),Q=w("a-date-picker"),A=w("a-divider"),X=w("a-input"),te=w("a-button"),de=w("a-space"),re=w("a-form"),ce=w("a-spin");return i(),h("div",Ia,[c(ce,{spinning:e.value},{default:r(()=>[c(re,{layout:"vertical",model:t,name:"basic",autocomplete:"off",onFinish:T,onFinishFailed:Z},{default:r(()=>[S("div",ka,[(i(!0),h(k,null,fe(C(pa),(l,ue)=>(i(),h(k,{key:ue},[l.type==="iSelect"?(i(),g(a,{key:0,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:r(()=>[l.name=="regime_id"?(i(),g(R,{key:0,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,options:C(y).regimes,"show-search":"","filter-option":F},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="modality_id"?(i(),g(R,{key:1,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,options:C(y).modalities},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="notary_id"?(i(),g(R,{key:2,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,options:P.value,"option-label-prop":"name",disabled:!t.city_id,"show-search":"","filter-option":q},{option:r(({value:b,name:ae,city:I,province:s,district:Y,address:ee})=>[S("div",Ca,[S("span",Ua,m(ae),1),S("span",Da,m(I)+" - "+m(s)+" - "+m(Y),1),S("span",Sa,m(ee),1)])]),_:2},1032,["value","onUpdate:value","options","disabled"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),l.type==="iDate"?(i(),g(a,{key:1,name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:r(()=>[c(Q,{locale:C(Ze),value:t[l.name],"onUpdate:value":b=>t[l.name]=b,style:{width:"100%"},format:za,placeholder:"día/mes/año",onChange:o[0]||(o[0]=b=>t.birthday=U.birthdateDate),disabled:l.disabled},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):n("",!0),l.type==="iSelectWrite"?(i(),g(a,{key:2,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:r(()=>[l.name=="comercialactivity_id"?(i(),g(R,{key:0,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,"show-search":"",options:C(y).comercialActivities,"filter-option":F},{dropdownRender:r(({menuNode:b})=>[c(C(p),{vnodes:b},null,8,["vnodes"]),c(A,{style:{margin:"4px 0"}}),c(de,{style:{padding:"4px 8px"}},{default:r(()=>[c(X,{ref_for:!0,ref:"inputRef",value:_.value,"onUpdate:value":o[1]||(o[1]=ae=>_.value=ae),placeholder:"Nueva actividad"},null,8,["value"]),c(te,{type:"text",onClick:v,loading:B.value},{icon:r(()=>[c(C(Qe))]),default:r(()=>[x(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):n("",!0),l.name=="economicsector_id"?(i(),g(R,{key:1,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,"show-search":"",options:C(y).economicSectors,"filter-option":F},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="city_id"?(i(),g(R,{key:2,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,"show-search":"",options:C(y).cities,"filter-option":F,onChange:z},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="province_id"?(i(),g(R,{key:3,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,"show-search":"",options:C(y).provinces,"filter-option":F,onChange:$,disabled:!t.city_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),l.name=="district_id"?(i(),g(R,{key:4,value:t[l.name],"onUpdate:value":b=>t[l.name]=b,"show-search":"",options:C(y).districts,"filter-option":F,disabled:!t.province_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),l.type==="iText"?(i(),g(a,{key:3,name:l.name,label:l.label,rules:[{required:l.required,message:l.message,type:l.email,max:l.max}]},{default:r(()=>[c(X,{onInput:b=>L(l.name),value:t[l.name],"onUpdate:value":b=>t[l.name]=b,disabled:l.disabled,maxlength:l.max,placeholder:l.placeholder},null,8,["onInput","value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):n("",!0)],64))),128))]),S("div",null,m(j()),1),c(a,null,{default:r(()=>[c(te,{class:"btn-produce",type:"primary","html-type":"submit",loading:V.value},{default:r(()=>[x("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},Aa=le(Ra,[["__scopeId","data-v-1dce1c70"]]);const se=G=>(da("data-v-194a6f06"),G=G(),ra(),G),Ea={class:"header-rep"},$a={class:"filters-dig"},Na=se(()=>S("img",{width:"20",style:{margin:"-2px 4px 0 0"},src:ca},null,-1)),Fa={class:"filters"},Ya={class:"rango"},Ma=se(()=>S("label",null,"Buscar por rango de Fechas",-1)),La={key:0,class:"asesor",style:{width:"300px"}},Ta=se(()=>S("label",null,"Buscar por Asesores",-1)),qa=["onClick"],Oa=se(()=>S("a",null,"Eliminar",-1)),Pa={class:"paginator-asesories"},Pe=50,Ba={__name:"AsesoriasLista",setup(G){M.locale("es");const H=D(!1),p=D(!1),O=D(!1),u=D(null),E=JSON.parse(localStorage.getItem("role")),B=ea.get("token"),_="https://apituempresa.soporte-pnte.com/api/",e="http://127.0.0.1:8000/api/",V=window.location.hostname=="localhost"||window.location.hostname=="127.0.0.1"?e:_,y=ne(),P=D([]),t=D(!1),L=D(!1),j=D(0),q=D({page:0}),v=D("asesorias"),z=D(1200),$=D(window.innerHeight-100),N=D("historial/advisories/filters"),F=D([]),T=D(null);D(null),y.$patch({asesores:y.asesores}),y.fetchAsesores();const Z=D([{label:"Últimos 7 días",value:[M().add(-7,"d"),M()]},{label:"Últimos 14 días",value:[M().add(-14,"d"),M()]},{label:"Último mes",value:[M().add(-30,"d"),M()]},{label:"Último 3 meses",value:[M().add(-90,"d"),M()]}]),U=(I,s)=>{const Y=I.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(Y)},o=()=>{$.value=window.innerHeight-360};aa(()=>{window.removeEventListener("resize",o)});const R=D([]),a=D([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"FECHA",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"ASESOR (a) - Nombre Completo",dataIndex:"asesor",width:150},...E[0].id===1?[{title:"SUPERVISOR",dataIndex:"misupervisor",width:140}]:[],{title:"Tipo de documento",dataIndex:"sol_tipo_doc",width:110,align:"center"},{title:"Número de Documento",dataIndex:"sol_num_doc",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:160},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:160},{title:"Correo electrónico",dataIndex:"sol_email",width:220},{title:"Celular",dataIndex:"sol_phone",width:90,align:"center"},{title:"Región",dataIndex:"mype_region",width:120},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Componente",dataIndex:"componente",width:180},{title:"Tema",dataIndex:"tema_componente",width:160},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}]),Q=D([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"FECHA",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"ASESOR (a) - Nombre Completo",dataIndex:"asesor",width:150},...E[0].id===1?[{title:"SUPERVISOR",dataIndex:"misupervisor",width:140}]:[],{title:"Tipo de documento",dataIndex:"sol_tipo_doc",width:110,align:"center"},{title:"Número de Documento",dataIndex:"sol_num_doc",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:160},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:160},{title:"Correo electrónico",dataIndex:"sol_email",width:220},{title:"Celular",dataIndex:"sol_phone",width:90,align:"center"},{title:"Región",dataIndex:"mype_region",width:120},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Detalle del trámite",dataIndex:"detalle_tramite",width:180},{title:"Sector económico",dataIndex:"sector_economico",width:180},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}]),A=D([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"FECHA",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"ASESOR (a) - Nombre Completo",dataIndex:"asesor",width:150},...E[0].id===1?[{title:"SUPERVISOR",dataIndex:"misupervisor",width:140}]:[],{title:"Tipo de documento",dataIndex:"sol_tipo_doc",width:110,align:"center"},{title:"Número de Documento",dataIndex:"sol_num_doc",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:140},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:140},{title:"Correo electrónico",dataIndex:"sol_email",width:220},{title:"Celular",dataIndex:"sol_phone",width:90,align:"center"},{title:"Región del negocio",dataIndex:"mype_region",width:140},{title:"Provincia del Negocio",dataIndex:"mype_provincia",width:160},{title:"Distrito del Negocio",dataIndex:"mype_distrito",width:160},{title:"Direccion del Negocio",dataIndex:"mype_direccion",width:230},{title:"N_RUC",dataIndex:"ruc",width:100,align:"center"},{title:"Nombre de Empresa Constituida",dataIndex:"mype_nombre",width:240},{title:"Régimen",dataIndex:"tipo_regimen",width:74,align:"center"},{title:"Notaría",dataIndex:"notaria",width:150},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}]),X=async()=>{b(v.value)},te=I=>{q.value.page=I,b()},de=I=>M(I).format("DD-MM-YYYY HH:mm"),re=I=>({asesorias:"Asesorías",ruc10:"Formalizaciones RUC 10",ruc20:"Formalizaciones RUC 20"})[I],ce=async I=>{try{let s=null;v.value=="asesorias"&&(s=`advisory/delete/${I.id}`),v.value=="ruc10"&&(s=`formalization/delete-ruc-10/${I.id}`),v.value=="ruc20"&&(s=`formalization/delete-ruc-20/${I.id}`);const Y=await K({url:s,method:"DELETE"});b(),W.success(Y.message)}catch(s){console.error("Error de red:",s)}},l=async I=>{try{let s=null;v.value=="asesorias"&&(s=`advisory/find/${I.id}`),v.value=="ruc10"&&(s=`formalization/find-ruc-10/${I.id}`),v.value=="ruc20"&&(s=`formalization/find-ruc-20/${I.id}`);const Y=await K({url:s,method:"GET"});Y.status==200&&(u.value=Y.data,v.value=="asesorias"&&(H.value=!0),v.value=="ruc10"&&(p.value=!0),v.value=="ruc20"&&(O.value=!0))}catch(s){console.error("Error de red:",s)}},ue=async()=>{L.value=!0;let I="",s="";v.value=="asesorias"&&(I="download/asesories",s="asesorias.xlsx"),v.value=="ruc10"&&(I="download/formalizations-ruc10",s="formalizacionesRUC10.xlsx"),v.value=="ruc20"&&(I="download/formalizations-ruc20",s="formalizacionesRUC20.xlsx");try{const Y={};T.value&&(Y.dateStart=M(T.value[0]).format("YYYY-MM-DD"),Y.dateEnd=M(T.value[1]).format("YYYY-MM-DD")),F.value&&(Y.idAsesor=F.value[0]);const{data:ee}=await oa.get(`${V}${I}`,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${B}`},params:Y,responseType:"blob"}),me=new Blob([ee]),ie=window.URL.createObjectURL(me),J=document.createElement("a");J.href=ie,J.download=s,document.body.appendChild(J),J.click(),document.body.removeChild(J)}catch{W.error("Error")}finally{L.value=!1}},b=async I=>{try{t.value=!0;const s={...F.value.length>=1&&{user_id:F.value.toString()},...T.value&&{dateStart:M(T.value[0]).format("YYYY-MM-DD")},...T.value&&{dateEnd:M(T.value[1]).format("YYYY-MM-DD")},...q.value.page!=0&&{page:q.value.page}};v.value=="asesorias"&&(R.value=a.value),I=="asesorias"&&(q.value.page=0,v.value=I,R.value=a.value,N.value="historial/advisories/filters"),I=="ruc10"&&(q.value.page=0,v.value=I,R.value=Q.value,N.value="historial/formalizations-10/filters"),I=="ruc20"&&(q.value.page=0,v.value=I,R.value=A.value,N.value="historial/formalizations-20/filters");const Y=await K({url:N.value,method:"GET",params:s});P.value=Y.data,j.value=Y.total}catch(s){console.error("Error de red:",s)}finally{t.value=!1}},ae=ta(()=>I=>((q.value.page==0?1:q.value.page)-1)*Pe+I+1);return ia(()=>{b(),window.addEventListener("resize",o),o()}),(I,s)=>{const Y=w("a-button"),ee=w("a-range-picker"),me=w("a-select"),ie=w("a-tag"),J=w("a-menu-item"),Be=w("a-popconfirm"),Ge=w("a-menu"),He=w("a-dropdown"),Ve=w("a-table"),je=w("a-pagination"),pe=w("a-drawer");return i(),h(k,null,[S("div",null,[S("div",Ea,[S("h3",{class:_e({hdactive:v.value=="asesorias"}),onClick:s[0]||(s[0]=d=>b("asesorias"))},"ASESORÍAS",2),S("h3",{class:_e({hdactive:v.value=="ruc10"}),onClick:s[1]||(s[1]=d=>b("ruc10"))},"FORMALIZACIONES RUC 10",2),S("h3",{class:_e({hdactive:v.value=="ruc20"}),onClick:s[2]||(s[2]=d=>b("ruc20"))},"FORMALIZACIONES RUC 20",2)]),S("div",$a,[S("div",null,[S("div",null,[c(Y,{class:"btn-excel",onClick:ue,loading:L.value,type:"primary"},{default:r(()=>[Na,x(" DESCARGAR ")]),_:1},8,["loading"])])]),S("div",Fa,[S("div",Ya,[Ma,c(ee,{value:T.value,"onUpdate:value":s[3]||(s[3]=d=>T.value=d),presets:Z.value},null,8,["value","presets"])]),C(E)[0].id==1?(i(),h("div",La,[Ta,c(me,{value:F.value,"onUpdate:value":s[4]||(s[4]=d=>F.value=d),mode:"multiple",placeholder:"Selecciona asesores","max-tag-count":"responsive",options:C(y).asesores,"filter-option":U},null,8,["value","options"])])):n("",!0),c(Y,{onClick:X},{default:r(()=>[x("BUSCAR")]),_:1})])]),c(Ve,{bordered:"",scroll:{x:z.value,y:$.value},class:"table-historial",columns:R.value,"data-source":P.value,pagination:!1,loading:t.value,size:"small"},{bodyCell:r(({column:d,record:f,index:Je})=>{var ye,he,ge,be,xe,we,Ie,ke,Ce,Ue,De,Se,ze,Re,Ae,Ee,$e,Ne,Fe,Ye,Me,Le,Te,qe,Oe;return[d.dataIndex=="idx"?(i(),h(k,{key:0},[x(m(ae.value(Je)),1)],64)):n("",!0),d.dataIndex=="ase_fecha"?(i(),h(k,{key:1},[x(m(de(f.created_at)),1)],64)):n("",!0),d.dataIndex=="sol_apellidos"?(i(),h(k,{key:2},[x(m((ye=f.people)==null?void 0:ye.lastname)+" "+m((he=f.people)==null?void 0:he.middlename),1)],64)):n("",!0),d.dataIndex=="sol_nombres"?(i(),h(k,{key:3},[x(m((ge=f.people)==null?void 0:ge.name),1)],64)):n("",!0),d.dataIndex=="sol_tipo_doc"?(i(),h(k,{key:4},[x(m((xe=(be=f.people)==null?void 0:be.typedocument)==null?void 0:xe.name),1)],64)):n("",!0),d.dataIndex=="sol_num_doc"?(i(),h(k,{key:5},[x(m((we=f.people)==null?void 0:we.documentnumber),1)],64)):n("",!0),d.dataIndex=="sol_email"?(i(),h(k,{key:6},[x(m((Ie=f.people)!=null&&Ie.email?f.people.email:"-"),1)],64)):n("",!0),d.dataIndex=="sol_phone"?(i(),h(k,{key:7},[x(m((ke=f.people)==null?void 0:ke.phone),1)],64)):n("",!0),d.dataIndex=="asesor"?(i(),h(k,{key:8},[x(m((Ce=f.user)==null?void 0:Ce.profile.name)+" "+m((Ue=f.user)==null?void 0:Ue.profile.lastname)+" "+m((De=f.user)==null?void 0:De.profile.middlename),1)],64)):n("",!0),d.dataIndex=="misupervisor"?(i(),h(k,{key:9},[x(m((Se=f.supervisor)==null?void 0:Se.supervisor_user.profile.name)+" "+m((ze=f.supervisor)==null?void 0:ze.supervisor_user.profile.lastname)+" "+m((Re=f.supervisor)==null?void 0:Re.supervisor_user.profile.middlename),1)],64)):n("",!0),d.dataIndex=="mype_region"?(i(),h(k,{key:10},[x(m((Ae=f.city)==null?void 0:Ae.name),1)],64)):n("",!0),d.dataIndex=="mype_provincia"?(i(),h(k,{key:11},[x(m((Ee=f.province)==null?void 0:Ee.name),1)],64)):n("",!0),d.dataIndex=="mype_distrito"?(i(),h(k,{key:12},[x(m(($e=f.district)==null?void 0:$e.name),1)],64)):n("",!0),d.dataIndex=="componente"?(i(),h(k,{key:13},[x(m((Ne=f.component)==null?void 0:Ne.name),1)],64)):n("",!0),d.dataIndex=="tema_componente"?(i(),h(k,{key:14},[x(m((Fe=f.theme)==null?void 0:Fe.name),1)],64)):n("",!0),d.dataIndex=="detalle_tramite"?(i(),h(k,{key:15},[x(m((Ye=f.detailprocedure)==null?void 0:Ye.name),1)],64)):n("",!0),d.dataIndex=="sector_economico"?(i(),h(k,{key:16},[x(m((Me=f.economicsector)==null?void 0:Me.name),1)],64)):n("",!0),d.dataIndex=="atividad_comercial"?(i(),h(k,{key:17},[x(m((Le=f.comercialactivity)==null?void 0:Le.name),1)],64)):n("",!0),d.dataIndex=="mype_direccion"?(i(),h(k,{key:18},[x(m(f==null?void 0:f.address),1)],64)):n("",!0),d.dataIndex=="mype_nombre"?(i(),h(k,{key:19},[x(m(f.nameMype),1)],64)):n("",!0),d.dataIndex=="tipo_regimen"?(i(),h(k,{key:20},[x(m((Te=f.regime)==null?void 0:Te.name),1)],64)):n("",!0),d.dataIndex=="numero_envio_notaria"?(i(),h(k,{key:21},[x(m(f.numbernotary),1)],64)):n("",!0),d.dataIndex=="notaria"?(i(),h(k,{key:22},[x(m((qe=f.notary)==null?void 0:qe.name),1)],64)):n("",!0),d.dataIndex=="codesunarp"?(i(),h(k,{key:23},[x(m(f.codesunarp),1)],64)):n("",!0),d.dataIndex==="modality"?(i(),g(ie,{key:24,color:((Oe=f.modality)==null?void 0:Oe.name)=="PRESENCIAL"?"green":"orange"},{default:r(()=>{var oe;return[x(m((oe=f.modality)==null?void 0:oe.name),1)]}),_:2},1032,["color"])):n("",!0),d.dataIndex=="ruc"?(i(),h(k,{key:25},[x(m(f.ruc?f.ruc:"EN TRÁMITE"),1)],64)):n("",!0),d.dataIndex=="actions"?(i(),g(He,{key:26,trigger:["click"]},{overlay:r(()=>[c(Ge,null,{default:r(()=>[c(J,null,{default:r(()=>[S("a",{onClick:oe=>l(f)},"Editar",8,qa)]),_:2},1024),c(J,null,{default:r(()=>[c(Be,{title:"¿Seguro de eliminar?",onConfirm:oe=>ce(f),class:"prod-alert"},{icon:r(()=>[c(C(na),{style:{color:"red"}})]),default:r(()=>[Oa]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:r(()=>[S("a",{class:"ant-dropdown-link",onClick:s[5]||(s[5]=la(()=>{},["prevent"]))},[c(Y,{shape:"circle",icon:sa(C(_a)),size:"small"},null,8,["icon"])])]),_:2},1024)):n("",!0)]}),_:1},8,["scroll","columns","data-source","loading"])]),S("div",Pa,[S("span",null,[c(ie,{color:"blue"},{default:r(()=>[S("b",null,m(j.value),1)]),_:1}),x(m(re(v.value)),1)]),c(je,{size:"small",total:j.value,pageSize:Pe,onChange:te,showSizeChanger:!1,defaultCurrent:2},null,8,["total"])]),c(pe,{width:"600",title:"Editar asesoría",open:H.value,"onUpdate:open":s[7]||(s[7]=d=>H.value=d),placement:"right"},{default:r(()=>[c(ha,{info:u.value,onCloseDraw:s[6]||(s[6]=d=>(H.value=!1,b()))},null,8,["info"])]),_:1},8,["open"]),c(pe,{width:"650",title:"Editar Formalización RUC 10",open:p.value,"onUpdate:open":s[9]||(s[9]=d=>p.value=d),placement:"right"},{default:r(()=>[c(wa,{info:u.value,onCloseDraw:s[8]||(s[8]=d=>(p.value=!1,b()))},null,8,["info"])]),_:1},8,["open"]),c(pe,{width:"820",title:"Editar Formalización RUC 20",open:O.value,"onUpdate:open":s[11]||(s[11]=d=>O.value=d),placement:"right"},{default:r(()=>[c(Aa,{info:u.value,onCloseDraw:s[10]||(s[10]=d=>(O.value=!1,b()))},null,8,["info"])]),_:1},8,["open"])],64)}}},Qa=le(Ba,[["__scopeId","data-v-194a6f06"]]);export{Qa as default};
