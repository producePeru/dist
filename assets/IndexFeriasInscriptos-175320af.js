import{l as v,r as c,a as J,j as P,X,a6 as x,o as s,d as r,c as I,R,m as Q,E as W,u as ee,b as F,w as E,t as u,y as m,F as ae,e as T,i as j,x as B,h as te,a2 as ne}from"./index-f8d1f2b5.js";import"./es-eebcc750.js";import{_ as ie}from"./TableComponent-74c1de65.js";import{d as le}from"./downloadExcel-de9202b7.js";import{_ as se}from"./FormComponent-b415cd92.js";import{u as oe}from"./selectes-fd0ee159.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-f0237bd8.js";import"./quill.snow-07761e5a.js";const de={class:"f-20"},re={__name:"ParticipanteSed",props:["info"],emits:["closeDraw"],setup(D,{emit:b}){v.locale("es");const y=c({ruc:{type:"iText",label:"RUC",name:"ruc",required:!0,message:"Ingrese el RUC",disabled:!1},comercialName:{type:"iText",label:"NOMBRE COMERCIAL",name:"comercialName",required:!0,message:"Ingrese el nombre comercial",disabled:!1},socialReason:{type:"iText",label:"RAZÓN SOCIAL",name:"socialReason",required:!0,message:"Ingrese la razón social",disabled:!1},economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccione el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccione la actividad comercial",disabled:!1},city_id:{type:"iSelect",label:"CIUDAD",name:"city_id",required:!0,message:"Seleccione la ciudad",disabled:!1},typedocument_id:{type:"iSelect",label:"TIPO DOCUMENTO",name:"typedocument_id",required:!0,message:"Seleccione el tipo de documento",disabled:!1},documentnumber:{type:"iText",label:"N° DOCUMENTO",name:"documentnumber",required:!0,message:"Ingrese el número de documento",disabled:!1},lastname:{type:"iText",label:"APELLIDO PATERNO",name:"lastname",required:!0,message:"Ingrese el apellido paterno",disabled:!1},middlename:{type:"iText",label:"APELLIDO MATERNO",name:"middlename",required:!0,message:"Ingrese el apellido materno",disabled:!1},name:{type:"iText",label:"NOMBRE",name:"name",required:!0,message:"Ingrese el nombre",disabled:!1},gender_id:{type:"iSelect",label:"GÉNERO",name:"gender_id",required:!0,message:"Seleccione el género",disabled:!1},phone:{type:"iText",label:"TELÉFONO",name:"phone",required:!0,message:"Ingrese el teléfono",disabled:!1},email:{type:"iText",label:"EMAIL",name:"email",required:!0,message:"Ingrese el correo electrónico",disabled:!1},birthday:{type:"iDate",label:"FECHA DE NACIMIENTO",name:"birthday",required:!0,message:"Seleccione la fecha de nacimiento",disabled:!1},positionCompany:{type:"iText",label:"CARGO EN EMPRESA",name:"positionCompany",required:!0,message:"Ingrese el cargo en la empresa",disabled:!1},instagram:{type:"iText",label:"INSTAGRAM",name:"instagram",required:!1,message:"",disabled:!1},facebook:{type:"iText",label:"FACEBOOK",name:"facebook",required:!1,message:"",disabled:!1},web:{type:"iText",label:"WEB",name:"web",required:!1,message:"",disabled:!1}});JSON.parse(localStorage.getItem("profile"));const f=b,_=D,g=c("GUARDAR"),e=J({}),h=c(!1),i=oe(),S=c(null),t=c({city_id:[],province_id:[],district_id:[],modality_id:[]}),A=a=>{console.log("handleInputEvent",a)},M=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),y.value.dateTramite.disabled=!1)},Y=async a=>{a=="city_id"&&(await i.fetchProvinces(e.city_id),t.value.province_id=i.provinces,y.value.province_id.disabled=!1),a=="province_id"&&(await i.fetchDistricts(e.province_id),t.value.district_id=i.districts,y.value.district_id.disabled=!1)},k=async a=>{console.log("handleFocusSelect",a),a=="city_id"&&(await i.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,t.value.province_id=[],t.value.city_id=i.cities)},L=a=>{},q=async()=>{h.value=!0;const a={ruc:e.ruc,comercialName:e.comercialName,socialReason:e.socialReason,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,city_id:e.city_id,typedocument_id:e.typedocument_id,documentnumber:e.documentnumber,lastname:e.lastname,middlename:e.middlename,name:e.name,gender_id:e.gender_id,phone:e.phone,email:e.email,birthday:v(e.birthday).format("YYYY-MM-DD HH:mm"),positionCompany:e.positionCompany,instagram:e.instagram,facebook:e.facebook,web:e.web};try{const p=await R({url:`fair/sed-update-data-user/${_.info.id}`,method:"PUT",data:a});p.status===200&&(Q.success(p.message),O(),f("closeDraw",!0))}catch(p){console.error("Error:",p);const n=document.getElementsByClassName("ant-drawer-body")[0];n&&(n.scrollTop=0)}finally{h.value=!1}},O=()=>{e.nameEvent=null,e.city_id=null,e.place=null,e.modality_id=null,e.dates=null,e.hours=null,e.description=null},N=async a=>{a&&(e.ruc=a.ruc,e.comercialName=a.comercialName,e.socialReason=a.socialReason,await i.fetchEconomicSectors(),t.value.economicsector_id=i.economicSectors,e.economicsector_id=a.economicsector.id,await i.fetchComercialActivities(),t.value.comercialactivity_id=i.comercialActivities,e.comercialactivity_id=a.comercialactivity.id,await i.fetchCities(),t.value.city_id=i.cities,e.city_id=a.city.id,await i.fetchTypeDocuments(),t.value.typedocument_id=i.typeDocuments,e.typedocument_id=a.typedocument.id,e.documentnumber=a.documentnumber,e.lastname=a.lastname,e.middlename=a.middlename,e.name=a.name,await i.fetchGenders(),t.value.gender_id=i.genders,e.gender_id=a.gender.id,e.sick=a.sick,e.phone=a.phone,e.email=a.email,a.birthday&&(e.birthday=v(a.birthday,"YYYY-MM-DD")),e.positionCompany=a.positionCompany,e.facebook=a.facebook,e.instagram=a.instagram,e.web=a.web)};return P(()=>{_.info&&N(_.info)}),X(()=>_.info,a=>{a?N(a):O()}),x("formState",e),x("loadingState",h),(a,p)=>(s(),r("div",de,[I(se,{fields:y.value,options:t.value,btnSaveName:g.value,onHandleInputEvent:A,resetSelect:S.value,onHandleChangeSelect:Y,onHandleFocusSelect:k,onHandleBlurSelect:L,onHandleChangeClock:M,onOnSubmit:q},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const ce={class:"advisory-table"},me={key:0},ue={key:1},pe={key:2},ye={key:3},_e={key:4},ge={key:5},fe={key:6},he={key:7},Ee={key:8},Ie={key:0,style:{"line-height":"1.5"}},ve={key:1},be=["onClick"],Se={__name:"EventSed",setup(D){const b=W(),y=JSON.parse(localStorage.getItem("role"))||[],f=c([]),_=c(0),g=c(150),e=c(!1);ee();const h=c(!1),i=c(null),S=c(!1),t=J({year:v("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),A=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"RUC",dataIndex:"ruc",fixed:"left",width:100,align:"center"},{title:"NOMBRE COMERCIAL",dataIndex:"comercialName",width:200},{title:"RAZÓN SOCIAL",dataIndex:"socialReason",width:200},{title:"SECTOR ECONÓMICO",dataIndex:"economicsector_id",width:160,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"comercialactivity_id",width:180},{title:"CATEGORÍA",dataIndex:"category_id",width:150},{title:"CIUDAD",dataIndex:"city_id",width:150,align:"center"},{title:"TIPO ASISTENTE",dataIndex:"typeAsistente",width:150,align:"center"},{title:"TIPO DOCUMENTO",dataIndex:"typedocument_id",width:150,align:"center"},{title:"N° DOCUMENTO",dataIndex:"documentnumber",width:150,align:"center"},{title:"APELLIDO PATERNO",dataIndex:"lastname",width:150,align:"center"},{title:"APELLIDO MATERNO",dataIndex:"middlename",width:150,align:"center"},{title:"NOMBRE",dataIndex:"name",width:150,align:"center"},{title:"GÉNERO",dataIndex:"gender_id",width:120,align:"center"},{title:"¿TIENE LESIÓN?",dataIndex:"sick",width:120,align:"center"},{title:"TELÉFONO",dataIndex:"phone",width:150,align:"center"},{title:"EMAIL",dataIndex:"email",width:200,align:"center"},{title:"FECHA DE NACIMIENTO",dataIndex:"birthday",width:150,align:"center"},{title:"CARGO EN EMPRESA",dataIndex:"positionCompany",width:180,align:"center"},{title:"CÓMO CONOCIÓ EL EVENTO",dataIndex:"howKnowEvent_id",width:200,align:"center"},{title:"INSTAGRAM",dataIndex:"instagram",width:180,align:"center"},{title:"FACEBOOK",dataIndex:"facebook",width:180,align:"center"},{title:"WEB",dataIndex:"web",width:180,align:"center"},{title:"REGISTRADO",dataIndex:"created_at",width:160,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],M=n=>{i.value=n,e.value=!0},Y=()=>{p(),e.value=!1},k=()=>{i.value=null,e.value=!0},L=async n=>{try{const l=await R({url:`attendance/delete/${n.id}`,method:"DELETE"});l.status==200&&(p(),Q.success(l.message))}catch(l){console.error("Error de red:",l)}},q=async()=>{S.value=!0;try{const n={};t.year&&(n.year=v(t.year).format("YYYY")),t.range&&(n.dateStart=t.range[0].format("YYYY/MM/DD"),n.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(n.name=t.name),t.orderby&&(n.orderby=t.orderby),t.asesor&&(n.asesor=t.asesor),await le("download/attendance-ugo","eventos-ugo",n)}catch(n){console.error("Error de red:",n)}finally{S.value=!1}},O=async n=>{t.page=n,await p()},N=async n=>{n&&(t.page=1,await p())},a=n=>y.some(l=>n.includes(l.id)),p=async()=>{try{h.value=!0;const n={page:t.page},l=b.params.slug;t.year&&(n.year=v(t.year).format("YYYY")),t.range&&(n.dateStart=t.range[0].format("YYYY/MM/DD"),n.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(n.name=t.name),t.orderby&&(n.orderby=t.orderby);let w=`fair/list-event-sed/${l}`;const C=await R({url:w,method:"GET",params:n});f.value=C.data.data,_.value=C.data.total,g.value=C.data.per_page}catch(n){console.error("Error de red:",n)}finally{h.value=!1}};return P(async()=>{await p()}),x("search",t),x("loading",h),x("loadingFile",S),(n,l)=>{const w=F("a-menu-item"),C=F("a-popconfirm"),Z=F("a-drawer");return s(),r("div",ce,[I(ie,{title:"INSCRITOS EN EL EVENTO SED",new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:A,titleSearch:"ESCRIBIR RUC",downloadExcel:!0,pageSize:g.value,nameTotal:"Inscritos SED",dataSource:f.value,total:_.value,onHandleNew:k,onHandleDownloadExcel:q,onHandleSearch:N,onHandlePaginator:O},{"data-cell":E(({column:o,record:d})=>{var U,G,H,$,V,K,z;return[o.dataIndex=="economicsector_id"?(s(),r("span",me,u((U=d.economicsector)==null?void 0:U.name),1)):m("",!0),o.dataIndex=="comercialactivity_id"?(s(),r("span",ue,u((G=d.comercialactivity)==null?void 0:G.name),1)):m("",!0),o.dataIndex=="category_id"?(s(),r("span",pe,u((H=d.category)==null?void 0:H.name),1)):m("",!0),o.dataIndex=="city_id"?(s(),r("span",ye,u(($=d.city)==null?void 0:$.name),1)):m("",!0),o.dataIndex=="typeAsistente"?(s(),r("span",_e,u(d.typeAsistente==1?"Representante":"Invitado"),1)):m("",!0),o.dataIndex=="typedocument_id"?(s(),r("span",ge,u((V=d.typedocument)==null?void 0:V.name),1)):m("",!0),o.dataIndex=="gender_id"?(s(),r("span",fe,u((K=d.gender)==null?void 0:K.name),1)):m("",!0),o.dataIndex=="sick"?(s(),r("span",he,u(d.typeAsistente=="yes"?"SI":"NO"),1)):m("",!0),o.dataIndex=="howKnowEvent_id"?(s(),r("span",Ee,u((z=d.howKnowEvent)==null?void 0:z.name),1)):m("",!0),o.dataIndex=="date"?(s(),r(ae,{key:9},[d.dateStart!=d.dateEnd?(s(),r("span",Ie,[l[1]||(l[1]=T("b",null,"Desde:",-1)),j(" "+u(d.dateStartFormat)+" ",1),l[2]||(l[2]=T("b",null,"Hasta:",-1)),j(" "+u(d.dateEndFormat),1)])):(s(),r("span",ve,u(d.dateStartFormat),1))],64)):m("",!0)]}),"custom-options":E(({record:o})=>[a([1,5])?(s(),B(w,{key:0},{default:E(()=>[T("a",{onClick:d=>M(o)},"Editar",8,be)]),_:2},1024)):m("",!0),a([1,5])?(s(),B(w,{key:1},{default:E(()=>[I(C,{placement:"rightBottom",title:`¿Quieres eliminar ${o.title} ?`,onConfirm:d=>L(o)},{icon:E(()=>[I(te(ne),{style:{color:"red"}})]),default:E(()=>[l[3]||(l[3]=T("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):m("",!0)]),_:1},8,["pageSize","dataSource","total"]),I(Z,{open:e.value,"onUpdate:open":l[0]||(l[0]=o=>e.value=o),title:i.value?"EDITAR REGISTRO":"NUEVO REGISTRO",placement:"right",width:"650"},{default:E(()=>[I(re,{onCloseDraw:Y,info:i.value},null,8,["info"])]),_:1},8,["open","title"])])}}},Me={__name:"IndexFeriasInscriptos",setup(D){const b=W(),y=c(!0),f=c(null),_=async()=>{try{y.value=!0;const g=b.params.slug,e=await R({url:`fair/type-fair/${g}`,method:"GET"});f.value=+e.data.fairtype_id}catch(g){console.error("Error de red:",g)}finally{y.value=!1}};return P(()=>{_()}),(g,e)=>f.value==1?(s(),B(Se,{key:0})):m("",!0)}};export{Me as default};
