import{r as s,a as se,p as x,k as de,X as C,b as d,o as p,d as M,c as r,w as n,m as O,f as ce,s as ue,i as T,z as y,e as m,y as w,a1 as pe,O as me,j as fe,a2 as ve,h as D}from"./index-5df45652.js";import{_ as _e}from"./TableComponent-7868579a.js";import{_ as Ee}from"./EventosUgo-15fcbed7.js";import{d as F}from"./downloadExcel-ee05a1a2.js";import{g as ye}from"./usePermissions-a0edd0e9.js";import"./es-b49b6a64.js";import{g as U}from"./publicInscripcion-623ff37e.js";import{F as he}from"./FileExcelOutlined-dce0c6fc.js";import"./icoexcel-1b303edf.js";import"./selectes-d99873b2.js";import"./SyncOutlined-5aba341a.js";import"./MoreOutlined-707461a2.js";const we={class:"layout-content"},De={key:0},ge={class:"filter-asesor",style:{width:"280px"}},Ie=["onClick"],Ae=["onClick"],xe=["onClick"],Ue={__name:"eventos-index",setup(Ce){const k=s([]),S=s(0),Y=s(150),i=s({}),f=s(!1),g=s(!1),h=s(null),u=s(!1),b=s([]),a=se({year:x("2026","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),$=[{title:"",dataIndex:"copy",fixed:"left",width:50},{title:"TIPO DE ACTIVIDAD",dataIndex:"tipo_actividad",width:180},{title:"NOMBRE DE ACTIVIDAD",dataIndex:"nombre_actividad",width:180},{title:"TEMA DE ACTIVIDAD",dataIndex:"tema",width:180},{title:"NOMBRE DE ENTIDAD ORGANIZADORA",dataIndex:"entidad_aliada",width:180},{title:"ASESOR",dataIndex:"asesor",width:180},{title:"MYPE Y/O EMPRENDEDORES BENEFICIADOS ESPERADOS",dataIndex:"beneficiarios",align:"center",width:180},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:120},{title:"REGIÓN DE LA ACTIVIDAD",dataIndex:"city",width:120},{title:"PROVINCIA DE LA ACTIVIDAD",dataIndex:"province",width:120},{title:"DISTRITO DE LA ACTIVIDAD",dataIndex:"district",width:120},{title:"LUGAR DE LA ACTIVIDAD",dataIndex:"address",width:120},{title:"¿REQUERIRÁ PASAJES?",dataIndex:"pasaje",align:"center",width:100},{title:"MONTO DE GASTOS",dataIndex:"monto",align:"center",width:100},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],P=(e,t)=>{const o=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)};async function z(e,t){const o=G(e,t);await B(o)?D.success("Link copiado"):D.error("No se pudo copiar el link")}function G(e,t){return`${U()}/actividades-ugo/${t}`}async function B(e){var t;try{if((t=navigator.clipboard)!=null&&t.writeText)return await navigator.clipboard.writeText(e),!0;const o=document.createElement("textarea");o.value=e,o.setAttribute("readonly",""),o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select();const v=document.execCommand("copy");return document.body.removeChild(o),v}catch{return!1}}const H=s([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]);function j(e,t){const o=`${U()}/actividades-ugo/${t}`;window.open(o,"_blank")}const Q=e=>{h.value=e,f.value=!0},q=()=>{c(),f.value=!1},J=()=>{h.value=null,f.value=!0},X=async e=>{try{const t=await O({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(c(),D.success(t.message))}catch(t){console.error("Error de red:",t)}},Z=async e=>{try{const t=await O({url:`attendance/event-finally/${e.id}`,method:"PUT"});t.status==200&&(c(),D.success(t.message))}catch(t){console.error("Error de red:",t)}},K=async()=>{u.value=!0;try{const e={};a.year&&(e.year=x(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor),await F("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{u.value=!1}},W=async()=>{u.value=!0;try{await F("download/all-activities-the-year","Actividades-UGO-2025")}catch(e){console.error("Error de red:",e)}finally{u.value=!1}},ee=async e=>{a.page=e,await c()},te=async e=>{e&&(a.page=1,await c())},c=async()=>{try{g.value=!0;const e={page:a.page};a.year&&(e.year=x(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor);const o=await O({url:"events-ugo/list",method:"GET",params:e});k.value=o.data.data,S.value=o.data.total,Y.value=o.data.per_page}catch(e){console.error("Error de red:",e)}finally{g.value=!1}},ae=async()=>{try{const e=await ce({url:"select/asesores",method:"GET"});e.status==200&&(b.value=e.data)}catch{console.log("Failed to delete")}};return de(async()=>{var e;i.value=await ye("eventos-ugo"),(e=i.value)!=null&&e.can_view_all&&(await c(),await ae())}),C("search",a),C("loading",g),C("loadingFile",u),(e,t)=>{var N,R,L;const o=d("a-button"),v=d("a-select"),oe=d("a-tooltip"),ne=d("a-input-group"),_=d("a-menu-item"),le=d("router-link"),re=d("a-popconfirm"),ie=d("a-drawer");return p(),M("div",we,[r(_e,{title:"LISTA ACTIVIDADES UGO",textNuevo:"NUEVO EVENTO",new:(N=i.value)==null?void 0:N.can_create,searchYear:!0,rangeDate:(R=i.value)==null?void 0:R.can_date_range,btnUpdate:!0,btnImport:!0,downloadExcel:(L=i.value)==null?void 0:L.can_download_reporte,placeholderSearch:"Buscar",columns:$,othersList:H.value,titleSearch:"BUSCAR POR EVENTO",pageSize:Y.value,nameTotal:"Actividades UGO",dataSource:k.value,total:S.value,onHandleNew:J,onHandleDownloadExcel:K,onHandleSearch:te,permisos:i.value,onHandleCallFetchData:c,onHandlePaginator:ee},{header:n(()=>[i.value.can_download_everything?(p(),M("div",De,[r(o,{loading:u.value,type:"text",icon:ue(T(he)),onClick:W},null,8,["loading","icon"])])):y("",!0),m("div",ge,[t[2]||(t[2]=m("small",null,"POR ASESOR",-1)),r(v,{allowClear:!0,value:a.asesor,"onUpdate:value":t[0]||(t[0]=l=>a.asesor=l),placeholder:"Selecciona Asesor","show-search":"",options:b.value,"filter-option":P},null,8,["value","options"])])]),"data-cell":n(({column:l,record:E})=>[l.dataIndex=="copy"?(p(),w(ne,{key:0,compact:""},{default:n(()=>[r(oe,{title:"copiar link"},{default:n(()=>[r(o,{type:"text",onClick:I=>z(E.eventsoffice_id,E.slug)},{icon:n(()=>[r(T(pe),{style:{"font-size":"11px"}})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):y("",!0)]),"custom-options":n(({record:l})=>{var E,I,V;return[r(_,null,{default:n(()=>[m("a",{href:"#",onClick:me(A=>j(l.eventsoffice_id,l.slug),["prevent"])}," Ver Link ",8,Ie)]),_:2},1024),r(_,null,{default:n(()=>[r(le,{to:`eventos-inscritos/${l.slug}`},{default:n(()=>t[3]||(t[3]=[fe("Inscritos")])),_:2},1032,["to"])]),_:2},1024),(E=i.value)!=null&&E.can_update?(p(),w(_,{key:0},{default:n(()=>[m("a",{onClick:A=>Q(l)},"Editar",8,Ae)]),_:2},1024)):y("",!0),(I=i.value)!=null&&I.can_finish?(p(),w(_,{key:1},{default:n(()=>[m("span",{style:{color:"#ff4d4f"},onClick:A=>Z(l)},"Finalizar",8,xe)]),_:2},1024)):y("",!0),(V=i.value)!=null&&V.can_delete?(p(),w(_,{key:2},{default:n(()=>[r(re,{placement:"rightBottom",title:`¿Quieres eliminar ${l.title} ?`,onConfirm:A=>X(l)},{icon:n(()=>[r(T(ve),{style:{color:"red"}})]),default:n(()=>[t[4]||(t[4]=m("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):y("",!0)]}),_:1},8,["new","rangeDate","downloadExcel","othersList","pageSize","dataSource","total","permisos"]),r(ie,{open:f.value,"onUpdate:open":t[1]||(t[1]=l=>f.value=l),title:h.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD",placement:"right",width:"550"},{default:n(()=>[r(Ee,{onCloseDraw:q,dataRow:h.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{Ue as default};
