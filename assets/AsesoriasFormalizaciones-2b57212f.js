import{u as me}from"./selectes-292a5904.js";import{f as Se,r as Ue,a as Ie}from"./asesorias-0812f050.js";import{c as i,A as De,N as ue,r as f,a as ve,k as pe,M as fe,b as h,o as s,d as V,w as n,e as g,F as Z,y as he,s as v,h as y,v as u,t as P,O as ze,a0 as xe,i as Y,a1 as we,B as te,m as W,f as ke,Y as Ae,u as Ne,z as Re,a3 as Oe,p as $e,j as Fe}from"./index-af55d7e2.js";import"./es-9405d451.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";import"./storage-75bb00b9.js";import{S as Ee}from"./DrawerSolicitante.componente-fcc7e79b.js";var qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};const Te=qe;function be(N){for(var k=1;k<arguments.length;k++){var F=arguments[k]!=null?Object(arguments[k]):{},U=Object.keys(F);typeof Object.getOwnPropertySymbols=="function"&&(U=U.concat(Object.getOwnPropertySymbols(F).filter(function(D){return Object.getOwnPropertyDescriptor(F,D).enumerable}))),U.forEach(function(D){Pe(N,D,F[D])})}return N}function Pe(N,k,F){return k in N?Object.defineProperty(N,k,{value:F,enumerable:!0,configurable:!0,writable:!0}):N[k]=F,N}var ye=function(k,F){var U=be({},k,F.attrs);return i(De,be({},U,{icon:Te}),null)};ye.displayName="RedoOutlined";ye.inheritAttrs=!1;const Le=ye;const Me={class:"grid-ruc20"},Ye={class:"select-notaries"},Ve={class:"name"},Ge={class:"city"},Be={class:"address"},je="DD/MM/YYYY",Je={__name:"AllFormalizacion20",props:["info","idCde"],emits:["closeDraw"],setup(N,{emit:k}){ue.locale("es");const F=we({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),U=k,D=N,c=f(null),R=JSON.parse(localStorage.getItem("profile")),q=JSON.parse(localStorage.getItem("role")),m=me(),t=f(!1),G=f(!1),B=f(!0),l=f([]),T=f(null),a=ve({});m.$patch({cities:m.cities}),m.$patch({modalities:m.modalities}),m.$patch({economicSectors:m.economicSectors}),m.$patch({comercialActivities:m.comercialActivities}),m.$patch({regimes:m.regimes}),m.$patch({typeCapital:m.typeCapital}),m.fetchEconomicSectors(),m.fetchComercialActivities(),m.fetchRegimes(),m.fetchModalities(),m.fetchTypeCapital(),m.fetchCities();const M=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}],K=o=>o&&o>ue().endOf("day"),A=o=>{if(o=="ruc"){const b=a.ruc;(b<2e10||b>20999999999)&&(a.ruc=null)}},_=o=>{(o=="ruc"||o=="montocapital")&&(a[o]=a[o].replace(/\D/g,""))},z=(o,b)=>{const r=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),L=b.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),d=b.city.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),ee=b.province.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),C=b.district.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return L.includes(r)||d.includes(r)||ee.includes(r)||C.includes(r)},O=async()=>{try{G.value=!0;const o={name:T.value};(await te({url:"create/comercial-activities",method:"POST",data:o})).status==200&&(T.value=null,m.fetchComercialActivities())}catch(o){console.log(o)}finally{G.value=!1}},x=o=>{a.province_id=null,a.district_id=null,m.fetchProvinces(o)},w=o=>{a.district_id=null,m.fetchDistricts(o)},I=async()=>{try{const{data:o}=await ke({url:"public/notaries-filters",method:"GET"}),b=o.map(r=>({value:r.id,name:r.name,city:r.city.name,province:r.province.name,district:r.district.name,address:r.address}));l.value=b,B.value=!1}catch(o){console.error("Error de red:",o)}},$=(o,b)=>{const r=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return b.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(r)};function H(o){c.value=Se;const{documentnumber:b,city_id:r,province_id:L,district_id:d,address:ee}=D.info,C=q.some(ae=>ae.id===7);a.dni=b,a.city_id=r,x(r),a.province_id=L,w(L),a.district_id=d,a.address=ee,I(),C&&(c.value.notary_id.disabled=!0,c.value.modality_id.disabled=!0,a.modality_id=1,a.notary_id=R.notary_id)}const X=async()=>{if(t.value=!0,!D.info.id)return W.error("Error al registrar, actualiza la página");const o={codesunarp:a.codesunarp,numbernotary:a.numbernotary,address:a.address,economicsector_id:a.economicsector_id,comercialactivity_id:a.comercialactivity_id,regime_id:a.regime_id,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,modality_id:a.modality_id,notary_id:a.notary_id,user_id:R.user_id,people_id:D.info.id,nameMype:a.nameMype,dateReception:a.dateReception?ue(a.dateReception).format("YYYY-MM-DD"):null,dateTramite:a.dateTramite?ue(a.dateTramite).format("YYYY-MM-DD"):null,ruc:a.ruc,dni:a.dni,typecapital_id:a.typecapital_id,isbic:a.isbic,montocapital:a.montocapital,cde_id:D.idCde?D.idCde:null};try{const b=await te({url:"formalization/create-ruc20",method:"POST",data:o});if(b.status===200){const r={razonSocial:null,ruc:a.ruc,createdFrom:"F20"};W.success(b.message),a.codesunarp=null,a.economicsector_id=null,a.comercialactivity_id=null,a.regime_id=null,a.city_id=null,a.province_id=null,a.district_id=null,a.address=null,a.modality_id=null,a.nameMype=null,a.dateReception=null,a.dateTramite=null,a.notary_id=null,a.ruc=null,a.numbernotary=null,a.isbic=null,a.montocapital=null,a.typecapital_id=null,U("closeDraw",!0)}}catch(b){console.log("Error: "+b)}finally{t.value=!1}};return pe(()=>{D.info&&H(D.info)}),fe(()=>D.info,o=>{o&&H()}),(o,b)=>{const r=h("a-select"),L=h("a-form-item"),d=h("a-date-picker"),ee=h("a-divider"),C=h("a-input"),ae=h("a-button"),ne=h("a-space"),ie=h("a-input-number"),re=h("a-form"),j=h("a-spin");return s(),V("div",null,[i(j,{spinning:B.value},{default:n(()=>[i(re,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:X},{default:n(()=>[g("div",Me,[(s(!0),V(Z,null,he(c.value,(e,Q)=>(s(),V(Z,{key:Q},[e.type==="iSelect"?(s(),v(L,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:n(()=>[e.name=="regime_id"?(s(),v(r,{key:0,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,options:y(m).regimes,"show-search":"","filter-option":$},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="modality_id"?(s(),v(r,{key:1,disabled:e.disabled,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,options:y(m).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0),e.name=="typecapital_id"?(s(),v(r,{key:2,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,options:y(m).typeCapital},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="isbic"?(s(),v(r,{key:3,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,options:M},null,8,["value","onUpdate:value"])):u("",!0),e.name=="notary_id"?(s(),v(r,{key:4,disabled:e.disabled,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,options:l.value,"option-label-prop":"name","show-search":"","filter-option":z},{option:n(({value:p,name:le,city:_e,province:se,district:E,address:oe})=>[g("div",Ye,[g("span",Ve,P(le),1),g("span",Ge,P(_e)+" - "+P(se)+" - "+P(E),1),g("span",Be,P(oe),1)])]),_:2},1032,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iDate"?(s(),v(L,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:n(()=>[i(d,{locale:y(ze),value:a[e.name],"onUpdate:value":p=>a[e.name]=p,style:{width:"100%"},format:je,placeholder:"día/mes/año","disabled-date":K,disabled:e.disabled,onChange:b[0]||(b[0]=p=>a.birthday=o.birthdateDate)},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSelectWrite"?(s(),v(L,{key:2,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:n(()=>[e.name=="comercialactivity_id"?(s(),v(r,{key:0,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,"show-search":"",options:y(m).comercialActivities,"filter-option":$},{dropdownRender:n(({menuNode:p})=>[i(y(F),{vnodes:p},null,8,["vnodes"]),i(ee,{style:{margin:"4px 0"}}),i(ne,{style:{padding:"4px 8px"}},{default:n(()=>[i(C,{ref_for:!0,ref:"inputRef",value:T.value,"onUpdate:value":b[1]||(b[1]=le=>T.value=le),placeholder:"Nueva actividad"},null,8,["value"]),i(ae,{type:"text",onClick:O,loading:G.value},{icon:n(()=>[i(y(xe))]),default:n(()=>[Y(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):u("",!0),e.name=="economicsector_id"?(s(),v(r,{key:1,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,"show-search":"",options:y(m).economicSectors,"filter-option":$},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="city_id"?(s(),v(r,{key:2,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,"show-search":"",options:y(m).cities,"filter-option":$,onChange:x},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="province_id"?(s(),v(r,{key:3,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,"show-search":"",options:y(m).provinces,"filter-option":$,onChange:w,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),e.name=="district_id"?(s(),v(r,{key:4,value:a[e.name],"onUpdate:value":p=>a[e.name]=p,"show-search":"",options:y(m).districts,"filter-option":$,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iText"?(s(),v(L,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email,max:e.max,min:e.min}]},{default:n(()=>[i(C,{onInput:p=>_(e.name),value:a[e.name],"onUpdate:value":p=>a[e.name]=p,disabled:e.disabled,maxlength:e.max,placeholder:e.placeholder},null,8,["onInput","value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iNumber"?(s(),v(L,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:n(()=>[i(ie,{style:{width:"100%"},value:a[e.name],"onUpdate:value":p=>a[e.name]=p,maxlength:e.max,onChange:p=>A(e.name)},null,8,["value","onUpdate:value","maxlength","onChange"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iTextLol"?(s(),v(L,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:n(()=>[i(C,{onInput:p=>_(e.name),value:a.dni,"onUpdate:value":b[2]||(b[2]=p=>a.dni=p),disabled:!D.documentnumber,maxlength:e.max,placeholder:e.placeholder},null,8,["onInput","value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iMoney"?(s(),v(L,{key:6,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:n(()=>[i(ie,{min:1,style:{width:"100%"},value:a[e.name],"onUpdate:value":p=>a[e.name]=p,formatter:p=>`S/ ${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>p.replace(/S\/\s?|(,*)/g,"")},null,8,["value","onUpdate:value","formatter","parser"])]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),i(L,null,{default:n(()=>[i(ae,{class:"btn-produce",type:"primary","html-type":"submit",loading:t.value},{default:n(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},He=de(Je,[["__scopeId","data-v-94cb37bc"]]);const We={class:"wrapper-booking"},Ke={class:"grid-booking"},Qe={__name:"FormalizacionRUC10",props:["info","idCde"],emits:["closeDraw"],setup(N,{emit:k}){const F=JSON.parse(localStorage.getItem("role")),U=we({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),D=JSON.parse(localStorage.getItem("profile")),c=N,R=k,q=f(!1),m=f(null);f(null),f(!1);const t=me(),G=f(!1);t.$patch({cities:t.cities}),t.$patch({provinces:t.provinces}),t.$patch({districts:t.districts}),t.$patch({modalities:t.modalities}),t.$patch({detailProcedures:t.detailProcedures}),t.$patch({economicSectors:t.economicSectors}),t.$patch({comercialActivities:t.comercialActivities}),t.fetchDetailProcedures(),t.fetchModalities(),t.fetchEconomicSectors(),t.fetchComercialActivities(),t.fetchCities();const B=f(!0),l=ve({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,address:null,user_id:D.user_id}),T=(x,w)=>new Promise((I,$)=>{!w||w.trim()===""?I():isNaN(w)||w<1e10||w>19999999999?$(new Error("El número de RUC no es válido")):I()}),a=async()=>{try{G.value=!0;const x={name:m.value};(await te({url:"create/comercial-activities",method:"POST",data:x})).status==200&&(m.value=null,t.fetchComercialActivities())}catch(x){console.log(x)}finally{G.value=!1}},M=x=>{l.province_id=null,l.district_id=null,t.fetchProvinces(x)},K=x=>{l.district_id=null,t.fetchDistricts(x)},A=(x,w)=>{const I=x.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return w.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(I)},_=async()=>{if(q.value=!0,!c.info.id)return W.error("Error al registrar, actualiza la página");const x={dni:l.dni,detailprocedure_id:l.detailprocedure_id,modality_id:l.modality_id,economicsector_id:l.economicsector_id,comercialactivity_id:l.comercialactivity_id,city_id:l.city_id,province_id:l.province_id,district_id:l.district_id,address:l.address,ruc:l.ruc,user_id:D.user_id,people_id:c.info.id,cde_id:c.idCde?c.idCde:null};try{const w=await te({url:"formalization/create-ruc-10",method:"POST",data:x});if(w.status===200){const I={razonSocial:null,ruc:l.ruc,createdFrom:"F10"};W.success(w.message),l.detailprocedure_id=null,l.modality_id=null,l.economicsector_id=null,l.comercialactivity_id=null,l.city_id=null,l.province_id=null,l.district_id=null,l.address=null,l.ruc=null,R("closeDraw",!0)}}catch(w){console.log("Error: "+w)}finally{q.value=!1}},z=()=>{W.warning("Debes de completar todos los espacios requeridos")};function O(){const{documentnumber:x,city_id:w,province_id:I,district_id:$,address:H}=c.info,X=F.some(o=>o.id===7);l.dni=x,l.city_id=w,M(w),l.province_id=I,K(I),l.district_id=$,l.address=H,X&&(l.modality_id=1),l.district_id&&setTimeout(()=>{B.value=!1},1500)}return pe(()=>{c.info&&O(c.info)}),fe(()=>c.info,x=>{x&&O()}),(x,w)=>{const I=h("a-select"),$=h("a-form-item"),H=h("a-input"),X=h("a-divider"),o=h("a-button"),b=h("a-space"),r=h("a-form"),L=h("a-spin");return s(),V("div",We,[i(L,{spinning:B.value},{default:n(()=>[i(r,{layout:"vertical",model:l,name:"basic",autocomplete:"off",onFinish:_,onFinishFailed:z},{default:n(()=>[g("div",Ke,[(s(!0),V(Z,null,he(y(Ue),(d,ee)=>(s(),V(Z,{key:ee},[d.type==="iSelect"?(s(),v($,{key:0,class:"item-max",name:d.name,label:d.label,rules:[{required:d.required,message:d.message}]},{default:n(()=>[d.name=="detailprocedure_id"?(s(),v(I,{key:0,value:l[d.name],"onUpdate:value":C=>l[d.name]=C,options:y(t).detailProcedures},null,8,["value","onUpdate:value","options"])):u("",!0),d.name=="modality_id"?(s(),v(I,{key:1,disabled:d.disabled,value:l[d.name],"onUpdate:value":C=>l[d.name]=C,options:y(t).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),d.type==="iText"?(s(),v($,{key:1,name:d.name,label:d.label,rules:[{required:d.required,message:d.message,type:"string",max:d.max},...d.name==="ruc"?[{validator:T}]:[]]},{default:n(()=>[i(H,{value:l[d.name],"onUpdate:value":C=>l[d.name]=C,disabled:d.name==="dni"&&!!l[d.name],maxlength:d.max,placeholder:d.placeholder},null,8,["value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),d.type==="iSelectWrite"?(s(),v($,{key:2,class:"item-max",name:d.name,label:d.label,rules:[{required:d.required,message:d.message}]},{default:n(()=>[d.name=="comercialactivity_id"?(s(),v(I,{key:0,value:l[d.name],"onUpdate:value":C=>l[d.name]=C,"show-search":"",options:y(t).comercialActivities,"filter-option":A},{dropdownRender:n(({menuNode:C})=>[i(y(U),{vnodes:C},null,8,["vnodes"]),i(X,{style:{margin:"4px 0"}}),i(b,{style:{padding:"4px 8px"}},{default:n(()=>[i(H,{ref_for:!0,ref:"inputRef",value:m.value,"onUpdate:value":w[0]||(w[0]=ae=>m.value=ae),placeholder:"Nueva actividad"},null,8,["value"]),i(o,{type:"text",onClick:a,loading:G.value},{icon:n(()=>[i(y(xe))]),default:n(()=>[Y(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):u("",!0),d.name=="economicsector_id"?(s(),v(I,{key:1,value:l[d.name],"onUpdate:value":C=>l[d.name]=C,"show-search":"",options:y(t).economicSectors,"filter-option":A},null,8,["value","onUpdate:value","options"])):u("",!0),d.name=="city_id"?(s(),v(I,{key:2,value:l[d.name],"onUpdate:value":C=>l[d.name]=C,"show-search":"",options:y(t).cities,"filter-option":A,onChange:M},null,8,["value","onUpdate:value","options"])):u("",!0),d.name=="province_id"?(s(),v(I,{key:3,value:l[d.name],"onUpdate:value":C=>l[d.name]=C,"show-search":"",options:y(t).provinces,"filter-option":A,onChange:K,disabled:!l.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),d.name=="district_id"?(s(),v(I,{key:4,value:l[d.name],"onUpdate:value":C=>l[d.name]=C,"show-search":"",options:y(t).districts,"filter-option":A,disabled:!l.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),i($,null,{default:n(()=>[i(o,{type:"primary",class:"btn-produce","html-type":"submit",loading:q.value},{default:n(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},Ze=de(Qe,[["__scopeId","data-v-a429704c"]]);const Xe={class:"wrapper-booking"},ea={class:"grid-booking"},aa={__name:"AsesoriaNuevo",props:["info","idCde"],emits:["closeDraw"],setup(N,{emit:k}){const F=JSON.parse(localStorage.getItem("role")),U=N,D=k,c=me(),R=JSON.parse(localStorage.getItem("profile")),q=f(!1);f(!1),f(null),f(null),c.$patch({components:c.components}),c.$patch({componentThemes:c.componentThemes}),c.$patch({modalities:c.modalities}),c.$patch({cities:c.cities}),c.$patch({economicSectors:c.economicSectors}),c.$patch({comercialActivities:c.comercialActivities}),c.fetchEconomicSectors(),c.fetchComercialActivities(),c.fetchComponents(),c.fetchModalities(),c.fetchCities();const m=f(!0),t=ve({cde_id:null,dni:null,economicsector_id:null,comercialactivity_id:null,component_id:null,theme_id:null,modality_id:null,ruc:null,city_id:null,province_id:null,district_id:null,observations:null,user_id:R.user_id}),G=_=>{_=="ruc"&&(t[_]=t[_].replace(/\D/g,""))},B=_=>{t.theme_id=null,c.fetchComponentThemes(_)},l=_=>{t.province_id=null,t.district_id=null,c.fetchProvinces(_)},T=_=>{t.district_id=null,c.fetchDistricts(_)},a=(_,z)=>{const O=_.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return z.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(O)},M=async()=>{if(q.value=!0,!U.info.id)return W.error("Error al registrar actualiza la página");const _={dni:t.dni,economicsector_id:t.economicsector_id,comercialactivity_id:t.comercialactivity_id,observations:t.observations,user_id:R.user_id,people_id:U.info.id,component_id:t.component_id,theme_id:t.theme_id,modality_id:t.modality_id,city_id:t.city_id,province_id:t.province_id,district_id:t.district_id,ruc:t.ruc,cde_id:U.idCde?U.idCde:null};try{const z=await te({url:"advisory/create",method:"POST",data:_});if(z.status===200){const O={razonSocial:null,ruc:t.ruc,createdFrom:"asesorias"};W.success(z.message),t.component_id=null,t.theme_id=null,t.modality_id=null,t.city_id=null,t.province_id=null,t.district_id=null,t.observations=null,t.ruc=null,t.economicsector_id=null,t.comercialactivity_id=null,D("closeDraw",!0)}}catch(z){console.log("Error: "+z)}finally{q.value=!1}},K=()=>{W.warning("Debes de completar todos los espacios requeridos")};function A(){const{documentnumber:_,city_id:z,province_id:O,district_id:x}=U.info,w=F.some(I=>I.id===7);t.dni=_,t.city_id=z,l(z),t.province_id=O,T(O),t.district_id=x,w&&(c.fetchComponentThemes(4),t.component_id=4,t.modality_id=1),t.district_id&&setTimeout(()=>{m.value=!1},1500)}return pe(()=>{U.info&&A(U.info)}),fe(()=>U.info,_=>{_&&A()}),(_,z)=>{const O=h("a-select"),x=h("a-form-item"),w=h("a-textarea"),I=h("a-input"),$=h("a-button"),H=h("a-form"),X=h("a-spin");return s(),V("div",Xe,[i(X,{spinning:m.value},{default:n(()=>[i(H,{layout:"vertical",model:t,name:"basic",autocomplete:"off",onFinish:M,onFinishFailed:K},{default:n(()=>[g("div",ea,[(s(!0),V(Z,null,he(y(Ie),(o,b)=>(s(),V(Z,{key:b},[o.type==="iSelect"?(s(),v(x,{key:0,class:"item-max",name:o.name,label:o.label,rules:[{required:o.required,message:o.message}]},{default:n(()=>[o.name=="modality_id"?(s(),v(O,{key:0,disabled:o.disabled,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,options:y(c).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),o.type==="iTextarea"?(s(),v(x,{key:1,name:o.name,label:o.label,rules:[{required:o.required,message:o.message}]},{default:n(()=>[i(w,{value:t[o.name],"onUpdate:value":r=>t[o.name]=r,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):u("",!0),o.type==="iText"?(s(),v(x,{key:2,name:o.name,label:o.label,rules:[{required:o.required,message:o.message,type:o.email,max:o.max}]},{default:n(()=>[i(I,{value:t[o.name],"onUpdate:value":r=>t[o.name]=r,maxlength:o.max,onInput:r=>G(o.name),placeholder:o.placeholder,disabled:o.name==="dni"&&!!t[o.name]},null,8,["value","onUpdate:value","maxlength","onInput","placeholder","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),o.type==="iSelectWrite"?(s(),v(x,{key:3,class:"item-max",name:o.name,label:o.label,rules:[{required:o.required,message:o.message}]},{default:n(()=>[o.name=="city_id"?(s(),v(O,{key:0,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,"show-search":"",options:y(c).cities,"filter-option":a,onChange:l},null,8,["value","onUpdate:value","options"])):u("",!0),o.name=="province_id"?(s(),v(O,{key:1,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,"show-search":"",options:y(c).provinces,"filter-option":a,onChange:T,disabled:!t.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),o.name=="district_id"?(s(),v(O,{key:2,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,"show-search":"",options:y(c).districts,"filter-option":a,disabled:!t.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),o.name=="economicsector_id"?(s(),v(O,{key:3,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,"show-search":"",options:y(c).economicSectors,"filter-option":a},null,8,["value","onUpdate:value","options"])):u("",!0),o.name=="comercialactivity_id"?(s(),v(O,{key:4,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,"show-search":"",options:y(c).comercialActivities,"filter-option":a},null,8,["value","onUpdate:value","options"])):u("",!0),o.name=="component_id"?(s(),v(O,{key:5,disabled:o.disabled,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,"show-search":"",options:y(c).components,"filter-option":a,onChange:B},null,8,["disabled","value","onUpdate:value","options"])):u("",!0),o.name=="theme_id"?(s(),v(O,{key:6,value:t[o.name],"onUpdate:value":r=>t[o.name]=r,"show-search":"",options:y(c).componentThemes,"filter-option":a,disabled:!t.component_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),i(x,null,{default:n(()=>[i($,{type:"primary",class:"btn-produce","html-type":"submit",loading:q.value},{default:n(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},ta=de(aa,[["__scopeId","data-v-7d34e3f3"]]);const oa={key:0},na={key:0},ia={key:0},la={__name:"AsesoriasHistorial",props:["totaladvisories","totalformalization10","totalformalization20"],setup(N){const k=N,F=f("1"),U=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Componente",dataIndex:"component",width:20},{title:"Tema",dataIndex:"theme",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:60},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],D=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Detalle del trámite",dataIndex:"detailprocedure",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:100},{title:"RUC",dataIndex:"ruc",width:50},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],c=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Régimen",dataIndex:"regime",width:80,align:"center"},{title:"Número solicitud constancia",dataIndex:"numbernotary",width:100},{title:"Nombre empresa",dataIndex:"mypename",width:160},{title:"RUC",dataIndex:"ruc",width:80},{title:"Modalidad",dataIndex:"modality",align:"center",width:70},{title:"Ciudad",dataIndex:"city",width:30},{title:"Provincia",dataIndex:"province",width:20},{title:"Distrito",dataIndex:"district",width:20},{title:"Dirección",dataIndex:"address",width:200}],R=q=>Ae(q).format("DD/MM/YYYY HH:mm A");return(q,m)=>{const t=h("a-table"),G=h("a-card"),B=h("a-tab-pane"),l=h("a-tabs");return s(),v(l,{activeKey:F.value,"onUpdate:activeKey":m[0]||(m[0]=T=>F.value=T),type:"card",class:"box-hist"},{default:n(()=>[i(B,{key:"1",tab:"ASESORÍAS"},{default:n(()=>[i(G,null,{default:n(()=>[i(t,{columns:U,"data-source":k.totaladvisories,bordered:"",pagination:!1,size:"small",scroll:{x:1200},"expand-column-width":100},{bodyCell:n(({index:T,column:a,record:M})=>[a.dataIndex==="idx"?(s(),V("span",oa,P(T+1),1)):u("",!0),a.dataIndex==="date_start"?(s(),V(Z,{key:1},[Y(P(R(M.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),i(B,{key:"2",tab:"RUC 10"},{default:n(()=>[i(G,null,{default:n(()=>[i(t,{columns:D,"data-source":k.totalformalization10,bordered:"",pagination:!1,size:"small",scroll:{x:1800},"expand-column-width":100},{bodyCell:n(({index:T,column:a,record:M})=>[a.dataIndex==="idx"?(s(),V("span",na,P(T+1),1)):u("",!0),a.dataIndex==="date_start"?(s(),V(Z,{key:1},[Y(P(R(M.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),i(B,{key:"3",tab:"RUC 20"},{default:n(()=>[i(G,null,{default:n(()=>[i(t,{columns:c,"data-source":k.totalformalization20,bordered:"",pagination:!1,size:"small",scroll:{x:2200},"expand-column-width":100},{bodyCell:n(({index:T,column:a,record:M})=>[a.dataIndex==="idx"?(s(),V("span",ia,P(T+1),1)):u("",!0),a.dataIndex==="date_start"?(s(),V(Z,{key:1},[Y(P(R(M.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1},8,["activeKey"])}}},sa=de(la,[["__scopeId","data-v-01e75dfe"]]);const J=N=>($e("data-v-a3690692"),N=N(),Fe(),N),da={class:"asesorias"},ra=J(()=>g("h3",{class:"title-produce"},"REGISTRO DE FORMALIZACIONES Y ASESORÍAS",-1)),ca=J(()=>g("br",null,null,-1)),ua={class:"wrapper-s"},ma=J(()=>g("label",{class:"label"},"Seleccione el tipo de documento",-1)),pa=J(()=>g("label",{class:"label"},"Digite el número de documento",-1)),_a=J(()=>g("h4",{class:"title-produce"},"RESULTADO DE LA BÚSQUEDA",-1)),va=J(()=>g("b",{class:"box-title"},"Apellidos y nombres:",-1)),fa=J(()=>g("b",{class:"box-title"},"Número de celular:",-1)),ha=J(()=>g("b",{class:"box-title"},"Correo electrónico:",-1)),ya=J(()=>g("b",{class:"box-title"},"Asesorías:",-1)),ga=J(()=>g("b",{class:"box-title"},"Formalizaciones RUC 20:",-1)),ba=J(()=>g("b",{class:"box-title"},"Formalizaciones RUC 10:",-1)),xa=J(()=>g("h4",{class:"title-produce"},"SELECCIONAR CDE",-1)),wa=J(()=>g("h4",{class:"title-produce"},"¿DESEA REGISTRAR UN NUEVO SERVICIO?",-1)),Ca={key:0,class:"card-as",style:{padding:"1rem"}},Sa=J(()=>g("h4",{class:"title-produce"},"HISTORIAL",-1)),Ua=J(()=>g("div",{class:"steps-content"},null,-1)),Ia={__name:"AsesoriasFormalizaciones",setup(N){const k=JSON.parse(localStorage.getItem("role")),F=()=>k.some(j=>j.id===7),U=me(),D=Ne(),c=Re(),R=f(0),q=f(null),m=f(null),t=f([{value:"asesoria",label:"ASESORÍA"},{value:"ruc20",label:"RUC 20"},{value:"ruc10",label:"RUC 10"}]);U.$patch({cdes:U.cdes}),U.fetchCdes();const G=f(null),B=f(!1),l=f(null);f(!1);const T=f(!1);f(!1);const a=f(!1),M=f(!1),K=f(!1),A=f(""),_=f([]),z=f(!1),O=f(0);f(!1);const x=f([]);f(null);const w=f([]),I=f([]),$=f([]),H=f(!1),X=j=>{m.value.cde_id=j,localStorage.setItem("profile",JSON.stringify(m.value))},o=(j,e)=>{const Q=j.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(Q)},b=()=>{ie(A.value),B.value=!1},r=()=>{d()},L=()=>{A.value=A.value.replace(/\D/g,"")},d=()=>{H.value=!1,A.value="",_.value=[],x.value=[],D.push({name:"asesorias-formalizaciones"})},ee=()=>{if(l.value=null,l.value=_.value,!q.value)return W.warning("Seleccionar un tipo de servicio");q.value=="asesoria"&&(K.value=!0),q.value=="ruc10"&&(M.value=!0),q.value=="ruc20"&&ae()},C=()=>{G.value=_.value,B.value=!0},ae=()=>{O.value=0,a.value=!0,T.value=!1},ne=async()=>{z.value=!0;const j=await te({url:`person/found/${R.value}/${A.value}`,method:"GET"});if(j.status==200)return _.value=j.data,re(_.value.id),z.value=!1},ie=async j=>{if(z.value=!0,!j)return W.warning("Ingresa un número de documento"),z.value=!1;if(R.value==0)return W.warning("Seleccionar el tipo de documento"),z.value=!1;if(R.value==1&&A.value.length<8){W.warning("El número de DNI está incompleto"),z.value=!1;return}const e=await te({url:`person/found/${R.value}/${A.value}`,method:"GET"});if(e.status==200)return _.value=e.data,re(e.data.id),m.value=JSON.parse(localStorage.getItem("profile")),z.value=!1;if(e.status===404){const Q={type:R.value,access:"asesorias",number:A.value};D.push({name:"registrar-persona",query:Q})}},re=async j=>{try{const{data:e}=await te({url:`historial/registers/${j}`,method:"GET"});w.value=e.advisories,I.value=e.formalization10,$.value=e.formalization20,H.value=!0}catch(e){console.error("Error de red:",e)}};return pe(()=>{c.query.type&&(R.value=c.query.type,A.value=c.query.number)}),(j,e)=>{const Q=h("a-radio"),p=h("a-tooltip"),le=h("a-radio-group"),_e=h("a-input-search"),se=h("a-card"),E=h("a-col"),oe=h("a-row"),ge=h("a-select"),Ce=h("a-button"),ce=h("a-drawer");return s(),V(Z,null,[g("div",da,[ra,ca,i(se,{class:"card-as card-gray"},{default:n(()=>[y(c).query.dni?(s(),v(y(Le),{key:0,class:"ico-reload",onClick:r})):u("",!0),g("div",ua,[g("div",null,[ma,i(le,{value:R.value,"onUpdate:value":e[0]||(e[0]=S=>R.value=S),onChange:d,class:"radio-produce"},{default:n(()=>[i(p,{color:"cyan"},{title:n(()=>[Y("Documento Nacional de Identidad")]),default:n(()=>[i(Q,{value:"1"},{default:n(()=>[Y("DNI")]),_:1})]),_:1}),i(p,{color:"cyan"},{title:n(()=>[Y("Carnet de Extranjería")]),default:n(()=>[i(Q,{value:"2"},{default:n(()=>[Y("CE")]),_:1})]),_:1}),i(p,{color:"cyan"},{title:n(()=>[Y("Pasaporte")]),default:n(()=>[i(Q,{value:"3"},{default:n(()=>[Y("PAS")]),_:1})]),_:1}),i(p,{color:"cyan"},{title:n(()=>[Y("Permiso Temporal de Permanencia")]),default:n(()=>[i(Q,{value:"4"},{default:n(()=>[Y("PTP")]),_:1})]),_:1})]),_:1},8,["value"])]),g("div",null,[pa,i(_e,{"enter-button":"BUSCAR",value:A.value,"onUpdate:value":e[1]||(e[1]=S=>A.value=S),placeholder:"",loading:z.value,onSearch:ie,onInput:L,class:"search-produce",maxlength:R.value==1?8:20},null,8,["value","loading","maxlength"])])])]),_:1}),i(oe,{gutter:[16,16]},{default:n(()=>[i(E,{xs:24,sm:24,lg:12},{default:n(()=>[_.value.length!=0?(s(),v(se,{key:0},{default:n(()=>[_a,i(y(Oe),{class:"box-icoedit",onClick:C}),i(oe,{gutter:[0,2],class:"box-info"},{default:n(()=>[i(E,{xs:12,sm:8},{default:n(()=>[va]),_:1}),i(E,{xs:12,sm:12},{default:n(()=>[g("span",null,P(_.value.lastname)+" "+P(_.value.middlename)+", "+P(_.value.name),1)]),_:1}),i(E,{xs:12,sm:8},{default:n(()=>[fa]),_:1}),i(E,{xs:12,sm:12},{default:n(()=>[g("span",null,P(_.value.phone?_.value.phone:"-"),1)]),_:1}),i(E,{xs:12,sm:8},{default:n(()=>[ha]),_:1}),i(E,{xs:12,sm:12},{default:n(()=>[g("span",null,P(_.value.email?_.value.email:"-"),1)]),_:1}),i(E,{xs:12,sm:8},{default:n(()=>[ya]),_:1}),i(E,{xs:12,sm:12},{default:n(()=>{var S;return[g("span",null,P((S=_.value)==null?void 0:S.idadvisory.length),1)]}),_:1}),i(E,{xs:12,sm:8},{default:n(()=>[ga]),_:1}),i(E,{xs:12,sm:12},{default:n(()=>{var S;return[g("span",null,P((S=_.value)==null?void 0:S.idformalization20.length),1)]}),_:1}),i(E,{xs:12,sm:8},{default:n(()=>[ba]),_:1}),i(E,{xs:12,sm:12},{default:n(()=>{var S;return[g("span",null,P((S=_.value)==null?void 0:S.idformalization10.length),1)]}),_:1})]),_:1})]),_:1})):u("",!0)]),_:1}),i(E,{xs:24,sm:24,lg:12},{default:n(()=>[_.value.length!=0?(s(),v(se,{key:0,style:{height:"100%"}},{default:n(()=>[i(oe,{gutter:[16,24]},{default:n(()=>[F()?u("",!0):(s(),v(E,{key:0,xs:24,sm:18,md:12,lg:12},{default:n(()=>[xa,i(ge,{class:"w-100",value:m.value.cde_id,"onUpdate:value":e[2]||(e[2]=S=>m.value.cde_id=S),options:y(U).cdes,"show-search":"","filter-option":o,onChange:X},null,8,["value","options"])]),_:1})),i(E,{xs:24,sm:18,md:12,lg:17},{default:n(()=>[wa,i(oe,{gutter:[10,0]},{default:n(()=>[i(E,{xs:17,sm:18},{default:n(()=>[i(ge,{class:"w-100",value:q.value,"onUpdate:value":e[3]||(e[3]=S=>q.value=S),options:t.value},null,8,["value","options"])]),_:1}),i(E,{xs:6},{default:n(()=>[i(Ce,{type:"primary",onClick:ee},{default:n(()=>[Y("REGISTRAR")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):u("",!0)]),_:1})]),_:1}),H.value?(s(),V("div",Ca,[Sa,i(sa,{totaladvisories:w.value,totalformalization10:I.value,totalformalization20:$.value},null,8,["totaladvisories","totalformalization10","totalformalization20"])])):u("",!0)]),g("section",null,[i(ce,{title:"Regitsrar una Formalización con RUC 20",open:a.value,"onUpdate:open":e[5]||(e[5]=S=>a.value=S),placement:"right",width:"880px"},{default:n(()=>[i(He,{info:l.value,idCde:m.value.cde_id,onCloseDraw:e[4]||(e[4]=S=>(a.value=!1,ne()))},null,8,["info","idCde"]),Ua]),_:1},8,["open"]),i(ce,{width:"600px",title:"Regitsrar Formalización con RUC 10",open:M.value,"onUpdate:open":e[7]||(e[7]=S=>M.value=S),placement:"right"},{default:n(()=>[i(Ze,{info:_.value,idCde:m.value.cde_id,onCloseDraw:e[6]||(e[6]=S=>(M.value=!1,ne()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(ce,{width:"600px",title:"Registrar una asesoría",open:K.value,"onUpdate:open":e[9]||(e[9]=S=>K.value=S),placement:"right"},{default:n(()=>[i(ta,{info:_.value,idCde:m.value.cde_id,onCloseDraw:e[8]||(e[8]=S=>(K.value=!1,ne()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(ce,{width:"600",open:B.value,"onUpdate:open":e[10]||(e[10]=S=>B.value=S),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:n(()=>[i(Ee,{onCloseDraw:b,updateValues:G.value},null,8,["updateValues"])]),_:1},8,["open"])])],64)}}},$a=de(Ia,[["__scopeId","data-v-a3690692"]]);export{$a as default};
