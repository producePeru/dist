import{_ as P}from"./TableComponent-b58a73f2.js";import{l as c,r as l,a as b,j as k,T as q,a5 as g,o as S,v as O,h as H,L as U,d as M,c as d,K as I,m as z,b as C,w as m,e as N,a0 as V,x as j}from"./index-62266265.js";import{d as G}from"./downloadExcel-5a422933.js";import{_ as J}from"./FormComponent-a20f2163.js";import{u as Q}from"./selectes-b886f1d3.js";import"./es-b43b0347.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-0087e1f1.js";import"./quill.snow-7427a127.js";/* empty css             */const X={key:1,class:"f-20"},K={__name:"RutaTalleresNuevo",props:["info"],emits:["closeDraw"],setup(A,{emit:_}){c.locale("es");const E=l({workshopName:{type:"iText",label:"NOMBRE DEL TALLER",name:"workshopName",required:!0,message:"Escribir el nombre del taller",disabled:!1,maxlength:250},date:{type:"iDate",label:"FECHA DEL TALLER",name:"date",required:!0,message:"Seleccionar una fecha",disabled:!1,disabledDate:o=>{const e=c().startOf("day");return o&&c(o).isBefore(e)}},hour:{type:"iText",label:"HORA DEL TALLER",name:"hour",required:!0,message:"Escribir hora",disabled:!1},link:{type:"iText",label:"ENLACE DE LA SALA",name:"link",required:!1,message:"Ingresa el link del taller",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL TALLER",name:"description",required:!1,message:"Escribir una descripción",disabled:!1},expositor:{type:"iText",label:"EXPOSITOR",name:"expositor",required:!1,message:"Ingresar un expositor",disabled:!1,maxlength:100}});JSON.parse(localStorage.getItem("profile"));const y=_,u=A,i=l(!1),p=l("CREAR"),n=b({}),s=l(!1);Q();const f=l(null),a=l({theme_id:[]}),w=o=>{console.log("handleInputEvent",o)},x=async o=>{},T=async o=>{},D=async o=>{},L=o=>{},Y=async()=>{s.value=!0;const o={workshopName:n.workshopName,date:c(n.date).format("YYYY-MM-DD"),hour:n.hour,link:n.link,description:n.description,expositor:n.expositor};try{const e=await I({url:"route-digital/store",method:"POST",data:o});e.status===200&&(z.success(e.message),R(),y("closeDraw",!0))}catch(e){console.error("Error:",e);const t=document.getElementsByClassName("ant-drawer-body")[0];t&&(t.scrollTop=0)}finally{s.value=!1}},R=()=>{n.workshopName=null,n.date=null,n.hour=null,n.link=null,n.description=null,n.expositor=null},v=async o=>{console.log("set info",o),i.value=!0;try{}catch(e){console.error("Error al cargar la información:",e)}finally{i.value=!1}};return k(()=>{u.info&&v(u.info)}),q(()=>u.info,o=>{o&&v(o)}),g("formState",n),g("loadingState",s),(o,e)=>i.value?(S(),O(H(U),{key:0,style:{color:"#00a6db"}})):(S(),M("div",X,[d(J,{fields:E.value,options:a.value,btnSaveName:p.value,onHandleInputEvent:w,resetSelect:f.value,onHandleChangeSelect:T,onHandleFocusSelect:D,onHandleBlurSelect:L,onHandleChangeClock:x,onOnSubmit:Y},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const W={class:"advisory-table"},Z=["onClick"],ce={__name:"RutaTalleres",setup(A){const _=JSON.parse(localStorage.getItem("role"))||[],E=l([]),y=l(0),u=l(150),i=l(!1),p=l(!1),n=l("Asesorías"),s=l(!1),f=l(null),a=b({year:c("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1});l([]);const w=l([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:80},{title:"TALLER",fixed:"left",dataIndex:"workshopName",width:200},{title:"FECHA",dataIndex:"date",width:120,align:"center"},{title:"HORA",dataIndex:"hour",width:120,align:"center"},{title:"EXPOSITOR",dataIndex:"expositor",width:140},{title:"DESCRIPCIÓN",dataIndex:"description",width:400},{title:"INVITACIÓN",dataIndex:"emp_country",align:"center",width:120},{title:"TEST DE ENTRADA",dataIndex:"emp_birth",align:"center",width:120},{title:"TEST SALIDA",dataIndex:"emp_age",align:"center",width:80}]),x=()=>{f.value=null,s.value=!0},T=async e=>{try{let t=null;n.value=="Asesorias"&&(t=`advisory/delete/${e.id}`),n.value=="Formalizaciones RUC 10"&&(t=`formalization/delete-ruc-10/${e.id}`),n.value=="Formalizaciones RUC 20"&&(t=`formalization/delete-ruc-20/${e.id}`);const r=await I({url:t,method:"DELETE"});o(),z.success(r.message)}catch(t){console.error("Error de red:",t)}},D=async()=>{p.value=!0;try{const e={};a.year&&(e.year=c(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);let t=null,r=null;a.type==1&&(t="download/asesories",r="Asesorías"),a.type==2&&(t="download/formalizations-ruc10",r="Formalizaciones 10"),a.type==3&&(t="download/formalizations-ruc20",r="Formalizaciones 20"),await G(t,r,e)}catch(e){console.error("Error de red:",e)}finally{p.value=!1}},L=async e=>{a.page=e,await o()},Y=async e=>{e&&(a.page=1,await o())},R=e=>{f.value=e,a.type==1&&(s.value=!0),a.type==2&&(open2.value=!0),a.type==3&&(open3.value=!0)},v=e=>_.some(t=>e.includes(t.id)),o=async()=>{i.value=!0;try{const e={page:a.page};a.year&&(e.year=c(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);const r=await I({url:"route-digital/list",method:"GET",params:e});E.value=r.data.data,y.value=r.data.total,u.value=r.data.per_page}catch(e){console.error("Error de red:",e)}finally{i.value=!1}};return k(async()=>{await o()}),g("search",a),g("loading",i),g("loadingFile",p),(e,t)=>{const r=C("a-menu-item"),B=C("a-popconfirm"),F=C("a-drawer");return S(),M("div",W,[d(P,{title:"TALLERES DE RUTA DIGITAL",new:!0,textNuevo:"NUEVO TALLER",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:w.value,titleSearch:"NOMBRE TALLER",pageSize:u.value,nameTotal:n.value,dataSource:E.value,total:y.value,onHandleNew:x,onHandleDownloadExcel:D,onHandleSearch:Y,onHandlePaginator:L},{"custom-options":m(({record:h})=>[d(r,null,{default:m(()=>[N("a",{onClick:$=>R(h)},"Editar",8,Z)]),_:2},1024),v([1,5])?(S(),O(r,{key:0},{default:m(()=>[d(B,{title:"¿Eliminar?",onConfirm:$=>T(h),class:"prod-alert",placement:"topRight"},{icon:m(()=>[d(H(V),{style:{color:"red"}})]),default:m(()=>[t[2]||(t[2]=N("a",null,"Eliminar",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)):j("",!0)]),_:1},8,["columns","pageSize","nameTotal","dataSource","total"]),d(F,{width:"500",title:"DETALLES DEL TALLER",open:s.value,"onUpdate:open":t[1]||(t[1]=h=>s.value=h),placement:"right"},{default:m(()=>[d(K,{info:f.value,onCloseDraw:t[0]||(t[0]=h=>(s.value=!1,o()))},null,8,["info"])]),_:1},8,["open"])])}}};export{ce as default};
