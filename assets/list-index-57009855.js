import{_ as W}from"./TableComponent-81f0c58d.js";import{p as E,r as s,a as V,k as L,U as G,X as C,o,d as m,c as p,w as u,z as S,m as q,h as j,u as z,b as I,i as J,F as H,e as A,j as N,t as R,y as U}from"./index-0c10d00d.js";import{_ as Q}from"./FormComponent-ab839f90.js";import{u as Z}from"./selectes-73b49fbf.js";import{U as K}from"./UpImage-e8a008d0.js";import"./es-f8cd8123.js";import{g as X}from"./usePermissions-7602307e.js";import{g as ee}from"./publicInscripcion-ebc9ecb9.js";import{C as te}from"./CloudUploadOutlined-ebb481bd.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-11c25ae6.js";import"./quill.snow-05aa88cd.js";import"./_plugin-vue_export-helper-c27b6911.js";const ae={class:"fairs"},ie={key:0},le={__name:"DrawCyberWow",props:["info"],emits:["closeDraw"],setup(P,{emit:w}){E.locale("es");const h=s({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},messageEndForm:{type:"iLabel",label:"MENSAJES DE INSCRIPCIONES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE AL FINALIZAR INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const D=w,n=P,y=s("GUARDAR"),e=V({}),g=s(!1),T=s(null),a=Z(),Y=s(null),r=s({city_id:[],fairtype_id:[],modality_id:[]}),O=()=>n.info?{name:n.info.image.name,url:n.info.image.url}:null,M=t=>{},x=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),h.value.dateTramite.disabled=!1)},k=async t=>{T.value=t.id},F=async t=>{t=="city_id"&&(await a.fetchCitiesNational(),e.city_id=null,r.value.city_id=a.citiesNational),t=="fairtype_id"&&(await a.fetchFairTypes(),r.value.fairtype_id=a.fairTypes),t=="modality_id"&&(await a.fetchModalities(),r.value.modality_id=a.modalities)},f=async()=>{g.value=!0;const t={title:e.title,subTitle:e.subTitle,description:e.description,fairtype_id:2,modality_id:1,startDate:E(e.dates.start).format("YYYY-MM-DD"),endDate:E(e.dates.end).format("YYYY-MM-DD"),metaMypes:e.metaMypes,city_id:e.city_id,fecha:null,place:null,hours:null,msgEndForm:e.msgEndForm,msgSendEmail:e.msgSendEmail,image_id:T.value};try{const v=n.info?`fair/update/${n.info.id}`:"events-ugse/cyber-wow-register-event",_=n.info?"PUT":"POST",b=await q({url:v,method:_,data:t});b.status===200&&(j.success(b.message),i(),D("closeDraw",!0))}catch(v){console.error("Error:",v);const _=document.getElementsByClassName("ant-drawer-body")[0];_&&(_.scrollTop=0)}finally{g.value=!1}},i=()=>{e.title=null,e.subTitle=null,e.description="</p>",e.fairtype_id=null,e.modality_id=null,e.dates=null,e.metaMypes=null,e.city_id=null,e.place=null,e.hours=null,e.msgEndForm="</p>",e.msgSendEmail="</p>"},l=async t=>{t&&(e.title=t.title,e.subTitle=t.subTitle,e.description=t.description,await a.fetchFairTypes(),r.value.fairtype_id=a.fairTypes,e.fairtype_id=t.fairtype_id,await a.fetchModalities(),r.value.modality_id=a.modalities,e.modality_id=t.modality_id,e.dates={start:E(t.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:E(t.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.metaMypes=t.metaMypes,await a.fetchCitiesNational(),r.value.city_id=a.citiesNational,e.city_id=t.city_id,e.fecha=t.fecha?E(t.fecha,"DD/MM/YYYY"):null,e.place=t.place,e.hours=t.hours,e.msgEndForm=t.msgEndForm||"</p>",e.msgSendEmail=t.msgSendEmail||"</p>")};return L(()=>{n.info&&l(n.info)}),G(()=>n.info,t=>{t?l(t):i()}),C("formState",e),C("loadingState",g),(t,v)=>(o(),m("div",ae,[p(Q,{fields:h.value,options:r.value,btnSaveName:y.value,onHandleInputEvent:M,resetSelect:Y.value,onHandleFocusSelect:F,onHandleChangeClock:x,onOnSubmit:f},{default:u(({field:_})=>[_.name=="iSlotOptions"?(o(),m("div",ie,[p(K,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:k,imageLoad:O()},null,8,["imageLoad"])])):S("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const se={class:"layout-content"},ne=["onClick"],oe={key:0,style:{"line-height":"1.5"}},re={key:1},de={key:0},ce=["onClick"],Ne={__name:"list-index",setup(P){const w=s({}),h=s([]),D=s(0),n=s(150),y=s(!1);z();const e=s(!1),g=s(null),T=s(!1),a=V({year:E("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:3}),Y=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:50},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:180},{title:"FECHAS INSCRIPCIONES",dataIndex:"date",width:70,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:100,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:100,align:"center"},{title:"FORMULARIO",dataIndex:"registerBtn",width:120,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],r=i=>{const l=`${ee()}/cyber-wow/${i}`;window.open(l,"_blank")},O=i=>{g.value=i,y.value=!0},M=()=>{f(),y.value=!1},x=()=>{g.value=null,y.value=!0},k=async i=>{a.page=i,await f()},F=async i=>{i&&(a.page=1,await f())},f=async()=>{try{e.value=!0;const i={page:a.page};a.year&&(i.year=E(a.year).format("YYYY"));const t=await q({url:"events-ugse/cyber-wow",method:"GET",params:i});h.value=t.data.data,D.value=t.data.total,n.value=t.data.per_page}catch(i){console.error("Error de red:",i)}finally{e.value=!1}};return L(async()=>{await f(),w.value=await X("wow-list")}),C("search",a),C("loading",e),C("loadingFile",T),(i,l)=>{var B;const t=I("a-tag"),v=I("a-button"),_=I("router-link"),b=I("a-menu-item"),$=I("a-drawer");return o(),m("div",se,[p(W,{title:"CYBER WOW",new:(B=w.value.value)==null?void 0:B.can_create,textNuevo:"NUEVO",placeholderSearch:"Buscar",searchYear:!0,columns:Y,titleSearch:"BUSCAR POR EVENTO",pageSize:n.value,nameTotal:"Eventos CYBER WOW",dataSource:h.value,total:D.value,btnUpdate:!0,onHandleNew:x,onHandleCallFetchData:f,onHandleSearch:F,onHandlePaginator:k},{"data-cell":u(({column:d,record:c})=>[d.dataIndex=="link"?(o(),m("a",{key:0,onClick:ue=>r(c.slug),href:"javascript:void(0)",target:"_blank"},[p(J(te),{style:{"font-size":"18px"}})],8,ne)):S("",!0),d.dataIndex=="date"?(o(),m(H,{key:1},[c.startDate!=c.endDate?(o(),m("span",oe,[l[1]||(l[1]=A("b",null,"Desde:",-1)),N(" "+R(c.dateStartFormat)+" ",1),l[2]||(l[2]=A("b",null,"Hasta:",-1)),N(" "+R(c.dateEndFormat),1)])):(o(),m("span",re,R(c.dateStartFormat),1))],64)):S("",!0),d.dataIndex=="registered"?(o(),U(t,{key:2,color:"processing"},{default:u(()=>[N(R(c.registered_wow),1)]),_:2},1024)):S("",!0),d.dataIndex=="registerBtn"?(o(),m(H,{key:3},[h.value[0].id==c.id?(o(),m("div",de,[p(v,null,{default:u(()=>l[3]||(l[3]=[N("REGISTRAR")])),_:1})])):S("",!0)],64)):S("",!0)]),"custom-options":u(({record:d})=>[p(b,null,{default:u(()=>[p(_,{to:`/admin/ugse/cyber-wow/inscritos/${d.slug}`,target:"_blank"},{default:u(()=>l[4]||(l[4]=[N(" Inscritos ")])),_:2},1032,["to"])]),_:2},1024),w.value.can_update?(o(),U(b,{key:0},{default:u(()=>[A("a",{onClick:c=>O(d)},"Editar",8,ce)]),_:2},1024)):S("",!0)]),_:1},8,["new","pageSize","dataSource","total"]),p($,{open:y.value,"onUpdate:open":l[0]||(l[0]=d=>y.value=d),title:g.value?"EDITAR EVENTO CYBER WOW":"REGISTRAR UN EVENTO CYBER WOW",placement:"right",width:"550"},{default:u(()=>[p(le,{onCloseDraw:M,info:g.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Ne as default};
