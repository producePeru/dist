import{r as u,a as G,l as w,b as r,o as i,d as c,c as n,w as l,e as g,F as S,s as Q,x as I,q as y,i as k,m as P,K as $,E as me,X as ce,j as pe,p as K,h as X,y as _e,t as T,J as fe}from"./index-77e60b6a.js";import{u as Z}from"./selectes-12c5adc1.js";import"./quill.snow-909a021c.js";import"./es-a99a0060.js";import{M as ve}from"./MoreOutlined-23d5929f.js";const ge={class:"grid-events"},ye={style:{display:"flex",margin:"1rem 0 .5rem"}},be={key:3,class:"grid-events-hour"},he={__name:"DrawEventosCalendario",props:["type"],emits:["closeDraw"],setup(B,{emit:q}){const p=Z();p.$patch({officesPnte:p.officesPnte}),p.fetchOfficesPnte();const b=u(!1),U=u([{dates:new Date}]),o=u({id_pnte:{type:"iSelect",label:"ÁREA DE",name:"id_pnte",required:!0,message:"",disabled:!1},title:{type:"iText",label:"TÍTULO",name:"title",required:!0,message:"",disabled:!1,max:150},date:{type:"iDate",label:"FECHA",name:"date",required:!1,message:"ssss",disabled:!1},description:{type:"iTextArea",label:"DESCRIPCIÓN",name:"description",required:!1,message:"Escribe descripción del evento",max:250},nameUser:{type:"iText",label:"RESPONSABLE",name:"nameUser",required:!1,message:"",disabled:!1,max:100},link:{type:"iText",label:"SI ES VIRTUAL PERGAR LINK",name:"link",required:!1,message:"",disabled:!1,max:100}}),a=G({allDay:1}),D=u([{start:null,end:w().subtract(0,"day").format("YYYY-MM-DD")}]),h=v=>v==="id_pnte"?p.officesPnte:[],C=v=>{const t={organiza:{type:"iText",label:"ORGANIZA",name:"organiza",required:!0,message:"",disabled:!1,max:150,placeholder:"Ejemplo: Municipalidad de ..."},numMypes:{type:"iText",label:"NÚMEROS DE MYPES QUE PARTICIPARÁN",name:"numMypes",required:!0,message:"",disabled:!1,max:10}};if(v==2){const m=Object.entries(o.value),_=m.findIndex(([z])=>z==="title"),M=[...m.slice(0,_+1),...Object.entries(t),...m.slice(_+1)];o.value=Object.fromEntries(M)}else{const m={...o.value};delete m.organiza,delete m.numMypes,o.value=m}},R=(v,t)=>{const m=v.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(m)},O=async()=>{if(!a.date)return P.error("Debes de seleccionar una fecha");const v={id_pnte:a.id_pnte,title:a.title,...a.organiza&&{organiza:a.organiza},...a.numMypes&&{numMypes:a.numMypes},date:w(a.date).format("YYYY-MM-DD"),start:w(a.hours[0]).format("HH:mm"),end:w(a.hours[1]).format("HH:mm"),description:a.description,nameUser:a.nameUser,link:a.link};b.value=!0;try{const t=await $({url:"event/create",method:"POST",data:v});t.status===200&&(P.success(t.message),a.title="")}catch(t){console.error("Failed to update record",t)}finally{b.value=!1}};return(v,t)=>{const m=r("a-select"),_=r("a-form-item"),M=r("a-input"),z=r("VDatePicker"),H=r("a-time-range-picker"),V=r("a-textarea"),L=r("a-button"),Y=r("a-form");return i(),c("div",null,[n(Y,{class:"form-events",layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:O},{default:l(()=>[g("div",ge,[(i(!0),c(S,null,Q(o.value,(e,F)=>(i(),c(S,{key:F},[e.type==="iSelect"?(i(),I(_,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:l(()=>[n(m,{value:a[e.name],"onUpdate:value":f=>a[e.name]=f,options:h(e.name),"show-search":"","filter-option":R,onChange:C},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name","label","rules"])):y("",!0),e.type==="iText"?(i(),I(_,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:l(()=>[n(M,{value:a[e.name],"onUpdate:value":f=>a[e.name]=f,maxlength:e.max,disabled:e.disabled,placeholder:e.placeholder},null,8,["value","onUpdate:value","maxlength","disabled","placeholder"])]),_:2},1032,["name","label","rules"])):y("",!0),e.type==="iDate"?(i(),I(_,{key:2,name:e.name,label:e.label},{default:l(()=>[n(z,{modelValue:a[e.name],"onUpdate:modelValue":f=>a[e.name]=f,mode:"date",attributes:U.value,"disabled-dates":D.value},null,8,["modelValue","onUpdate:modelValue","attributes","disabled-dates"]),g("div",ye,[g("div",null,[t[1]||(t[1]=g("label",{style:{display:"block"},for:""},"HORARIO",-1)),n(H,{"use12-hours":"",value:a.hours,"onUpdate:value":t[0]||(t[0]=f=>a.hours=f),format:"h:mm a"},null,8,["value"])])])]),_:2},1032,["name","label"])):y("",!0),e.type==="iSwitch"?(i(),c("div",be)):y("",!0),e.type==="iTextArea"?(i(),I(_,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:l(()=>[n(V,{value:a[e.name],"onUpdate:value":f=>a[e.name]=f,rows:6,maxlength:e.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):y("",!0)],64))),128))]),n(_,null,{default:l(()=>[n(L,{type:"primary","html-type":"submit",loading:b.value,style:{"margin-top":"1rem"}},{default:l(()=>t[2]||(t[2]=[k("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const xe={class:"grid-events"},we={__name:"DrawResultados",props:["type"],emits:["closeDraw"],setup(B,{emit:q}){const p=Z();p.$patch({officesPnte:p.officesPnte}),p.fetchOfficesPnte();const b=u(!1);u([{dates:new Date}]);const U=u({resultados:{type:"iTextArea",label:"RESULTADOS",name:"resultados",required:!1,message:"Escribe los resultados de los evento"}}),o=G({allDay:1});u([{start:null,end:w().subtract(0,"day").format("YYYY-MM-DD")}]);const a=async()=>{if(!o.date)return P.error("Debes de seleccionar una fecha");const D={id_pnte:o.id_pnte,title:o.title,...o.organiza&&{organiza:o.organiza},...o.numMypes&&{numMypes:o.numMypes},date:w(o.date).format("YYYY-MM-DD"),start:w(o.hours[0]).format("HH:mm"),end:w(o.hours[1]).format("HH:mm"),description:o.description,nameUser:o.nameUser,link:o.link};b.value=!0;try{const h=await $({url:"event/create",method:"POST",data:D});h.status===200&&(P.success(h.message),o.title="")}catch(h){console.error("Failed to update record",h)}finally{b.value=!1}};return(D,h)=>{const C=r("a-textarea"),R=r("a-form-item"),O=r("a-button"),v=r("a-form");return i(),c("div",null,[n(v,{class:"form-events",layout:"vertical",model:o,name:"basic",autocomplete:"off",onFinish:a},{default:l(()=>[g("div",xe,[(i(!0),c(S,null,Q(U.value,(t,m)=>(i(),c(S,{key:m},[t.type==="iTextArea"?(i(),I(R,{key:0,name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:l(()=>[n(C,{value:o[t.name],"onUpdate:value":_=>o[t.name]=_,rows:10,maxlength:t.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):y("",!0)],64))),128))]),n(R,null,{default:l(()=>[n(O,{type:"primary","html-type":"submit",loading:b.value,style:{"margin-top":"1rem"}},{default:l(()=>h[0]||(h[0]=[k("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const Ee={key:0},De={key:1},ke=["onClick"],Se={class:"paginator"},Te={__name:"EventosCalendario",setup(B){w.locale("es");const q=JSON.parse(localStorage.getItem("role"))||[],p=u(!1),b=u(!1),U=u(null),o=u(0),a=u(50),D=u({page:0}),h=u(1200),C=u([]),R=u(!1),O=u(window.innerHeight-100),v=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"ÁREA",fixed:"left",dataIndex:"office",width:100},{title:"TÍTULO",dataIndex:"title",width:200},{title:"FECHA",dataIndex:"date",width:120,align:"center"},{title:"HORARIO",dataIndex:"hours",width:120,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description",width:240},{title:"RESPONSABLE",dataIndex:"nameUser",width:240},{title:"",dataIndex:"actions",width:40,align:"center",fixed:"right"}],t=G({search:""}),m=d=>q.some(s=>d.includes(s.id)),_=()=>{N(),p.value=!1},M=d=>{U.value=d,b.value=!0},z=()=>{p.value=!0},H=()=>{let d={search:t.search};N(d)},V=()=>{t.search||N()},L=d=>w(d).format("DD/MM/YYYY"),Y=d=>w(d,"HH:mm:ss").format("HH:mm"),e=d=>({ferias:"FERIAS",rd:"RUTA DIGITAL",ugse:"UGSE",uger:"UGGER",ugo:"UGO"})[d],F=d=>{D.value.page=d,N()},f=()=>{O.value=window.innerHeight-330},W=me(()=>d=>D.value.page*a.value+d+1),N=async d=>{try{R.value=!0;let s;s=D.value.page==0?"":D.value,s=d?{...s,...d}:s;const{data:E}=await $({url:"event/list",method:"GET",params:s});C.value=E==null?void 0:E.data,o.value=E.total,a.value=E.per_page}catch(s){console.error("Error de red:",s)}finally{R.value=!1}};return ce(()=>{window.removeEventListener("resize",f)}),pe(()=>{window.addEventListener("resize",f),f(),N()}),(d,s)=>{const E=r("a-button"),ee=r("router-link"),j=r("a-col"),ae=r("a-input"),te=r("a-input-group"),ne=r("a-row"),se=r("a-menu-item"),oe=r("a-menu"),le=r("a-dropdown"),re=r("a-table"),ie=r("a-tag"),de=r("a-pagination"),J=r("a-drawer");return i(),c(S,null,[g("div",null,[s[7]||(s[7]=g("h3",{class:"title-produce"},"EVENTOS PNTE 2025",-1)),n(ne,{style:{margin:"1rem 0"}},{default:l(()=>[n(j,{xs:24,md:12,lg:18},{default:l(()=>[n(E,{type:"primary",onClick:z,class:"box-btn-add"},{default:l(()=>s[4]||(s[4]=[k(" NUEVO EVENTO ")])),_:1}),n(ee,{to:"/calendario/eventos",target:"_blank",style:{"margin-left":"1rem"}},{default:l(()=>[n(E,{type:"dashed",icon:K(X(_e))},{default:l(()=>s[5]||(s[5]=[k("Ver Calendario")])),_:1},8,["icon"])]),_:1})]),_:1}),n(j,{xs:24,md:12,lg:6},{default:l(()=>[n(te,{compact:""},{default:l(()=>[n(ae,{value:t.search,"onUpdate:value":s[0]||(s[0]=x=>t.search=x),style:{width:"calc(100% - 80px)"},onInput:V},null,8,["value"]),n(E,{type:"primary",disabled:t.search==="",onClick:H},{default:l(()=>s[6]||(s[6]=[k("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(re,{bordered:"",scroll:{x:h.value,y:O.value},class:"table-events-google",columns:v,"data-source":C.value,pagination:!1,loading:R.value,size:"small"},{bodyCell:l(({column:x,record:A,index:ue})=>[x.dataIndex=="idx"?(i(),c(S,{key:0},[k(T(W.value(ue)),1)],64)):y("",!0),x.dataIndex=="date"?(i(),c(S,{key:1},[k(T(L(A.date)),1)],64)):y("",!0),x.dataIndex=="office"?(i(),c(S,{key:2},[k(T(e(A.office)),1)],64)):y("",!0),x.dataIndex=="hours"?(i(),c(S,{key:3},[A.allDay==1?(i(),c("span",Ee,"Todo el día")):(i(),c("span",De,T(Y(A.start))+" - "+T(Y(A.end)),1))],64)):y("",!0),x.dataIndex=="actions"?(i(),I(le,{key:4,trigger:["click"]},{overlay:l(()=>[n(oe,null,{default:l(()=>[m([5,10,11])?(i(),I(se,{key:0},{default:l(()=>[g("a",{onClick:Re=>M(A)},"Resultados",8,ke)]),_:2},1024)):y("",!0)]),_:2},1024)]),default:l(()=>[g("a",{class:"ant-dropdown-link",onClick:s[1]||(s[1]=fe(()=>{},["prevent"]))},[n(E,{shape:"circle",icon:K(X(ve)),size:"small"},null,8,["icon"])])]),_:2},1024)):y("",!0)]),_:1},8,["scroll","data-source","loading"])]),g("div",Se,[g("span",null,[n(ie,{color:"blue"},{default:l(()=>[g("b",null,T(o.value),1)]),_:1}),s[8]||(s[8]=k("Eventos creados"))]),n(de,{size:"small",total:o.value,pageSize:a.value,onChange:F,showSizeChanger:!1},null,8,["total","pageSize"])]),n(J,{open:p.value,"onUpdate:open":s[2]||(s[2]=x=>p.value=x),title:U.value?"Editar Evento":"NUEVO EVENTO",placement:"right",width:"450"},{default:l(()=>[n(he,{onCloseDraw:_,dataRow:U.value,type:"events"},null,8,["dataRow"])]),_:1},8,["open","title"]),n(J,{open:b.value,"onUpdate:open":s[3]||(s[3]=x=>b.value=x),title:"RESULTADOS",placement:"right",width:"450"},{default:l(()=>[n(we)]),_:1},8,["open"])],64)}}};export{Te as default};
