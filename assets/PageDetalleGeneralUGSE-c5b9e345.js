import{c as t,A as ae,N as Y,g as le,r as w,z as oe,S as re,k as ie,b,o as r,d as c,w as l,a6 as se,B as de,i,e as o,t as e,h,F as C,y as N,a8 as F,s as L,v as D,J as G}from"./index-2b74dd24.js";import"./es-950b2508.js";import{E as ue}from"./EnvironmentOutlined-13fd5b7d.js";import{T as ce}from"./TeamOutlined-ce9c7721.js";var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};const pe=_e;function X(y){for(var m=1;m<arguments.length;m++){var v=arguments[m]!=null?Object(arguments[m]):{},$=Object.keys(v);typeof Object.getOwnPropertySymbols=="function"&&($=$.concat(Object.getOwnPropertySymbols(v).filter(function(g){return Object.getOwnPropertyDescriptor(v,g).enumerable}))),$.forEach(function(g){me(y,g,v[g])})}return y}function me(y,m,v){return m in y?Object.defineProperty(y,m,{value:v,enumerable:!0,configurable:!0,writable:!0}):y[m]=v,y}var I=function(m,v){var $=X({},m,v.attrs);return t(ae,X({},$,{icon:pe}),null)};I.displayName="VerticalAlignBottomOutlined";I.inheritAttrs=!1;const fe=I;const ve=o("h4",null,"Resumen General del convenio",-1),he={class:"info-h1"},be=o("br",null,null,-1),ye={style:{"text-transform":"uppercase"}},ge={style:{display:"flex","flex-wrap":"wrap"}},ke=["onClick"],we=o("br",null,null,-1),De={key:0},$e=o("br",null,null,-1),Ae=o("h4",null,"Compromisos",-1),Ce={style:{width:"100%"}},Oe={style:{"margin-bottom":"6px"}},xe={style:{"text-transform":"capitalize"}},Be={key:0},Re={key:1},Pe={key:2,class:"acciones"},Ee=o("h4",null,"Acciones",-1),Ye={style:{width:"20px"}},Fe={style:{width:"100%"}},Le={key:0},Me={key:1},Ue={class:"conv-files"},Ve=["onClick"],je=["onClick"],Se=["onClick"],Te="DD/MM/YYYY",He={__name:"PageDetalleGeneralUGSE",setup(y){Y.locale("es");const m=le.get("token"),v="https://apituempresa.soporte-pnte.com/api/",$="http://127.0.0.1:8000/api/",g=window.location.hostname=="localhost"||window.location.hostname=="127.0.0.1"?$:v,O=w(null),H=w(),M=w(null),U=w(!1),V=w(!1),q=oe();w([]);const R=re(se,{style:{fontSize:"18px"},spin:!0});w(null);const x=w(null),d=w([]),j=s=>{if(s)return Y(s).format("DD-MM-YYYY")},S=async(s,u)=>{x.value=u;try{const _=await G.get(`${g}agreement/commitment-download/${s}`,{responseType:"blob",headers:{Accept:"application/json",Authorization:`Bearer ${m}`}}),f=window.URL.createObjectURL(new Blob([_.data])),k=document.createElement("a");k.href=f,k.setAttribute("download",u),document.body.appendChild(k),k.click(),document.body.removeChild(k)}catch(_){console.error("Error al descargar el archivo",_)}finally{x.value=null}},Z=async s=>{M.value=s.id;try{const u=await G({url:`${g}agreement/file-download/${s.id}`,method:"POST",responseType:"blob",headers:{Authorization:`Bearer ${m}`}}),_=window.URL.createObjectURL(new Blob([u.data])),f=document.createElement("a");f.href=_,f.setAttribute("download",s.name),document.body.appendChild(f),f.click(),window.URL.revokeObjectURL(_),document.body.removeChild(f)}catch(u){console.error("Error downloading file:",u)}finally{M.value=null}},K=async(s,u)=>{try{V.value=!0;const _=q.params.id,f=O.value?`${g}pdf/agreements-general/${_}?start=${O.value.start}&end=${O.value.end}`:`${g}pdf/agreements-general/${_}`,k=await G.get(f,{responseType:"blob",headers:{Accept:"application/json",Authorization:`Bearer ${m}`}}),z=window.URL.createObjectURL(new Blob([k.data])),A=document.createElement("a");A.href=z,A.setAttribute("download",`${s}.pdf`),document.body.appendChild(A),A.click()}catch(_){console.error("Error descargando el PDF:",_)}finally{V.value=!1}},ee=async s=>{if(!Array.isArray(s)||s===null){console.warn("Invalid date array provided."),await T(),O.value=null;return}if(s.length===2){const u={start:Y(s[0]).format("YYYY/MM/DD"),end:Y(s[1]).format("YYYY/MM/DD")};await T(u),O.value=u}},T=async s=>{try{U.value=!0;const u=q.params.id,_=s?`/agreement/general/${u}?start=${s.start}&end=${s.end}`:`/agreement/general/${u}`,f=await de({url:_,method:"GET"});d.value=f}catch(u){console.error("Error de red:",u)}finally{U.value=!1}};return ie(()=>{T()}),(s,u)=>{const _=b("router-link"),f=b("a-breadcrumb-item"),k=b("a-breadcrumb"),z=b("a-range-picker"),A=b("a-button"),te=b("a-tooltip"),P=b("a-flex"),p=b("a-descriptions-item"),B=b("a-spin"),ne=b("a-descriptions");return r(),c("section",null,[t(k,null,{default:l(()=>[t(f,null,{default:l(()=>[t(_,{to:"/admin/convenios/ugse"},{default:l(()=>[i("Lista de convenios")]),_:1})]),_:1}),t(f,null,{default:l(()=>[ve]),_:1})]),_:1}),t(B,{spinning:U.value},{default:l(()=>{var J;return[t(P,{justify:"space-between"},{default:l(()=>[o("h1",he,e(d.value.alliedEntity),1),t(P,{align:"center",gap:10},{default:l(()=>[o("div",null,[t(z,{value:H.value,"onUpdate:value":u[0]||(u[0]=n=>H.value=n),onChange:ee,format:Te},null,8,["value"])]),t(te,{placement:"topLeft",title:"Descargar reporte en PDF"},{default:l(()=>[t(A,{class:"btn-pdf",onClick:u[1]||(u[1]=n=>K(d.value.alliedEntity)),loading:V.value,type:"primary"},{default:l(()=>[o("b",null,[t(h(fe)),i(" PDF ")])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),be,t(ne,{bordered:"",size:"small"},{default:l(()=>[t(p,{label:"Región"},{default:l(()=>{var n;return[i(e((n=d.value.region)==null?void 0:n.name),1)]}),_:1}),t(p,{label:"Provincia"},{default:l(()=>{var n;return[i(e((n=d.value.provincia)==null?void 0:n.name),1)]}),_:1}),t(p,{label:"Distrito"},{default:l(()=>{var n;return[i(e((n=d.value.distrito)==null?void 0:n.name),1)]}),_:1}),t(p,{label:"RUC"},{default:l(()=>[i(e(d.value.ruc),1)]),_:1}),t(p,{label:"Componente",span:2},{default:l(()=>[o("span",ye,e(d.value.components),1)]),_:1}),t(p,{label:"Inicio convenio"},{default:l(()=>[i(e(j(d.value.startDate)),1)]),_:1}),t(p,{label:"Fin convenio"},{default:l(()=>[i(e(j(d.value.endDate)),1)]),_:1}),t(p,{label:"Renovación Automática",style:{width:"200px"}},{default:l(()=>[i(e(d.value.renovation),1)]),_:1}),t(p,{label:"Punto Focal"},{default:l(()=>[i(e(d.value.focal),1)]),_:1}),t(p,{label:"Focal cargo"},{default:l(()=>[i(e(d.value.focalCargo),1)]),_:1}),t(p,{label:"Focal Num. celular"},{default:l(()=>[i(e(d.value.focalPhone),1)]),_:1}),t(p,{label:"Representante Legal"},{default:l(()=>[i(e(d.value.aliado),1)]),_:1}),t(p,{label:"Num. celular",span:2},{default:l(()=>[i(e(d.value.aliadoPhone),1)]),_:1}),t(p,{label:"Comentarios",span:3},{default:l(()=>[o("p",null,e(d.value.observations),1)]),_:1}),t(p,{label:"Archivos",span:3},{default:l(()=>[o("div",ge,[(r(!0),c(C,null,N(d.value.files_agreements,(n,E)=>(r(),c("div",{class:"conv-files",key:E},[M.value!=n.id?(r(),c("a",{key:0,onClick:a=>Z(n)},[t(h(F)),i(" "+e(n.name),1)],8,ke)):(r(),L(B,{key:1,indicator:h(R),style:{"min-width":"100px"}},null,8,["indicator"]))]))),128))])]),_:1})]),_:1}),we,((J=d.value.compromisos)==null?void 0:J.length)>=1?(r(),c("div",De,[$e,Ae,(r(!0),c(C,null,N(d.value.compromisos,(n,E)=>(r(),c("div",{class:"acciones-box",key:E,style:{margin:"1rem 0"}},[t(P,{gap:10},{default:l(()=>[o("b",null,e(E+1),1),o("div",Ce,[o("div",Oe,[i("Título: "),o("b",null,e(n.title),1)]),o("div",null,[i("Tipo: "),o("span",xe,e(n.type),1)]),n.meta?(r(),c("div",Be,"Meta: "+e(n.meta),1)):D("",!0),n.description?(r(),c("div",Re,"Descripción: "+e(n.description),1)):D("",!0),o("div",null,"Registrado por: "+e(n.profile.name)+" "+e(n.profile.lastname)+" "+e(n.profile.middlename),1),n.acciones.length>=1?(r(),c("div",Pe,[Ee,(r(!0),c(C,null,N(n.acciones,(a,Q)=>(r(),c("div",{class:"acciones-box acciones-bg",key:Q},[t(P,null,{default:l(()=>[o("div",Ye,e(Q+1),1),o("div",Fe,[o("div",null,"Conferencia: "+e(a.accion),1),o("div",null,"Fecha: "+e(j(a.date)),1),o("div",null,"Modalidad: "+e(a.modality=="v"?"Virtual":"Presencial"),1),a.address?(r(),c("div",Le,[t(h(ue)),i(" "+e(a.address),1)])):D("",!0),o("div",null,[t(h(ce)),i(" "+e(a.participants)+" participantes ",1)]),a.details?(r(),c("div",Me,"Detalle: "+e(a.details),1)):D("",!0),o("div",null,"Registrado por: "+e(a.profile.name)+" "+e(a.profile.lastname)+" "+e(a.profile.middlename),1),o("div",Ue,[a.file1_name?(r(),c(C,{key:0},[x.value==a.file1_name?(r(),L(B,{key:0,indicator:h(R)},null,8,["indicator"])):(r(),c("a",{key:1,onClick:W=>S(a.file1_path,a.file1_name)},[t(h(F)),i(" "+e(a.file1_name),1)],8,Ve))],64)):D("",!0),a.file2_name?(r(),c(C,{key:1},[x.value==a.file2_name?(r(),L(B,{key:0,indicator:h(R)},null,8,["indicator"])):(r(),c("a",{key:1,onClick:W=>S(a.file2_path,a.file2_name)},[t(h(F)),i(" "+e(a.file2_name),1)],8,je))],64)):D("",!0),a.file3_name?(r(),c(C,{key:2},[x.value==a.file3_name?(r(),L(B,{key:0,indicator:h(R)},null,8,["indicator"])):(r(),c("a",{key:1,onClick:W=>S(a.file3_path,a.file3_name)},[t(h(F)),i(" "+e(a.file3_name),1)],8,Se))],64)):D("",!0)])])]),_:2},1024)]))),128))])):D("",!0)])]),_:2},1024)]))),128))])):D("",!0)]}),_:1},8,["spinning"])])}}};export{He as default};
