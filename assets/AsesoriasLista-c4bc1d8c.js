import{_ as ae}from"./icoexcel-a1d0882d.js";import{J as T,g as ie,r as c,x as ne,H as oe,k as de,b as y,o as i,d as o,e as u,n as C,c as A,w as R,F as d,G as le,m as se,z as re,i as n,t as a,s as l,q as ce,p as me,j as pe}from"./index-fc29f185.js";import"./es-588feca2.js";import{_ as ue}from"./_plugin-vue_export-helper-c27b6911.js";const _e=g=>(me("data-v-2948f833"),g=g(),pe(),g),xe={class:"header-rep"},he={class:"filters-dig"},ve=_e(()=>u("img",{width:"20",style:{"margin-right":"6px"},src:ae},null,-1)),Ie={class:"paginator"},Y=20,ge={__name:"AsesoriasLista",setup(g){T.locale("es");const w=JSON.parse(localStorage.getItem("profile")),J=ie.get("token"),V="https://apituempresa.soporte-pnte.com/api/",j="http://127.0.0.1:8000/api/",G=window.location.hostname=="localhost"||window.location.hostname=="127.0.0.1"?j:V,z=c([]),f=c(!1),k=c(!1),E=c(0),p=c({page:0}),m=c("asesorias");c("");const H=c(1200),N=c(window.innerHeight-100),b=()=>{N.value=window.innerHeight-315};ne(()=>{window.removeEventListener("resize",b)});const v=c([]),D=c([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:200,filters:[{text:"Joe",value:1},{text:"Jim",value:2}]},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante Email",dataIndex:"sol_email",width:200},{title:"Solicitante Celular",dataIndex:"sol_phone",width:160},{title:"Supervisor",dataIndex:"misupervisor",width:200},{title:"Región",dataIndex:"mype_region",width:140},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Componente",dataIndex:"componente",width:180},{title:"Tema",dataIndex:"tema_componente",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),q=c([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante Celular",dataIndex:"sol_phone",width:160},{title:"Solicitante Email",dataIndex:"sol_email",width:200},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Detalle del trámite",dataIndex:"detalle_tramite",width:180},{title:"Sector económico",dataIndex:"sector_economico",width:180},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),Z=c([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Código SUNARP",dataIndex:"codesunarp",width:140,align:"center"},{title:"Solicitante Celular",dataIndex:"sol_phone",width:160},{title:"Sector económico",dataIndex:"sector_economico",width:130},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:160},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Dirección",dataIndex:"mype_direccion",width:230},{title:"Nombre empresa",dataIndex:"mype_nombre",width:180},{title:"Régimen",dataIndex:"tipo_regimen",width:80,align:"center"},{title:"Número de notaría",dataIndex:"numero_envio_notaria",width:140},{title:"Notaría",dataIndex:"notaria",width:150},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"RUC",dataIndex:"ruc",width:100,align:"center"}]),X=r=>{p.value.page=r,I()},K=r=>T(r).format("DD-MM-YYYY"),Q=(r,s,_)=>{},W=async()=>{k.value=!0;let r="",s="";m.value=="asesorias"&&(r="download/asesories",s="asesorias.xlsx"),m.value=="ruc10"&&(r="download/formalizations-ruc10",s="formalizacionesRUC10.xlsx"),m.value=="ruc20"&&(r="download/formalizations-ruc20",s="formalizacionesRUC20.xlsx");try{const{data:_}=await le.get(`${G}${r}`,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${J}`},responseType:"blob"}),h=new Blob([_]),S=window.URL.createObjectURL(h),x=document.createElement("a");x.href=S,x.download=s,document.body.appendChild(x),x.click(),document.body.removeChild(x)}catch{se.error("Error")}finally{k.value=!1}},I=async r=>{try{f.value=!0;let s="historial/advisories";v.value=D.value,r=="asesorias"&&(p.value.page=0,m.value=r,v.value=D.value,s="historial/advisories"),r=="ruc10"&&(p.value.page=0,m.value=r,v.value=q.value,s=`historial/formalizations-10/${w.user_id}/${w.documentnumber}`),r=="ruc20"&&(p.value.page=0,m.value=r,v.value=Z.value,s=`historial/formalizations-20/${w.user_id}/${w.documentnumber}`);let _=p.value.page==0?"":p.value;const h=await re({url:s,method:"GET",params:_});z.value=h.data,E.value=h.total}catch(s){console.error("Error de red:",s)}finally{f.value=!1}},ee=oe(()=>r=>((p.value.page==0?1:p.value.page)-1)*Y+r+1);return de(()=>{I(),window.addEventListener("resize",b),b()}),(r,s)=>{const _=y("a-button"),h=y("a-tag"),S=y("a-table"),x=y("a-pagination");return i(),o(d,null,[u("div",null,[u("div",xe,[u("h3",{class:C({hdactive:m.value=="asesorias"}),onClick:s[0]||(s[0]=t=>I("asesorias"))},"ASESORÍAS",2),u("h3",{class:C({hdactive:m.value=="ruc10"}),onClick:s[1]||(s[1]=t=>I("ruc10"))},"FORMALIZACIONES RUC 10",2),u("h3",{class:C({hdactive:m.value=="ruc20"}),onClick:s[2]||(s[2]=t=>I("ruc20"))},"FORMALIZACIONES RUC 20",2)]),u("div",he,[A(_,{onClick:W,loading:k.value},{default:R(()=>[ve,n(" DESCARGAR ")]),_:1},8,["loading"])]),A(S,{onChange:Q,bordered:"",scroll:{x:H.value,y:N.value},class:"ant-table-striped",columns:v.value,"data-source":z.value,pagination:!1,loading:f.value,size:"small"},{bodyCell:R(({column:t,record:e,index:te})=>{var L,U,$,M,B,F,O,P;return[t.dataIndex=="idx"?(i(),o(d,{key:0},[n(a(ee.value(te)),1)],64)):l("",!0),t.dataIndex=="ase_fecha"?(i(),o(d,{key:1},[n(a(K(e.created_at)),1)],64)):l("",!0),t.dataIndex=="sol_apellidos"?(i(),o(d,{key:2},[n(a(e.people.lastname)+" "+a(e.people.middlename),1)],64)):l("",!0),t.dataIndex=="sol_nombres"?(i(),o(d,{key:3},[n(a(e.people.name),1)],64)):l("",!0),t.dataIndex=="sol_email"?(i(),o(d,{key:4},[n(a(e.people.email),1)],64)):l("",!0),t.dataIndex=="sol_phone"?(i(),o(d,{key:5},[n(a(e.people.phone),1)],64)):l("",!0),t.dataIndex=="misupervisor"?(i(),o(d,{key:6},[n(a(e.supervisor.supervisor_user.profile.name)+" "+a(e.supervisor.supervisor_user.profile.lastname)+" "+a(e.supervisor.supervisor_user.profile.middlename),1)],64)):l("",!0),t.dataIndex=="mype_region"?(i(),o(d,{key:7},[n(a(e.city.name),1)],64)):l("",!0),t.dataIndex=="mype_provincia"?(i(),o(d,{key:8},[n(a(e.province.name),1)],64)):l("",!0),t.dataIndex=="mype_distrito"?(i(),o(d,{key:9},[n(a(e.district.name),1)],64)):l("",!0),t.dataIndex=="componente"?(i(),o(d,{key:10},[n(a((L=e.component)==null?void 0:L.name),1)],64)):l("",!0),t.dataIndex=="tema_componente"?(i(),o(d,{key:11},[n(a((U=e.theme)==null?void 0:U.name),1)],64)):l("",!0),t.dataIndex=="detalle_tramite"?(i(),o(d,{key:12},[n(a(($=e.detailprocedure)==null?void 0:$.name),1)],64)):l("",!0),t.dataIndex=="sector_economico"?(i(),o(d,{key:13},[n(a((M=e.economicsector)==null?void 0:M.name),1)],64)):l("",!0),t.dataIndex=="atividad_comercial"?(i(),o(d,{key:14},[n(a((B=e==null?void 0:e.comercialactivity)==null?void 0:B.name),1)],64)):l("",!0),t.dataIndex=="mype_direccion"?(i(),o(d,{key:15},[n(a(e==null?void 0:e.address),1)],64)):l("",!0),t.dataIndex=="mype_nombre"?(i(),o(d,{key:16},[n(a((F=e.mype)==null?void 0:F.name),1)],64)):l("",!0),t.dataIndex=="tipo_regimen"?(i(),o(d,{key:17},[n(a((O=e.regime)==null?void 0:O.name),1)],64)):l("",!0),t.dataIndex=="numero_envio_notaria"?(i(),o(d,{key:18},[n(a(e.numbernotary),1)],64)):l("",!0),t.dataIndex=="notaria"?(i(),o(d,{key:19},[n(a((P=e.notary)==null?void 0:P.name),1)],64)):l("",!0),t.dataIndex=="codesunarp"?(i(),o(d,{key:20},[n(a(e.codesunarp),1)],64)):l("",!0),t.dataIndex==="modality"?(i(),ce(h,{key:21,color:e.modality.name=="Presencial"?"green":"orange"},{default:R(()=>[n(a(e.modality.name),1)]),_:2},1032,["color"])):l("",!0)]}),_:1},8,["scroll","columns","data-source","loading"])]),u("div",Ie,[A(x,{size:"small",total:E.value,pageSize:Y,onChange:X,showSizeChanger:!1,defaultCurrent:2},null,8,["total"])])],64)}}},be=ue(ge,[["__scopeId","data-v-2948f833"]]);export{be as default};
