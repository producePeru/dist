import{_ as R}from"./FormComponent-4bf37019.js";import{u as F}from"./selectes-d146f2e5.js";import{U as A}from"./UpImage-40bf8922.js";import{p as r,r as n,a as q,k as L,U as w,X as f,o as y,d as S,c as g,w as P,z as H,m as V,h as U}from"./index-3f88e443.js";import"./es-16fe77c6.js";const k={class:"fairs"},x={key:0},Z={__name:"DrawSed",props:["info"],emits:["closeDraw"],setup(_,{emit:b}){r.locale("es");const m=n({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},place:{type:"iText",label:"LUGAR DEL EVENTO",name:"place",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: PRODUCE 2"},fecha:{type:"iDate",label:"FECHA DEL EVENTO",name:"fecha",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: Lunes: 12 de mayo"},hours:{type:"iText",label:"HORARIO DEL EVENTO",name:"hours",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm"},messageEndForm:{type:"iLabel",label:"MENSAJES DE INSCRIPCIONES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE AL FINALIZAR INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const h=b,i=_,N=n("GUARDAR"),e=q({}),o=n(!1),c=n(null),t=F(),D=n(null),s=n({city_id:[],fairtype_id:[],modality_id:[]}),v=()=>i.info?{name:i.info.image.name,url:i.info.image.url}:null,T=a=>{},I=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),m.value.dateTramite.disabled=!1)},M=async a=>{c.value=a.id},C=async a=>{a=="city_id"&&(await t.fetchCitiesNational(),e.city_id=null,s.value.city_id=t.citiesNational),a=="fairtype_id"&&(await t.fetchFairTypes(),s.value.fairtype_id=t.fairTypes),a=="modality_id"&&(await t.fetchModalities(),s.value.modality_id=t.modalities)},Y=a=>{},O=async()=>{o.value=!0;const a={title:e.title,subTitle:e.subTitle,description:e.description,fairtype_id:1,modality_id:1,startDate:r(e.dates.start).format("YYYY-MM-DD"),endDate:r(e.dates.end).format("YYYY-MM-DD"),metaMypes:e.metaMypes,city_id:e.city_id,fecha:e.fecha,place:e.place,hours:e.hours,msgEndForm:e.msgEndForm,msgSendEmail:e.msgSendEmail,image_id:c.value};try{const d=i.info?`fair/update/${i.info.id}`:"fair/create",l=i.info?"PUT":"POST",E=await V({url:d,method:l,data:a});E.status===200&&(U.success(E.message),u(),h("closeDraw",!0))}catch(d){console.error("Error:",d);const l=document.getElementsByClassName("ant-drawer-body")[0];l&&(l.scrollTop=0)}finally{o.value=!1}},u=()=>{e.title=null,e.subTitle=null,e.description="</p>",e.fairtype_id=null,e.modality_id=null,e.dates=null,e.metaMypes=null,e.city_id=null,e.place=null,e.hours=null,e.msgEndForm="</p>",e.msgSendEmail="</p>"},p=async a=>{a&&(e.title=a.title,e.subTitle=a.subTitle,e.description=a.description,await t.fetchFairTypes(),s.value.fairtype_id=t.fairTypes,e.fairtype_id=a.fairtype_id,await t.fetchModalities(),s.value.modality_id=t.modalities,e.modality_id=a.modality_id,e.dates={start:r(a.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:r(a.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.metaMypes=a.metaMypes,await t.fetchCitiesNational(),s.value.city_id=t.citiesNational,e.city_id=a.city_id,e.fecha=a.fecha?r(a.fecha,"DD/MM/YYYY"):null,e.place=a.place,e.hours=a.hours,e.msgEndForm=a.msgEndForm||"</p>",e.msgSendEmail=a.msgSendEmail||"</p>")};return L(()=>{i.info&&p(i.info)}),w(()=>i.info,a=>{a?p(a):u()}),f("formState",e),f("loadingState",o),(a,d)=>(y(),S("div",k,[g(R,{fields:m.value,options:s.value,btnSaveName:N.value,onHandleInputEvent:T,resetSelect:D.value,onHandleFocusSelect:C,onHandleBlurSelect:Y,onHandleChangeClock:I,onOnSubmit:O},{default:P(({field:l})=>[l.name=="iSlotOptions"?(y(),S("div",x,[g(A,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:M,imageLoad:v()},null,8,["imageLoad"])])):H("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};export{Z as _};
