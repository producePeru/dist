import{r as d,a as j,k as V,T as W,W as U,o as L,y as J,i as $,L as K,d as q,c as y,m as k,h as G,p as M,f as te,b as Y,w as x,e as I,j as H,t as ie,z as ee,O as pe,n as _e}from"./index-483a1ab3.js";import{_ as ve}from"./TableComponent-a45d92d8.js";import{d as fe}from"./downloadExcel-ec71d15f.js";import{_ as Q}from"./FormComponent-be616adb.js";import{u as X}from"./selectes-6af2002b.js";import"./es-d22a2706.js";import{g as ye}from"./publicInscripcion-2287ab50.js";import{_ as ge}from"./_plugin-vue_export-helper-c27b6911.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-d0af161b.js";import"./quill.snow-a9eaa851.js";const Ee={key:1,class:"ases-draw"},be={__name:"EditarAsesoria",props:{info:{type:Object,required:!0,default:()=>({})}},emits:["closeDraw"],setup(F,{emit:g}){const _=F,A=g,u=X(),E=d(!0),b=d(!1),o=j({}),e=d("ACTUALIZAR"),m=d({city_id:[],province_id:[],district_id:[],gender_id:[],sick:[]}),t=async(n,v)=>{if(n=="city_id"&&(await u.fetchProvinces(o.city_id),m.value.province_id=u.provinces,p.value.province_id.disabled=!1),n=="province_id"&&(await u.fetchDistricts(o.province_id),m.value.district_id=u.districts,p.value.district_id.disabled=!1),n=="component_id"&&(await u.fetchComponentThemes(o.component_id),m.value.theme_id=u.componentThemes,o.theme_id=null,p.value.theme_id.disabled=!1),n==="theme_id")if(v==17)p.value={...p.value,observations:{type:"iNumber",label:"NÚMERO DE RESERVA (Z- 7 dígitos)",name:"observations",required:!0,message:"Ingresar número de reserva",disabled:!1,prefix:"Z -",maxlength:7,rules:[{validator:(a,w)=>{if(!w)return Promise.reject(new Error("Ingresar número de reserva"));const R=String(w).length;return R<7?Promise.reject(new Error("El número debe tener al menos 7 cifras")):R>7?Promise.reject(new Error("El número no puede superar las 7 cifras")):Promise.resolve()},trigger:"change"}]}};else{o.observations=null;const{observations:a,...w}=p.value;p.value=w}},S=async n=>{n=="city_id"&&(o.province_id=null,o.district_id=null,m.value.province_id=[],m.value.city_id=u.cities),n=="province_id"&&(o.province_id=null,o.district_id=null,m.value.district_id=[])},r=async()=>{b.value=!0;const n={economicsector_id:o.economicsector_id,comercialactivity_id:o.comercialactivity_id,component_id:o.component_id,theme_id:o.theme_id,modality_id:o.modality_id,ruc:o.ruc,city_id:o.city_id,province_id:o.province_id,district_id:o.district_id,...o.observations&&{observations:o.observations}};try{const v=await k({url:`advisory/update-values-advisory/${_.info.id}`,method:"PUT",data:n});v.status==200&&(G.success(v.message),A("closeDraw",!0),T())}catch{const a=document.getElementsByClassName("ant-drawer-body")[0];a&&(a.scrollTop=0)}finally{b.value=!1}},T=()=>{o.economicsector_id=null,o.comercialactivity_id=null,o.component_id=null,o.theme_id=null,o.theme_id=null,o.modality_id=null,o.ruc=null,o.city_id=null,o.province_id=null,o.district_id=null,o.observations=null;const{observations:n,...v}=p.value;p.value=v},p=d({economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},component_id:{type:"iSelect",label:"COMPONENTE",name:"component_id",required:!0,message:"Seleccionar un componente",disabled:!1},theme_id:{type:"iSelect",label:"TEMA DEL COMPONENTE",name:"theme_id",required:!0,message:"Seleccionar un tema del componente",disabled:!0},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!1},ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(n,v)=>{if(!v)return Promise.resolve();const a=v.toString();return a.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):["10","15","17","20"].includes(a.substring(0,2))?Promise.resolve():Promise.reject(new Error("El RUC debe empezar con 10, 15, 17 o 20"))},trigger:"change"}]},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0}}),N=async n=>{E.value=!0;try{if(n){if(o.economicsector_id=n.econimic_sector_id,o.comercialactivity_id=n.activity_comercial_id,o.city_id=n.city_id,await u.fetchProvinces(o.city_id),m.value.province_id=u.provinces,o.province_id=n.province_id,await u.fetchDistricts(o.province_id),m.value.district_id=u.districts,o.district_id=n.district_id,o.modality_id=n.modality_id,o.ruc=n.ruc,o.component_id=n.component_id,p.value.theme_id.disabled=!1,o.component_id=n.component_id,await u.fetchComponentThemes(o.component_id),m.value.theme_id=u.componentThemes,o.theme_id=n.theme_id,n.theme_id==17)p.value={...p.value,observations:{type:"iNumber",label:"NÚMERO DE RESERVA (7 dígitos)",name:"observations",required:!0,message:"Ingresar número de reserva",disabled:!1,prefix:"Z -",maxlength:7,rules:[{validator:(v,a)=>{if(!a)return Promise.reject(new Error("Ingresar número de reserva"));const w=String(a).length;return w<7?Promise.reject(new Error("El número debe tener al menos 7 cifras")):w>7?Promise.reject(new Error("El número no puede superar las 7 cifras")):Promise.resolve()},trigger:"change"}]}};else{o.observations=null;const{observations:v,...a}=p.value;p.value=a}o.observations=n.observations}}catch(v){console.error("Error al cargar la información:",v)}finally{}};return V(async()=>{_.info&&N(_.info),await u.fetchEconomicSectors(),m.value.economicsector_id=u.economicSectors,await u.fetchComercialActivities(),m.value.comercialactivity_id=u.comercialActivities,await u.fetchCities(),m.value.city_id=u.cities,await u.fetchModalities(),m.value.modality_id=u.modalities,await u.fetchComponents(),m.value.component_id=u.components,E.value=!1}),W(()=>_.info,n=>{n?N(n):T()}),U("formState",o),U("loadingState",b),(n,v)=>E.value?(L(),J($(K),{key:0,style:{color:"#00a6db"}})):(L(),q("div",Ee,[y(Q,{fields:p.value,options:m.value,btnSaveName:e.value,onHandleFocusSelect:S,onHandleChangeSelect:t,onOnSubmit:r},null,8,["fields","options","btnSaveName"])]))}},Ce={key:1,class:"f-20"},Se={__name:"EditarFormalizacionRUC10",props:["info"],emits:["closeDraw"],setup(F,{emit:g}){M.locale("es");const _=d({economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},detailprocedure_id:{type:"iSelect",label:"DETALLE DEL TRÁMITE",name:"detailprocedure_id",required:!0,message:"Seleccionar el detalle del trámite",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!1},ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(c,D)=>{if(!D)return Promise.resolve();const i=D.toString();return i.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):["10","15"].includes(i.substring(0,2))?Promise.resolve():Promise.reject(new Error("El RUC debe empezar con 10 o 15"))},trigger:"change"}]},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!1,message:"Seleccionar tipo de documento",disabled:!1}}),A=JSON.parse(localStorage.getItem("profile")),u=g,E=F,b=d(!0),o=d("ACTUALIZAR"),e=j({}),m=d(!1),t=X(),S=d(null),r=d({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[],component_id:[],theme_id:[],detailprocedure_id:[]}),T=c=>{console.log("handleInputEvent",c)},p=async c=>{c=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),_.value.dateTramite.disabled=!1)},N=async c=>{c=="city_id"&&(await t.fetchProvinces(e.city_id),r.value.province_id=t.provinces,_.value.province_id.disabled=!1),c=="province_id"&&(await t.fetchDistricts(e.province_id),r.value.district_id=t.districts,_.value.district_id.disabled=!1)},n=async c=>{console.log("handleFocusSelect",c),c=="city_id"&&(await t.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,r.value.province_id=[],r.value.city_id=t.cities),c=="province_id"&&(e.province_id=null,e.district_id=null,r.value.district_id=[]),c=="regime_id"&&(await t.fetchRegimes(),r.value.regime_id=t.regimes),c=="economicsector_id"&&(await t.fetchEconomicSectors(),r.value.economicsector_id=t.economicSectors),c=="comercialactivity_id"&&(await t.fetchComercialActivities(),r.value.comercialactivity_id=t.comercialActivities),c=="detailprocedure_id"&&(await t.fetchDetailProcedures(),r.value.detailprocedure_id=t.detailProcedures)},v=c=>{},a=async()=>{m.value=!0;const c={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,detailprocedure_id:e.detailprocedure_id,modality_id:e.modality_id,ruc:e.ruc,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,updated_by:A.user_id};try{(await k({url:`formalization/update-ruc-10/${E.info.id}`,method:"PUT",data:c})).status===200&&(w(),u("closeDraw",!0))}catch(D){console.error("Error:",D);const i=document.getElementsByClassName("ant-drawer-body")[0];i&&(i.scrollTop=0)}finally{m.value=!1}},w=()=>{e.economicsector_id=null,e.comercialactivity_id=null,e.detailprocedure_id=null,e.modality_id=null,e.ruc=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null},R=async c=>{b.value=!0;try{c&&(await t.fetchEconomicSectors(),r.value.economicsector_id=t.economicSectors,e.economicsector_id=c.econimic_sector_id,await t.fetchComercialActivities(),r.value.comercialactivity_id=t.comercialActivities,e.comercialactivity_id=c.activity_comercial_id,await t.fetchDetailProcedures(),r.value.detailprocedure_id=t.detailProcedures,e.detailprocedure_id=c.detailprocedure_id,await t.fetchModalities(),r.value.modality_id=t.modalities,e.modality_id=c.modality_id,e.ruc=c.ruc,e.address=c.address,await t.fetchCities(),r.value.city_id=t.cities,e.city_id=c.city_id,await t.fetchProvinces(e.city_id),r.value.province_id=t.provinces,_.value.province_id.disabled=!1,e.province_id=c.province_id,await t.fetchDistricts(e.province_id),r.value.district_id=t.districts,_.value.district_id.disabled=!1,e.district_id=c.district_id)}catch(D){console.error("Error al cargar la información:",D)}finally{b.value=!1}};return V(()=>{E.info&&R(E.info)}),W(()=>E.info,c=>{c&&R(c)}),U("formState",e),U("loadingState",m),(c,D)=>b.value?(L(),J($(K),{key:0,style:{color:"#00a6db"}})):(L(),q("div",Ce,[y(Q,{fields:_.value,options:r.value,btnSaveName:o.value,onHandleInputEvent:T,resetSelect:S.value,onHandleChangeSelect:N,onHandleFocusSelect:n,onHandleBlurSelect:v,onHandleChangeClock:p,onOnSubmit:a},null,8,["fields","options","btnSaveName","resetSelect"])]))}},he={key:1,class:"f-20"},Ie={__name:"EditarFormalizacionRUC20",props:["info"],emits:["closeDraw"],setup(F,{emit:g}){M.locale("es");const _=d({ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(i,O)=>{if(!O)return Promise.resolve();const h=O.toString();return h.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):h.startsWith("20")?Promise.resolve():Promise.reject(new Error('El número de RUC debe comenzar con "20"'))},trigger:"change"}]},nameMype:{type:"iText",label:"NOMBRE EMPRESA",name:"nameMype",required:!0,message:"Escribir nombre de la empresa",disabled:!1},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!0,message:"Escribir la dirección del negocio",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},regime_id:{type:"iSelect",label:"RÉGIMEN SOCIETARIO",name:"regime_id",required:!0,message:"Seleccionar el régimen societario",disabled:!1},economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},numbernotary:{type:"iText",label:"NÚM. SOLICITUD CONSTANCIA",name:"numbernotary",required:!0,message:"Escribir número de solicitud de constancia",disabled:!1,maxlength:8,rules:[{validator:(i,O)=>{if(!O)return Promise.reject(new Error("El número de notaría es requerido"));const h=O.toString();return/^\d{8}$/.test(h)?Promise.resolve():Promise.reject(new Error("El número debe tener exactamente 8 dígitos numéricos"))},trigger:"change"}]},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},notary_id:{type:"iSelectNotary",label:"NOTARÍA",name:"notary_id",required:!0,message:"Seleccionar una notaría",disabled:!1},dateReception:{type:"iDate",label:"FECHA DE RECEPCION PNTE",name:"dateReception",required:!0,disabled:!1,disabledDate:i=>!1},dateTramite:{type:"iDate",label:"FEC. TRÁMITE SID SUNARP-SUNAT",name:"dateTramite",required:!0,disabled:!1,disabledDate:i=>e.dateReception&&i&&M(i).isBefore(M(e.dateReception))},isbic:{type:"iSelect",label:"¿ES UNA SOCIEDAD BIC?",name:"isbic",required:!1,message:"Buscar BIC",disabled:!1},montocapital:{type:"iMoney",label:"MONTO DE CAPITAL SOCIAL",name:"montocapital",required:!1,message:"Escribir el Monto de capital social",disabled:!1},typecapital_id:{type:"iSelect",label:"TIPO DE APORTE DE CAPITAL",name:"typecapital_id",required:!1,message:"Seleccionar BIC",disabled:!1}}),A=JSON.parse(localStorage.getItem("profile")),u=g,E=F,b=d(!0),o=d("REGISTRAR"),e=j({}),m=d(!1),t=X(),S=d(null),r=d({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[]}),T=i=>{console.log("handleInputEvent",i)},p=async i=>{i=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),_.value.dateTramite.disabled=!1)},N=async i=>{i=="city_id"&&(await t.fetchProvinces(e.city_id),r.value.province_id=t.provinces,_.value.province_id.disabled=!1),i=="province_id"&&(await t.fetchDistricts(e.province_id),r.value.district_id=t.districts,_.value.district_id.disabled=!1)},n=async i=>{console.log("handleFocusSelect",i),i=="city_id"&&(await t.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,r.value.province_id=[],r.value.city_id=t.cities),i=="province_id"&&(e.province_id=null,e.district_id=null,r.value.district_id=[]),i=="modality_id"&&(await t.fetchModalities(),r.value.modality_id=t.modalities),i=="regime_id"&&(await t.fetchRegimes(),r.value.regime_id=t.regimes),i=="economicsector_id"&&(await t.fetchEconomicSectors(),r.value.economicsector_id=t.economicSectors),i=="comercialactivity_id"&&(await t.fetchComercialActivities(),r.value.comercialactivity_id=t.comercialActivities),i=="notary_id"&&w(),i=="isbic"&&a(),i=="typecapital_id"&&(await t.fetchTypeCapital(),r.value.typecapital_id=t.typeCapital)},v=i=>{},a=()=>{r.value.isbic=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}]},w=async()=>{try{const{data:i}=await te({url:"public/notaries-filters",method:"GET"}),O=i.map(h=>({value:h.id,name:h.name,city:h.city.name,province:h.province.name,district:h.district.name,address:h.address}));r.value.notary_id=O}catch(i){console.error("Error de red:",i)}},R=async()=>{m.value=!0;const i={ruc:e.ruc,nameMype:e.nameMype,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,modality_id:e.modality_id,regime_id:e.regime_id,economicsector_id:e.economicsector_id,numbernotary:e.numbernotary,comercialactivity_id:e.comercialactivity_id,notary_id:e.notary_id,dateReception:M(e.dateReception).format("YYYY-MM-DD"),dateTramite:M(e.dateTramite).format("YYYY-MM-DD"),isbic:e.isbic,montocapital:e.montocapital,typecapital_id:e.typecapital_id,user_id:e.user_id,people_id:e.people_id,dni:e.dni,userupdated_id:A.user_id};try{(await k({url:`formalization/update-ruc-20/${E.info.id}`,method:"PUT",data:i})).status===200&&(c(),u("closeDraw",!0))}catch(O){console.error("Error:",O);const h=document.getElementsByClassName("ant-drawer-body")[0];h&&(h.scrollTop=0)}finally{m.value=!1}},c=()=>{e.ruc=null,e.nameMype=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.modality_id=null,e.regime_id=null,e.economicsector_id=null,e.numbernotary=null,e.comercialactivity_id=null,e.notary_id=null,e.dateReception=null,e.dateTramite=null,e.isbic=null,e.montocapital=null,e.typecapital_id=null},D=async i=>{b.value=!0;try{i&&(e.ruc=i.ruc,e.nameMype=i.name_mype,await t.fetchCities(),r.value.city_id=t.cities,e.city_id=i.city_id,await t.fetchProvinces(e.city_id),r.value.province_id=t.provinces,_.value.province_id.disabled=!1,e.province_id=i.province_id,await t.fetchDistricts(e.province_id),r.value.district_id=t.districts,_.value.district_id.disabled=!1,e.district_id=i.district_id,e.address=i.address,await t.fetchModalities(),r.value.modality_id=t.modalities,e.modality_id=i.modality_id,await t.fetchRegimes(),r.value.regime_id=t.regimes,e.regime_id=i.regime_id,await t.fetchEconomicSectors(),r.value.economicsector_id=t.economicSectors,e.economicsector_id=i.econimic_sector_id,e.numbernotary=i.num_solicitud,await t.fetchComercialActivities(),r.value.comercialactivity_id=t.comercialActivities,e.comercialactivity_id=i.activity_comercial_id,w(),e.notary_id=i.notary_id,e.dateReception=i.date_reception?M(i.date_reception,"DD/MM/YYYY"):null,e.dateTramite=i.date_tramite?M(i.date_tramite,"DD/MM/YYYY"):null,e.isbic=i.bic,e.montocapital=i.monto_capital,await t.fetchTypeCapital(),r.value.typecapital_id=t.typeCapital,e.typecapital_id=i.typecapital_id)}catch(O){console.error("Error al cargar la información:",O)}finally{b.value=!1}};return V(()=>{E.info&&D(E.info)}),W(()=>E.info,i=>{i&&D(i)}),U("formState",e),U("loadingState",m),(i,O)=>b.value?(L(),J($(K),{key:0,style:{color:"#00a6db"}})):(L(),q("div",he,[y(Q,{fields:_.value,options:r.value,btnSaveName:o.value,onHandleInputEvent:T,resetSelect:S.value,onHandleChangeSelect:N,onHandleFocusSelect:n,onHandleBlurSelect:v,onHandleChangeClock:p,onOnSubmit:R},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const we={class:"flex justify-between mt-4"},De={__name:"DescribeMotive",props:["loadingDescribeMotive"],emits:["closeModal","goToFunction"],setup(F,{emit:g}){const _=F,A=g,u=d(!0),E=d(null),b=d({comentario:""}),o={comentario:[{validator:(t,S)=>S?S.trim().split(/\s+/).length<4?Promise.reject("Debe contener al menos 4 palabras"):Promise.resolve():Promise.reject("El comentario es obligatorio"),trigger:"blur"}]},e=()=>{u.value=!1,E.value.resetFields(),A("closeModal")},m=()=>{E.value.validate().then(()=>{A("goToFunction",b.value.comentario)}).catch(()=>{G.error("Corrige los errores antes de continuar")})};return(t,S)=>{const r=Y("a-textarea"),T=Y("a-form-item"),p=Y("a-button"),N=Y("a-form");return L(),J(N,{model:b.value,rules:o,ref_key:"formRef",ref:E,layout:"vertical"},{default:x(()=>[y(T,{name:"comentario"},{default:x(()=>[y(r,{value:b.value.comentario,"onUpdate:value":S[0]||(S[0]=n=>b.value.comentario=n),placeholder:"Escribe tu comentario (mínimo 4 palabras)...",rows:4},null,8,["value"])]),_:1}),I("div",we,[y(p,{onClick:e,class:"w-1/2 mr-2"},{default:x(()=>S[1]||(S[1]=[H("Cancelar")])),_:1}),y(p,{type:"primary",class:"w-1/2 ml-2",onClick:m,loading:_.loadingDescribeMotive},{default:x(()=>[H(ie(_.loadingDescribeMotive?"":"Aceptar"),1)]),_:1},8,["loading"])])]),_:1},8,["model"])}}},Oe=ge(De,[["__scopeId","data-v-19c517c6"]]);const Ae={class:"layout-content"},Te={class:"advisory-table"},Ne={class:"filter-type"},Re={key:0,class:"filter-type"},xe={key:1,class:"filter-asesor"},Me=["onClick"],je={__name:"reportes-index",setup(F){const g=JSON.parse(localStorage.getItem("profile"))||{},_=d(!1),A=d(null),u=d(!1),E=d([{label:"ASESORÍAS",value:1},{label:"F. RUC 10",value:2},{label:"F. RUC 20",value:3}]),b=d([{label:"CDE",value:1},{label:"CDEAI INSTITUCIONES",value:2},{label:"CDEAN NOTARÍAS",value:3}]),o=d([]),e=d(0),m=d(90),t=d(!1),S=d(!1),r=d("Asesorías"),T=d(!1),p=d(!1),N=d(!1),n=d(null),v=d(!1),a=j({year:M("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null}),w=d([]),R=d([]),c=(s,l)=>{const C=s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return l.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(C)},D=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:80},{title:"FECHA",fixed:"left",dataIndex:"date",width:100,align:"center"},...g.rol!=2?[{title:"ASESOR",dataIndex:"asesor",width:200,customCell:()=>({style:{backgroundColor:"#f0f5ff"}})}]:[],...g.rol!=2?[{title:"ASESOR CDE",dataIndex:"asesor_cde",width:160,customCell:()=>({style:{backgroundColor:"#f0f5ff"}})}]:[],{title:"TIPO DOCUMENTO",dataIndex:"emp_document_type",width:100,align:"center"},{title:"NÚMERO DE DOCUMENTO",dataIndex:"emp_document_number",align:"center",width:140},{title:"SOLICITANTE APELLIDO PATERNO",dataIndex:"emp_lastname",width:150},{title:"SOLICITANTE APELLIDO MATERNO",dataIndex:"emp_middlename",width:150},{title:"SOLICITANTE NONBRE",dataIndex:"emp_name",width:150},{title:"PAÍS",dataIndex:"emp_country",align:"center",width:120},{title:"FEC. NAC",dataIndex:"emp_birth",align:"center",width:120},{title:"EDAD",dataIndex:"emp_age",align:"center",width:80},{title:"GÉNERO",dataIndex:"emp_gender",width:80,align:"center"},{title:"DISCAPACIDAD",dataIndex:"emp_discapabilities",width:120,align:"center"},{title:"HIJOS",dataIndex:"emp_soons",width:80,align:"center"},{title:"CELULAR",dataIndex:"emp_phone",width:120,align:"center"},{title:"EMAIL",dataIndex:"emp_email",width:200},{title:"CIUDAD",dataIndex:"city",width:120,align:"center"},{title:"PROVINCIA",dataIndex:"province",width:140,align:"center"},{title:"DISTRITO",dataIndex:"district",width:140,align:"center"},{title:"RUC",dataIndex:"ruc",width:120,align:"center"}],i=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_service",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"COMPONENTE",dataIndex:"component",width:140,align:"center"},{title:"TEMA",dataIndex:"theme",width:200},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"CODIGO SID SUNARP",align:"center",dataIndex:"observations",width:140},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],O=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"DETALLE DEL TRÁMITE",dataIndex:"detail_tramit",width:180},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],h=[{title:"NOMBRE DE LA EMPRESA",dataIndex:"nameMype",width:200},{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"FECHA DE RECEPCIÓN",dataIndex:"date_reception",width:160,align:"center"},{title:"FECHA DE TRÁMITE",dataIndex:"date_tramite",width:160,align:"center"},{title:"TIPO DE RÉGIMEN",dataIndex:"type_regimen",width:150,align:"center"},{title:"BIC",dataIndex:"bic",width:50,align:"center"},{title:"NÚMERO DE SOLICITUD",dataIndex:"num_solicitud",width:160,align:"center"},{title:"NOTARÍA",dataIndex:"notaria",width:200},{title:"TIPO DE APORTE",dataIndex:"type_aporte",width:160,align:"center"},{title:"MONTO CAPITAL",dataIndex:"monto_capital",width:160,align:"center"},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}];function ae(){if(g.user_id){const s={user:g.user_id,name:g.name,lastname:g.lastname,middlename:g.middlename};if(g.user_id){const l=btoa(JSON.stringify(s)),C=`${ye()}/preguntas-formalizaciones?data=${l}`;window.open(C,"_blank")}}}const le=()=>{console.log("handleNew...")},re=s=>({Asesorias:"ases","Formalizaciones RUC 10":"f10","Formalizaciones RUC 20":"f20"})[s],oe=async s=>{_.value=!0;try{const C={table_name:{Asesorias:"asesoria","Formalizaciones RUC 10":"f10","Formalizaciones RUC 20":"f20"}[r.value]||r.value,row_id:A.value.id,description:s,action:"d"};if((await k({url:"token/indicate-reason-action",method:"POST",data:C})).status==200)try{let P=null;r.value==="Asesorias"&&(P=`advisory/delete/${A.value.id}`),r.value==="Formalizaciones RUC 10"&&(P=`formalization/delete-ruc-10/${A.value.id}`),r.value==="Formalizaciones RUC 20"&&(P=`formalization/delete-ruc-20/${A.value.id}`);const B=await k({url:P,method:"DELETE"});z(),G.success(B.message),u.value=!1}catch(P){console.error("Error al eliminar registro:",P),G.error("No se pudo eliminar el registro.")}}catch(l){console.error("Error al registrar motivo:",l),G.error("No se pudo registrar el motivo de la acción.")}finally{_.value=!1}},ne=async()=>{S.value=!0;try{const s={};a.year&&(s.year=M(a.year).format("YYYY")),a.range&&(s.dateStart=a.range[0].format("YYYY/MM/DD"),s.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(s.asesor=a.asesor),a.name&&(s.name=a.name),a.typeCdes&&(s.typeCdes=a.typeCdes);let l=null,C=null;a.type==1&&(l="download/asesories",C="Asesorías"),a.type==2&&(l="download/formalizations-ruc10",C="Formalizaciones 10"),a.type==3&&(l="download/formalizations-ruc20",C="Formalizaciones 20"),await fe(l,C,s)}catch(s){console.error("Error de red:",s)}finally{S.value=!1}},se=async s=>{a.page=s,await z()},de=async s=>{s&&(a.page=1,await z())},ce=s=>{n.value=s,a.type==1&&(T.value=!0),a.type==2&&(p.value=!0),a.type==3&&(N.value=!0)},ue=()=>{a.type==1&&(R.value=[...D,...i],r.value="Asesorias"),a.type==2&&(R.value=[...D,...O],r.value="Formalizaciones RUC 10"),a.type==3&&(R.value=[...D,...h],r.value="Formalizaciones RUC 20")},z=async()=>{t.value=!0,ue();try{const s={page:a.page};a.year&&(s.year=M(a.year).format("YYYY")),a.range&&(s.dateStart=a.range[0].format("YYYY/MM/DD"),s.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(s.asesor=a.asesor),a.name&&(s.name=a.name),a.typeCdes&&(s.typeCdes=a.typeCdes);let l=null;a.type==1&&(l="historial/advisories/filters"),a.type==2&&(l="historial/formalizations-10/filters"),a.type==3&&(l="historial/formalizations-20/filters");const C=await k({url:l,method:"GET",params:s});o.value=C.data.data,e.value=C.data.total,m.value=C.data.per_page,g.rol!=2&&await me()}catch(s){console.error("Error de red:",s)}finally{t.value=!1}},me=async()=>{try{const s=await te({url:"select/asesores-report",method:"GET"});s.status==200&&(w.value=s.data)}catch{console.log("Failed to delete")}};return V(async()=>{await z()}),U("search",a),U("loading",t),U("loadingFile",S),(s,l)=>{const C=Y("a-select"),Z=Y("a-menu-item"),P=Y("a-drawer"),B=Y("a-modal");return L(),q("div",Ae,[I("div",Te,[y(ve,{title:`REPORTE GENERAL - ${r.value}`,new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:R.value,downloadExcel:!0,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:m.value,nameTotal:r.value,dataSource:o.value,total:e.value,onHandleNew:le,onHandleDownloadExcel:ne,onHandleSearch:de,onHandlePaginator:se},{header:x(()=>[I("div",Ne,[l[12]||(l[12]=I("small",null,"TIPO",-1)),y(C,{value:a.type,"onUpdate:value":l[0]||(l[0]=f=>a.type=f),options:E.value},null,8,["value","options"])]),$(g).rol!=2?(L(),q("div",Re,[l[13]||(l[13]=I("small",null,"TIPO CDE",-1)),y(C,{allowClear:!0,value:a.typeCdes,"onUpdate:value":l[1]||(l[1]=f=>a.typeCdes=f),options:b.value},null,8,["value","options"])])):ee("",!0),$(g).rol!=2?(L(),q("div",xe,[l[14]||(l[14]=I("small",null,"POR ASESOR",-1)),y(C,{allowClear:!0,value:a.asesor,"onUpdate:value":l[2]||(l[2]=f=>a.asesor=f),placeholder:"Selecciona Asesor","show-search":"",options:w.value,"filter-option":c},null,8,["value","options"])])):ee("",!0)]),"custom-options":x(({record:f})=>[y(Z,null,{default:x(()=>[I("a",{onClick:Pe=>ce(f)},"Editar",8,Me)]),_:2},1024)]),_:1},8,["title","columns","pageSize","nameTotal","dataSource","total"]),y(P,{width:"500",title:"EDITAR ASESORÍA",open:T.value,"onUpdate:open":l[4]||(l[4]=f=>T.value=f),placement:"right"},{default:x(()=>[y(be,{info:n.value,onCloseDraw:l[3]||(l[3]=f=>(T.value=!1,z()))},null,8,["info"])]),_:1},8,["open"]),y(P,{width:"550",title:"Editar Formalización RUC 10",open:p.value,"onUpdate:open":l[6]||(l[6]=f=>p.value=f),placement:"right"},{default:x(()=>[y(Se,{info:n.value,onCloseDraw:l[5]||(l[5]=f=>(p.value=!1,z()))},null,8,["info"])]),_:1},8,["open"]),y(P,{width:"550",title:"Editar Formalización RUC 20",open:N.value,"onUpdate:open":l[8]||(l[8]=f=>N.value=f),placement:"right"},{default:x(()=>[y(Ie,{info:n.value,onCloseDraw:l[7]||(l[7]=f=>(N.value=!1,z()))},null,8,["info"])]),_:1},8,["open"]),y(B,{open:v.value,"onUpdate:open":l[9]||(l[9]=f=>v.value=f),title:"📌 ¿Aún no llenaste el formulario?",width:"420px",footer:null,maskClosable:!1,closable:!1},{default:x(()=>[l[15]||(l[15]=I("p",null,"¡Hola! 👋",-1)),l[16]||(l[16]=I("p",null,"Notamos que aún no has completado el formulario con preguntas frecuentes sobre formalización.",-1)),l[17]||(l[17]=I("p",null,"Tómate un momento para completarlo cuando puedas. ¡Tu experiencia es importante para nosotros!",-1)),l[18]||(l[18]=I("br",null,null,-1)),I("a",{href:"#",onClick:pe(ae,["prevent"]),class:"btn-complete-modal"}," IR AL FORMULARIO "),l[19]||(l[19]=I("br",null,null,-1)),l[20]||(l[20]=I("p",{style:{color:"#ff4d4f","text-align":"center"}},[H("Completado el formulario regresa a esta página y "),I("b",null,"actualiza"),H(" para que este mensaje desaparezca. ")],-1))]),_:1},8,["open"]),y(B,{open:u.value,"onUpdate:open":l[11]||(l[11]=f=>u.value=f),title:"DESCRIBE MOTIVO",footer:null,width:"450px"},{default:x(()=>[I("span",{class:_e(["tag-formalizations",re(r.value)])},ie(r.value),3),y(Oe,{onCloseModal:l[10]||(l[10]=f=>u.value=!1),onGoToFunction:oe,loadingDescribeMotive:_.value},null,8,["loadingDescribeMotive"])]),_:1},8,["open"])])])}}};export{je as default};
