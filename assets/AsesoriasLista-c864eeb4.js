import{l as f,a8 as X,r as d,E as de,X as se,j as $,b,o as E,d as B,e as g,t as G,c as p,w as S,x as q,i as Z,q as H,h,L as J,F as ae,a9 as le,J as ue,p as me,a as W,T as K,a5 as k,f as Q,K as V}from"./index-7867bbe2.js";import{_ as _e}from"./icoexcel-1b303edf.js";import"./es-6f7efd55.js";import{M as pe}from"./MoreOutlined-186dc1bc.js";import{d as ve}from"./downloadExcel-1afecc00.js";import{_ as ee}from"./FormComponent-e1fce6b0.js";import{u as te}from"./selectes-5e36ad1b.js";const ye={class:"table-component"},fe={class:"title-produce"},ge={class:"table-filters"},he={class:"filter-type"},Se={class:"filter-year"},Ee={class:"filter-range-date"},be={key:0,class:"filter-asesor"},Ce={class:"filter-search"},Ie={key:1},we={class:"paginator"},De="DD/MM/YYYY",Oe={__name:"TableComponent",props:["title","new","textNuevo","columns","dataSource","total","placeholderSearch","asesoresList","nameTotal","pageSize","titleSearch","tipoformalizacion"],emits:["handleNew","handleDownloadExcel","handleSearch","handlePaginator"],setup(F,{emit:x}){f.locale("es");const o=F,C=x,N=JSON.parse(localStorage.getItem("role"))||[],m=X("search"),v=X("loading"),D=X("loadingFile"),e=d(window.innerHeight-100),y=d({page:1}),i=d(1200),n=d([{label:"Últimos 7 días",value:[f().add(-7,"d"),f()]},{label:"Últimos 14 días",value:[f().add(-14,"d"),f()]},{label:"Último mes",value:[f().add(-30,"d"),f()]}]),a=d([{label:"ASESORÍAS",value:1},{label:"F. RUC 10",value:2},{label:"F. RUC 20",value:3}]),O=l=>N.some(r=>l.includes(r.id)),R=de(()=>l=>(y.value.page-1)*o.pageSize+l+1),P=()=>{C("handleNew")},Y=async()=>{C("handleDownloadExcel")},U=()=>{C("handleSearch",!0)},z=l=>{y.value.page=l,C("handlePaginator",l)},A=()=>{e.value=window.innerHeight-310},M=(l,r)=>{const t=l.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)};return se(()=>{window.removeEventListener("resize",A)}),$(()=>{window.addEventListener("resize",A),A()}),(l,r)=>{const t=b("a-button"),c=b("a-col"),s=b("a-select"),u=b("a-date-picker"),_=b("a-range-picker"),T=b("a-input"),L=b("a-row"),I=b("a-menu"),j=b("a-dropdown"),oe=b("a-table"),re=b("a-tag"),ne=b("a-pagination");return E(),B(ae,null,[g("div",ye,[g("h3",fe,G(o.title),1),p(L,{style:{margin:"1rem 0"}},{default:S(()=>[p(c,{xs:24,md:5},{default:S(()=>[o.new?(E(),q(t,{key:0,type:"primary",onClick:P,style:{"margin-right":".6rem"}},{default:S(()=>[Z(G(o.textNuevo),1)]),_:1})):H("",!0),p(t,{class:"btn-excel",onClick:Y,loading:h(D),type:"primary"},{default:S(()=>r[6]||(r[6]=[g("img",{width:"20",style:{margin:"-2px 4px 0 0"},src:_e},null,-1)])),_:1},8,["loading"])]),_:1}),p(c,{xs:24,md:19},{default:S(()=>[g("div",ge,[g("div",he,[r[7]||(r[7]=g("small",null,"TIPO",-1)),o.tipoformalizacion?(E(),q(s,{key:0,value:h(m).type,"onUpdate:value":r[0]||(r[0]=w=>h(m).type=w),options:a.value},null,8,["value","options"])):H("",!0)]),g("div",Se,[r[8]||(r[8]=g("small",null,"AÑO",-1)),p(u,{allowClear:!1,value:h(m).year,"onUpdate:value":r[1]||(r[1]=w=>h(m).year=w),picker:"year",placeholder:"Seleccionar año"},null,8,["value"])]),g("div",Ee,[r[9]||(r[9]=g("small",null,"Por rango de fechas",-1)),p(_,{value:h(m).range,"onUpdate:value":r[2]||(r[2]=w=>h(m).range=w),presets:n.value,format:De},null,8,["value","presets"])]),O([1,5])?(E(),B("div",be,[r[10]||(r[10]=g("small",null,"Por asesor",-1)),o.asesoresList?(E(),q(s,{key:0,allowClear:!0,value:h(m).asesor,"onUpdate:value":r[3]||(r[3]=w=>h(m).asesor=w),placeholder:"Selecciona Asesor","show-search":"",options:o.asesoresList,"filter-option":M},null,8,["value","options"])):H("",!0)])):H("",!0),g("div",Ce,[g("small",null,G(o.titleSearch),1),p(T,{value:h(m).name,"onUpdate:value":r[4]||(r[4]=w=>h(m).name=w),placeholder:o.placeholderSearch},null,8,["value","placeholder"])]),p(t,{type:"primary",onClick:U},{default:S(()=>[h(v)?(E(),q(h(J),{key:0})):(E(),B("span",Ie,"BUSCAR"))]),_:1})])]),_:1})]),_:1}),p(oe,{bordered:"",scroll:{x:i.value,y:e.value},class:"table-pnte",columns:o==null?void 0:o.columns,"data-source":o==null?void 0:o.dataSource,pagination:!1,loading:h(v),size:"small"},{bodyCell:S(({column:w,record:ie,index:ce})=>[w.dataIndex=="idx"?(E(),B(ae,{key:0},[Z(G(R.value(ce)),1)],64)):H("",!0),le(l.$slots,"data-cell",{column:w,record:ie}),w.dataIndex=="actions"?(E(),q(j,{key:1,trigger:["click"]},{overlay:S(()=>[p(I,null,{default:S(()=>[le(l.$slots,"custom-options",{record:ie})]),_:2},1024)]),default:S(()=>[g("a",{class:"ant-dropdown-link",onClick:r[5]||(r[5]=ue(()=>{},["prevent"]))},[p(t,{shape:"circle",icon:me(h(pe)),size:"small"},null,8,["icon"])])]),_:2},1024)):H("",!0)]),_:3},8,["scroll","columns","data-source","loading"])]),g("div",we,[g("span",null,[p(re,{color:"blue"},{default:S(()=>[g("b",null,G(o==null?void 0:o.total),1)]),_:1}),Z(G(o.nameTotal),1)]),p(ne,{size:"small",total:o==null?void 0:o.total,pageSize:o.pageSize,onChange:z,showSizeChanger:!1},null,8,["total","pageSize"])])],64)}}},Ae={key:1,class:"f-20"},Te={__name:"EditarAsesoria",props:["info"],emits:["closeDraw"],setup(F,{emit:x}){f.locale("es");const o=d({economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},component_id:{type:"iSelect",label:"COMPONENTE",name:"component_id",required:!0,message:"Seleccionar un componente",disabled:!1},theme_id:{type:"iSelect",label:"TEMA DEL COMPONENTE",name:"theme_id",required:!0,message:"Seleccionar un tema del componente",disabled:!0},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!1},ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(t,c)=>{if(!c)return Promise.resolve();const s=c.toString();return s.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):["10","15","20"].includes(s.substring(0,2))?Promise.resolve():Promise.reject(new Error("El RUC debe empezar con 10, 15 o 20"))},trigger:"change"}]},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},observations:{type:"iText",label:"NRO DE RESERVA / OBSERVACIONES",name:"observations",required:!1,message:"Seleccionar tipo de documento",disabled:!1}}),C=JSON.parse(localStorage.getItem("profile")),N=x,m=F,v=d(!0),D=d("ACTUALIZAR"),e=W({}),y=d(!1),i=te(),n=d(null),a=d({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[],component_id:[],theme_id:[]}),O=t=>{console.log("handleInputEvent",t)},R=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),o.value.dateTramite.disabled=!1)},P=async t=>{t=="city_id"&&(await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,o.value.province_id.disabled=!1),t=="province_id"&&(await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,o.value.district_id.disabled=!1),t=="component_id"&&(await i.fetchComponentThemes(e.component_id),a.value.theme_id=i.componentThemes,e.theme_id=null,o.value.theme_id.disabled=!1)},Y=async t=>{console.log("handleFocusSelect",t),t=="city_id"&&(await i.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,a.value.province_id=[],a.value.city_id=i.cities),t=="province_id"&&(e.province_id=null,e.district_id=null,a.value.district_id=[]),t=="modality_id"&&(await i.fetchModalities(),a.value.modality_id=i.modalities),t=="regime_id"&&(await i.fetchRegimes(),a.value.regime_id=i.regimes),t=="economicsector_id"&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors),t=="comercialactivity_id"&&(await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities),t=="notary_id"&&A(),t=="isbic"&&z(),t=="typecapital_id"&&(await i.fetchTypeCapital(),a.value.typecapital_id=i.typeCapital),t=="component_id"&&(await i.fetchComponents(),a.value.component_id=i.components)},U=t=>{},z=()=>{a.value.isbic=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}]},A=async()=>{try{const{data:t}=await Q({url:"public/notaries-filters",method:"GET"}),c=t.map(s=>({value:s.id,name:s.name,city:s.city.name,province:s.province.name,district:s.district.name,address:s.address}));a.value.notary_id=c}catch(t){console.error("Error de red:",t)}},M=async()=>{y.value=!0;const t={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,component_id:e.component_id,theme_id:e.theme_id,modality_id:e.modality_id,ruc:e.ruc,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,observations:e.observations,updated_by:C.user_id};try{(await V({url:`advisory/update/${m.info.id}`,method:"PUT",data:t})).status===200&&(l(),N("closeDraw",!0))}catch(c){console.error("Error:",c);const s=document.getElementsByClassName("ant-drawer-body")[0];s&&(s.scrollTop=0)}finally{y.value=!1}},l=()=>{e.economicsector_id=null,e.comercialactivity_id=null,e.component_id=null,e.theme_id=null,e.modality_id=null,e.ruc=null,e.city_id=null,e.province_id=null,e.district_id=null,e.observations=null},r=async t=>{v.value=!0;try{t&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors,e.economicsector_id=t.econimic_sector_id,await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities,e.comercialactivity_id=t.activity_comercial_id,await i.fetchComponents(),a.value.component_id=i.components,o.value.theme_id.disabled=!1,e.component_id=t.component_id,await i.fetchComponentThemes(e.component_id),a.value.theme_id=i.componentThemes,e.theme_id=t.theme_id,await i.fetchModalities(),a.value.modality_id=i.modalities,e.modality_id=t.modality_id,e.ruc=t.ruc,e.observations=t.observations,await i.fetchCities(),a.value.city_id=i.cities,e.city_id=t.city_id,await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,o.value.province_id.disabled=!1,e.province_id=t.province_id,await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,o.value.district_id.disabled=!1,e.district_id=t.district_id)}catch(c){console.error("Error al cargar la información:",c)}finally{v.value=!1}};return $(()=>{m.info&&r(m.info)}),K(()=>m.info,t=>{t&&r(t)}),k("formState",e),k("loadingState",y),(t,c)=>v.value?(E(),q(h(J),{key:0,style:{color:"#00a6db"}})):(E(),B("div",Ae,[p(ee,{fields:o.value,options:a.value,btnSaveName:D.value,onHandleInputEvent:O,resetSelect:n.value,onHandleChangeSelect:P,onHandleFocusSelect:Y,onHandleBlurSelect:U,onHandleChangeClock:R,onOnSubmit:M},null,8,["fields","options","btnSaveName","resetSelect"])]))}},Ne={key:1,class:"f-20"},Re={__name:"EditarFormalizacionRUC10",props:["info"],emits:["closeDraw"],setup(F,{emit:x}){f.locale("es");const o=d({economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},detailprocedure_id:{type:"iSelect",label:"DETALLE DEL TRÁMITE",name:"detailprocedure_id",required:!0,message:"Seleccionar el detalle del trámite",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!1},ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(l,r)=>{if(!r)return Promise.resolve();const t=r.toString();return t.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):["10","15"].includes(t.substring(0,2))?Promise.resolve():Promise.reject(new Error("El RUC debe empezar con 10 o 15"))},trigger:"change"}]},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!1,message:"Seleccionar tipo de documento",disabled:!1}}),C=JSON.parse(localStorage.getItem("profile")),N=x,m=F,v=d(!0),D=d("ACTUALIZAR"),e=W({}),y=d(!1),i=te(),n=d(null),a=d({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[],component_id:[],theme_id:[],detailprocedure_id:[]}),O=l=>{console.log("handleInputEvent",l)},R=async l=>{l=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),o.value.dateTramite.disabled=!1)},P=async l=>{l=="city_id"&&(await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,o.value.province_id.disabled=!1),l=="province_id"&&(await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,o.value.district_id.disabled=!1)},Y=async l=>{console.log("handleFocusSelect",l),l=="city_id"&&(await i.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,a.value.province_id=[],a.value.city_id=i.cities),l=="province_id"&&(e.province_id=null,e.district_id=null,a.value.district_id=[]),l=="regime_id"&&(await i.fetchRegimes(),a.value.regime_id=i.regimes),l=="economicsector_id"&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors),l=="comercialactivity_id"&&(await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities),l=="detailprocedure_id"&&(await i.fetchDetailProcedures(),a.value.detailprocedure_id=i.detailProcedures)},U=l=>{},z=async()=>{y.value=!0;const l={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,detailprocedure_id:e.detailprocedure_id,modality_id:e.modality_id,ruc:e.ruc,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,updated_by:C.user_id};try{(await V({url:`formalization/update-ruc-10/${m.info.id}`,method:"PUT",data:l})).status===200&&(A(),N("closeDraw",!0))}catch(r){console.error("Error:",r);const t=document.getElementsByClassName("ant-drawer-body")[0];t&&(t.scrollTop=0)}finally{y.value=!1}},A=()=>{e.economicsector_id=null,e.comercialactivity_id=null,e.detailprocedure_id=null,e.modality_id=null,e.ruc=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null},M=async l=>{v.value=!0;try{l&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors,e.economicsector_id=l.econimic_sector_id,await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities,e.comercialactivity_id=l.activity_comercial_id,await i.fetchDetailProcedures(),a.value.detailprocedure_id=i.detailProcedures,e.detailprocedure_id=l.detailprocedure_id,await i.fetchModalities(),a.value.modality_id=i.modalities,e.modality_id=l.modality_id,e.ruc=l.ruc,e.address=l.address,await i.fetchCities(),a.value.city_id=i.cities,e.city_id=l.city_id,await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,o.value.province_id.disabled=!1,e.province_id=l.province_id,await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,o.value.district_id.disabled=!1,e.district_id=l.district_id)}catch(r){console.error("Error al cargar la información:",r)}finally{v.value=!1}};return $(()=>{m.info&&M(m.info)}),K(()=>m.info,l=>{l&&M(l)}),k("formState",e),k("loadingState",y),(l,r)=>v.value?(E(),q(h(J),{key:0,style:{color:"#00a6db"}})):(E(),B("div",Ne,[p(ee,{fields:o.value,options:a.value,btnSaveName:D.value,onHandleInputEvent:O,resetSelect:n.value,onHandleChangeSelect:P,onHandleFocusSelect:Y,onHandleBlurSelect:U,onHandleChangeClock:R,onOnSubmit:z},null,8,["fields","options","btnSaveName","resetSelect"])]))}},xe={key:1,class:"f-20"},Me={__name:"EditarFormalizacionRUC20",props:["info"],emits:["closeDraw"],setup(F,{emit:x}){f.locale("es");const o=d({ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(t,c)=>{if(!c)return Promise.resolve();const s=c.toString();return s.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):s.startsWith("20")?Promise.resolve():Promise.reject(new Error('El número de RUC debe comenzar con "20"'))},trigger:"change"}]},nameMype:{type:"iText",label:"NOMBRE EMPRESA",name:"nameMype",required:!0,message:"Escribir nombre de la empresa",disabled:!1},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!0,message:"Escribir la dirección del negocio",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},regime_id:{type:"iSelect",label:"RÉGIMEN SOCIETARIO",name:"regime_id",required:!0,message:"Seleccionar el régimen societario",disabled:!1},economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},numbernotary:{type:"iNumber",label:"NÚM. SOLICITUD CONSTANCIA",name:"numbernotary",required:!0,message:"Escribir número de solicitud de constancia",disabled:!1,maxlength:8,rules:[{validator:(t,c)=>c?c.toString().length!==8?Promise.reject(new Error("El número debe tener exactamente 8 dígitos")):Promise.resolve():Promise.reject(new Error("El número de notaría es requerido")),trigger:"change"}]},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},notary_id:{type:"iSelectNotary",label:"NOTARÍA",name:"notary_id",required:!0,message:"Seleccionar una notaría",disabled:!1},dateReception:{type:"iDate",label:"FECHA DE RECEPCION PNTE",name:"dateReception",required:!0,disabled:!1,disabledDate:t=>!1},dateTramite:{type:"iDate",label:"FEC. TRÁMITE SID SUNARP-SUNAT",name:"dateTramite",required:!0,disabled:!1,disabledDate:t=>e.dateReception&&t&&f(t).isBefore(f(e.dateReception))},isbic:{type:"iSelect",label:"¿ES UNA SOCIEDAD BIC?",name:"isbic",required:!1,message:"Buscar BIC",disabled:!1},montocapital:{type:"iMoney",label:"MONTO DE CAPITAL SOCIAL",name:"montocapital",required:!1,message:"Escribir el Monto de capital social",disabled:!1},typecapital_id:{type:"iSelect",label:"TIPO DE APORTE DE CAPITAL",name:"typecapital_id",required:!1,message:"Seleccionar BIC",disabled:!1}}),C=JSON.parse(localStorage.getItem("profile")),N=x,m=F,v=d(!0),D=d("REGISTRAR"),e=W({}),y=d(!1),i=te(),n=d(null),a=d({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[]}),O=t=>{console.log("handleInputEvent",t)},R=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),o.value.dateTramite.disabled=!1)},P=async t=>{t=="city_id"&&(await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,o.value.province_id.disabled=!1),t=="province_id"&&(await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,o.value.district_id.disabled=!1)},Y=async t=>{console.log("handleFocusSelect",t),t=="city_id"&&(await i.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,a.value.province_id=[],a.value.city_id=i.cities),t=="province_id"&&(e.province_id=null,e.district_id=null,a.value.district_id=[]),t=="modality_id"&&(await i.fetchModalities(),a.value.modality_id=i.modalities),t=="regime_id"&&(await i.fetchRegimes(),a.value.regime_id=i.regimes),t=="economicsector_id"&&(await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors),t=="comercialactivity_id"&&(await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities),t=="notary_id"&&A(),t=="isbic"&&z(),t=="typecapital_id"&&(await i.fetchTypeCapital(),a.value.typecapital_id=i.typeCapital)},U=t=>{},z=()=>{a.value.isbic=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}]},A=async()=>{try{const{data:t}=await Q({url:"public/notaries-filters",method:"GET"}),c=t.map(s=>({value:s.id,name:s.name,city:s.city.name,province:s.province.name,district:s.district.name,address:s.address}));a.value.notary_id=c}catch(t){console.error("Error de red:",t)}},M=async()=>{y.value=!0;const t={ruc:e.ruc,nameMype:e.nameMype,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,modality_id:e.modality_id,regime_id:e.regime_id,economicsector_id:e.economicsector_id,numbernotary:e.numbernotary,comercialactivity_id:e.comercialactivity_id,notary_id:e.notary_id,dateReception:f(e.dateReception).format("YYYY-MM-DD"),dateTramite:f(e.dateTramite).format("YYYY-MM-DD"),isbic:e.isbic,montocapital:e.montocapital,typecapital_id:e.typecapital_id,user_id:e.user_id,people_id:e.people_id,dni:e.dni,userupdated_id:C.user_id};try{(await V({url:`formalization/update-ruc-20/${m.info.id}`,method:"PUT",data:t})).status===200&&(l(),N("closeDraw",!0))}catch(c){console.error("Error:",c);const s=document.getElementsByClassName("ant-drawer-body")[0];s&&(s.scrollTop=0)}finally{y.value=!1}},l=()=>{e.ruc=null,e.nameMype=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.modality_id=null,e.regime_id=null,e.economicsector_id=null,e.numbernotary=null,e.comercialactivity_id=null,e.notary_id=null,e.dateReception=null,e.dateTramite=null,e.isbic=null,e.montocapital=null,e.typecapital_id=null},r=async t=>{v.value=!0;try{t&&(e.ruc=t.ruc,e.nameMype=t.name_mype,await i.fetchCities(),a.value.city_id=i.cities,e.city_id=t.city_id,await i.fetchProvinces(e.city_id),a.value.province_id=i.provinces,o.value.province_id.disabled=!1,e.province_id=t.province_id,await i.fetchDistricts(e.province_id),a.value.district_id=i.districts,o.value.district_id.disabled=!1,e.district_id=t.district_id,e.address=t.address,await i.fetchModalities(),a.value.modality_id=i.modalities,e.modality_id=t.modality_id,await i.fetchRegimes(),a.value.regime_id=i.regimes,e.regime_id=t.regime_id,await i.fetchEconomicSectors(),a.value.economicsector_id=i.economicSectors,e.economicsector_id=t.econimic_sector_id,e.numbernotary=t.num_solicitud,await i.fetchComercialActivities(),a.value.comercialactivity_id=i.comercialActivities,e.comercialactivity_id=t.activity_comercial_id,A(),e.notary_id=t.notary_id,e.dateReception=t.date_reception?f(t.date_reception,"DD/MM/YYYY"):null,e.dateTramite=t.date_tramite?f(t.date_tramite,"DD/MM/YYYY"):null,e.isbic=t.bic,e.montocapital=t.monto_capital,await i.fetchTypeCapital(),a.value.typecapital_id=i.typeCapital,e.typecapital_id=t.typecapital_id)}catch(c){console.error("Error al cargar la información:",c)}finally{v.value=!1}};return $(()=>{m.info&&r(m.info)}),K(()=>m.info,t=>{t&&r(t)}),k("formState",e),k("loadingState",y),(t,c)=>v.value?(E(),q(h(J),{key:0,style:{color:"#00a6db"}})):(E(),B("div",xe,[p(ee,{fields:o.value,options:a.value,btnSaveName:D.value,onHandleInputEvent:O,resetSelect:n.value,onHandleChangeSelect:P,onHandleFocusSelect:Y,onHandleBlurSelect:U,onHandleChangeClock:R,onOnSubmit:M},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const Le={class:"advisory-table"},Pe=["onClick"],Ge={__name:"AsesoriasLista",setup(F){JSON.parse(localStorage.getItem("role"));const x=d([]),o=d(0),C=d(150),N=d(!1),m=d(!1),v=d("Asesorías"),D=d(!1),e=d(!1),y=d(!1),i=d(null),n=W({year:f("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1}),a=d([]),O=d([]),R=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:80},{title:"FECHA",fixed:"left",dataIndex:"date",width:100,align:"center"},{title:"ASESOR",dataIndex:"asesor",width:200},{title:"SOLICITANTE APELLIDO PATERNO",dataIndex:"emp_lastname",width:150},{title:"SOLICITANTE APELLIDO MATERNO",dataIndex:"emp_middlename",width:150},{title:"SOLICITANTE NONBRE",dataIndex:"emp_name",width:150},{title:"TIPO DOCUMENTO",dataIndex:"emp_document_type",width:100,align:"center"},{title:"NÚMERO DE DOCUMENTO",dataIndex:"emp_document_number",align:"center",width:140},{title:"PAÍS",dataIndex:"emp_country",align:"center",width:120},{title:"FEC. NAC",dataIndex:"emp_birth",align:"center",width:120},{title:"EDAD",dataIndex:"emp_age",align:"center",width:80},{title:"GÉNERO",dataIndex:"emp_gender",width:80,align:"center"},{title:"DISCAPACIDAD",dataIndex:"emp_discapabilities",width:120,align:"center"},{title:"HIJOS",dataIndex:"emp_soons",width:80,align:"center"},{title:"CELULAR",dataIndex:"emp_phone",width:120,align:"center"},{title:"EMAIL",dataIndex:"emp_email",width:200},{title:"CIUDAD",dataIndex:"city",width:120,align:"center"},{title:"PROVINCIA",dataIndex:"province",width:140,align:"center"},{title:"DISTRITO",dataIndex:"district",width:140,align:"center"},{title:"RUC",dataIndex:"ruc",width:120,align:"center"}],P=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_service",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"COMPONENTE",dataIndex:"component",width:140,align:"center"},{title:"TEMA",dataIndex:"theme",width:200},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"OBSERVACIONES",dataIndex:"observations",width:200},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],Y=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"DETALLE DEL TRÁMITE",dataIndex:"detail_tramit",width:180},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],U=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"FECHA DE RECEPCIÓN",dataIndex:"date_reception",width:160,align:"center"},{title:"FECHA DE TRÁMITE",dataIndex:"date_tramite",width:160,align:"center"},{title:"TIPO DE RÉGIMEN",dataIndex:"type_regimen",width:150,align:"center"},{title:"BIC",dataIndex:"bic",width:50,align:"center"},{title:"NÚMERO DE SOLICITUD",dataIndex:"num_solicitud",width:160,align:"center"},{title:"NOTARÍA",dataIndex:"notaria",width:200},{title:"TIPO DE APORTE",dataIndex:"type_aporte",width:160,align:"center"},{title:"MONTO CAPITAL",dataIndex:"monto_capital",width:160,align:"center"},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],z=()=>{console.log("handleNew...")},A=async()=>{m.value=!0;try{const u={paginate:!1};n.year&&(u.year=f(n.year).format("YYYY")),n.range&&(u.dateStart=n.range[0].format("YYYY/MM/DD"),u.dateEnd=n.range[1].format("YYYY/MM/DD")),n.asesor&&(u.asesor=n.asesor),n.name&&(u.name=n.name);let _=null,T=null,L=null;n.type==1&&(_="historial/advisories/filters",T="download/asesories",L="Asesorías"),n.type==2&&(_="historial/formalizations-10/filters",T="download/formalizations-ruc10",L="Formalizaciones 10"),n.type==3&&(_="historial/formalizations-20/filters",T="download/formalizations-ruc20",L="Formalizaciones 20");const j=(await V({url:_,method:"GET",params:u})).data;await ve(T,L,j)}catch(u){console.error("Error de red:",u)}finally{m.value=!1}},M=async u=>{n.page=u,await c()},l=async u=>{u&&(n.page=1,await c())},r=u=>{i.value=u,n.type==1&&(D.value=!0),n.type==2&&(e.value=!0),n.type==3&&(y.value=!0)},t=()=>{n.type==1&&(O.value=[...R,...P],v.value="Asesorias"),n.type==2&&(O.value=[...R,...Y],v.value="Formalizaciones RUC 10"),n.type==3&&(O.value=[...R,...U],v.value="Formalizaciones RUC 20")},c=async()=>{N.value=!0,t();try{const u={page:n.page};n.year&&(u.year=f(n.year).format("YYYY")),n.range&&(u.dateStart=n.range[0].format("YYYY/MM/DD"),u.dateEnd=n.range[1].format("YYYY/MM/DD")),n.asesor&&(u.asesor=n.asesor),n.name&&(u.name=n.name);let _=null;n.type==1&&(_="historial/advisories/filters"),n.type==2&&(_="historial/formalizations-10/filters"),n.type==3&&(_="historial/formalizations-20/filters");const T=await V({url:_,method:"GET",params:u});x.value=T.data.data,o.value=T.data.total,C.value=T.data.per_page}catch(u){console.error("Error de red:",u)}finally{N.value=!1}},s=async()=>{try{const u=await Q({url:"select/asesores-report",method:"GET"});u.status==200&&(a.value=u.data)}catch{console.log("Failed to delete")}};return $(async()=>{await c(),await s()}),k("search",n),k("loading",N),k("loadingFile",m),(u,_)=>{const T=b("a-menu-item"),L=b("a-drawer");return E(),B("div",Le,[p(Oe,{title:`REPORTE GENERAL - ${v.value}`,new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",tipoformalizacion:!0,columns:O.value,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:C.value,nameTotal:v.value,asesoresList:a.value,dataSource:x.value,total:o.value,onHandleNew:z,onHandleDownloadExcel:A,onHandleSearch:l,onHandlePaginator:M},{"custom-options":S(({record:I})=>[p(T,null,{default:S(()=>[g("a",{onClick:j=>r(I)},"Editar",8,Pe)]),_:2},1024)]),_:1},8,["title","columns","pageSize","nameTotal","asesoresList","dataSource","total"]),p(L,{width:"500",title:"EDITAR ASESORÍA",open:D.value,"onUpdate:open":_[1]||(_[1]=I=>D.value=I),placement:"right"},{default:S(()=>[p(Te,{info:i.value,onCloseDraw:_[0]||(_[0]=I=>(D.value=!1,c()))},null,8,["info"])]),_:1},8,["open"]),p(L,{width:"550",title:"Editar Formalización RUC 10",open:e.value,"onUpdate:open":_[3]||(_[3]=I=>e.value=I),placement:"right"},{default:S(()=>[p(Re,{info:i.value,onCloseDraw:_[2]||(_[2]=I=>(e.value=!1,c()))},null,8,["info"])]),_:1},8,["open"]),p(L,{width:"550",title:"Editar Formalización RUC 20",open:y.value,"onUpdate:open":_[5]||(_[5]=I=>y.value=I),placement:"right"},{default:S(()=>[p(Me,{info:i.value,onCloseDraw:_[4]||(_[4]=I=>(y.value=!1,c()))},null,8,["info"])]),_:1},8,["open"])])}}};export{Ge as default};
