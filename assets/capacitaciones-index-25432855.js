import{_ as Q}from"./TableComponent-c89fcc82.js";import{p as c,r as s,a as L,k as B,X as I,o as _,y as A,i as $,L as z,d as M,c as u,m as Y,h as N,U as W,b as x,w as d,e as D,t as k,z as q,F as G,x as Z,j as E}from"./index-2c1d98b1.js";import{_ as X}from"./FormComponent-6fc03bc7.js";import{u as j}from"./selectes-8e7f3aac.js";import"./es-d9bd4dcd.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-39110c8e.js";import"./quill.snow-eb3ad49c.js";const ee={key:1,class:"register-training"},ae={__name:"RegistroCapacitaciones",emits:["closeDraw"],setup(P,{emit:h}){c.locale("es");const C=h,b=s(!0),y=s("REGISTRAR"),i=L({}),a=s(!1),o=j(),n=s(null),m=s({meta_id:[],especialista_id:[],dimension_id:[],modalidad:[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}]}),p=l=>{console.log("handleInputEvent",l)},w=async l=>{l=="dateReception"&&(i.dateTramite&&(i.dateTramite=null),S.value.dateTramite.disabled=!1)},R=async(l,t)=>{if(l==="meta_id"){S.value.fecha.allowedMonth=null,i.fecha=null;let e=m.value.meta_id.find(r=>r.value==t);console.log("meta",e),S.value.fecha.allowedMonth=e.label}},O=async l=>{l=="meta_id"&&(m.value.meta_id=o.trainingMetas),l=="especialista_id"&&(m.value.especialista_id=o.trainingSpecialist),l=="dimension_id"&&(m.value.dimension_id=o.trainingDimensions)},H=async()=>{a.value=!0;const l={meta_id:i.meta_id,especialista_id:i.especialista_id,fecha:c(i.fecha).format("YYYY-MM-DD"),horaInicio:c(i.horaInicio).format("HH:mm"),horaFin:c(i.horaFin).format("HH:mm"),dimension_id:i.dimension_id,modalidad:i.modalidad,tema:i.tema,lugar:i.lugar,participantes:i.participantes,empresas:i.empresas,coordinador:i.coordinador,observaciones:i.observaciones,estado:1};try{const t=await Y({url:"training/register-training",method:"POST",data:l});t.status===200&&(N.success(t.message),F(),C("closeDraw",!0))}catch(t){t.response&&t.response.data&&t.response.data.message?N.error(t.response.data.message):N.error("Ocurrió un error inesperado.");const e=document.getElementsByClassName("ant-drawer-body")[0];e&&(e.scrollTop=0)}finally{a.value=!1}},F=()=>{i.meta_id=null,i.especialista_id=null,i.fecha=null,i.horaInicio=null,i.horaFin=null,i.dimension_id=null,i.modalidad=null,i.tema=null,i.lugar=null,i.participantes=null,i.empresas=null,i.coordinador=null,i.observaciones=null},S=s({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDateRangeDisabled",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1,allowedMonth:null},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÓN",name:"dimension_id",required:!0,message:"Seleccionar dimensión",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return B(async()=>{await o.fetchTrainingMetas(),await o.fetchTrainingSpecialist(),await o.fetchTrainingDimensions(),m.value.meta_id=o.trainingMetas,m.value.especialista_id=o.trainingSpecialist,m.value.dimension_id=o.trainingDimensions,b.value=!1}),I("formState",i),I("loadingState",a),(l,t)=>b.value?(_(),A($(z),{key:0,style:{color:"#00a6db"}})):(_(),M("div",ee,[u(X,{fields:S.value,options:m.value,btnSaveName:y.value,onHandleInputEvent:p,resetSelect:n.value,onHandleChangeSelect:R,onHandleFocusSelect:O,onHandleChangeClock:w,onOnSubmit:H,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const ie={key:1,class:"register-training"},te={__name:"EditarCapacitaciones",props:["info"],emits:["closeDraw"],setup(P,{emit:h}){c.locale("es");const C=h,b=P,y=s(!0),i=s("REGISTRAR"),a=L({}),o=s(!1),n=j(),m=s(null),p=s({meta_id:[],especialista_id:[],dimension_id:[],modalidad:[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}]}),w=e=>{console.log("handleInputEvent",e)},R=async e=>{e=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),t.value.dateTramite.disabled=!1)},O=async(e,r)=>{if(e==="meta_id"){t.value.fecha.allowedMonth=null,a.fecha=null;let v=p.value.meta_id.find(T=>T.value==r);console.log("meta",v),t.value.fecha.allowedMonth=v.label}},H=async e=>{e=="meta_id"&&(p.value.meta_id=n.trainingMetas),e=="especialista_id"&&(p.value.especialista_id=n.trainingSpecialist),e=="dimension_id"&&(p.value.dimension_id=n.trainingDimensions)},F=async()=>{o.value=!0;const e={meta_id:a.meta_id,especialista_id:a.especialista_id,fecha:c(a.fecha).format("YYYY-MM-DD"),horaInicio:c(a.horaInicio).format("HH:mm"),horaFin:c(a.horaFin).format("HH:mm"),dimension_id:a.dimension_id,modalidad:a.modalidad,tema:a.tema,lugar:a.lugar,participantes:a.participantes,empresas:a.empresas,coordinador:a.coordinador,observaciones:a.observaciones,estado:a.estado};try{const r=await Y({url:`training/update-training/${b.info.id}`,method:"PUT",data:e});r.status===200&&(N.success(r.message),S(),C("closeDraw",!0))}catch(r){r.response&&r.response.data&&r.response.data.message?N.error(r.response.data.message):N.error("Ocurrió un error inesperado.");const v=document.getElementsByClassName("ant-drawer-body")[0];v&&(v.scrollTop=0)}finally{o.value=!1}},S=()=>{a.meta_id=null,a.especialista_id=null,a.fecha=null,a.horaInicio=null,a.horaFin=null,a.dimension_id=null,a.modalidad=null,a.tema=null,a.lugar=null,a.participantes=null,a.empresas=null,a.coordinador=null,a.observaciones=null},l=async e=>{e&&(a.meta_id=e.meta_id,a.especialista_id=e.especialista_id,a.dimension_id=e.dimension_id,a.modalidad=e.modalidad,a.tema=e.tema,a.lugar=e.lugar,a.participantes=e.participantes,a.empresas=e.empresas,a.coordinador=e.coordinador,a.observaciones=e.observaciones,a.fecha=c(e.fecha,"YYYY-MM-DD"),a.horaInicio=c(e.horaInicio,"HH:mm"),a.horaFin=c(e.horaFin,"HH:mm"),a.estado=e.estado)},t=s({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDateRangeDisabled",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1,allowedMonth:null},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÓN",name:"dimension_id",required:!0,message:"Seleccionar dimensión",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return B(async()=>{b.info&&l(b.info),await n.fetchTrainingMetas(),await n.fetchTrainingSpecialist(),await n.fetchTrainingDimensions(),p.value.meta_id=n.trainingMetas,p.value.especialista_id=n.trainingSpecialist,p.value.dimension_id=n.trainingDimensions,y.value=!1}),W(()=>b.info,e=>{e?l(e):S()}),I("formState",a),I("loadingState",o),(e,r)=>y.value?(_(),A($(z),{key:0,style:{color:"#00a6db"}})):(_(),M("div",ie,[u(X,{fields:t.value,options:p.value,btnSaveName:i.value,onHandleInputEvent:w,resetSelect:m.value,onHandleChangeSelect:O,onHandleFocusSelect:H,onHandleChangeClock:R,onOnSubmit:F,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const ne={class:"layout-content"},le={key:0,style:{display:"flex","flex-direction":"column"}},se=["onClick"],ge={__name:"capacitaciones-index",setup(P){const h=s(!1),C=s([]),b=s(0),y=s(100),i=s(!1),a=s(!1),o=s(null),n=L({asesor:null,month:c(),page:1}),m=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"Fecha/Hora",fixed:"left",dataIndex:"horario",align:"center",width:120},{title:"Especialista",dataIndex:"especialista",width:160},{title:"Tema",dataIndex:"tema",width:170},{title:"Modalidad",dataIndex:"modalidadText",width:120,align:"center"},{title:"Participantes",dataIndex:"participantes",align:"center",width:140},{title:"Estado",dataIndex:"estado",align:"center",width:140},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],p=()=>{o.value=null,h.value=!0},w=async()=>{o.value=null,h.value=!1,await l()},R=async()=>{a.value=!0},O=async t=>{n.page=t,await l()},H=async t=>{t&&(n.page=1,await l())},F=t=>{o.value=t,h.value=!0},S=async(t,e)=>{try{const r={estado:e},v=await Y({url:`training/update-training-status/${t}`,method:"PUT",data:r});console.log("response",v)}catch(r){console.error("Error de red:",r)}},l=async()=>{i.value=!0;try{const t={page:n.page};n.year&&(t.year=c(n.year).format("YYYY")),n.asesor&&(t.asesor=n.asesor),n.name&&(t.name=n.name);const e=await Y({url:"training/list-trainings",method:"GET"});e.status==200&&(C.value=e.data.data,b.value=e.data.total,y.value=e.data.per_page)}catch(t){console.error("Error de red:",t)}finally{i.value=!1}};return B(async()=>{await l()}),I("search",n),I("loading",i),I("loadingFile",a),(t,e)=>{const r=x("a-date-picker"),v=x("a-tag"),T=x("a-select-option"),J=x("a-select"),K=x("a-menu-item"),V=x("a-drawer");return _(),M("div",ne,[u(Q,{title:"CAPACITACIONES UGSE",new:!0,textNuevo:"NUEVO",columns:m,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:y.value,nameTotal:"Capacitaciones",dataSource:C.value,total:b.value,onHandleNew:p,onHandleDownloadExcel:R,onHandleSearch:H,onHandlePaginator:O},{header:d(()=>[D("div",null,[u(r,{value:n.month,"onUpdate:value":e[0]||(e[0]=f=>n.month=f),picker:"month"},null,8,["value"])])]),"data-cell":d(({column:f,record:g})=>[f.dataIndex=="horario"?(_(),M("div",le,[D("b",null,k($(c)(g.fecha).format("DD/MM/YYYY")),1),D("span",null,k(g.horaInicio)+" - "+k(g.horaFin),1)])):q("",!0),f.dataIndex=="especialista"?(_(),M(G,{key:1},[D("span",{class:"dot-specialist",style:Z(`background-color: ${g.colorEspecialista};`)},null,4),D("span",null,k(g.especialista),1)],64)):q("",!0),f.dataIndex=="modalidadText"?(_(),M(G,{key:2},[g.modalidad==1?(_(),A(v,{key:0,color:"blue"},{default:d(()=>e[3]||(e[3]=[E(" Presencial ")])),_:1})):g.modalidad==2?(_(),A(v,{key:1,color:"green"},{default:d(()=>e[4]||(e[4]=[E(" Virtual ")])),_:1})):g.modalidad==3?(_(),A(v,{key:2,color:"orange"},{default:d(()=>e[5]||(e[5]=[E(" Mixto ")])),_:1})):q("",!0)],64)):q("",!0),f.dataIndex=="estado"?(_(),A(J,{key:3,value:g.estado,"onUpdate:value":U=>g.estado=U,style:{width:"150px"},placeholder:"Seleccione estado",onChange:U=>S(g.id,U)},{default:d(()=>[u(T,{value:1},{default:d(()=>e[6]||(e[6]=[E("📅 Programada")])),_:1}),u(T,{value:2},{default:d(()=>e[7]||(e[7]=[E("⏳ En curso")])),_:1}),u(T,{value:3},{default:d(()=>e[8]||(e[8]=[E("✅ Completado")])),_:1}),u(T,{value:4},{default:d(()=>e[9]||(e[9]=[E("❌ Cancelado")])),_:1})]),_:2},1032,["value","onUpdate:value","onChange"])):q("",!0)]),"custom-options":d(({record:f})=>[u(K,null,{default:d(()=>[D("a",{onClick:g=>F(f)},"Editar",8,se)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),u(V,{width:"500",title:"Registro de Capacitaciones",open:h.value,"onUpdate:open":e[1]||(e[1]=f=>h.value=f),placement:"right"},{default:d(()=>[u(ae,{onCloseDraw:w})]),_:1},8,["open"]),u(V,{width:"500",title:"Editar capacitación",open:h.value,"onUpdate:open":e[2]||(e[2]=f=>h.value=f),placement:"right"},{default:d(()=>[u(te,{info:o.value,onCloseDraw:w},null,8,["info"])]),_:1},8,["open"])])}}};export{ge as default};
