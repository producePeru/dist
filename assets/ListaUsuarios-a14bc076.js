import{r as o,j as $,a as q,X as B,R as N,b as t,o as _,d as y,c as e,w as n,e as u,i as g,F as A,m as L,G as oe,t as x,y as k,x as re,O as ue,q as ce,h as de}from"./index-735c7ce9.js";import"./es-0a4e9cad.js";import{M as pe}from"./MoreOutlined-696528f1.js";const ve={__name:"DrawAdministrarVistasUsuario",props:["idUser"],emits:["closeDraw"],setup(O,{emit:U}){const d=O,b=U,p=o(!0),f=o(!1),v=[{label:"Inicio",value:"inicio"},{label:"Drive Principal",value:"drive"},{label:"Drive Carpetas",value:"drive-mis-carpetas"},{label:"Drive Archivos",value:"drive-mis-archivos"},{label:"Drive Subir Archivo",value:"drive-subir-archivo"},{label:"formalizaciones - Principal",value:"asesorias"},{label:"AF - Registro",value:"asesorias-formalizaciones"},{label:"AF - Reportes",value:"asesorias-listado"},{label:"AF - Solicitantes",value:"solicitantes"},{label:"AF - Notarias",value:"notarias"},{label:"RUTA DIGITAL UGO PRINCIPAL",value:"ruta-digital-principal"},{label:"Registro de Ruta Digital UGO",value:"ruta-digital-registro"},{label:"PLANES DE ACCIÓN",value:"planes-accion-principal"},{label:"Registro Planes de Acción UGO",value:"planes-accion"},{label:"Convenios Principal",value:"convenios"},{label:"Convenios UGO",value:"estado-convenio-ugo"},{label:"Convenios UGSE",value:"estado-convenio-ugse"},{label:"Ferias Principal",value:"ferias"},{label:"Ferias Empresariales",value:"ferias-empresariales"},{label:"Ferias Participantes",value:"ferias-inscritos"},{label:"Asistencias Principal",value:"asistencia"},{label:"Asistencias UGO Listas",value:"asistencia-lista"},{label:"Asistencias UGO Usuarios",value:"asistencia-inscritos"},{label:"Calendario Principal",value:"calendario"},{label:"Eventos PNTE",value:"calendario-eventos"},{label:"Reserva de sala",value:"calendario-salas"},{label:"USUARIOS PRINCIPAL",value:"usuarios"},{label:"Nuevo usuario",value:"usuarios-nuevo"},{label:"Asesor - Notario",value:"asesor-externo-notario"},{label:"Lista usuarios",value:"usuarios-lista"},{label:"Asesores",value:"asesores"},{label:"Creación de usuarios",value:"nuevo-registro"},{label:"Config. Principal",value:"configuraciones"},{label:"Config. Token API",value:"tokens"},{label:"CDEs",value:"cdes"},{label:"Correos Masivos",value:"correos-masivos"},{label:"SED Principal",value:"sed"},{label:"SED MYPE",value:"sed-listado"},{label:"PP03 Principal",value:"pp03"},{label:"PP03 Listado",value:"pp03-listado"}];$(()=>{d.idUser&&P(d.idUser)});const r=q({indeterminate:!0,checkAll:!1,checkedList:[]});B(()=>r.checkedList,s=>{r.indeterminate=!!s.length&&s.length<v.length,r.checkAll=s.length===v.length}),B(()=>d.idUser,s=>{s&&P()});const h=async()=>{f.value=!0;const s={views:r.checkedList};try{const l=await N({url:`user/views/${d.idUser.id}`,method:"PUT",data:s});if(l.status==403)return L.error(l.message);L.success(l.message),b("closeDraw",!0)}catch{L.error("No se pudo registrar este usuario")}finally{f.value=!1}},P=async()=>{p.value=!0;try{const{data:s}=await N({url:`user/views/${d.idUser.id}`,method:"GET"});r.checkedList=s}catch(s){console.log("Error",s)}finally{p.value=!1}};return(s,l)=>{const E=t("a-checkbox-group"),D=t("a-spin"),m=t("a-button");return _(),y(A,null,[e(D,{spinning:p.value},{default:n(()=>[e(E,{value:r.checkedList,"onUpdate:value":l[0]||(l[0]=R=>r.checkedList=R),options:v,class:"views-list"},null,8,["value"])]),_:1},8,["spinning"]),l[2]||(l[2]=u("br",null,null,-1)),l[3]||(l[3]=u("br",null,null,-1)),e(m,{type:"primary","html-type":"submit",loading:f.value,onClick:h},{default:n(()=>l[1]||(l[1]=[g("GUARDAR")])),_:1},8,["loading"])],64)}}};const me=["onClick"],_e=["onClick"],ge={class:"paginator"},we={__name:"ListaUsuarios",setup(O){const U=o(null),d=o(!1),b=o(!1),p=o(50),f=o([]),v=o(!1),r=o(0),h=o({page:1}),P=o("user/list"),s=o(1200),l=o(window.innerHeight-100),E=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"DNI",dataIndex:"documentnumber",fixed:"left",width:80},{title:"Nombres",dataIndex:"name",width:120},{title:"Apellidos",dataIndex:"lastname",width:120},{title:"Correo",dataIndex:"email",width:200},{title:"Celular",dataIndex:"phone",width:100,align:"center"},{title:"Fecha Nac.",dataIndex:"birthday",width:100,align:"center"},{title:"Oficina",dataIndex:"office",width:120,align:"center"},{title:"CDE",dataIndex:"cde",width:140},{title:"ROL",dataIndex:"role",width:160},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],D=()=>{l.value=window.innerHeight-300},m=q({search:""}),R=()=>{let i={search:m.search};C(i)},H=()=>{m.search||C()},X=()=>{C(),d.value=!1,b.value=!1},Y=i=>{h.value.page=i,C()},j=i=>{U.value=i,d.value=!0},J=i=>{U.value=i,b.value=!0},C=async i=>{try{v.value=!0;const a=h.value.page===1?"":h.value,S=i?{...a,...i}:a,{data:I}=await N({url:P.value,method:"GET",params:S});f.value=I.data,r.value=I.total,p.value=I.per_page}catch(a){console.error("Error de red:",a)}finally{v.value=!1}},K=oe(()=>i=>(h.value.page-1)*p.value+i+1);return $(()=>{C(),window.addEventListener("resize",D),D()}),(i,a)=>{const S=t("a-col"),I=t("a-input"),G=t("a-button"),Q=t("a-input-group"),W=t("a-row"),z=t("a-menu-item"),Z=t("a-menu"),ee=t("a-dropdown"),ae=t("a-table"),le=t("a-tag"),te=t("a-pagination"),se=t("a-drawer");return _(),y(A,null,[u("div",null,[a[4]||(a[4]=u("h3",{class:"title-produce"},"USUARIOS DEL PROGRAMA PNTE",-1)),e(W,{style:{margin:"1rem 0"}},{default:n(()=>[e(S,{xs:24,md:12,lg:18}),e(S,{xs:24,md:12,lg:6},{default:n(()=>[e(Q,{compact:""},{default:n(()=>[e(I,{value:m.search,"onUpdate:value":a[0]||(a[0]=c=>m.search=c),style:{width:"calc(100% - 80px)"},onInput:H},null,8,["value"]),e(G,{type:"primary",disabled:m.search==="",onClick:R},{default:n(()=>a[3]||(a[3]=[g("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),e(ae,{bordered:"",scroll:{x:s.value,y:l.value},class:"table-users",columns:E,"data-source":f.value,pagination:!1,loading:v.value,size:"small"},{bodyCell:n(({column:c,record:w,index:ne})=>{var F,T,V,M;return[c.dataIndex==="idx"?(_(),y(A,{key:0},[g(x(K.value(ne)),1)],64)):k("",!0),c.dataIndex=="documentnumber"?(_(),y(A,{key:1},[g(x((F=w.profile)==null?void 0:F.documentnumber),1)],64)):k("",!0),c.dataIndex=="name"?(_(),y(A,{key:2},[g(x((T=w.profile)==null?void 0:T.name),1)],64)):k("",!0),c.dataIndex=="lastname"?(_(),y(A,{key:3},[g(x((V=w.profile)==null?void 0:V.lastname)+" "+x((M=w.profile)==null?void 0:M.middlename),1)],64)):k("",!0),c.dataIndex=="actions"?(_(),re(ee,{key:4,trigger:["click"]},{overlay:n(()=>[e(Z,null,{default:n(()=>[e(z,null,{default:n(()=>[u("a",{onClick:ie=>j(w)},"Editar",8,me)]),_:2},1024),e(z,null,{default:n(()=>[u("a",{onClick:ie=>J(w)},"Vistas",8,_e)]),_:2},1024)]),_:2},1024)]),default:n(()=>[u("a",{class:"ant-dropdown-link",onClick:a[1]||(a[1]=ue(()=>{},["prevent"]))},[e(G,{shape:"circle",icon:ce(de(pe)),size:"small"},null,8,["icon"])])]),_:2},1024)):k("",!0)]}),_:1},8,["scroll","data-source","loading"])]),u("div",ge,[u("span",null,[e(le,{color:"blue"},{default:n(()=>[u("b",null,x(r.value),1)]),_:1}),a[5]||(a[5]=g("Usuarios"))]),e(te,{size:"small",total:r.value,pageSize:p.value,onChange:Y,showSizeChanger:!1},null,8,["total","pageSize"])]),e(se,{width:"450",open:b.value,"onUpdate:open":a[2]||(a[2]=c=>b.value=c),class:"draw-notary",title:"ADMINISTRAR VISTAS",placement:"right"},{default:n(()=>[e(ve,{idUser:U.value,onCloseDraw:X},null,8,["idUser"])]),_:1},8,["open"])],64)}}};export{we as default};
