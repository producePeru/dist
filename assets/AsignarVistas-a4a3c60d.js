import{_ as P}from"./FormComponent-70ed3df0.js";import{p as N,r as c,a as E,X as _,o as d,d as O,e as R,t as A,c as T,m as I,h as v,k as z,U as B,b as D,w as G,y as u,z as h}from"./index-2f7da517.js";import"./es-2d2adb5a.js";import{_ as L}from"./TableComponent-e63875b8.js";const M={class:"password-pnte"},$={style:{color:"#00a6db"}},Z={__name:"CambiarContrasena",props:["info"],emits:["closeDraw"],setup(g,{emit:U}){N.locale("es");const r=U,k=g,w=c({password:{type:"iText",label:"CONTRASEÑA",name:"password",required:!0,message:"Ingrese la nueva contraseña",disabled:!1}}),y=c("CAMBIAR"),p=E({}),m=c(!1),S=c(null),C=async()=>{m.value=!0;const x={id:k.info.id,password:p.password};try{const t=await I({url:"user/change-password",method:"POST",data:x});t.status===200&&(v.success(t.message),b(),r("closeDraw",!0))}catch(t){t.response&&t.response.data&&t.response.data.message?v.error(t.response.data.message):v.error("Ocurrió un error inesperado.");const l=document.getElementsByClassName("ant-drawer-body")[0];l&&(l.scrollTop=0)}finally{m.value=!1}},b=()=>{p.password=null};return _("formState",p),_("loadingState",m),(x,t)=>{var l,n,i;return d(),O("div",M,[R("h4",$,A((l=g.info)==null?void 0:l.name)+" "+A((n=g.info)==null?void 0:n.lastname)+" "+A((i=g.info)==null?void 0:i.middlename),1),t[0]||(t[0]=R("br",null,null,-1)),T(P,{fields:w.value,btnSaveName:y.value,resetSelect:S.value,onOnSubmit:C},null,8,["fields","btnSaveName","resetSelect"])])}}},F={class:"advisory-table"},j={__name:"AsignarVistas",props:["info","typeOffice"],emits:["closeDraw"],setup(g,{emit:U}){const r=g,k=c([]),w=c(0),y=c(150),p=c(!1),m=c(!1),S=c([]),C=E({year:N("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),b=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:10},{title:"NOMBRE PÁGINA",dataIndex:"name",fixed:"left",width:50},{title:"ASIGNAR",dataIndex:"asignar",width:20,align:"center"},{title:"CREAR",dataIndex:"crear",width:20,align:"center"},{title:"ACTUALIZAR",dataIndex:"actualizar",width:20,align:"center"},{title:"ELIMINAR",dataIndex:"eliminar",width:20,align:"center"},{title:"DESCARGAR",dataIndex:"descargar",width:20,align:"center"},{title:"FINALIZAR",dataIndex:"finalizar",width:20,align:"center"},{title:"IMPORTAR",dataIndex:"importar",width:20,align:"center"}],x=async n=>{C.page=n,await l()},t=async(n,i,s)=>{const o={user_id:r.info.id,page_id:s.id,type:n,value:i.target.checked};try{const a=await I({url:"page/user-assign-view",method:"PUT",data:o});console.log(":)",a.message)}catch(a){a.response&&a.response.data&&a.response.data.message?v.error(a.response.data.message):v.error("Ocurrió un error inesperado.");const e=document.getElementsByClassName("ant-drawer-body")[0];e&&(e.scrollTop=0)}},l=async()=>{try{p.value=!0;let n=null;r.typeOffice=="UGO"&&(n="page/list-ugo"),r.typeOffice=="ALL"&&(n="page/list-all");const[i,s]=await Promise.all([I({url:n,method:"GET"}),I({url:`page/views-to-user/${r.info.id}`,method:"GET"})]),o=i.data.data,a=s.data,e={};a.forEach(f=>{e[f.slug]=f.pivot}),k.value=o.map(f=>({...f,pivot:e[f.slug]||{can_create:!1,can_update:!1,can_delete:!1,can_download:!1,can_finish:!1,can_import:!1}})),w.value=i.data.total,y.value=i.data.per_page}catch(n){console.error("Error al obtener datos:",n)}finally{p.value=!1}};return z(async()=>{r.info&&l()}),B(()=>r.info,n=>{n?l():S.value=[]}),_("search",C),_("loading",p),_("loadingFile",m),(n,i)=>{const s=D("a-checkbox");return d(),O("div",F,[T(L,{nameTotal:"Páginas disponibles",columns:b,pageSize:y.value,dataSource:k.value,total:w.value,onHandleCallFetchData:l,onHandlePaginator:x,cityList:!1},{"data-cell":G(({column:o,record:a})=>[o.dataIndex=="asignar"?(d(),u(s,{key:0,checked:a.pivot.can_view_all,"onUpdate:checked":e=>a.pivot.can_view_all=e,onChange:e=>t("can_view_all",e,a)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),o.dataIndex=="crear"?(d(),u(s,{key:1,checked:a.pivot.can_create,"onUpdate:checked":e=>a.pivot.can_create=e,onChange:e=>t("can_create",e,a)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),o.dataIndex=="actualizar"?(d(),u(s,{key:2,checked:a.pivot.can_update,"onUpdate:checked":e=>a.pivot.can_update=e,onChange:e=>t("can_update",e,a)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),o.dataIndex=="eliminar"?(d(),u(s,{key:3,checked:a.pivot.can_delete,"onUpdate:checked":e=>a.pivot.can_delete=e,onChange:e=>t("can_delete",e,a)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),o.dataIndex=="descargar"?(d(),u(s,{key:4,checked:a.pivot.can_download,"onUpdate:checked":e=>a.pivot.can_download=e,onChange:e=>t("can_download",e,a)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),o.dataIndex=="finalizar"?(d(),u(s,{key:5,checked:a.pivot.can_finish,"onUpdate:checked":e=>a.pivot.can_finish=e,onChange:e=>t("can_finish",e,a)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),o.dataIndex=="importar"?(d(),u(s,{key:6,checked:a.pivot.can_import,"onUpdate:checked":e=>a.pivot.can_import=e,onChange:e=>t("can_import",e,a)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0)]),_:1},8,["pageSize","dataSource","total"])])}}};export{Z as _,j as a};
