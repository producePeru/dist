import{_ as pe}from"./icoexcel-a1d0882d.js";import{J,g as me,r as p,v as ue,H as ce,k as _e,b as y,o as i,d as o,e as c,n as b,h as xe,c as C,w as A,s as n,F as s,G as he,m as ve,y as Ie,i as d,t,q as we,p as ye,j as ge}from"./index-196a8fcf.js";import"./es-896c0dda.js";import{_ as fe}from"./_plugin-vue_export-helper-c27b6911.js";const ke=w=>(ye("data-v-1273ddae"),w=w(),ge(),w),Se={class:"header-rep"},be={class:"filters-dig"},Ce={key:0},Ae=ke(()=>c("img",{width:"20",style:{"margin-right":"6px"},src:pe},null,-1)),Re={class:"paginator"},Z=20,De={__name:"AsesoriasLista",setup(w){J.locale("es");const X=JSON.parse(localStorage.getItem("role")),K=me.get("token"),Q="https://apituempresa.soporte-pnte.com/api/",W="http://127.0.0.1:8000/api/",ee=window.location.hostname=="localhost"||window.location.hostname=="127.0.0.1"?W:Q,R=p([]),g=p(!1),f=p(!1),D=p(0),u=p({page:0}),m=p("asesorias");p("");const te=p(1200),z=p(window.innerHeight-100),k=()=>{z.value=window.innerHeight-315};ue(()=>{window.removeEventListener("resize",k)});const v=p([]),N=p([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"S. Tipo Documento",dataIndex:"sol_tipo_doc",width:160},{title:"S. Núm. Documento",dataIndex:"sol_num_doc",width:150},{title:"S. Email",dataIndex:"sol_email",width:200},{title:"S. Celular",dataIndex:"sol_phone",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:200},{title:"Supervisor",dataIndex:"misupervisor",width:200},{title:"Región",dataIndex:"mype_region",width:140},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Componente",dataIndex:"componente",width:180},{title:"Tema",dataIndex:"tema_componente",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),ae=p([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"S. Tipo Documento",dataIndex:"sol_tipo_doc",width:160},{title:"S. Núm. Documento",dataIndex:"sol_num_doc",width:150},{title:"S. Email",dataIndex:"sol_email",width:200},{title:"S. Celular",dataIndex:"sol_phone",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:200},{title:"Supervisor",dataIndex:"misupervisor",width:200},{title:"Región",dataIndex:"mype_region",width:140},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Detalle del trámite",dataIndex:"detalle_tramite",width:180},{title:"Sector económico",dataIndex:"sector_economico",width:180},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),ie=p([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"S. Tipo Documento",dataIndex:"sol_tipo_doc",width:160},{title:"S. Núm. Documento",dataIndex:"sol_num_doc",width:150},{title:"S. Email",dataIndex:"sol_email",width:200},{title:"S. Celular",dataIndex:"sol_phone",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:200},{title:"Supervisor",dataIndex:"misupervisor",width:200},{title:"Región",dataIndex:"mype_region",width:140},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Dirección",dataIndex:"mype_direccion",width:230},{title:"Nombre empresa",dataIndex:"mype_nombre",width:180},{title:"Régimen",dataIndex:"tipo_regimen",width:80,align:"center"},{title:"Número de notaría",dataIndex:"numero_envio_notaria",width:140},{title:"Notaría",dataIndex:"notaria",width:150},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"RUC",dataIndex:"ruc",width:120,align:"center"}]),oe=r=>{u.value.page=r,I()},ne=r=>J(r).format("DD-MM-YYYY HH:mm"),de=(r,l,_)=>{},se=async()=>{f.value=!0;let r="",l="";m.value=="asesorias"&&(r="download/asesories",l="asesorias.xlsx"),m.value=="ruc10"&&(r="download/formalizations-ruc10",l="formalizacionesRUC10.xlsx"),m.value=="ruc20"&&(r="download/formalizations-ruc20",l="formalizacionesRUC20.xlsx");try{const{data:_}=await he.get(`${ee}${r}`,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${K}`},responseType:"blob"}),h=new Blob([_]),S=window.URL.createObjectURL(h),x=document.createElement("a");x.href=S,x.download=l,document.body.appendChild(x),x.click(),document.body.removeChild(x)}catch{ve.error("Error")}finally{f.value=!1}},I=async r=>{try{g.value=!0;let l="historial/advisories";v.value=N.value,r=="asesorias"&&(u.value.page=0,m.value=r,v.value=N.value,l="historial/advisories"),r=="ruc10"&&(u.value.page=0,m.value=r,v.value=ae.value,l="historial/formalizations-10"),r=="ruc20"&&(u.value.page=0,m.value=r,v.value=ie.value,l="historial/formalizations-20");let _=u.value.page==0?"":u.value;const h=await Ie({url:l,method:"GET",params:_});R.value=h.data,D.value=h.total}catch(l){console.error("Error de red:",l)}finally{g.value=!1}},le=ce(()=>r=>((u.value.page==0?1:u.value.page)-1)*Z+r+1);return _e(()=>{I(),window.addEventListener("resize",k),k()}),(r,l)=>{const _=y("a-button"),h=y("a-tag"),S=y("a-table"),x=y("a-pagination");return i(),o(s,null,[c("div",null,[c("div",Se,[c("h3",{class:b({hdactive:m.value=="asesorias"}),onClick:l[0]||(l[0]=a=>I("asesorias"))},"ASESORÍAS",2),c("h3",{class:b({hdactive:m.value=="ruc10"}),onClick:l[1]||(l[1]=a=>I("ruc10"))},"FORMALIZACIONES RUC 10",2),c("h3",{class:b({hdactive:m.value=="ruc20"}),onClick:l[2]||(l[2]=a=>I("ruc20"))},"FORMALIZACIONES RUC 20",2)]),c("div",be,[xe(X)[0].id==1?(i(),o("div",Ce,[C(_,{onClick:se,loading:f.value},{default:A(()=>[Ae,d(" DESCARGAR ")]),_:1},8,["loading"])])):n("",!0)]),C(S,{onChange:de,bordered:"",scroll:{x:te.value,y:z.value},class:"table-historial",columns:v.value,"data-source":R.value,pagination:!1,loading:g.value,size:"small"},{bodyCell:A(({column:a,record:e,index:re})=>{var E,L,U,M,T,B,F,O,$,H,P,Y,V,j,G,q;return[a.dataIndex=="idx"?(i(),o(s,{key:0},[d(t(le.value(re)),1)],64)):n("",!0),a.dataIndex=="ase_fecha"?(i(),o(s,{key:1},[d(t(ne(e.created_at)),1)],64)):n("",!0),a.dataIndex=="sol_apellidos"?(i(),o(s,{key:2},[d(t(e.people.lastname)+" "+t(e.people.middlename),1)],64)):n("",!0),a.dataIndex=="sol_nombres"?(i(),o(s,{key:3},[d(t(e.people.name),1)],64)):n("",!0),a.dataIndex=="sol_tipo_doc"?(i(),o(s,{key:4},[d(t(e.people.typedocument.name),1)],64)):n("",!0),a.dataIndex=="sol_num_doc"?(i(),o(s,{key:5},[d(t(e.people.documentnumber),1)],64)):n("",!0),a.dataIndex=="sol_email"?(i(),o(s,{key:6},[d(t(e.people.email),1)],64)):n("",!0),a.dataIndex=="sol_phone"?(i(),o(s,{key:7},[d(t(e.people.phone),1)],64)):n("",!0),a.dataIndex=="asesor"?(i(),o(s,{key:8},[d(t((E=e.supervisado)==null?void 0:E.supervisado_user.profile.name)+" "+t((L=e.supervisado)==null?void 0:L.supervisado_user.profile.lastname)+" "+t((U=e.supervisado)==null?void 0:U.supervisado_user.profile.middlename),1)],64)):n("",!0),a.dataIndex=="misupervisor"?(i(),o(s,{key:9},[d(t((M=e.supervisor)==null?void 0:M.supervisor_user.profile.name)+" "+t((T=e.supervisor)==null?void 0:T.supervisor_user.profile.lastname)+" "+t((B=e.supervisor)==null?void 0:B.supervisor_user.profile.middlename),1)],64)):n("",!0),a.dataIndex=="mype_region"?(i(),o(s,{key:10},[d(t(e.city.name),1)],64)):n("",!0),a.dataIndex=="mype_provincia"?(i(),o(s,{key:11},[d(t(e.province.name),1)],64)):n("",!0),a.dataIndex=="mype_distrito"?(i(),o(s,{key:12},[d(t(e.district.name),1)],64)):n("",!0),a.dataIndex=="componente"?(i(),o(s,{key:13},[d(t((F=e.component)==null?void 0:F.name),1)],64)):n("",!0),a.dataIndex=="tema_componente"?(i(),o(s,{key:14},[d(t((O=e.theme)==null?void 0:O.name),1)],64)):n("",!0),a.dataIndex=="detalle_tramite"?(i(),o(s,{key:15},[d(t(($=e.detailprocedure)==null?void 0:$.name),1)],64)):n("",!0),a.dataIndex=="sector_economico"?(i(),o(s,{key:16},[d(t((H=e.economicsector)==null?void 0:H.name),1)],64)):n("",!0),a.dataIndex=="atividad_comercial"?(i(),o(s,{key:17},[d(t((P=e==null?void 0:e.comercialactivity)==null?void 0:P.name),1)],64)):n("",!0),a.dataIndex=="mype_direccion"?(i(),o(s,{key:18},[d(t(e==null?void 0:e.address),1)],64)):n("",!0),a.dataIndex=="mype_nombre"?(i(),o(s,{key:19},[d(t((Y=e.mype)==null?void 0:Y.name),1)],64)):n("",!0),a.dataIndex=="tipo_regimen"?(i(),o(s,{key:20},[d(t((V=e.regime)==null?void 0:V.name),1)],64)):n("",!0),a.dataIndex=="numero_envio_notaria"?(i(),o(s,{key:21},[d(t(e.numbernotary),1)],64)):n("",!0),a.dataIndex=="notaria"?(i(),o(s,{key:22},[d(t((j=e.notary)==null?void 0:j.name),1)],64)):n("",!0),a.dataIndex=="codesunarp"?(i(),o(s,{key:23},[d(t(e.codesunarp),1)],64)):n("",!0),a.dataIndex==="modality"?(i(),we(h,{key:24,color:e.modality.name=="Presencial"?"green":"orange"},{default:A(()=>[d(t(e.modality.name),1)]),_:2},1032,["color"])):n("",!0),a.dataIndex=="ruc"?(i(),o(s,{key:25},[d(t((G=e.mype)!=null&&G.ruc?`20${(q=e.mype)==null?void 0:q.ruc}`:""),1)],64)):n("",!0)]}),_:1},8,["scroll","columns","data-source","loading"])]),c("div",Re,[C(x,{size:"small",total:D.value,pageSize:Z,onChange:oe,showSizeChanger:!1,defaultCurrent:2},null,8,["total"])])],64)}}},Ue=fe(De,[["__scopeId","data-v-1273ddae"]]);export{Ue as default};
