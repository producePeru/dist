import{_ as J}from"./TableComponent-786e2d4e.js";import{r as s,u as Z,a as K,l as D,j as W,a6 as x,b as _,o as r,d as v,c as d,w as o,R as Y,f as X,t as ee,y as l,F as O,x as m,i as h,e as E,h as ae,a2 as te,m as b}from"./index-b8c397e4.js";import{_ as ne}from"./EventosUgo-132a1fa5.js";import{d as oe}from"./downloadExcel-d58d5069.js";import{g as se}from"./usePermissions-5a75e885.js";import"./es-ea278d56.js";import"./icoexcel-1b303edf.js";import"./selectes-a540eed2.js";import"./MoreOutlined-fe4af2e3.js";const re={class:"advisory-table"},le={key:0},ie=["href"],de=["onClick"],ce=["onClick"],Ie={__name:"list-index",setup(ue){JSON.parse(localStorage.getItem("role"));const C=s([]),S=s(0),N=s(150),f=s({}),p=s(!1);Z();const I=s(!1),g=s(null),w=s(!1),k=s([]),a=K({year:D("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),F=[{title:"ASESOR",dataIndex:"asesor",fixed:"left",width:180},{title:"DESCRIPCIÓN",dataIndex:"description",width:450},{title:"NOMBRE DE LA ACTIVIDAD",dataIndex:"title",width:220},{title:"INSCRITOS",dataIndex:"attendance_list_count",width:100,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:150},{title:"DISTRITO",dataIndex:"district",width:150},{title:"LUGAR",dataIndex:"address",width:180},{title:"FECHA CREACIÓN",dataIndex:"created_at",width:140,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],V=s([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]),L=e=>{g.value=e,p.value=!0},M=()=>{c(),p.value=!1},U=()=>{g.value=null,p.value=!0},$=async e=>{try{const t=await Y({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(c(),b.success(t.message))}catch(t){console.error("Error de red:",t)}},B=async e=>{try{const t=await Y({url:`attendance/event-finally/${e.id}`,method:"PUT"});t.status==200&&(c(),b.success(t.message))}catch(t){console.error("Error de red:",t)}},G=async()=>{w.value=!0;try{const e={};a.year&&(e.year=D(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor),await oe("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{w.value=!1}},H=async e=>{a.page=e,await c()},P=async e=>{e&&(a.page=1,await c())},c=async()=>{try{I.value=!0;const e={page:a.page};a.year&&(e.year=D(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor);const i=await Y({url:"attendance/list",method:"GET",params:e});C.value=i.data.data,S.value=i.data.total,N.value=i.data.per_page}catch(e){console.error("Error de red:",e)}finally{I.value=!1}},z=async()=>{try{const e=await X({url:"select/asesores",method:"GET"});e.status==200&&(k.value=e.data)}catch{console.log("Failed to delete")}};return W(async()=>{f.value=await se("eventos-ugo-lista"),await c(),await z()}),x("search",a),x("loading",I),x("loadingFile",w),(e,t)=>{const i=_("a-tag"),y=_("a-menu-item"),j=_("router-link"),q=_("a-popconfirm"),Q=_("a-drawer");return r(),v("div",re,[d(J,{title:"LISTA EVENTOS UGO",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:F,othersList:V.value,titleSearch:"BUSCAR POR EVENTO",pageSize:N.value,nameTotal:"Eventos UGO",asesoresList:k.value,dataSource:C.value,total:S.value,btnUpdate:!0,onHandleNew:U,onHandleDownloadExcel:G,onHandleSearch:P,permisos:f.value,onHandleCallFetchData:c,onHandlePaginator:H,btnImport:!0},{"data-cell":o(({column:n,record:u})=>[n.dataIndex=="type_activity"?(r(),v("span",le,ee(u.pnte),1)):l("",!0),n.dataIndex=="modality"?(r(),v(O,{key:1},[u.modality=="p"?(r(),m(i,{key:0,color:"blue"},{default:o(()=>t[1]||(t[1]=[h("PRESENCIAL")])),_:1})):l("",!0),u.modality=="v"?(r(),m(i,{key:1,color:"orange"},{default:o(()=>t[2]||(t[2]=[h("VIRTUAL")])),_:1})):l("",!0)],64)):l("",!0),n.dataIndex=="dateDiff"?(r(),v(O,{key:2},[u.finally?(r(),m(i,{key:0,color:"red"},{default:o(()=>t[3]||(t[3]=[h(" FINALIZADO ")])),_:1})):l("",!0)],64)):l("",!0)]),"custom-options":o(({record:n})=>{var u,A,T;return[d(y,null,{default:o(()=>[E("a",{href:n.eventsoffice_id===3?`https://inscripcion.soporte-pnte.com/fortalece-tu-mercado/${n.slug}`:`/asistencias/${n.slug}`,target:"_blank"}," Ver Link ",8,ie)]),_:2},1024),d(y,null,{default:o(()=>[d(j,{to:`inscritos/${n.slug}`},{default:o(()=>t[4]||(t[4]=[h("Inscritos")])),_:2},1032,["to"])]),_:2},1024),(u=f.value)!=null&&u.can_update?(r(),m(y,{key:0},{default:o(()=>[E("a",{onClick:R=>L(n)},"Editar",8,de)]),_:2},1024)):l("",!0),(A=f.value)!=null&&A.can_finish?(r(),m(y,{key:1},{default:o(()=>[E("span",{style:{color:"#ff4d4f"},onClick:R=>B(n)},"Finalizar",8,ce)]),_:2},1024)):l("",!0),(T=f.value)!=null&&T.can_delete?(r(),m(y,{key:2},{default:o(()=>[d(q,{placement:"rightBottom",title:`¿Quieres eliminar ${n.title} ?`,onConfirm:R=>$(n)},{icon:o(()=>[d(ae(te),{style:{color:"red"}})]),default:o(()=>[t[5]||(t[5]=E("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):l("",!0)]}),_:1},8,["othersList","pageSize","asesoresList","dataSource","total","permisos"]),d(Q,{open:p.value,"onUpdate:open":t[0]||(t[0]=n=>p.value=n),title:g.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD",placement:"right",width:"550"},{default:o(()=>[d(ne,{onCloseDraw:M,dataRow:g.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{Ie as default};
