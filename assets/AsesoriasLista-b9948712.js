import{_ as U}from"./icoexcel-a1d0882d.js";import{g as V,r as o,K as F,l as O,b as p,o as l,d as k,e as r,c as v,w as i,F as A,L as j,m as G,h as H,j as d,t as n,s as _,B as x}from"./index-5115c556.js";const M=r("h3",null,"ASESORÍAS",-1),P={class:"filters"},$=r("img",{width:"20",style:{"margin-right":"6px"},src:U},null,-1),q={class:"paginator"},J={__name:"AsesoriasLista",setup(K){const C="https://apituempresa.soporte-pnte.com/api/v1",E="http://127.0.0.1:8000/api/v1",z=window.location.hostname=="127.0.0.1"?E:C,B=V.get("token"),f=o([]),u=o(!1),m=o(!1),y=o(0),b=o({page:1}),L=o(1200),I=o(window.innerHeight-100),h=()=>{I.value=window.innerHeight-300};F(()=>{window.removeEventListener("resize",h)});const R=[{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:180},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante género",dataIndex:"sol_genero",width:140,align:"center"},{title:"Solicitante discapacidad",dataIndex:"sol_discapacidad",width:176,align:"center"},{title:"Solicitante telf.",dataIndex:"sol_telefono",width:120,align:"center"},{title:"Solicitante correo",dataIndex:"sol_correo",width:180},{title:"Supervisor",dataIndex:"misupervisor",width:180},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Componente",dataIndex:"componente",width:180},{title:"Tema",dataIndex:"tema_componente",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}],N=e=>{b.value.page=e,S()},T=async()=>{m.value=!0;const e={};try{const{data:g}=await j.post(`${z}/download-asesorias`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${B}`},responseType:"blob"}),w=new Blob([g]),s=window.URL.createObjectURL(w),t=document.createElement("a");t.href=s,t.download="asesorias.xlsx",document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch{G.error("Error")}finally{m.value=!1}},S=async()=>{try{u.value=!0;const e=await H({url:"/asesorias",method:"GET",params:b.value});f.value=e.data,y.value=e.total}catch(e){console.error("Error de red:",e)}finally{u.value=!1}};return O(()=>{S(),window.addEventListener("resize",h),h()}),(e,g)=>{const w=p("a-button"),s=p("a-tag"),t=p("a-table"),D=p("a-pagination");return l(),k(A,null,[r("div",null,[M,r("div",P,[v(w,{onClick:T,loading:m.value},{default:i(()=>[$,d(" DESCARGAR ")]),_:1},8,["loading"])]),v(t,{bordered:"",scroll:{x:L.value,y:I.value},class:"ant-table-striped",columns:R,"data-source":f.value,pagination:!1,loading:u.value,size:"small"},{bodyCell:i(({column:c,record:a})=>[c.dataIndex=="solName"?(l(),k(A,{key:0},[d(n(a.person.last_name)+" "+n(a.person.middle_name)+", "+n(a.person.name),1)],64)):_("",!0),c.dataIndex==="sol_discapacidad"?(l(),x(s,{key:1,color:a.sol_discapacidad=="NO"?"blue":"pink"},{default:i(()=>[d(n(a.sol_discapacidad),1)]),_:2},1032,["color"])):_("",!0),c.dataIndex==="sol_genero"?(l(),x(s,{key:2,class:"uppercase",color:a.sol_genero=="h"?"default":"error"},{default:i(()=>[d(n(a.sol_genero),1)]),_:2},1032,["color"])):_("",!0),c.dataIndex==="modality"?(l(),x(s,{key:3,color:a.modalidad=="VIRTUAL"?"orange":"green"},{default:i(()=>[d(n(a.modalidad),1)]),_:2},1032,["color"])):_("",!0)]),_:1},8,["scroll","data-source","loading"])]),r("div",q,[v(D,{size:"small",total:y.value,pageSize:20,onChange:N,showSizeChanger:!1},null,8,["total"])])],64)}}};export{J as default};
