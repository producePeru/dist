import{_ as $}from"./TableComponent-91664cc1.js";import{p as y,r as l,a as U,k as q,U as W,X as I,o as r,d as m,c as d,w as E,z as v,m as L,h as G,u as j,b as T,i as A,F as z,e as P,j as b,t as Y,y as V}from"./index-dac8a4c4.js";import{_ as J}from"./FormComponent-d69e8d88.js";import{u as Q}from"./selectes-365ec481.js";import{U as Z}from"./UpImage-8129d60e.js";import"./es-fa122243.js";import{g as K}from"./usePermissions-a3e2772a.js";import{g as X}from"./publicInscripcion-ebc9ecb9.js";import{C as ee}from"./CloudUploadOutlined-cd6fb2ba.js";import{T as te}from"./TeamOutlined-67760cda.js";import{A as ae}from"./AuditOutlined-e4099465.js";import"./icoexcel-1b303edf.js";import"./SyncOutlined-102dcbde.js";import"./MoreOutlined-c980a48d.js";import"./quill.snow-a97463ac.js";import"./_plugin-vue_export-helper-c27b6911.js";const ie={class:"fairs"},se={key:0},le={__name:"DrawCyberWow",props:["info"],emits:["closeDraw"],setup(B,{emit:w}){y.locale("es");const h=l({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},messageEndForm:{type:"iLabel",label:"MENSAJES DE INSCRIPCIONES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE AL FINALIZAR INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const N=w,n=B,_=l("GUARDAR"),e=U({}),u=l(!1),C=l(null),a=Q(),O=l(null),c=l({city_id:[],fairtype_id:[],modality_id:[]}),R=()=>n.info?{name:n.info.image.name,url:n.info.image.url}:null,M=t=>{},x=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),h.value.dateTramite.disabled=!1)},k=async t=>{C.value=t.id},F=async t=>{t=="city_id"&&(await a.fetchCitiesNational(),e.city_id=null,c.value.city_id=a.citiesNational),t=="fairtype_id"&&(await a.fetchFairTypes(),c.value.fairtype_id=a.fairTypes),t=="modality_id"&&(await a.fetchModalities(),c.value.modality_id=a.modalities)},f=async()=>{u.value=!0;const t={title:e.title,subTitle:e.subTitle,description:e.description,fairtype_id:2,modality_id:1,startDate:y(e.dates.start).format("YYYY-MM-DD"),endDate:y(e.dates.end).format("YYYY-MM-DD"),metaMypes:e.metaMypes,city_id:e.city_id,fecha:null,place:null,hours:null,msgEndForm:e.msgEndForm,msgSendEmail:e.msgSendEmail,image_id:C.value};try{const S=n.info?`fair/update/${n.info.id}`:"events-ugse/cyber-wow-register-event",p=n.info?"PUT":"POST",D=await L({url:S,method:p,data:t});D.status===200&&(G.success(D.message),i(),N("closeDraw",!0))}catch(S){console.error("Error:",S);const p=document.getElementsByClassName("ant-drawer-body")[0];p&&(p.scrollTop=0)}finally{u.value=!1}},i=()=>{e.title=null,e.subTitle=null,e.description="</p>",e.fairtype_id=null,e.modality_id=null,e.dates=null,e.metaMypes=null,e.city_id=null,e.place=null,e.hours=null,e.msgEndForm="</p>",e.msgSendEmail="</p>"},s=async t=>{t&&(e.title=t.title,e.subTitle=t.subTitle,e.description=t.description,await a.fetchFairTypes(),c.value.fairtype_id=a.fairTypes,e.fairtype_id=t.fairtype_id,await a.fetchModalities(),c.value.modality_id=a.modalities,e.modality_id=t.modality_id,e.dates={start:y(t.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:y(t.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.metaMypes=t.metaMypes,await a.fetchCitiesNational(),c.value.city_id=a.citiesNational,e.city_id=t.city_id,e.fecha=t.fecha?y(t.fecha,"DD/MM/YYYY"):null,e.place=t.place,e.hours=t.hours,e.msgEndForm=t.msgEndForm||"</p>",e.msgSendEmail=t.msgSendEmail||"</p>")};return q(()=>{n.info&&s(n.info)}),W(()=>n.info,t=>{t?s(t):i()}),I("formState",e),I("loadingState",u),(t,S)=>(r(),m("div",ie,[d(J,{fields:h.value,options:c.value,btnSaveName:_.value,onHandleInputEvent:M,resetSelect:O.value,onHandleFocusSelect:F,onHandleChangeClock:x,onOnSubmit:f},{default:E(({field:p})=>[p.name=="iSlotOptions"?(r(),m("div",se,[d(Z,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:k,imageLoad:R()},null,8,["imageLoad"])])):v("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const ne={class:"layout-content"},oe=["onClick"],re={key:0,style:{"line-height":"1.5"}},de={key:1},ce={key:3,class:"btn-group-wow"},me={key:0},ue=["onClick"],Oe={__name:"list-index",setup(B){const w=l({}),h=l([]),N=l(0),n=l(150),_=l(!1);j();const e=l(!1),u=l(null),C=l(!1),a=U({year:y("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:3}),O=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:50},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:180},{title:"FECHAS INSCRIPCIONES",dataIndex:"date",width:70,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:100,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:100,align:"center"},{title:"ACCIONES",dataIndex:"registerBtn",width:120,align:"center"}],c=i=>{const s=`${X()}/cyber-wow/${i}`;window.open(s,"_blank")},R=i=>{u.value=i,_.value=!0},M=()=>{f(),_.value=!1},x=()=>{u.value=null,_.value=!0},k=async i=>{a.page=i,await f()},F=async i=>{i&&(a.page=1,await f())},f=async()=>{try{e.value=!0;const i={page:a.page};a.year&&(i.year=y(a.year).format("YYYY"));const t=await L({url:"events-ugse/cyber-wow",method:"GET",params:i});h.value=t.data.data,N.value=t.data.total,n.value=t.data.per_page}catch(i){console.error("Error de red:",i)}finally{e.value=!1}};return q(async()=>{await f(),w.value=await K("wow-list")}),I("search",a),I("loading",e),I("loadingFile",C),(i,s)=>{var H;const t=T("a-tag"),S=T("router-link"),p=T("a-menu-item"),D=T("a-drawer");return r(),m("div",ne,[d($,{title:"CYBER WOW",new:(H=w.value.value)==null?void 0:H.can_create,textNuevo:"NUEVO",placeholderSearch:"Buscar",searchYear:!0,columns:O,titleSearch:"BUSCAR POR EVENTO",pageSize:n.value,nameTotal:"Eventos CYBER WOW",dataSource:h.value,total:N.value,btnUpdate:!0,onHandleNew:x,onHandleCallFetchData:f,onHandleSearch:F,onHandlePaginator:k},{"data-cell":E(({column:g,record:o})=>[g.dataIndex=="link"?(r(),m("a",{key:0,onClick:pe=>c(o.slug),href:"javascript:void(0)",target:"_blank"},[d(A(ee),{style:{"font-size":"18px"}})],8,oe)):v("",!0),g.dataIndex=="date"?(r(),m(z,{key:1},[o.startDate!=o.endDate?(r(),m("span",re,[s[1]||(s[1]=P("b",null,"Desde:",-1)),b(" "+Y(o.dateStartFormat)+" ",1),s[2]||(s[2]=P("b",null,"Hasta:",-1)),b(" "+Y(o.dateEndFormat),1)])):(r(),m("span",de,Y(o.dateStartFormat),1))],64)):v("",!0),g.dataIndex=="registered"?(r(),V(t,{key:2,color:"processing"},{default:E(()=>[b(Y(o.registered_wow),1)]),_:2},1024)):v("",!0),g.dataIndex=="registerBtn"?(r(),m("div",ce,[d(S,{to:`/admin/ugse/cyber-wow/inscritos/${o.slug}`},{default:E(()=>[d(A(te)),s[3]||(s[3]=b(" Inscritos "))]),_:2},1032,["to"]),h.value[0].id==o.id?(r(),m("div",me,[d(S,{to:`/admin/ugse/cyber-wow/administrar/${o.slug}`},{default:E(()=>[d(A(ae)),s[4]||(s[4]=b(" Gestionar "))]),_:2},1032,["to"])])):v("",!0)])):v("",!0)]),"custom-options":E(({record:g})=>[w.value.can_update?(r(),V(p,{key:0},{default:E(()=>[P("a",{onClick:o=>R(g)},"Editar",8,ue)]),_:2},1024)):v("",!0)]),_:1},8,["new","pageSize","dataSource","total"]),d(D,{open:_.value,"onUpdate:open":s[0]||(s[0]=g=>_.value=g),title:u.value?"EDITAR EVENTO CYBER WOW":"REGISTRAR UN EVENTO CYBER WOW",placement:"right",width:"550"},{default:E(()=>[d(le,{onCloseDraw:M,info:u.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Oe as default};
