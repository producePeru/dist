import{z as y,r as m,a as X,j as B,Q as G,b as c,o as l,d as g,c as r,w as i,e as a,F as $,v as Z,h as b,p as f,q as p,i as h,G as O,m as H,t as v,Z as W,X as ee,a6 as te,Y as I}from"./index-6e4bbc85.js";import{i as ae,f as ne,F as oe,a as se,b as le,c as re}from"./isSameOrBefore-52579afc.js";import"./es-ed250ef0.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import{V as z}from"./VideoCameraOutlined-9c5e317d.js";const ie={class:"grid-events"},ue={class:"video-conference"},de={key:0,class:"form-label-1"},me={__name:"FormCrearSala",props:["info","pcategories"],emits:["closeDraw"],setup(P,{emit:L}){y.extend(ae),y.locale("es"),JSON.parse(localStorage.getItem("profile"));const C=L,x=P,D=m(!1),E=m(!0);m(null);const Y=[{label:"UGO",value:"ugo"},{label:"UGSE",value:"ugse"},{label:"UGGER",value:"ugger"},{label:"DIRECCIÓN",value:"de"}],w=m([{label:"SALA 1",value:1},{label:"SALA 2",value:2}]),t=X({endDate:null}),k=()=>{t.title=null,t.time=null,t.description=null,t.linkVideo=null,t.unity=null,t.room=null},A=async()=>{D.value=!0;const d={title:t.title,startDate:y(t.startDate).format("YYYY-MM-DD"),timeStart:y(t.time[0]).format("HH:mm"),timeEnd:y(t.time[1]).format("HH:mm"),description:t.description,link:t.linkVideo,unity:t.unity,room:t.room};try{const u=await O({url:"room/store",method:"POST",data:d});u.status==200&&(H.success(u.message),k(),C("closeDraw")),u.status==400&&H.error(u.message),u.status==409&&H.warning(u.message)}catch{console.log("Failed to update record")}finally{D.value=!1}};function M(d){d?t.startDate=y(d.start):k()}return B(()=>{x.info&&M(x.info)}),G(()=>x.info,d=>{d&&M(d)}),(d,u)=>{const R=c("a-input"),_=c("a-form-item"),N=c("a-textarea"),T=c("a-select"),q=c("a-date-picker"),F=c("a-time-range-picker"),U=c("a-button"),n=c("a-form");return l(),g("div",null,[r(n,{class:"form-events",layout:"vertical",model:t,name:"basic",autocomplete:"off",onFinish:A},{default:i(()=>[a("div",ie,[(l(!0),g($,null,Z(b(ne),(e,S)=>(l(),g($,{key:S},[e.type==="iText"?(l(),f(_,{key:0,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:i(()=>[r(R,{value:t[e.name],"onUpdate:value":s=>t[e.name]=s,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iTextarea"?(l(),f(_,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:i(()=>[r(N,{value:t[e.name],"onUpdate:value":s=>t[e.name]=s,rows:2,style:{resize:"none"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iLinkVideo"?(l(),f(_,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:i(()=>[a("div",ue,[r(b(z)),E.value?(l(),g("label",de,"ENLACE DE REUNIÓN")):(l(),g("label",{key:1,class:"form-label-2",onClick:u[0]||(u[0]=s=>E.value=!0)},"Agrega video conferencia"))]),E.value?(l(),f(R,{key:0,value:t[e.name],"onUpdate:value":s=>t[e.name]=s},null,8,["value","onUpdate:value"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iSelect"?(l(),f(_,{key:3,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:i(()=>[e.name=="room"?(l(),f(T,{key:0,value:t[e.name],"onUpdate:value":s=>t[e.name]=s,options:w.value},null,8,["value","onUpdate:value","options"])):p("",!0),e.name=="unity"?(l(),f(T,{key:1,value:t[e.name],"onUpdate:value":s=>t[e.name]=s,options:Y},null,8,["value","onUpdate:value"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iDate"?(l(),f(_,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:i(()=>[r(q,{value:t[e.name],"onUpdate:value":s=>t[e.name]=s,disabled:e.disabled,style:{width:"100%"},format:"DD/MM/YYYY"},null,8,["value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iTime"?(l(),f(_,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:i(()=>[r(F,{value:t[e.name],"onUpdate:value":s=>t[e.name]=s,"minute-step":15,format:"h:mm A","use12-hours":""},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):p("",!0)],64))),128))]),r(_,{style:{"margin-top":".5rem"}},{default:i(()=>[r(U,{type:"primary","html-type":"submit",loading:D.value,style:{float:"inline-end"}},{default:i(()=>u[1]||(u[1]=[h("RESERVAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}},ce=j(me,[["__scopeId","data-v-94a81bc4"]]);const pe={class:"event-tooltip"},ve={class:"room-infox"},_e={key:0},fe=["href"],ye={style:{"text-transform":"uppercase"}},be={class:"room-actions"},ge=["onClick"],xe=300,ke={__name:"SalaReuniones",setup(P){const L=JSON.parse(localStorage.getItem("profile")),C=m(null),x=m(null),D=m([]),E=m(null),Y=m(!0),w=m(null),t=m(!1),k=m(null),A=m({plugins:[se,le,re],headerToolbar:{left:"prev,next today",center:"title",right:""},buttonText:{today:"Hoy",month:"Mes",week:"Semana",day:"Día"},initialView:"dayGridMonth",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!0,select:N,eventClick:T,eventsSet:q,locale:"es",eventColor:"#ffcccb",eventBorderColor:"transparent",datesSet:R}),M=n=>I(n).format("DD/MM/YYYY"),d=n=>I(n,"HH:mm:ss").format("h:mm a"),u=()=>{t.value=!1,U(C.value,x.value)};function R(n){const e=n.view.currentStart,S=e.getMonth()+1,s=e.getFullYear();C.value=S,x.value=s,U()}let _=0;function N(n){const e=new Date().getTime();if(e-_<=xe){const S=n.end;w.value={start:y(n.start).format("YYYY-MM-DDTHH:mm"),end:y(S).subtract(1,"day").format("YYYY-MM-DDTHH:mm"),allDay:n.allDay},k.value=!1,t.value=!0}_=e}function T(n){}function q(n){}const F=async n=>{try{const e=await O({url:`room/delete/${n}`,method:"DELETE"});e.status==200&&(U(),H.success(e.message))}catch(e){console.error("Error de red:",e)}},U=async()=>{try{Y.value=!0;const n=await O({url:`room/list?month=${C.value}&year=${x.value}`,method:"GET"});D.value=n}catch(n){console.error("Error de red:",n)}finally{Y.value=!1}};return B(()=>{}),G(D,n=>{A.value.events=n}),(n,e)=>{const S=c("a-flex"),s=c("a-popconfirm"),J=c("a-popover"),Q=c("a-spin"),K=c("a-modal");return l(),g("section",null,[r(S,{align:"center",justify:"space-between"},{default:i(()=>e[2]||(e[2]=[a("h3",{style:{margin:"0"}},"SALA DE REUNIONES",-1),a("div",{class:"room-color"},[a("span",null,[h("SALA 1 "),a("i")]),a("span",null,[h("SALA 2 "),a("i")])],-1)])),_:1}),e[6]||(e[6]=a("br",null,null,-1)),r(Q,{spinning:Y.value},{default:i(()=>[r(b(oe),{class:"demo-app-calendar",options:A.value},{eventContent:i(o=>[r(J,{trigger:"click",open:k.value===o.event.id},{content:i(()=>[a("div",pe,[a("div",ve,[a("b",null,v(o.event.title),1),a("span",null,"Fecha de reserva: "+v(M(o.event.start)),1),a("span",null,"Desde: "+v(d(o.event.extendedProps.timeStart)),1),a("span",null,"Hasta: "+v(d(o.event.extendedProps.timeEnd)),1),o.event.extendedProps.description?(l(),g("span",_e,[e[3]||(e[3]=h("Descripción: ")),a("p",null,v(o.event.extendedProps.description),1)])):p("",!0),o.event.extendedProps.link?(l(),g("a",{key:1,href:o.event.extendedProps.link,target:"_blank"},[r(b(z)),e[4]||(e[4]=h(" Link de la sala "))],8,fe)):p("",!0),a("span",null,[e[5]||(e[5]=h("Unidad: ")),a("b",ye,v(o.event.extendedProps.unity),1)]),a("span",null,"Sala: "+v(o.event.extendedProps.room),1),a("span",null,"Reservado por: "+v(o.event.extendedProps.registered),1)]),a("div",be,[r(b(W),{class:"room-close",onClick:e[0]||(e[0]=V=>k.value=null)}),o.event.extendedProps._id==b(L).id?(l(),f(s,{key:0,placement:"rightBottom",title:"¿Deseas eliminar este registro?",onConfirm:V=>F(o.event.id)},{icon:i(()=>[r(b(ee),{style:{color:"red"}})]),default:i(()=>[r(b(te),{class:"room-delete"})]),_:2},1032,["onConfirm"])):p("",!0)])])]),default:i(()=>[a("div",{style:{display:"flex",gap:"4px"},onClick:V=>k.value=o.event.id},[a("span",null,v(d(o.event.extendedProps.timeStart))+" - "+v(d(o.event.extendedProps.timeEnd)),1),a("span",null,v(o.event.title),1)],8,ge)]),_:2},1032,["open"])]),_:1},8,["options"])]),_:1},8,["spinning"]),r(K,{open:t.value,"onUpdate:open":e[1]||(e[1]=o=>t.value=o),title:"RESERVAR SALA",footer:"",width:"480px"},{default:i(()=>[r(ce,{info:w.value,pcategories:E.value,onCloseDraw:u},null,8,["info","pcategories"])]),_:1},8,["open"])])}}},Ye=j(ke,[["__scopeId","data-v-cdfa2a2b"]]);export{Ye as default};
