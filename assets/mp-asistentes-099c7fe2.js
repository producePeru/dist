import{_ as $}from"./TableComponent-cd2d272e.js";import{E as F,r as s,u as H,a as L,p as N,k as z,X as y,b as x,o as g,d as E,c as h,w as _,m as O,y as G,z as C,e as c,t as n}from"./index-42c93728.js";import{d as j}from"./downloadExcel-eba59960.js";import"./es-e20cb20a.js";import{_ as q}from"./ParticipanteSed-9d93a374.js";import"./icoexcel-1b303edf.js";import"./selectes-7340cf8f.js";import"./SyncOutlined-397427b3.js";import"./MoreOutlined-949ae3e7.js";import"./FormComponent-68b1fdea.js";import"./quill.snow-28de71b4.js";const J={class:"layout-content mp-table"},X={key:1,class:"mp-empresario"},K={key:2,class:"mp-empresario"},Q=["onClick"],de={__name:"mp-asistentes",setup(W){const f=F();JSON.parse(localStorage.getItem("role"));const S=s([]),D=s(0),R=s(150),d=s(!1);H();const v=s(!1),m=s(null),I=s(!1),k=s({name:"Cargando..."}),t=L({year:N("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),Y=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"ASISTIÃ“",dataIndex:"asistio",width:80,align:"center",fixed:"left"},{title:"EMPRESARIO",dataIndex:"empresario",width:360},{title:"DISCAPACIDAD",dataIndex:"sick",width:120,align:"center"},{title:"VINCULACIÃ“N CON LA MYPE",dataIndex:"roleCompany",width:200,align:"center"},{title:"EMPRESA",dataIndex:"empresa",width:360},{title:"SECTOR ECONÃ“MICO",dataIndex:"economicSector",align:"center",width:120},{title:"RUBRO",dataIndex:"rubro",align:"center",width:180},{title:"ACTIVIDAD COMERCIAL",dataIndex:"comercialActivity",align:"center",width:180},{title:"DNI OBS",dataIndex:"obs_dni",align:"center",width:100},{title:"RUC OBS",dataIndex:"obs_ruc",align:"center",width:100},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],T=e=>{m.value=e,d.value=!0},b=()=>{u(),d.value=!1},U=()=>{m.value=null,d.value=!0},M=async(e,o)=>{const p={slug:f.params.slug,ruc:o.ruc,doc_number:o.dni};try{const i=await O({url:"mp/toggle-attendance",method:"PUT",data:p});i.status==200&&console.log("status",i.message)}catch(i){console.error("Error de red:",i)}},P=async()=>{I.value=!0;try{const e={},o=f.params.slug;t.name&&(e.name=t.name);let l=`download/mp-attendance-export/${o}`;await j(l,"inscritos",e)}catch(e){console.error("Error de red:",e)}finally{I.value=!1}},B=async e=>{t.page=e,await u()},V=async e=>{e&&(t.page=1,await u())},u=async()=>{try{v.value=!0;const e={page:t.page},o=f.params.slug;t.year&&(e.year=N(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby);const l=await O({url:`mp/attendance-event/${o}`,method:"GET",params:e});k.value.name=l.eventTitle,S.value=l.data.data,D.value=l.data.total,R.value=l.data.per_page}catch(e){console.error("Error de red:",e)}finally{v.value=!1}};return z(async()=>{await u()}),y("search",t),y("loading",v),y("loadingFile",I),(e,o)=>{var A;const l=x("a-checkbox"),p=x("a-menu-item"),i=x("a-drawer");return g(),E("div",J,[h($,{title:`ðŸ‘© INSCRITOS EN : ${(A=k.value)==null?void 0:A.name}`,new:!1,textNuevo:"NUEVO EVENTO",downloadExcel:!0,placeholderSearch:"Buscar",bread:!0,routeBack:"/admin/mp/capacitaciones",searchYear:!1,rangeDate:!1,columns:Y,titleSearch:"FILTRAR POR RUC O DNI",pageSize:R.value,nameTotal:"Inscritos",dataSource:S.value,total:D.value,btnUpdate:!0,onHandleNew:U,onHandleCallFetchData:u,onHandleDownloadExcel:P,onHandleSearch:V,onHandlePaginator:B},{"data-cell":_(({column:r,record:a})=>[r.dataIndex=="asistio"?(g(),G(l,{key:0,checked:a.attendance,"onUpdate:checked":w=>a.attendance=w,onChange:w=>M(w,a)},null,8,["checked","onUpdate:checked","onChange"])):C("",!0),r.dataIndex=="empresario"?(g(),E("div",X,[c("b",null,n(a.name)+" "+n(a.last_name)+" "+n(a.middle_name),1),c("span",null,n(a.typeDocument)+" "+n(a.dni)+" / "+n(a.phone)+" / "+n(a.email),1)])):C("",!0),r.dataIndex=="empresa"?(g(),E("div",K,[c("b",null,n(a.socialReason),1),c("span",null,n(a.ruc),1),c("span",null,n(a.city)+" - "+n(a.province)+" - "+n(a.district),1)])):C("",!0)]),"custom-options":_(({record:r})=>[h(p,null,{default:_(()=>[c("a",{onClick:a=>T(r)},"Editar",8,Q)]),_:2},1024)]),_:1},8,["title","pageSize","dataSource","total"]),h(i,{open:d.value,"onUpdate:open":o[0]||(o[0]=r=>d.value=r),title:m.value?"EDITAR DATOS DEL PARTICIPANTE":"NUEVO REGISTRO",placement:"right",width:"650"},{default:_(()=>[h(q,{onCloseDraw:b,info:m.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{de as default};
