import{g as S,r as _,b as c,o as k,y as G,w as n,e,c as l,d as C,t as u,i as B,$ as q,z as H,j as y,h as x,K as A,k as K,F,v as P}from"./index-617fe921.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import{S as W}from"./SaveOutlined-f7f0748a.js";const J={class:"modal-container"},Q={key:0,class:"preview-card"},X={class:"preview-header"},Y={class:"file-name"},Z={class:"video-wrapper"},ee=["src"],oe={style:{"margin-bottom":"14px"}},te={class:"char-count"},ae={__name:"UploadVideoModal",props:{visible:{type:Boolean,default:!1}},emits:["close","uploaded"],setup(I,{emit:$}){const g=$,V=S.get("token"),D="https://apituempresa.soporte-pnte.com/api/",b="http://127.0.0.1:8000/api/",m=window.location.hostname=="localhost"?b:D,i=_(null),p=_(null),v=_(""),r=_(""),s=_(!1),t=()=>{i.value=null,p.value=null},f=d=>["video/mp4","video/webm","video/avi","video/quicktime"].includes(d.type)?!0:(x.error("Formato no permitido"),!1),w=d=>{const o=d.file.originFileObj;i.value=o,p.value=URL.createObjectURL(o)},a=()=>{h(),g("close")},U=async()=>{if(!i.value){x.error("Debe seleccionar un video");return}s.value=!0;const d=new FormData;d.append("video",i.value),d.append("title",v.value),d.append("description",r.value);try{const{data:o}=await A.post(`${m}google/drive-videos-pnte`,d,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${V}`}});x.success("Video subido correctamente a Google Drive"),g("uploaded",o.data),h(),g("close")}catch(o){console.error(o),x.error("Error al subir el video")}finally{s.value=!1}},h=()=>{i.value=null,p.value=null,v.value="",r.value=""};return(d,o)=>{const z=c("a-upload-dragger"),M=c("a-button"),j=c("a-tooltip"),R=c("a-input"),T=c("a-textarea"),L=c("a-modal");return k(),G(L,{open:I.visible,onCancel:a,width:"500px",centered:"",footer:null,class:"video-modal"},{default:n(()=>{var O;return[e("div",J,[o[5]||(o[5]=e("div",{class:"header"},[e("h2",null,"Subir Nuevo Video")],-1)),l(z,{name:"file",multiple:!1,"before-upload":f,"show-upload-list":!1,onChange:w},{default:n(()=>o[2]||(o[2]=[e("p",{class:"ant-upload-text"},"Haz clic para seleccionar un video",-1),e("p",{class:"formats"},"MP4, WebM, AVI, MOV",-1)])),_:1}),o[6]||(o[6]=e("br",null,null,-1)),p.value?(k(),C("div",Q,[e("div",X,[e("span",Y,u((O=i.value)==null?void 0:O.name),1),l(j,{title:"Eliminar video"},{default:n(()=>[l(M,{type:"text",class:"delete-btn",onClick:t},{default:n(()=>[l(B(q))]),_:1})]),_:1})]),e("div",Z,[e("video",{src:p.value,controls:"",class:"video-preview"},null,8,ee)])])):H("",!0),e("div",oe,[o[3]||(o[3]=e("label",{class:"label"},"TÃ­tulo del Video",-1)),l(R,{value:v.value,"onUpdate:value":o[0]||(o[0]=E=>v.value=E),placeholder:"Ingresa el tÃ­tulo del video"},null,8,["value"])]),o[7]||(o[7]=e("label",{class:"label"},"DescripciÃ³n",-1)),l(T,{value:r.value,"onUpdate:value":o[1]||(o[1]=E=>r.value=E),placeholder:"Agrega una descripciÃ³n para tu video",maxlength:500,rows:4},null,8,["value"]),e("div",te,u(r.value.length)+"/500 caracteres",1),l(M,{type:"primary",block:"",class:"btn-upload",loading:s.value,disabled:!i.value||!v.value||!r.value,onClick:U},{default:n(()=>[l(B(W)),o[4]||(o[4]=y(" GUARDAR VIDEO "))]),_:1},8,["loading","disabled"])])]}),_:1},8,["open"])}}},le=N(ae,[["__scopeId","data-v-05e04604"]]);const se={class:"layout-content"},ne={class:"video-head"},ie={class:"video-grid"},de={class:"thumb"},re=["src"],ce={class:"duration"},ue={class:"info"},pe={class:"desc"},ve={class:"meta"},_e={class:"actions"},me={style:{display:"flex",gap:"8px","align-items":"center"}},fe={__name:"videos-index",setup(I){const $=S.get("token"),g="https://apituempresa.soporte-pnte.com/api/",V="http://127.0.0.1:8000/api/",D=window.location.hostname=="localhost"?V:g,b=_(!1),m=_([]),i=s=>console.log("Editar",s),p=s=>console.log("Descargar",s),v=s=>{m.value=m.value.filter(t=>t!==s)},r=async()=>{const s=await A.get(`${D}google/videos-pnte`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${$}`}});m.value=s.data.data,console.log("response",s)};return K(async()=>{await r()}),(s,t)=>{const f=c("a-button"),w=c("a-tooltip");return k(),C(F,null,[e("div",se,[e("div",ne,[t[3]||(t[3]=e("h3",null,"VIDEOS SUBIDOS",-1)),l(f,{type:"primary",onClick:t[0]||(t[0]=a=>b.value=!0)},{default:n(()=>t[2]||(t[2]=[y(" NUEVO ")])),_:1})]),e("div",ie,[(k(!0),C(F,null,P(m.value,(a,U)=>(k(),C("div",{key:U,class:"video-card"},[e("pre",null,u(a),1),e("div",de,[e("img",{src:a==null?void 0:a.google.thumbnail,alt:"Miniatura"},null,8,re),e("span",ce,u(a.duration),1)]),e("div",ue,[e("h3",null,u(a==null?void 0:a.google.name),1),e("p",pe,u(a.description),1),e("div",ve,[e("span",null,u(a.date),1),e("span",null,u(a.size),1)]),e("div",_e,[l(f,{class:"edit",onClick:h=>i(a)},{default:n(()=>t[4]||(t[4]=[y("âœï¸ Editar")])),_:2},1032,["onClick"]),e("div",me,[l(w,{title:"Descargar"},{default:n(()=>[l(f,{class:"options-icon",onClick:h=>p(a)},{default:n(()=>t[5]||(t[5]=[y("â¬‡ï¸")])),_:2},1032,["onClick"])]),_:2},1024),l(w,{title:"Eliminar"},{default:n(()=>[l(f,{class:"options-icon delete",onClick:h=>v(a)},{default:n(()=>t[6]||(t[6]=[y("ðŸ—‘ï¸")])),_:2},1032,["onClick"])]),_:2},1024)])])])]))),128))])]),l(le,{visible:b.value,onClose:t[1]||(t[1]=a=>b.value=!1)},null,8,["visible"])],64)}}},ye=N(fe,[["__scopeId","data-v-44fe60f9"]]);export{ye as default};
