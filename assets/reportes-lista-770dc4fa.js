import{_ as T}from"./TableComponent-8dbb725f.js";import{r as n,E as v,u as M,a as P,k as Y,X as I,b as c,o as L,d as U,c as o,w as i,p as V,m as x,j as b,i as B,a2 as H,e as $,h as O}from"./index-de9d4c9c.js";import{_ as k}from"./DrawMP-26d51b86.js";import{d as F}from"./downloadExcel-7c04975b.js";import"./es-05e43534.js";import"./icoexcel-1b303edf.js";import"./selectes-d8dee7d1.js";import"./SyncOutlined-2baf36ed.js";import"./MoreOutlined-4eb1e390.js";import"./FormComponent-9eec914e.js";import"./quill.snow-be95cf9a.js";import"./UpImage-ae8fb4a9.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./timezone-dfebb835.js";const G={class:"layout-content"},de={__name:"reportes-lista",setup(z){JSON.parse(localStorage.getItem("role"));const E=n([]),h=n(0),w=n(150);v();const s=n(!1);n(!1),M();const m=n(!1),u=n(null),p=n(!1),a=P({page:1}),f=[{title:"#",dataIndex:"idx",align:"center",width:50,fixed:"left"},{title:"RUC",dataIndex:"ruc",width:100,align:"center"},{title:"RAZON SOCIAL",dataIndex:"razonSocial",width:180},{title:"SECTOR MYPE",dataIndex:"sector_priorizado",width:180},{title:"REGIÓN ASESOR",dataIndex:"region_asesor",width:140},{title:"PROVINCIA ASESOR",dataIndex:"province_asesor",width:140},{title:"DISTRITO ASESOR",dataIndex:"district_asesor",width:140},{title:"ASESOR",dataIndex:"asesor",width:180},{title:"TIPO DE DOCUMENTO",dataIndex:"tipo_documento",align:"center",width:100},{title:"NÚMERO DE DOCUMENTO",dataIndex:"documentnumber",width:140},{title:"PAÍS NACIMIENTO",dataIndex:"country",width:140},{title:"FECHA DE NACIMIENTO",dataIndex:"birthday",align:"center",width:140},{title:"APELLIDO PATERNO",dataIndex:"lastname",width:180},{title:"APELLIDO MATERNO",dataIndex:"middlename",width:180},{title:"NOMBRES",dataIndex:"name",width:180},{title:"VINCULACIÓN CON LA MYPE",dataIndex:"title",width:180},{title:"GÉNERO",dataIndex:"gender",align:"center",width:120},{title:"DISCAPACIDAD",dataIndex:"sick",align:"center",width:120},{title:"NIVEL EDUCATIVO",dataIndex:"title",width:180},{title:"TELÉFONO",dataIndex:"phone",width:180},{title:"EMAIL",dataIndex:"email",width:200},{title:"PERIODO PRODUCTOR",dataIndex:"periodo",width:180},{title:"CANTIDAD MAQUINARIA",dataIndex:"cantidad",width:180},{title:"REGIÓN MYPE",dataIndex:"mype_region",width:140},{title:"PROVINCIA MYPE",dataIndex:"mype_province",width:140},{title:"DISTRITO MYPE",dataIndex:"mype_district",width:140},{title:"UBICACIÓN",dataIndex:"mype_ubicacion",width:180},{title:"FECHA ASESORÍA",dataIndex:"created_at",align:"center",width:160},{title:"COMPONENTE ASESORÍA",dataIndex:"componente",width:180},{title:"TEMA ASESORÍA",dataIndex:"tema",width:180},{title:"MODALIDAD",dataIndex:"modalidad",width:180},{title:"MES",dataIndex:"mes",width:100},{title:"MES NÚMERO",dataIndex:"mes_numero",align:"center",width:80},{title:"ACTIVIDAD",dataIndex:"comercialactivity",width:180},{title:"AÑO",dataIndex:"year",align:"center",width:140},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],A=()=>{r(),s.value=!1},g=()=>{u.value=null,s.value=!0},S=async e=>{try{const t=await x({url:`purchases-my-peru/delete/${e.id}`,method:"DELETE"});t.status==200&&(r(),O.success(t.message)),t.status==500&&O.error(t.message)}catch(t){console.error("Error de red:",t)}},_=async()=>{p.value=!0;try{await F("download/cp-registros/export","compras mi Perú",{})}catch(e){console.error("Error de red:",e)}finally{p.value=!1}},R=async e=>{a.page=e,await r()},D=async e=>{e&&(a.page=1,await r())},r=async()=>{try{m.value=!0;const e={page:a.page};a.year&&(e.year=V(a.year).format("YYYY")),a.range&&(e.startDate=a.range[0].format("YYYY/MM/DD"),e.endDate=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby);const t=await x({url:"purchases-my-peru/list",method:"GET",params:e}),{data:d}=t;E.value=d.data,h.value=d.total,w.value=d.per_page}catch(e){console.error("Error de red:",e)}finally{m.value=!1}};return Y(async()=>{await r()}),I("search",a),I("loading",m),I("loadingFile",p),(e,t)=>{const d=c("a-button"),N=c("a-popconfirm"),y=c("a-menu-item"),C=c("a-drawer");return L(),U("div",G,[o(T,{title:"REPORTES COMPRAS MI PERÚ",new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:f,titleSearch:"BUSCAR",pageSize:w.value,nameTotal:"Registros",dataSource:E.value,total:h.value,btnUpdate:!0,onHandleNew:g,onHandleCallFetchData:r,onHandleDownloadExcel:_,onHandleSearch:D,onHandlePaginator:R,downloadExcel:!0},{left:i(()=>[o(d,{type:"primary",onClick:t[0]||(t[0]=l=>e.$router.push("/admin/compras-peru/registrar"))},{default:i(()=>t[2]||(t[2]=[b(" REGISTRAR ")])),_:1})]),"custom-options":i(({record:l})=>[o(y,null,{default:i(()=>[o(N,{placement:"rightBottom",title:`¿Quieres eliminar al ${l.ruc} ?`,onConfirm:Q=>S(l)},{icon:i(()=>[o(B(H),{style:{color:"red"}})]),default:i(()=>[t[3]||(t[3]=$("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),o(C,{open:s.value,"onUpdate:open":t[1]||(t[1]=l=>s.value=l),title:u.value?"EDITAR EVENTO MP":"REGISTRAR UN EVENTO",placement:"right",width:"550"},{default:i(()=>[o(k,{onCloseDraw:A,info:u.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{de as default};
