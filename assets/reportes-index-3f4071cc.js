import{r as u,a as H,k as Z,U as X,X as P,o as T,y as G,i as z,L as K,d as k,c as f,m as $,h as Y,p as x,f as te,b as U,w as N,e as h,j as B,t as ie,z as W,O as ve,n as fe}from"./index-e6c24072.js";import{_ as ye}from"./TableComponent-d62ac496.js";import{d as ge}from"./downloadExcel-21bc3911.js";import{_ as Q}from"./FormComponent-81574557.js";import{u as ee}from"./selectes-4ca23084.js";import"./es-91bc37be.js";import{g as Ee}from"./publicInscripcion-ebc9ecb9.js";import{_ as be}from"./_plugin-vue_export-helper-c27b6911.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-4fac0e33.js";import"./quill.snow-4fab7f17.js";const Ce={key:1,class:"ases-draw"},he={__name:"EditarAsesoria",props:{info:{type:Object,required:!0,default:()=>({})}},emits:["closeDraw"],setup(L,{emit:y}){const _=L,w=y,r=ee(),g=u(!0),E=u(!1),e=H({}),t=u("ACTUALIZAR"),s=u({city_id:[],province_id:[],district_id:[],gender_id:[],sick:[]}),n=async(i,p)=>{if(i=="city_id"&&(await r.fetchProvinces(e.city_id),s.value.province_id=r.provinces,m.value.province_id.disabled=!1),i=="province_id"&&(await r.fetchDistricts(e.province_id),s.value.district_id=r.districts,m.value.district_id.disabled=!1),i=="component_id"&&(await r.fetchComponentThemes(e.component_id),s.value.theme_id=r.componentThemes,e.theme_id=null,m.value.theme_id.disabled=!1),i==="theme_id")if(p==17)m.value={...m.value,observations:{type:"iNumber",label:"NÚMERO DE RESERVA (Z- 7 dígitos)",name:"observations",required:!0,message:"Ingresar número de reserva",disabled:!1,prefix:"Z -",maxlength:7,rules:[{validator:(a,A)=>{if(!A)return Promise.reject(new Error("Ingresar número de reserva"));const M=String(A).length;return M<7?Promise.reject(new Error("El número debe tener al menos 7 cifras")):M>7?Promise.reject(new Error("El número no puede superar las 7 cifras")):Promise.resolve()},trigger:"change"}]}};else{e.observations=null;const{observations:a,...A}=m.value;m.value=A}},C=async i=>{i=="city_id"&&(e.province_id=null,e.district_id=null,s.value.province_id=[],s.value.city_id=r.cities),i=="province_id"&&(e.province_id=null,e.district_id=null,s.value.district_id=[])},d=async()=>{E.value=!0;const i={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,component_id:e.component_id,theme_id:e.theme_id,modality_id:e.modality_id,ruc:e.ruc,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,...e.observations&&{observations:e.observations}};try{const p=await $({url:`advisory/update-values-advisory/${_.info.id}`,method:"PUT",data:i});p.status==200&&(Y.success(p.message),w("closeDraw",!0),D())}catch{const a=document.getElementsByClassName("ant-drawer-body")[0];a&&(a.scrollTop=0)}finally{E.value=!1}},D=()=>{e.economicsector_id=null,e.comercialactivity_id=null,e.component_id=null,e.theme_id=null,e.theme_id=null,e.modality_id=null,e.ruc=null,e.city_id=null,e.province_id=null,e.district_id=null,e.observations=null;const{observations:i,...p}=m.value;m.value=p},m=u({economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},component_id:{type:"iSelect",label:"COMPONENTE",name:"component_id",required:!0,message:"Seleccionar un componente",disabled:!1},theme_id:{type:"iSelect",label:"TEMA DEL COMPONENTE",name:"theme_id",required:!0,message:"Seleccionar un tema del componente",disabled:!0},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!1},ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(i,p)=>{if(!p)return Promise.resolve();const a=p.toString();return a.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):["10","15","17","20"].includes(a.substring(0,2))?Promise.resolve():Promise.reject(new Error("El RUC debe empezar con 10, 15, 17 o 20"))},trigger:"change"}]},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0}}),O=async i=>{g.value=!0;try{if(i){if(e.economicsector_id=i.econimic_sector_id,e.comercialactivity_id=i.activity_comercial_id,e.city_id=i.city_id,await r.fetchProvinces(e.city_id),s.value.province_id=r.provinces,e.province_id=i.province_id,await r.fetchDistricts(e.province_id),s.value.district_id=r.districts,e.district_id=i.district_id,e.modality_id=i.modality_id,e.ruc=i.ruc,e.component_id=i.component_id,m.value.theme_id.disabled=!1,e.component_id=i.component_id,await r.fetchComponentThemes(e.component_id),s.value.theme_id=r.componentThemes,e.theme_id=i.theme_id,i.theme_id==17)m.value={...m.value,observations:{type:"iNumber",label:"NÚMERO DE RESERVA (7 dígitos)",name:"observations",required:!0,message:"Ingresar número de reserva",disabled:!1,prefix:"Z -",maxlength:7,rules:[{validator:(p,a)=>{if(!a)return Promise.reject(new Error("Ingresar número de reserva"));const A=String(a).length;return A<7?Promise.reject(new Error("El número debe tener al menos 7 cifras")):A>7?Promise.reject(new Error("El número no puede superar las 7 cifras")):Promise.resolve()},trigger:"change"}]}};else{e.observations=null;const{observations:p,...a}=m.value;m.value=a}e.observations=i.observations}}catch(p){console.error("Error al cargar la información:",p)}finally{g.value=!1}};return Z(async()=>{_.info&&O(_.info),await r.fetchEconomicSectors(),s.value.economicsector_id=r.economicSectors,await r.fetchComercialActivities(),s.value.comercialactivity_id=r.comercialActivities,await r.fetchCities(),s.value.city_id=r.cities,await r.fetchModalities(),s.value.modality_id=r.modalities,await r.fetchComponents(),s.value.component_id=r.components,g.value=!1}),X(()=>_.info,i=>{i?O(i):D()}),P("formState",e),P("loadingState",E),(i,p)=>g.value?(T(),G(z(K),{key:0,style:{color:"#00a6db"}})):(T(),k("div",Ce,[f(Q,{fields:m.value,options:s.value,btnSaveName:t.value,onHandleFocusSelect:C,onHandleChangeSelect:n,onOnSubmit:d},null,8,["fields","options","btnSaveName"])]))}};const Ie={key:1,class:"ppnn-draw"},Se={__name:"EditarPPNN",props:{info:{type:Object,required:!0,default:()=>({})}},emits:["closeDraw"],setup(L,{emit:y}){const _=L,w=y,r=ee(),g=u(!0),E=u(!1),e=H({}),t=u("ACTUALIZAR"),s=u({city_id:[],province_id:[],district_id:[],economicsector_id:[]}),n=async i=>{i=="city_id"&&(await r.fetchProvinces(e.city_id),s.value.province_id=r.provinces,m.value.province_id.disabled=!1),i=="province_id"&&(await r.fetchDistricts(e.province_id),s.value.district_id=r.districts,m.value.district_id.disabled=!1),i=="component_id"&&(await r.fetchComponentThemes(e.component_id),s.value.theme_id=r.componentThemes,e.theme_id=null,m.value.theme_id.disabled=!1)},C=async i=>{i=="city_id"&&(await r.fetchCities(),e.district_id=null,s.value.province_id=[],s.value.city_id=r.cities),i=="province_id"&&(e.province_id=null,e.district_id=null,s.value.district_id=[])},d=async()=>{E.value=!0;const i={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,detailprocedure_id:e.detailprocedure_id,modality_id:e.modality_id,ruc:e.ruc,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address};try{const p=await $({url:`formalization/update-values-ruc-10/${_.info.id}`,method:"PUT",data:i});p.status==200&&(Y.success(p.message),w("closeDraw",!0),D())}catch{Y.error(r.error)}finally{E.value=!1}},D=()=>{e.economicsector_id=null,e.comercialactivity_id=null,e.detailprocedure_id=null,e.modality_id=null,e.ruc=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null},m=u({economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},detailprocedure_id:{type:"iSelect",label:"DETALLE DEL TRÁMITE",name:"detailprocedure_id",required:!0,message:"Seleccionar detalle del trámite",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!1},ruc:{type:"iNumber",label:"NÚMERO DE RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,required:!0,rules:[{validator:(i,p)=>{if(!p)return Promise.reject(new Error("El Número de RUC es obligatorio"));const a=p.toString();return a.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):["10","15","17"].includes(a.substring(0,2))?Promise.resolve():Promise.reject(new Error("El RUC debe empezar con 10, 15 o 17"))},trigger:"change"}]},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!0,message:"Escribir la direccion del Negocio",disabled:!1}}),O=async i=>{g.value=!0;try{i&&(e.economicsector_id=i.econimic_sector_id,e.comercialactivity_id=i.activity_comercial_id,e.detailprocedure_id=i.detailprocedure_id,e.modality_id=i.modality_id,e.ruc=i.ruc,e.city_id=i.city_id,await r.fetchProvinces(e.city_id),s.value.province_id=r.provinces,e.province_id=i.province_id,await r.fetchDistricts(e.province_id),s.value.district_id=r.districts,e.district_id=i.district_id,e.address=i.address)}catch(p){Y.error(p.message)}finally{g.value=!1}};return Z(async()=>{_.info&&O(_.info),await r.fetchEconomicSectors(),s.value.economicsector_id=r.economicSectors,await r.fetchComercialActivities(),s.value.comercialactivity_id=r.comercialActivities,await r.fetchDetailProcedures(),s.value.detailprocedure_id=r.detailProcedures,await r.fetchModalities(),s.value.modality_id=r.modalities,await r.fetchCities(),s.value.city_id=r.cities,await r.fetchProvinces(e.city_id),s.value.province_id=r.provinces,await r.fetchDistricts(e.province_id),s.value.district_id=r.districts,g.value=!1}),X(()=>_.info,i=>{i?O(i):D()}),P("formState",e),P("loadingState",E),(i,p)=>g.value?(T(),G(z(K),{key:0,style:{color:"#00a6db"}})):(T(),k("div",Ie,[f(Q,{fields:m.value,options:s.value,btnSaveName:t.value,onHandleFocusSelect:C,onHandleChangeSelect:n,onOnSubmit:d,mayus:!0},null,8,["fields","options","btnSaveName"])]))}},we={key:1,class:"f-20"},De={__name:"EditarFormalizacionRUC20",props:["info"],emits:["closeDraw"],setup(L,{emit:y}){x.locale("es");const _=u({ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(o,S)=>{if(!S)return Promise.resolve();const I=S.toString();return I.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):I.startsWith("20")?Promise.resolve():Promise.reject(new Error('El número de RUC debe comenzar con "20"'))},trigger:"change"}]},nameMype:{type:"iText",label:"NOMBRE EMPRESA",name:"nameMype",required:!0,message:"Escribir nombre de la empresa",disabled:!1},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!0,message:"Escribir la dirección del negocio",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},regime_id:{type:"iSelect",label:"RÉGIMEN SOCIETARIO",name:"regime_id",required:!0,message:"Seleccionar el régimen societario",disabled:!1},economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},numbernotary:{type:"iText",label:"NÚM. SOLICITUD CONSTANCIA",name:"numbernotary",required:!0,message:"Escribir número de solicitud de constancia",disabled:!1,maxlength:8,rules:[{validator:(o,S)=>{if(!S)return Promise.reject(new Error("El número de notaría es requerido"));const I=S.toString();return/^\d{8}$/.test(I)?Promise.resolve():Promise.reject(new Error("El número debe tener exactamente 8 dígitos numéricos"))},trigger:"change"}]},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},notary_id:{type:"iSelectNotary",label:"NOTARÍA",name:"notary_id",required:!0,message:"Seleccionar una notaría",disabled:!1},dateReception:{type:"iDate",label:"FECHA DE RECEPCION PNTE",name:"dateReception",required:!0,disabled:!1,disabledDate:o=>!1},dateTramite:{type:"iDate",label:"FEC. TRÁMITE SID SUNARP-SUNAT",name:"dateTramite",required:!0,disabled:!1,disabledDate:o=>t.dateReception&&o&&x(o).isBefore(x(t.dateReception))},isbic:{type:"iSelect",label:"¿ES UNA SOCIEDAD BIC?",name:"isbic",required:!1,message:"Buscar BIC",disabled:!1},montocapital:{type:"iMoney",label:"MONTO DE CAPITAL SOCIAL",name:"montocapital",required:!1,message:"Escribir el Monto de capital social",disabled:!1},typecapital_id:{type:"iSelect",label:"TIPO DE APORTE DE CAPITAL",name:"typecapital_id",required:!1,message:"Seleccionar BIC",disabled:!1}}),w=JSON.parse(localStorage.getItem("profile")),r=y,g=L,E=u(!0),e=u("REGISTRAR"),t=H({}),s=u(!1),n=ee(),C=u(null),d=u({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[]}),D=o=>{console.log("handleInputEvent",o)},m=async o=>{o=="dateReception"&&(t.dateTramite&&(t.dateTramite=null),_.value.dateTramite.disabled=!1)},O=async o=>{o=="city_id"&&(await n.fetchProvinces(t.city_id),d.value.province_id=n.provinces,_.value.province_id.disabled=!1),o=="province_id"&&(await n.fetchDistricts(t.province_id),d.value.district_id=n.districts,_.value.district_id.disabled=!1)},i=async o=>{console.log("handleFocusSelect",o),o=="city_id"&&(await n.fetchCities(),t.city_id=null,t.province_id=null,t.district_id=null,d.value.province_id=[],d.value.city_id=n.cities),o=="province_id"&&(t.province_id=null,t.district_id=null,d.value.district_id=[]),o=="modality_id"&&(await n.fetchModalities(),d.value.modality_id=n.modalities),o=="regime_id"&&(await n.fetchRegimes(),d.value.regime_id=n.regimes),o=="economicsector_id"&&(await n.fetchEconomicSectors(),d.value.economicsector_id=n.economicSectors),o=="comercialactivity_id"&&(await n.fetchComercialActivities(),d.value.comercialactivity_id=n.comercialActivities),o=="notary_id"&&A(),o=="isbic"&&a(),o=="typecapital_id"&&(await n.fetchTypeCapital(),d.value.typecapital_id=n.typeCapital)},p=o=>{},a=()=>{d.value.isbic=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}]},A=async()=>{try{const{data:o}=await te({url:"public/notaries-filters",method:"GET"}),S=o.map(I=>({value:I.id,name:I.name,city:I.city.name,province:I.province.name,district:I.district.name,address:I.address}));d.value.notary_id=S}catch(o){console.error("Error de red:",o)}},M=async()=>{s.value=!0;const o={ruc:t.ruc,nameMype:t.nameMype,city_id:t.city_id,province_id:t.province_id,district_id:t.district_id,address:t.address,modality_id:t.modality_id,regime_id:t.regime_id,economicsector_id:t.economicsector_id,numbernotary:t.numbernotary,comercialactivity_id:t.comercialactivity_id,notary_id:t.notary_id,dateReception:x(t.dateReception).format("YYYY-MM-DD"),dateTramite:x(t.dateTramite).format("YYYY-MM-DD"),isbic:t.isbic,montocapital:t.montocapital,typecapital_id:t.typecapital_id,user_id:t.user_id,people_id:t.people_id,dni:t.dni,userupdated_id:w.user_id};try{(await $({url:`formalization/update-ruc-20/${g.info.id}`,method:"PUT",data:o})).status===200&&(J(),r("closeDraw",!0))}catch(S){console.error("Error:",S);const I=document.getElementsByClassName("ant-drawer-body")[0];I&&(I.scrollTop=0)}finally{s.value=!1}},J=()=>{t.ruc=null,t.nameMype=null,t.city_id=null,t.province_id=null,t.district_id=null,t.address=null,t.modality_id=null,t.regime_id=null,t.economicsector_id=null,t.numbernotary=null,t.comercialactivity_id=null,t.notary_id=null,t.dateReception=null,t.dateTramite=null,t.isbic=null,t.montocapital=null,t.typecapital_id=null},q=async o=>{E.value=!0;try{o&&(t.ruc=o.ruc,t.nameMype=o.name_mype,await n.fetchCities(),d.value.city_id=n.cities,t.city_id=o.city_id,await n.fetchProvinces(t.city_id),d.value.province_id=n.provinces,_.value.province_id.disabled=!1,t.province_id=o.province_id,await n.fetchDistricts(t.province_id),d.value.district_id=n.districts,_.value.district_id.disabled=!1,t.district_id=o.district_id,t.address=o.address,await n.fetchModalities(),d.value.modality_id=n.modalities,t.modality_id=o.modality_id,await n.fetchRegimes(),d.value.regime_id=n.regimes,t.regime_id=o.regime_id,await n.fetchEconomicSectors(),d.value.economicsector_id=n.economicSectors,t.economicsector_id=o.econimic_sector_id,t.numbernotary=o.num_solicitud,await n.fetchComercialActivities(),d.value.comercialactivity_id=n.comercialActivities,t.comercialactivity_id=o.activity_comercial_id,A(),t.notary_id=o.notary_id,t.dateReception=o.date_reception?x(o.date_reception,"DD/MM/YYYY"):null,t.dateTramite=o.date_tramite?x(o.date_tramite,"DD/MM/YYYY"):null,t.isbic=o.bic,t.montocapital=o.monto_capital,await n.fetchTypeCapital(),d.value.typecapital_id=n.typeCapital,t.typecapital_id=o.typecapital_id)}catch(S){console.error("Error al cargar la información:",S)}finally{E.value=!1}};return Z(()=>{g.info&&q(g.info)}),X(()=>g.info,o=>{o&&q(o)}),P("formState",t),P("loadingState",s),(o,S)=>E.value?(T(),G(z(K),{key:0,style:{color:"#00a6db"}})):(T(),k("div",we,[f(Q,{fields:_.value,options:d.value,btnSaveName:e.value,onHandleInputEvent:D,resetSelect:C.value,onHandleChangeSelect:O,onHandleFocusSelect:i,onHandleBlurSelect:p,onHandleChangeClock:m,onOnSubmit:M},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const Oe={class:"flex justify-between mt-4"},Ae={__name:"DescribeMotive",props:["loadingDescribeMotive"],emits:["closeModal","goToFunction"],setup(L,{emit:y}){const _=L,w=y,r=u(!0),g=u(null),E=u({comentario:""}),e={comentario:[{validator:(n,C)=>C?C.trim().split(/\s+/).length<4?Promise.reject("Debe contener al menos 4 palabras"):Promise.resolve():Promise.reject("El comentario es obligatorio"),trigger:"blur"}]},t=()=>{r.value=!1,g.value.resetFields(),w("closeModal")},s=()=>{g.value.validate().then(()=>{w("goToFunction",E.value.comentario)}).catch(()=>{Y.error("Corrige los errores antes de continuar")})};return(n,C)=>{const d=U("a-textarea"),D=U("a-form-item"),m=U("a-button"),O=U("a-form");return T(),G(O,{model:E.value,rules:e,ref_key:"formRef",ref:g,layout:"vertical"},{default:N(()=>[f(D,{name:"comentario"},{default:N(()=>[f(d,{value:E.value.comentario,"onUpdate:value":C[0]||(C[0]=i=>E.value.comentario=i),placeholder:"Escribe tu comentario (mínimo 4 palabras)...",rows:4},null,8,["value"])]),_:1}),h("div",Oe,[f(m,{onClick:t,class:"w-1/2 mr-2"},{default:N(()=>C[1]||(C[1]=[B("Cancelar")])),_:1}),f(m,{type:"primary",class:"w-1/2 ml-2",onClick:s,loading:_.loadingDescribeMotive},{default:N(()=>[B(ie(_.loadingDescribeMotive?"":"Aceptar"),1)]),_:1},8,["loading"])])]),_:1},8,["model"])}}},Ne=be(Ae,[["__scopeId","data-v-19c517c6"]]);const Te={class:"layout-content"},Re={class:"advisory-table"},xe={class:"filter-type"},Me={key:0,class:"filter-type"},Pe={key:1,class:"filter-asesor"},Le=["onClick"],Ue=["onClick"],Ze={__name:"reportes-index",setup(L){const y=JSON.parse(localStorage.getItem("profile"))||{},_=u(!1),w=u(null),r=u(!1),g=u([{label:"ASESORÍAS",value:1},{label:"F. RUC 10",value:2},{label:"F. RUC 20",value:3}]),E=u([{label:"CDE",value:1},{label:"CDEAI INSTITUCIONES",value:2},{label:"CDEAN NOTARÍAS",value:3}]),e=u([]),t=u(0),s=u(90),n=u(!1),C=u(!1),d=u("Asesorías"),D=u(!1),m=u(!1),O=u(!1),i=u(null),p=u(!1),a=H({year:x("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null}),A=u([]),M=u([]),J=(c,l)=>{const b=c.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return l.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(b)},q=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:80},{title:"FECHA",fixed:"left",dataIndex:"date",width:100,align:"center"},...y.rol!=2?[{title:"ASESOR",dataIndex:"asesor",width:200,customCell:()=>({style:{backgroundColor:"#f0f5ff"}})}]:[],...y.rol!=2?[{title:"ASESOR CDE",dataIndex:"asesor_cde",width:160,customCell:()=>({style:{backgroundColor:"#f0f5ff"}})}]:[],{title:"TIPO DOCUMENTO",dataIndex:"emp_document_type",width:100,align:"center"},{title:"NÚMERO DE DOCUMENTO",dataIndex:"emp_document_number",align:"center",width:140},{title:"SOLICITANTE APELLIDO PATERNO",dataIndex:"emp_lastname",width:150},{title:"SOLICITANTE APELLIDO MATERNO",dataIndex:"emp_middlename",width:150},{title:"SOLICITANTE NONBRE",dataIndex:"emp_name",width:150},{title:"PAÍS",dataIndex:"emp_country",align:"center",width:120},{title:"FEC. NAC",dataIndex:"emp_birth",align:"center",width:120},{title:"EDAD",dataIndex:"emp_age",align:"center",width:80},{title:"GÉNERO",dataIndex:"emp_gender",width:80,align:"center"},{title:"DISCAPACIDAD",dataIndex:"emp_discapabilities",width:120,align:"center"},{title:"HIJOS",dataIndex:"emp_soons",width:80,align:"center"},{title:"CELULAR",dataIndex:"emp_phone",width:120,align:"center"},{title:"EMAIL",dataIndex:"emp_email",width:200},{title:"CIUDAD",dataIndex:"city",width:120,align:"center"},{title:"PROVINCIA",dataIndex:"province",width:140,align:"center"},{title:"DISTRITO",dataIndex:"district",width:140,align:"center"},{title:"RUC",dataIndex:"ruc",width:120,align:"center"}],o=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_service",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"COMPONENTE",dataIndex:"component",width:140,align:"center"},{title:"TEMA",dataIndex:"theme",width:200},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"CODIGO SID SUNARP",align:"center",dataIndex:"observations",width:140},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],S=[{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"DETALLE DEL TRÁMITE",dataIndex:"detail_tramit",width:180},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],I=[{title:"NOMBRE DE LA EMPRESA",dataIndex:"nameMype",width:200},{title:"SECTOR ECONÓMICO",dataIndex:"econimic_sector",width:120,align:"center"},{title:"ACTIVIDAD COMERCIAL",dataIndex:"activity_comercial",width:200},{title:"FECHA DE RECEPCIÓN",dataIndex:"date_reception",width:160,align:"center"},{title:"FECHA DE TRÁMITE",dataIndex:"date_tramite",width:160,align:"center"},{title:"TIPO DE RÉGIMEN",dataIndex:"type_regimen",width:150,align:"center"},{title:"BIC",dataIndex:"bic",width:50,align:"center"},{title:"NÚMERO DE SOLICITUD",dataIndex:"num_solicitud",width:160,align:"center"},{title:"NOTARÍA",dataIndex:"notaria",width:200},{title:"TIPO DE APORTE",dataIndex:"type_aporte",width:160,align:"center"},{title:"MONTO CAPITAL",dataIndex:"monto_capital",width:160,align:"center"},{title:"NODALIDAD",dataIndex:"modality",width:100,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}];function ae(){if(y.user_id){const c={user:y.user_id,name:y.name,lastname:y.lastname,middlename:y.middlename};if(y.user_id){const l=btoa(JSON.stringify(c)),b=`${Ee()}/preguntas-formalizaciones?data=${l}`;window.open(b,"_blank")}}}const re=()=>{console.log("handleNew...")},le=c=>({Asesorias:"ases","Formalizaciones RUC 10":"f10","Formalizaciones RUC 20":"f20"})[c],oe=async c=>{_.value=!0;try{const b={table_name:{Asesorias:"asesoria","Formalizaciones RUC 10":"f10","Formalizaciones RUC 20":"f20"}[d.value]||d.value,row_id:w.value.id,description:c,action:"d"};if((await $({url:"token/indicate-reason-action",method:"POST",data:b})).status==200)try{let R=null;d.value==="Asesorias"&&(R=`advisory/delete/${w.value.id}`),d.value==="Formalizaciones RUC 10"&&(R=`formalization/delete-ruc-10/${w.value.id}`),d.value==="Formalizaciones RUC 20"&&(R=`formalization/delete-ruc-20/${w.value.id}`);const V=await $({url:R,method:"DELETE"});F(),Y.success(V.message),r.value=!1}catch(R){console.error("Error al eliminar registro:",R),Y.error("No se pudo eliminar el registro.")}}catch(l){console.error("Error al registrar motivo:",l),Y.error("No se pudo registrar el motivo de la acción.")}finally{_.value=!1}},ne=c=>{w.value=c,r.value=!0},se=async()=>{C.value=!0;try{const c={};a.year&&(c.year=x(a.year).format("YYYY")),a.range&&(c.dateStart=a.range[0].format("YYYY/MM/DD"),c.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(c.asesor=a.asesor),a.name&&(c.name=a.name),a.typeCdes&&(c.typeCdes=a.typeCdes);let l=null,b=null;a.type==1&&(l="download/asesories",b="Asesorías"),a.type==2&&(l="download/formalizations-ruc10",b="Formalizaciones 10"),a.type==3&&(l="download/formalizations-ruc20",b="Formalizaciones 20"),await ge(l,b,c)}catch(c){console.error("Error de red:",c)}finally{C.value=!1}},de=async c=>{a.page=c,await F()},ce=async c=>{c&&(a.page=1,await F())},ue=c=>{i.value=c,a.type==1&&(D.value=!0),a.type==2&&(m.value=!0),a.type==3&&(O.value=!0)},me=()=>{a.type==1&&(M.value=[...q,...o],d.value="Asesorias"),a.type==2&&(M.value=[...q,...S],d.value="Formalizaciones RUC 10"),a.type==3&&(M.value=[...q,...I],d.value="Formalizaciones RUC 20")},F=async()=>{n.value=!0,me();try{const c={page:a.page};a.year&&(c.year=x(a.year).format("YYYY")),a.range&&(c.dateStart=a.range[0].format("YYYY/MM/DD"),c.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(c.asesor=a.asesor),a.name&&(c.name=a.name),a.typeCdes&&(c.typeCdes=a.typeCdes);let l=null;a.type==1&&(l="historial/advisories/filters"),a.type==2&&(l="historial/formalizations-10/filters"),a.type==3&&(l="historial/formalizations-20/filters");const b=await $({url:l,method:"GET",params:c});e.value=b.data.data,t.value=b.data.total,s.value=b.data.per_page,y.rol!=2&&await pe()}catch(c){console.error("Error de red:",c)}finally{n.value=!1}},pe=async()=>{try{const c=await te({url:"select/asesores-report",method:"GET"});c.status==200&&(A.value=c.data)}catch{console.log("Failed to delete")}};return Z(async()=>{await F()}),P("search",a),P("loading",n),P("loadingFile",C),(c,l)=>{const b=U("a-select"),j=U("a-menu-item"),R=U("a-drawer"),V=U("a-modal");return T(),k("div",Te,[h("div",Re,[f(ye,{title:`REPORTE GENERAL - ${d.value}`,new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:M.value,downloadExcel:!0,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:s.value,nameTotal:d.value,dataSource:e.value,total:t.value,onHandleNew:re,onHandleDownloadExcel:se,onHandleSearch:ce,onHandlePaginator:de},{header:N(()=>[h("div",xe,[l[12]||(l[12]=h("small",null,"TIPO",-1)),f(b,{value:a.type,"onUpdate:value":l[0]||(l[0]=v=>a.type=v),options:g.value},null,8,["value","options"])]),z(y).rol!=2?(T(),k("div",Me,[l[13]||(l[13]=h("small",null,"TIPO CDE",-1)),f(b,{allowClear:!0,value:a.typeCdes,"onUpdate:value":l[1]||(l[1]=v=>a.typeCdes=v),options:E.value},null,8,["value","options"])])):W("",!0),z(y).rol!=2?(T(),k("div",Pe,[l[14]||(l[14]=h("small",null,"POR ASESOR",-1)),f(b,{allowClear:!0,value:a.asesor,"onUpdate:value":l[2]||(l[2]=v=>a.asesor=v),placeholder:"Selecciona Asesor","show-search":"",options:A.value,"filter-option":J},null,8,["value","options"])])):W("",!0)]),"custom-options":N(({record:v})=>[f(j,null,{default:N(()=>[h("a",{onClick:_e=>ue(v)},"Editar",8,Le)]),_:2},1024),z(y).rol==1?(T(),G(j,{key:0},{default:N(()=>[h("a",{onClick:_e=>ne(v),style:{color:"#ff4d4f"}},"Eliminar",8,Ue)]),_:2},1024)):W("",!0)]),_:1},8,["title","columns","pageSize","nameTotal","dataSource","total"]),f(R,{width:"600",title:"EDITAR ASESORÍA",open:D.value,"onUpdate:open":l[4]||(l[4]=v=>D.value=v),placement:"right"},{default:N(()=>[f(he,{info:i.value,onCloseDraw:l[3]||(l[3]=v=>(D.value=!1,F()))},null,8,["info"])]),_:1},8,["open"]),f(R,{width:"600",title:"EDITAR PPNN",open:m.value,"onUpdate:open":l[6]||(l[6]=v=>m.value=v),placement:"right"},{default:N(()=>[f(Se,{info:i.value,onCloseDraw:l[5]||(l[5]=v=>(m.value=!1,F()))},null,8,["info"])]),_:1},8,["open"]),f(R,{width:"600",title:"Editar Formalización RUC 20",open:O.value,"onUpdate:open":l[8]||(l[8]=v=>O.value=v),placement:"right"},{default:N(()=>[f(De,{info:i.value,onCloseDraw:l[7]||(l[7]=v=>(O.value=!1,F()))},null,8,["info"])]),_:1},8,["open"]),f(V,{open:p.value,"onUpdate:open":l[9]||(l[9]=v=>p.value=v),title:"📌 ¿Aún no llenaste el formulario?",width:"420px",footer:null,maskClosable:!1,closable:!1},{default:N(()=>[l[15]||(l[15]=h("p",null,"¡Hola! 👋",-1)),l[16]||(l[16]=h("p",null,"Notamos que aún no has completado el formulario con preguntas frecuentes sobre formalización.",-1)),l[17]||(l[17]=h("p",null,"Tómate un momento para completarlo cuando puedas. ¡Tu experiencia es importante para nosotros!",-1)),l[18]||(l[18]=h("br",null,null,-1)),h("a",{href:"#",onClick:ve(ae,["prevent"]),class:"btn-complete-modal"}," IR AL FORMULARIO "),l[19]||(l[19]=h("br",null,null,-1)),l[20]||(l[20]=h("p",{style:{color:"#ff4d4f","text-align":"center"}},[B("Completado el formulario regresa a esta página y "),h("b",null,"actualiza"),B(" para que este mensaje desaparezca. ")],-1))]),_:1},8,["open"]),f(V,{open:r.value,"onUpdate:open":l[11]||(l[11]=v=>r.value=v),title:"DESCRIBE MOTIVO",footer:null,width:"450px"},{default:N(()=>[h("span",{class:fe(["tag-formalizations",le(d.value)])},ie(d.value),3),f(Ne,{onCloseModal:l[10]||(l[10]=v=>r.value=!1),onGoToFunction:oe,loadingDescribeMotive:_.value},null,8,["loadingDescribeMotive"])]),_:1},8,["open"])])])}}};export{Ze as default};
