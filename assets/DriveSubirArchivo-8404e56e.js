import{g as E,r as x,a as N,b as u,o as n,d,e as p,c as i,w as r,F as m,K as L,m as f,s as H,x as b,h,i as S,y as _,t as P}from"./index-c6040b72.js";import{u as $}from"./selectes-725e3102.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import{U as T}from"./UploadOutlined-cbd465fe.js";const z={pdfDocument:{type:"iUpload",label:"",name:"pdfDocument",required:!1,message:""},file_id:{type:"iSelect",label:"Seleccionar una carpeta",name:"file_id",required:!0,message:"Debes seleccionar una carpeta"}};const J={class:"agreement-wrapper"},K={class:"grid-item"},W={__name:"DriveSubirArchivo",setup(G){const y=JSON.parse(localStorage.getItem("profile")),D=E.get("token"),c=$(),w="https://apituempresa.soporte-pnte.com/api/",k="http://127.0.0.1:8000/api/",U=window.location.hostname=="localhost"||window.location.hostname=="127.0.0.1"?k:w;c.$patch({folders:c.folders}),c.fetchFolders();const v=x(!1),t=x([]),o=N({pdfDocument:null,file_id:null}),C=s=>{o.pdfDocument=null;const e=t.value.indexOf(s),l=t.value.slice();l.splice(e,1),t.value=l},F=s=>{const e=["pdf","xls","xlsx","doc","docx","ppt","pptx","png","jpg","jpeg","gif"],l=s.name.split(".").pop().toLowerCase();return e.includes(l)?(t.value=[...t.value,s],o.pdfDocument="file",!1):(f.error("Solo se permiten archivos PDF, Excel, Word, PowerPoint e imÃ¡genes."),!1)},q=async()=>{v.value=!0;const s={user_id:y.user_id,profile_id:y.id,files:t.value,file_id:o.file_id};try{const{data:e}=await L.post(`${U}drive/up-files`,s,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${D}`}});f.success(e.message),t.value=[],o.file_id=null}catch{f.error("Error al subir")}finally{v.value=!1}},A=()=>{t.value>=1?o.pdfDocument="file":f.error("Debes completar los campos requeridos")};return(s,e)=>{const l=u("a-button"),B=u("a-upload"),g=u("a-form-item"),I=u("a-select"),R=u("a-form");return n(),d(m,null,[e[1]||(e[1]=p("h3",null,"SUBIR ARCHIVOS",-1)),e[2]||(e[2]=p("br",null,null,-1)),p("div",J,[i(R,{layout:"vertical",model:o,name:"basic",autocomplete:"off",onFinish:q,onFinishFailed:A},{default:r(()=>[p("div",K,[(n(!0),d(m,null,H(h(z),(a,V)=>(n(),d(m,{key:V},[a.type==="iUpload"?(n(),b(g,{key:0,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:r(()=>[i(B,{"file-list":t.value,"before-upload":F,onRemove:C},{default:r(()=>[i(l,null,{default:r(()=>[i(h(T)),e[0]||(e[0]=S(" Seleccionar archivo "))]),_:1})]),_:1},8,["file-list"])]),_:2},1032,["name","label","rules"])):_("",!0),t.value.length>=1?(n(),d(m,{key:1},[a.type==="iSelect"?(n(),b(g,{key:0,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:r(()=>[i(I,{value:o[a.name],"onUpdate:value":O=>o[a.name]=O,options:h(c).folders,style:{width:"280px"}},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name","label","rules"])):_("",!0)],64)):_("",!0)],64))),128))]),t.value.length>=1?(n(),b(g,{key:0},{default:r(()=>[i(l,{class:"btn-produce",type:"primary","html-type":"submit",loading:v.value},{default:r(()=>[S("SUBIR "+P(t.value.length==1?"ARCHIVO":"ARCHIVOS"),1)]),_:1},8,["loading"])]),_:1})):_("",!0)]),_:1},8,["model"])])],64)}}},Z=j(W,[["__scopeId","data-v-e196962b"]]);export{Z as default};
