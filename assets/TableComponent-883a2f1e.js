import{c as l,A as de,g as pe,b as u,o as n,x as y,w as c,h as a,m as R,K as me,l as h,a9 as N,r as b,G as fe,Z as ve,j as ge,d as v,e as r,a7 as _e,t as w,i as I,y as m,q as P,L as ye,F as B,aa as $,O as he}from"./index-7e9acb77.js";import{_ as be}from"./icoexcel-1b303edf.js";import{u as we}from"./selectes-a3dddb5f.js";import{U as Se}from"./UploadOutlined-0ed0ebd7.js";import"./es-9e9e6cdd.js";import{M as ke}from"./MoreOutlined-2b91a63f.js";var Ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};const Oe=Ce;function j(d){for(var p=1;p<arguments.length;p++){var i=arguments[p]!=null?Object(arguments[p]):{},t=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),t.forEach(function(f){xe(d,f,i[f])})}return d}function xe(d,p,i){return p in d?Object.defineProperty(d,p,{value:i,enumerable:!0,configurable:!0,writable:!0}):d[p]=i,d}var L=function(p,i){var t=j({},p,i.attrs);return l(de,j({},t,{icon:Oe}),null)};L.displayName="SyncOutlined";L.inheritAttrs=!1;const ze=L,De={__name:"BtnInportExcel",setup(d){const p=(localStorage.getItem("token")||pe.get("token")||"").replace(/"/g,""),i=p?`Bearer ${p}`:"",t="https://apituempresa.soporte-pnte.com/api/",f="http://127.0.0.1:8000/api/",z=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?f:t,s=async k=>{if(!i)return R.error("Token no encontrado"),!1;const C=new FormData;C.append("file",k);try{const{data:_}=await me.post(`${z}import/events-ugo`,C,{headers:{"Content-Type":"multipart/form-data",Authorization:i}});R.success(_.message||"Importación exitosa")}catch(_){console.error(_)}return!1};return(k,C)=>{const _=u("a-button"),O=u("a-upload");return n(),y(O,{style:{"margin-left":"8px"},"before-upload":s,"show-upload-list":!1,accept:".xlsx,.xls,.csv"},{default:c(()=>[l(_,{type:"dashed"},{default:c(()=>[l(a(Se))]),_:1})]),_:1})}}};const Ae={class:"table-component"},Ee={class:"title-produce"},Ue={key:1,class:"title-produce"},Ne={class:"table-filters"},Ie={key:0,class:"filter-year"},Le={key:1,class:"filter-type"},Te={key:2,class:"filter-type"},Fe={key:3,class:"filter-offices"},Re={key:4,class:"filter-range-date"},Pe={key:5,class:"filter-asesor"},Be={key:6,class:"filter-asesor"},$e={key:7,class:"filter-asesor"},je={class:"filter-search"},Me={key:1},Ye={class:"paginator"},Ge="DD/MM/YYYY",Qe={__name:"TableComponent",props:["title","bread","routeBack","btnUpdate","btnImport","new","textNuevo","columns","dataSource","total","placeholderSearch","asesoresList","nameTotal","pageSize","titleSearch","othersList","tipoformalizacion","searchYear","rangeDate","tipooficina","downloadExcel","cityList","heightTable"],emits:["handleNew","handleDownloadExcel","handleSearch","handlePaginator","handleCallFetchData"],setup(d,{emit:p}){h.locale("es");const i=we();i.$patch({cities:i.cities}),i.fetchCities();const t=d,f=p,z=JSON.parse(localStorage.getItem("role"))||[],s=N("search"),k=N("loading"),C=N("loadingFile"),_=b(window.innerHeight-100),O=b({page:1}),M=b(1200),Y=b([{label:"Últimos 7 días",value:[h().add(-7,"d"),h()]},{label:"Últimos 14 días",value:[h().add(-14,"d"),h()]},{label:"Último mes",value:[h().add(-30,"d"),h()]}]),G=b([{label:"CDE",value:1},{label:"CDEAI INSTITUCIONES",value:2},{label:"CDEAN NOTARÍAS",value:3}]),H=b([{label:"ASESORÍAS",value:1},{label:"F. RUC 10",value:2},{label:"F. RUC 20",value:3}]),V=b([{label:"UGO",value:1},{label:"UGSE",value:2},{label:"TODOS",value:3}]),q=g=>z.some(e=>g.includes(e.id)),J=fe(()=>g=>(O.value.page-1)*t.pageSize+g+1),X=()=>{f("handleCallFetchData")},Z=()=>{f("handleNew")},Q=async()=>{f("handleDownloadExcel")},W=()=>{O.value.page=1,f("handleSearch",!0)},K=g=>{O.value.page=g,f("handlePaginator",g)},D=()=>{if(t.heightTable)return _.value=window.innerHeight-t.heightTable;_.value=window.innerHeight-310},A=(g,e)=>{const E=g.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(E)};return ve(()=>{window.removeEventListener("resize",D)}),ge(()=>{window.addEventListener("resize",D),D()}),(g,e)=>{const E=u("router-link"),U=u("a-breadcrumb-item"),ee=u("a-breadcrumb"),x=u("a-button"),T=u("a-col"),te=u("a-date-picker"),S=u("a-select"),ae=u("a-range-picker"),le=u("a-input"),oe=u("a-row"),ne=u("a-menu"),se=u("a-dropdown"),re=u("a-table"),ie=u("a-tag"),ue=u("a-pagination");return n(),v(B,null,[r("div",Ae,[d.bread?(n(),y(ee,{key:0},{default:c(()=>[l(U,null,{default:c(()=>[l(E,{to:d.routeBack},{default:c(()=>[l(a(_e)),e[10]||(e[10]=r("span",{class:"fs-13"}," Atrás",-1))]),_:1},8,["to"])]),_:1}),l(U,null,{default:c(()=>[r("h3",Ee,w(t.title),1)]),_:1})]),_:1})):(n(),v("h3",Ue,w(t.title),1)),l(oe,{style:{margin:"1rem 0"}},{default:c(()=>[l(T,{xs:24,md:5},{default:c(()=>[t.new?(n(),y(x,{key:0,type:"primary",onClick:Z,style:{"margin-right":".6rem"}},{default:c(()=>[I(w(t.textNuevo),1)]),_:1})):m("",!0),d.downloadExcel?m("",!0):(n(),y(x,{key:1,class:"btn-excel",onClick:Q,loading:a(C),type:"primary"},{default:c(()=>e[11]||(e[11]=[r("img",{width:"20",style:{margin:"-2px 4px 0 0"},src:be},null,-1)])),_:1},8,["loading"])),d.btnImport?(n(),y(De,{key:2})):m("",!0),d.btnUpdate?(n(),y(x,{key:3,style:{"margin-left":".6rem"},icon:P(a(ze)),onClick:X},null,8,["icon"])):m("",!0)]),_:1}),l(T,{xs:24,md:19},{default:c(()=>[r("div",Ne,[t.searchYear?(n(),v("div",Ie,[e[12]||(e[12]=r("small",null,"AÑO",-1)),l(te,{allowClear:!1,value:a(s).year,"onUpdate:value":e[0]||(e[0]=o=>a(s).year=o),picker:"year",placeholder:"Seleccionar año"},null,8,["value"])])):m("",!0),t.tipoformalizacion?(n(),v("div",Le,[e[13]||(e[13]=r("small",null,"TIPO",-1)),l(S,{value:a(s).type,"onUpdate:value":e[1]||(e[1]=o=>a(s).type=o),options:H.value},null,8,["value","options"])])):m("",!0),t.tipoformalizacion?(n(),v("div",Te,[e[14]||(e[14]=r("small",null,"TIPO CDE",-1)),l(S,{allowClear:!0,value:a(s).typeCdes,"onUpdate:value":e[2]||(e[2]=o=>a(s).typeCdes=o),options:G.value},null,8,["value","options"])])):m("",!0),t.tipooficina?(n(),v("div",Fe,[e[15]||(e[15]=r("small",null,"OFICINA",-1)),l(S,{value:a(s).offices,"onUpdate:value":e[3]||(e[3]=o=>a(s).offices=o),options:V.value},null,8,["value","options"])])):m("",!0),t.rangeDate?(n(),v("div",Re,[e[16]||(e[16]=r("small",null,"POR RANGO DE FECHAS",-1)),l(ae,{value:a(s).range,"onUpdate:value":e[4]||(e[4]=o=>a(s).range=o),presets:Y.value,format:Ge},null,8,["value","presets"])])):m("",!0),q([1,5])&&t.asesoresList?(n(),v("div",Pe,[e[17]||(e[17]=r("small",null,"POR ASESOR",-1)),t.asesoresList?(n(),y(S,{key:0,allowClear:!0,value:a(s).asesor,"onUpdate:value":e[5]||(e[5]=o=>a(s).asesor=o),placeholder:"Selecciona Asesor","show-search":"",options:t.asesoresList,"filter-option":A},null,8,["value","options"])):m("",!0)])):m("",!0),t.cityList?(n(),v("div",Be,[e[18]||(e[18]=r("small",null,"POR REGIÓN",-1)),l(S,{allowClear:!0,value:a(s).city_id,"onUpdate:value":e[6]||(e[6]=o=>a(s).city_id=o),placeholder:"Selecciona región","show-search":"",options:a(i).cities,"filter-option":A},null,8,["value","options"])])):m("",!0),t.othersList?(n(),v("div",$e,[e[19]||(e[19]=r("small",null,"ORDENAR POR",-1)),l(S,{allowClear:!0,value:a(s).orderby,"onUpdate:value":e[7]||(e[7]=o=>a(s).orderby=o),placeholder:"Filtrador por:","show-search":"",options:t.othersList,"filter-option":A},null,8,["value","options"])])):m("",!0),r("div",je,[r("small",null,w(t.titleSearch),1),l(le,{value:a(s).name,"onUpdate:value":e[8]||(e[8]=o=>a(s).name=o),placeholder:t.placeholderSearch},null,8,["value","placeholder"])]),l(x,{type:"primary",onClick:W},{default:c(()=>[a(k)?(n(),y(a(ye),{key:0})):(n(),v("span",Me,"BUSCAR"))]),_:1})])]),_:1})]),_:1}),l(re,{bordered:"",scroll:{x:M.value,y:_.value},class:"table-pnte",columns:t==null?void 0:t.columns,"data-source":t==null?void 0:t.dataSource,pagination:!1,loading:a(k),size:"small"},{bodyCell:c(({column:o,record:F,index:ce})=>[o.dataIndex=="idx"?(n(),v(B,{key:0},[I(w(J.value(ce)),1)],64)):m("",!0),$(g.$slots,"data-cell",{column:o,record:F}),o.dataIndex=="actions"?(n(),y(se,{key:1,trigger:["click"]},{overlay:c(()=>[l(ne,null,{default:c(()=>[$(g.$slots,"custom-options",{record:F})]),_:2},1024)]),default:c(()=>[r("a",{class:"ant-dropdown-link",onClick:e[9]||(e[9]=he(()=>{},["prevent"]))},[l(x,{shape:"circle",icon:P(a(ke)),size:"small"},null,8,["icon"])])]),_:2},1024)):m("",!0)]),_:3},8,["scroll","columns","data-source","loading"])]),r("div",Ye,[r("span",null,[l(ie,{color:"blue"},{default:c(()=>[r("b",null,w(t==null?void 0:t.total),1)]),_:1}),I(w(t.nameTotal),1)]),l(ue,{size:"small",total:t==null?void 0:t.total,pageSize:t.pageSize,onChange:K,showSizeChanger:!1},null,8,["total","pageSize"])])],64)}}};export{Qe as _};
