import{_ as V}from"./TableComponent-a0a95197.js";import{r as o,a as G,k as H,X as h,b as c,o as u,d as N,c as r,w as s,p as Y,m as j,f as q,i as J,e as O,z as g,y as C,j as y,t as D}from"./index-dde6e8ba.js";import{E as $}from"./EditarEmpresario-7796277b.js";import"./es-bec1faaf.js";import"./icoexcel-1b303edf.js";import"./selectes-0a881b7c.js";import"./MoreOutlined-d9a55dba.js";import"./FormComponent-f6341e79.js";import"./quill.snow-cbc5f33d.js";import"./useBusinessman-181a4673.js";import"./_plugin-vue_export-helper-c27b6911.js";const X={class:"layout-content"},K={key:0,class:"filter-asesor"},Q=["onClick"],ce={__name:"empresarios-index",setup(W){const w=JSON.parse(localStorage.getItem("profile"))||{},I=o([]),S=o(0),E=o(100),p=o(!1),_=o(!1),i=o(!1),x=o(null),R=o(!1),v=o([]),t=G({asesor:null,name:null,page:1}),k=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"TIPO DOCUMENTO",fixed:"left",dataIndex:"typedocument",align:"center",width:120},{title:"NUM. DOC",dataIndex:"documentnumber",fixed:"left",width:120,align:"center"},{title:"NOMBRES",dataIndex:"name",width:170},{title:"APELLIDOS",dataIndex:"last_name",width:180},{title:"REGIÓN",dataIndex:"city",align:"center",width:140},{title:"PROVINCIA",dataIndex:"province",align:"center",width:140},{title:"DISTRITO",dataIndex:"district",align:"center",width:150},{title:"CELULAR",dataIndex:"phone",align:"center",width:100},{title:"GÉNERO",dataIndex:"gender",align:"center",width:100},{title:"DISCAPACIDAD",dataIndex:"sick",align:"center",width:120},{title:"HIJOS",dataIndex:"hasSoon",align:"center",width:120},{title:"EMAIL",dataIndex:"email",width:240},...w.rol!=2?[{title:"REGISTRADO POR",dataIndex:"registered",width:200,customCell:()=>({style:{backgroundColor:"#f0f5ff"}})}]:[],{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],A=()=>{console.log("handleNew...")},L=async()=>{i.value=!1,await d()},T=(e,a)=>{const m=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(m)},P=async()=>{_.value=!0},z=async e=>{t.page=e,await d()},U=async e=>{e&&(t.page=1,await d())},B=e=>{x.value=e,i.value=!0},d=async()=>{p.value=!0;try{const e={page:t.page};t.year&&(e.year=Y(t.year).format("YYYY")),t.asesor&&(e.asesor=t.asesor),t.name&&(e.name=t.name);const a=await j({url:"businessman/list",method:"GET",params:e});a.status==200&&(I.value=a.data.data,S.value=a.data.total,E.value=a.data.per_page,R.value=a.rol,a.rol!=2&&await M())}catch(e){console.error("Error de red:",e)}finally{p.value=!1}},M=async()=>{try{const e=await q({url:"select/asesores-report",method:"GET"});e.status==200&&(v.value=e.data)}catch{console.log("Failed to delete")}};return H(async()=>{await d()}),h("search",t),h("loading",p),h("loadingFile",_),(e,a)=>{const m=c("a-select"),f=c("a-tag"),b=c("a-menu-item"),F=c("a-drawer");return u(),N("div",X,[r(V,{title:"EMPRESARIOS",new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar por nombres apellidos DNI",columns:k,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:E.value,nameTotal:"Solicitantes",dataSource:I.value,total:S.value,onHandleNew:A,onHandleDownloadExcel:P,onHandleSearch:U,onHandlePaginator:z},{header:s(()=>[J(w).rol!=2?(u(),N("div",K,[a[2]||(a[2]=O("small",null,"POR ASESOR",-1)),r(m,{allowClear:!0,value:t.asesor,"onUpdate:value":a[0]||(a[0]=n=>t.asesor=n),placeholder:"Selecciona Asesor","show-search":"",options:v.value,"filter-option":T},null,8,["value","options"])])):g("",!0)]),"data-cell":s(({column:n,record:l})=>[n.dataIndex=="sick"?(u(),C(f,{key:0},{default:s(()=>[y(D((l.sick||"").toLowerCase()==="si"?"SI":(l.sick||"").toLowerCase()==="no"?"NO":"NO ESPECIFICÓ"),1)]),_:2},1024)):g("",!0),n.dataIndex=="hasSoon"?(u(),C(f,{key:1},{default:s(()=>[y(D((l.hasSoon||"").toLowerCase()==="si"?"SI":(l.hasSoon||"").toLowerCase()==="no"?"NO":"NO ESPECIFICÓ"),1)]),_:2},1024)):g("",!0)]),"custom-options":s(({record:n})=>[r(b,null,{default:s(()=>[O("a",{onClick:l=>B(n)},"Editar",8,Q)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),r(F,{width:"500",title:"Actualizar datos del empresario",open:i.value,"onUpdate:open":a[1]||(a[1]=n=>i.value=n),placement:"right"},{default:s(()=>[r($,{updateInfoBusinessman:x.value,onRegistered:L},null,8,["updateInfoBusinessman"])]),_:1},8,["open"])])}}};export{ce as default};
