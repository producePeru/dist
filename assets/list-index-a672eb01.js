import{_ as W}from"./TableComponent-e1174de9.js";import{p as S,r as l,a as V,k as U,U as G,X as T,o as d,y as B,i as H,L as j,d as g,c as r,w as c,z as h,m as $,h as z,u as J,b as D,F as Q,e as b,j as C,t as k}from"./index-588b0512.js";import{_ as Z}from"./FormComponent-7a2094f6.js";import{u as K}from"./selectes-c9cd2ec1.js";import{U as X}from"./UpImage-f209c148.js";import"./es-dc0c137e.js";import{g as ee}from"./usePermissions-a7bb72bb.js";import{g as te}from"./publicInscripcion-ebc9ecb9.js";import{C as ae}from"./CloudUploadOutlined-db1f9f5f.js";import{A as ie}from"./AuditOutlined-4cf20b0e.js";import"./icoexcel-1b303edf.js";import"./SyncOutlined-e87f9f23.js";import"./MoreOutlined-c1fe2c95.js";import"./quill.snow-09e44321.js";import"./_plugin-vue_export-helper-c27b6911.js";const le={key:1,class:"fairs"},se={key:0},ne={__name:"DrawCyberWow",props:["info"],emits:["closeDraw"],setup(L,{emit:Y}){S.locale("es");const w=l({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},messageEndForm:{type:"iLabel",label:"MENSAJES DE INSCRIPCIONES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE AL FINALIZAR INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const O=Y,n=L,p=l(!0),I=l("GUARDAR"),e=V({}),N=l(!1),y=l(null),s=K(),x=l(null),u=l({city_id:[],fairtype_id:[],modality_id:[]}),M=()=>n.info?{name:n.info.image.name,url:n.info.image.url}:null,F=t=>{},A=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),w.value.dateTramite.disabled=!1)},P=async t=>{y.value=t.id},v=async t=>{t=="city_id"&&(await s.fetchCitiesNational(),e.city_id=null,u.value.city_id=s.citiesNational),t=="fairtype_id"&&(await s.fetchFairTypes(),u.value.fairtype_id=s.fairTypes),t=="modality_id"&&(await s.fetchModalities(),u.value.modality_id=s.modalities)},i=async()=>{N.value=!0;const t={title:e.title,subTitle:e.subTitle,description:e.description,fairtype_id:2,modality_id:1,startDate:S(e.dates.start).format("YYYY-MM-DD"),endDate:S(e.dates.end).format("YYYY-MM-DD"),metaMypes:e.metaMypes,city_id:e.city_id,fecha:null,place:null,hours:null,msgEndForm:e.msgEndForm,msgSendEmail:e.msgSendEmail,image_id:y.value};try{const m=n.info?`fair/update/${n.info.id}`:"events-ugse/cyber-wow-register-event",f=n.info?"PUT":"POST",R=await $({url:m,method:f,data:t});R.status===200&&(z.success(R.message),a(),O("closeDraw",!0))}catch(m){console.error("Error:",m);const f=document.getElementsByClassName("ant-drawer-body")[0];f&&(f.scrollTop=0)}finally{N.value=!1}},a=()=>{e.title=null,e.subTitle=null,e.description="</p>",e.fairtype_id=null,e.modality_id=null,e.dates=null,e.metaMypes=null,e.city_id=null,e.place=null,e.hours=null,e.msgEndForm="</p>",e.msgSendEmail="</p>"},E=async t=>{p.value=!0;try{t&&(e.title=t.title,e.subTitle=t.subTitle,e.description=t.description,await s.fetchFairTypes(),u.value.fairtype_id=s.fairTypes,e.fairtype_id=t.fairtype_id,await s.fetchModalities(),u.value.modality_id=s.modalities,e.modality_id=t.modality_id,e.dates={start:S(t.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:S(t.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.metaMypes=t.metaMypes,await s.fetchCitiesNational(),u.value.city_id=s.citiesNational,e.city_id=t.city_id,e.fecha=t.fecha?S(t.fecha,"DD/MM/YYYY"):null,e.place=t.place,e.hours=t.hours,e.msgEndForm=t.msgEndForm||"</p>",e.msgSendEmail=t.msgSendEmail||"</p>")}catch(m){console.error("Error al cargar la información:",m)}finally{p.value=!1}};return U(()=>{n.info&&E(n.info)}),G(()=>n.info,t=>{t?E(t):a()}),T("formState",e),T("loadingState",N),(t,m)=>p.value?(d(),B(H(j),{key:0,style:{color:"#00a6db"}})):(d(),g("div",le,[r(Z,{fields:w.value,options:u.value,btnSaveName:I.value,onHandleInputEvent:F,resetSelect:x.value,onHandleFocusSelect:v,onHandleChangeClock:A,onOnSubmit:i},{default:c(({field:f})=>[f.name=="iSlotOptions"?(d(),g("div",se,[r(X,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:P,imageLoad:M()},null,8,["imageLoad"])])):h("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const oe={class:"layout-content"},re=["onClick"],de={key:0,style:{"line-height":"1.5"}},ce={key:1},ue={key:3,class:"btn-group-wow"},me={key:0},pe=["onClick"],Ye={__name:"list-index",setup(L){const Y=l({}),w=l([]),O=l(0),n=l(150),p=l(!1);J();const I=l(!1),e=l(null),N=l(!1),y=V({year:S("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:3}),s=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:50},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:180},{title:"FECHAS INSCRIPCIONES",dataIndex:"date",width:70,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:80,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:80,align:"center"},{title:"ACCIONES",dataIndex:"registerBtn",width:140,align:"center"}],x=i=>{const a=`${te()}/cyber-wow/${i}`;window.open(a,"_blank")},u=i=>{e.value=i,p.value=!0},M=()=>{v(),p.value=!1},F=()=>{e.value=null,p.value=!0},A=async i=>{y.page=i,await v()},P=async i=>{i&&(y.page=1,await v())},v=async()=>{try{I.value=!0;const i={page:y.page};y.year&&(i.year=S(y.year).format("YYYY"));const E=await $({url:"events-ugse/cyber-wow",method:"GET",params:i});w.value=E.data.data,O.value=E.data.total,n.value=E.data.per_page}catch(i){console.error("Error de red:",i)}finally{I.value=!1}};return U(async()=>{await v(),Y.value=await ee("wow-list")}),T("search",y),T("loading",I),T("loadingFile",N),(i,a)=>{const E=D("a-tag"),t=D("router-link"),m=D("a-button"),f=D("a-menu-item"),R=D("a-drawer");return d(),g("div",oe,[r(W,{title:"CYBER WOW",new:!0,textNuevo:"NUEVO",placeholderSearch:"Buscar",searchYear:!0,columns:s,titleSearch:"BUSCAR POR EVENTO",pageSize:n.value,nameTotal:"Eventos CYBER WOW",dataSource:w.value,total:O.value,btnUpdate:!0,onHandleNew:F,onHandleCallFetchData:v,onHandleSearch:P,onHandlePaginator:A},{"data-cell":c(({column:_,record:o})=>[_.dataIndex=="link"?(d(),g("a",{key:0,onClick:q=>x(o.slug),href:"javascript:void(0)",target:"_blank"},[r(H(ae),{style:{"font-size":"18px"}})],8,re)):h("",!0),_.dataIndex=="date"?(d(),g(Q,{key:1},[o.startDate!=o.endDate?(d(),g("span",de,[b("div",null,[a[1]||(a[1]=b("b",null,"Desde:",-1)),C(" "+k(o.dateStartFormat),1)]),b("div",null,[a[2]||(a[2]=b("b",null,"Hasta:",-1)),C(k(o.dateEndFormat),1)])])):(d(),g("span",ce,k(o.dateStartFormat),1))],64)):h("",!0),_.dataIndex=="registered"?(d(),B(E,{key:2,color:"processing"},{default:c(()=>[C(k(o.registered_wow),1)]),_:2},1024)):h("",!0),_.dataIndex=="registerBtn"?(d(),g("div",ue,[r(m,{type:"text"},{default:c(()=>[r(t,{to:`/admin/ugse/cyber-wow/inscritos/${o.slug}`},{default:c(()=>a[3]||(a[3]=[C(" Inscritos ")])),_:2},1032,["to"])]),_:2},1024),b("div",null,[r(m,{type:"text",onClick:q=>u(o)},{default:c(()=>a[4]||(a[4]=[C("Editar")])),_:2},1032,["onClick"])]),w.value[0].id==o.id?(d(),g("div",me,[r(m,{type:"text"},{default:c(()=>[r(t,{to:`/admin/ugse/cyber-wow/administrar/${o.slug}`},{default:c(()=>[r(H(ie)),a[5]||(a[5]=C(" Gestionar "))]),_:2},1032,["to"])]),_:2},1024)])):h("",!0)])):h("",!0)]),"custom-options":c(({record:_})=>[Y.value.can_update?(d(),B(f,{key:0},{default:c(()=>[b("a",{onClick:o=>u(_)},"Editar",8,pe)]),_:2},1024)):h("",!0)]),_:1},8,["pageSize","dataSource","total"]),r(R,{open:p.value,"onUpdate:open":a[0]||(a[0]=_=>p.value=_),title:e.value?"EDITAR EVENTO CYBER WOW":"REGISTRAR UN EVENTO CYBER WOW",placement:"right",width:"550"},{default:c(()=>[r(ne,{onCloseDraw:M,info:e.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Ye as default};
