import{F as I,_ as L,a as P}from"./FormalizacionFooter-b6250857.js";import{u as q,r as s,l as U,b as z,o as V,d as D,e,q as G,c as l,w as d,F as R,f as F,t as j,j as r,p as J,k as K,g as C,m as Q}from"./index-eadd5391.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const Z="/assets/gps-ico-4fa94334.png";const i=c=>(J("data-v-8a226ccb"),c=c(),K(),c),A=i(()=>e("div",{class:"container header-wrapper"},[e("img",{src:L,alt:"logo-produce"}),e("img",{src:P,alt:"logo-tu-empresa"})],-1)),H=[A],W={class:"form-map"},X={class:"container"},$={class:"background-map"},ee=i(()=>e("h2",{class:"title2 ff"},"Paso 2: Selección de puntos de atención",-1)),ae=i(()=>e("div",{class:"info-gps"},[e("span",null,[r("Este ícono "),e("img",{src:Z,alt:"formalizate ubicación"}),r(" represeta la ubicación geográfica de nuestros centros de desarrollo empresarial, pulse en el mapa a continuación para elegir el de su preferencia.")])],-1)),oe={class:"modal-info ff"},te=i(()=>e("span",null,"Quiero atenderme aquí",-1)),se=i(()=>e("div",{class:"modal-info ff msg-ok"},[e("p",{class:"ff"},[r("Un asesor se comunicará contigo dentro de las "),e("b",null,"24 horas")]),e("p",null,"(No considerar sábados, domingos ni feriados), gracias")],-1)),ne={__name:"FormalizacionMapa",setup(c){const w=q();let n;const y=s(null);let p;const u=s(!1),m=s(!1),x=s(null),_=s(!1),g=s([]),f=s(null),v=s(!1),S=s(null),E=o=>{f.value=o,m.value=!0},M=async()=>{let o=C.get("formalization-data");o||w.push({name:"formalizacion"}),o=JSON.parse(o),o.id_gps_cdes=f.value.title,u.value=!0;try{const a=await F({url:"/public/formalization",method:"POST",data:o});a.status==200&&(v.value=!0,S.value=a.message)}catch{Q.error("Error al registrar")}finally{u.value=!1}},b=()=>{w.push({name:"formalizacion"}),C.remove("formalization-data")},O=()=>{window.pageYOffset>10?_.value=!0:_.value=!1},B=()=>{window.scrollTo({top:0,behavior:"smooth"})},N=async()=>{try{const{data:o}=await F({url:"/public/location-cdes",method:"GET"}),a=o.map(t=>({position:{lat:parseFloat(t.position.lat),lng:parseFloat(t.position.lng)},title:t.title}));g.value=[...g.value,a]}catch(o){console.log(o)}},T=()=>{b()};return U(async()=>{window.addEventListener("scroll",O),B(),await N(),navigator.geolocation?navigator.geolocation.getCurrentPosition(o=>{n=new window.google.maps.Map(y.value,{center:{lat:o.coords.latitude,lng:o.coords.longitude},zoom:11}),g.value[0].forEach(a=>{new window.google.maps.Marker({position:a.position,map:n,title:a.title}).addListener("click",()=>{E(a)})}),p=new window.google.maps.places.SearchBox(document.getElementById("searchInput")),p.addListener("places_changed",()=>{const a=p.getPlaces();if(a.length===0)return;const t=a[0];n.setCenter(t.geometry.location),n.setZoom(15),new window.google.maps.Marker({position:t.geometry.location,map:n,title:t.name})})},()=>{console.error("Error al obtener la ubicación del usuario.")}):console.error("La geolocalización no está disponible en este navegador.")}),(o,a)=>{const t=z("a-button"),k=z("a-modal");return V(),D(R,null,[e("header",{class:G(["header",{floatingNav:_.value}]),ref_key:"navBar",ref:x},H,2),e("section",W,[e("div",X,[e("div",$,[ee,ae,e("div",{ref_key:"mapContainer",ref:y,style:{height:"500px"}},null,512)])])]),l(k,{open:m.value,"onUpdate:open":a[0]||(a[0]=h=>m.value=h),title:"",width:"350px",footer:!1},{default:d(()=>[e("div",oe,[te,e("h3",null,j(f.value.title),1)]),l(t,{onClick:M,loading:u.value,class:"form-button",type:"primary","html-type":"submit"},{default:d(()=>[r("ESCOGER")]),_:1},8,["loading"])]),_:1},8,["open"]),l(k,{open:v.value,"onUpdate:open":a[1]||(a[1]=h=>v.value=h),title:"",width:"450px",footer:!1,onCancel:T},{default:d(()=>[se,l(t,{onClick:b,class:"form-button",type:"primary","html-type":"submit"},{default:d(()=>[r("OK")]),_:1})]),_:1},8,["open"]),l(I)],64)}}},ce=Y(ne,[["__scopeId","data-v-8a226ccb"]]);export{ce as default};
