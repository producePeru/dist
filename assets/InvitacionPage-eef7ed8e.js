import{_ as L}from"./tuempresa-7c20bfb9.js";import{R as V}from"./ModalRegistroMYPE-16bb99a0.js";import{k as B,u as j,r as h,a as S,l as A,b as u,o as P,d as R,e,c as s,i as c,t as p,w as i,m as v,n as C,f as g,s as Y,p as J,j as K}from"./index-9de93fa8.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";const l=f=>(J("data-v-aefe2b5d"),f=f(),K(),f),W={class:"background"},X={class:"container"},Z={class:"questionary"},ee={class:"box"},oe=l(()=>e("div",{class:"text-center"},[e("img",{src:L,alt:""}),e("div",{class:"head-title"},[e("h2",{class:"title"},"Confirmación de asistencia a talleres de Ruta Digital")])],-1)),ae={class:"box-info-workshop"},te=l(()=>e("b",null,"Taller: ",-1)),ne=l(()=>e("b",null,"Expositor: ",-1)),se=l(()=>e("b",null,"Fecha del taller:",-1)),le={class:"box"},re={key:0,class:"personal-info"},ie=l(()=>e("h4",{class:"c-primary"},"Mis Datos",-1)),ce=l(()=>e("span",{class:"name"},"Nombres y Apellidos: ",-1)),ue=l(()=>e("span",{class:"name"},"Correo electrónico: ",-1)),de=l(()=>e("span",{class:"name"},"Número de contácto: ",-1)),_e=l(()=>e("br",null,null,-1)),pe={class:"box"},me=["innerHTML"],he=l(()=>e("br",null,null,-1)),ve=l(()=>e("h3",{class:"box-title"},"¿Estas interesado en participar en este taller de Ruta Digital?",-1)),fe={class:"box"},ge=l(()=>e("span",{class:"box-mensagge"},"Opcional",-1)),be=l(()=>e("h3",{class:"box-title"},"¿Cómo te enteraste del taller?",-1)),ye={class:"box-btn"},we={__name:"InvitacionPage",setup(f){const N=B(),M=j(),k=h(null),b=h(!1),y=h(!1),w=h(!1),D=h([]),r=S({id:null,exponent:null,idIn:null,idOut:null,dateTestIn:null,dateTestOut:null,title:null,workShopDate:null}),a=S({name:null,email:null,phone:null,ruc:null,dni:null}),n=S({id_questionnaire:null,ruc:null,dni:null,attendance:null,social:null}),U=()=>{n.ruc=n.ruc.replace(/\D/g,"")},$=t=>{a.name=t.name_complete,a.email=t.email,a.phone=t.phone,a.ruc=t.ruc,a.dni=t.dni_number},E=async()=>{a.ruc=null,a.dni=null;let t=n.ruc;if(!t)return v.warning("Ingresa el número de RUC");y.value=!0;try{const{data:o}=await g({url:`/data-mype/${t}`,method:"GET"});o.ruc&&(a.ruc=o.ruc,a.name=o.name_complete,a.email=o.email,a.phone=o.phone,a.dni=o.dni_number)}catch(o){if(console.error("Error de red:",o.response.status),a.name=null,a.email=null,a.phone=null,a.dni=null,o.response.status==404)try{const{data:d}=await g({url:`/api-data-mype/${n.ruc}`,method:"GET"}),x={razonSocial:d.razonSocial,numeroDocumento:d.numeroDocumento};k.value=x,b.value=!0}catch(d){v.warning("El número de RUC no es válido"),console.error("Error de red:",d)}}finally{y.value=!1}},T=()=>{window.scrollTo({top:200,behavior:"smooth"})},F=async()=>{if(a.name==null&&a.dni==null&&a.ruc==null){E(),v.warning("Revisando sus datos"),T();return}const t={ruc_mype:a.ruc,dni_mype:a.dni,workshop_id:r.id,email:a.email,is_participant:n.attendance};w.value=!0;try{const o=await C({url:`/accept-invitation/${r.id}`,method:"POST",data:t});v.success(o.message),M.push({name:"enviado"}),await C({url:`/addPoint/${r.id}/${n.social}`,method:"PUT"})}catch(o){console.error("Error:",o.response.data.errors[0])}finally{w.value=!1}},q=()=>{v.error("Debes de completar todos los datos"),T()},O=async t=>{try{const{data:o}=await g({url:`/invitations/${t}`,method:"GET"});D.value=o,console.log(o)}catch(o){console.error("Error de red:",o)}};return A(async()=>{try{const t=await g({url:`/get-workshop-slug/${N.params.slug}`,method:"GET"});r.id=t.workshop.id,r.exponent=t.workshop.exponent_name,r.title=t.workshop.title,r.workShopDate=t.workshop.workshop_date,await O(t.workshop.id_invitation)}catch(t){console.error("Error de red:",t)}}),(t,o)=>{const d=u("a-divider"),x=u("a-input-search"),z=u("a-form-item"),m=u("a-radio"),I=u("a-radio-group"),G=u("a-button"),H=u("a-form");return P(),R("div",W,[e("section",X,[e("div",Z,[e("div",ee,[oe,s(d),e("div",ae,[e("span",null,[te,c(p(r.title),1)]),e("span",null,[ne,c(p(r.exponent),1)]),e("span",null,[se,c(" "+p(r.workShopDate),1)])])]),s(H,{layout:"vertical",model:n,autocomplete:"off",onFinish:F,onFinishFailed:q},{default:i(()=>[e("div",le,[s(z,{class:"search-ruc f-15",name:"ruc",label:"Número de RUC",rules:[{required:!0,message:"Es importante el número de RUC"}]},{default:i(()=>[s(x,{maxlength:15,loading:y.value,size:"large",value:n.ruc,"onUpdate:value":o[0]||(o[0]=_=>n.ruc=_),"enter-button":"",onSearch:E,onInput:U},null,8,["loading","value"])]),_:1}),a.name?(P(),R("div",re,[ie,e("div",null,[ce,e("span",null,p(a.name),1)]),e("div",null,[ue,e("span",null,p(a.email),1)]),e("div",null,[de,e("span",null,p(a.phone),1)]),_e])):Y("",!0)]),e("div",pe,[e("div",{class:"html-invitation",innerHTML:D.value.content},null,8,me),he,ve,s(I,{value:n.attendance,"onUpdate:value":o[1]||(o[1]=_=>n.attendance=_)},{default:i(()=>[s(m,{value:"si"},{default:i(()=>[c("SI")]),_:1}),s(m,{value:"no"},{default:i(()=>[c("NO")]),_:1})]),_:1},8,["value"])]),e("div",fe,[ge,be,s(I,{class:"group-radios",value:n.social,"onUpdate:value":o[2]||(o[2]=_=>n.social=_)},{default:i(()=>[s(m,{class:"item-radio",value:"rrss"},{default:i(()=>[c("Redes sociales")]),_:1}),s(m,{class:"item-radio",value:"sms"},{default:i(()=>[c("SMS")]),_:1}),s(m,{class:"item-radio",value:"correo"},{default:i(()=>[c("Correo")]),_:1})]),_:1},8,["value"])]),e("div",ye,[s(G,{type:"primary","html-type":"submit",size:"large",loading:w.value},{default:i(()=>[c("Enviar respuestas")]),_:1},8,["loading"])])]),_:1},8,["model"])])]),s(V,{open:b.value,onHandleCloseModal:o[3]||(o[3]=_=>b.value=!1),rucProp:k.value,onHandleSetData:$},null,8,["open","rucProp"])])}}},Te=Q(we,[["__scopeId","data-v-aefe2b5d"]]);export{Te as default};
