import{u as T,r as m,n as j,b as n,o,d as p,e as r,c as a,w as e,F as f,h as I,j as d,t as S,s as g,B as u,i as N,Q as q,H as F,L as G,C as E,m as h,D as H}from"./index-da4b24a2.js";import{M as J}from"./MoreOutlined-15ce32e8.js";const P=r("h3",null,"USUARIOS",-1),Q={class:"filters"},K=["onClick"],W=r("a",null,"Eliminar",-1),X={class:"paginator"},te={__name:"ListaUsuarios",setup(Y){const U=T(),w=m([]),y=m(!1),x=m(0),b=m({page:1}),z=[{title:"Nombres",dataIndex:"name",fixed:"left",width:60},{title:"Apellidos",dataIndex:"apellidos",fixed:"left",width:50},{title:"N° documento",dataIndex:"document_number",align:"center",width:40},{title:"Correo electrónico",dataIndex:"email",width:60},{title:"Celular",dataIndex:"phone_number",align:"center",width:20},{title:"Género",dataIndex:"gender",align:"center",width:20},{title:"",dataIndex:"actions",align:"center",width:30}],A=t=>{b.value.page=t,v()},B=async t=>{const s={dni:t.document_number};U.push({name:"nuevo-usuario",query:s})},M=async t=>{const s=t.document_number,c=JSON.parse(localStorage.getItem("user")),k=E.AES.decrypt(c.rol,"rol").toString(E.enc.Utf8);if(s===c.dni)return h.warning("Amiwito no te puedes autoeliminar");if(k==="super")try{const l=await I({url:`/delete-user/${H}/${s}`,method:"PUT"});h.success(l.message),v()}catch{h.error("No se puede eliminar a este usuario")}else h.warning("No estas autorizado")},v=async()=>{try{y.value=!0;const t=await I({url:"/users",method:"GET",params:b.value});w.value=t.data,x.value=t.total}catch(t){console.error("Error de red:",t)}finally{y.value=!1}};return j(v),(t,s)=>{const c=n("a-button"),k=n("router-link"),l=n("a-tag"),C=n("a-menu-item"),O=n("a-popconfirm"),V=n("a-menu"),D=n("a-dropdown"),$=n("a-table"),L=n("a-pagination");return o(),p(f,null,[r("div",null,[P,r("div",Q,[a(k,{to:"nuevo-usuario"},{default:e(()=>[a(c,{type:"primary"},{default:e(()=>[d(" NUEVO ")]),_:1})]),_:1})]),a($,{bordered:"",class:"ant-table-striped",columns:z,"data-source":w.value,pagination:!1,loading:y.value,size:"small"},{bodyCell:e(({column:_,record:i})=>[_.dataIndex=="apellidos"?(o(),p(f,{key:0},[d(S(i.last_name)+" "+S(i.middle_name),1)],64)):g("",!0),_.dataIndex=="gender"?(o(),p(f,{key:1},[i.gender=="h"?(o(),u(l,{key:0,color:"blue"},{default:e(()=>[d("Hombre")]),_:1})):(o(),u(l,{key:1,color:"pink"},{default:e(()=>[d("Mujer")]),_:1}))],64)):g("",!0),_.dataIndex=="is_disabled"?(o(),p(f,{key:2},[i.activo!=1?(o(),u(l,{key:0,color:"success"},{default:e(()=>[d("Activo")]),_:1})):(o(),u(l,{key:1,color:"error"},{default:e(()=>[d("Inactivo")]),_:1}))],64)):g("",!0),_.dataIndex=="actions"?(o(),u(D,{key:3,trigger:["click"]},{overlay:e(()=>[a(V,null,{default:e(()=>[a(C,null,{default:e(()=>[r("a",{onClick:R=>B(i)},"Editar",8,K)]),_:2},1024),a(C,null,{default:e(()=>[a(O,{title:"¿Eliminar?",onConfirm:R=>M(i)},{icon:e(()=>[a(N(q),{style:{color:"red"}})]),default:e(()=>[W]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:e(()=>[r("a",{class:"ant-dropdown-link",onClick:s[0]||(s[0]=F(()=>{},["prevent"]))},[a(c,{shape:"circle",icon:G(N(J)),size:"small"},null,8,["icon"])])]),_:2},1024)):g("",!0)]),_:1},8,["data-source","loading"])]),r("div",X,[a(L,{size:"small",total:x.value,pageSize:20,onChange:A,showSizeChanger:!1},null,8,["total"])])],64)}}};export{te as default};
