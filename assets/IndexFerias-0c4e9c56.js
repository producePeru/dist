import{D as A,u as ie,g as re,r as o,a as de,Q as ce,x as ue,k as pe,b as l,o as s,d as v,e as u,c as n,w as t,i as m,F as x,I as T,s as p,v as r,t as N,h as F,Z as _e,R as me,H as fe,m as ge}from"./index-5fd26e4c.js";import{_ as he}from"./NuevaFeria-cd6bcbf5.js";import{u as ve}from"./selectes-b1dc16fb.js";import"./es-1738796d.js";import{C as Ie}from"./CloudOutlined-0ba24060.js";import{M as ye}from"./MoreOutlined-e9e32f5c.js";import"./quill.snow-a73ae1ff.js";const we=u("h3",{class:"title-produce"},"FERIAS EMPRESARIALES",-1),xe={key:1},Ee=["onClick"],ke=["onClick"],Ce=u("a",null,"Eliminar",-1),De={class:"paginator"},Me={__name:"IndexFerias",props:["idConvenio"],setup(Re){A.locale("es");const L=ie(),$=JSON.parse(localStorage.getItem("role"))||[];ve(),re.get("token");const g=o(!1),I=o(null);o(!1),o(null);const E=o(0),k=o(50),y=o({page:0}),B=o(1200),b=o([]),C=o(!1);o(!1),o(!1),o(!1),o(!1),o(null);const O=o(window.innerHeight-100),V=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"FERIA",fixed:"left",dataIndex:"title",width:200},{title:"LINK",dataIndex:"slug",width:100,align:"center"},{title:"META MYPES",dataIndex:"metaMypes",width:120,align:"center"},{title:"INSCRITOS",dataIndex:"countMypes",width:120,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"DÍAS RESTANTES",dataIndex:"dateDiff",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:150},{title:"DISTRITO",dataIndex:"district",width:150},{title:"CREADO POR",dataIndex:"profile",width:170},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],h=de({search:""}),D=a=>$.some(e=>a.includes(e.id)),P=()=>{f(),g.value=!1},U=a=>{I.value=a,g.value=!0},H=()=>{I.value=null,g.value=!0},z=a=>{const e=A().startOf("day"),_=A(a).startOf("day").diff(e,"days");return _<=-1?_:_===0?1:_},Q=()=>{let a={search:h.search};f(a)},G=()=>{h.search||f()},Y=a=>{console.log("Inscriptos"),L.push(`/admin/ferias/inscritos/${a.slug}`)},Z=a=>{y.value.page=a,f()},R=()=>{O.value=window.innerHeight-320},j=async a=>{try{const e=await T({url:`agreement/delete/${a.id}`,method:"DELETE"});e.status==200&&(f(),ge.success(e.message))}catch(e){console.error("Error de red:",e)}},q=ce(()=>a=>y.value.page*k.value+a+1),f=async a=>{try{C.value=!0;let e;e=y.value.page==0?"":y.value,e=a?{...e,...a}:e;const{data:i}=await T({url:"fair/list",method:"GET",params:e});b.value=i==null?void 0:i.data,E.value=i.total,k.value=i.per_page}catch(e){console.error("Error de red:",e)}finally{C.value=!1}};return ue(()=>{window.removeEventListener("resize",R)}),pe(()=>{window.addEventListener("resize",R),R(),f()}),(a,e)=>{const i=l("a-button"),_=l("a-col"),J=l("a-input"),K=l("a-input-group"),X=l("a-row"),W=l("router-link"),w=l("a-tag"),S=l("a-menu-item"),ee=l("a-popconfirm"),te=l("a-menu"),ae=l("a-dropdown"),ne=l("a-table"),oe=l("a-pagination"),le=l("a-drawer");return s(),v(x,null,[u("div",null,[we,n(X,{style:{margin:"1rem 0"}},{default:t(()=>[n(_,{xs:24,md:12,lg:18},{default:t(()=>[D([5,10,11])?(s(),p(i,{key:0,type:"primary",onClick:H,style:{"margin-right":".5rem"}},{default:t(()=>[m("NUEVA FERIA")]),_:1})):r("",!0)]),_:1}),n(_,{xs:24,md:12,lg:6},{default:t(()=>[n(K,{compact:""},{default:t(()=>[n(J,{value:h.search,"onUpdate:value":e[0]||(e[0]=d=>h.search=d),style:{width:"calc(100% - 80px)"},onInput:G},null,8,["value"]),n(i,{type:"primary",disabled:h.search==="",onClick:Q},{default:t(()=>[m("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(ne,{bordered:"",scroll:{x:B.value,y:O.value},class:"table-fairs",columns:V,"data-source":b.value,pagination:!1,loading:C.value,size:"small"},{bodyCell:t(({column:d,record:c,index:se})=>[d.dataIndex=="idx"?(s(),v(x,{key:0},[m(N(q.value(se)),1)],64)):r("",!0),d.dataIndex=="slug"?(s(),p(W,{key:1,to:`/feria/${c.slug}`,target:"_blank"},{default:t(()=>[n(F(Ie),{class:"fair-link"})]),_:2},1032,["to"])):r("",!0),d.dataIndex=="modality"?(s(),v(x,{key:2},[c.modality=="p"?(s(),p(w,{key:0,color:"blue"},{default:t(()=>[m("PRESENCIAL")]),_:1})):r("",!0),c.modality=="v"?(s(),p(w,{key:1,color:"orange"},{default:t(()=>[m("VIRTUAL")]),_:1})):r("",!0)],64)):r("",!0),d.dataIndex=="dateDiff"?(s(),v(x,{key:3},[z(c.endDate2)<0?(s(),p(w,{key:0,color:"red"},{default:t(()=>[m(" FINALIZADO ")]),_:1})):(s(),v("span",xe,N(z(c.endDate2)),1))],64)):r("",!0),d.dataIndex=="actions"?(s(),p(ae,{key:4,trigger:["click"]},{overlay:t(()=>[n(te,null,{default:t(()=>[D([5,10,11])?(s(),p(S,{key:0},{default:t(()=>[u("a",{onClick:M=>U(c)},"Editar",8,Ee)]),_:2},1024)):r("",!0),n(S,null,{default:t(()=>[u("a",{onClick:M=>Y(c)},"Inscritos",8,ke)]),_:2},1024),D([5,10,11])?(s(),p(S,{key:1},{default:t(()=>[n(ee,{placement:"rightBottom",title:`¿Quieres eliminar ${c.title} ?`,onConfirm:M=>j(c)},{icon:t(()=>[n(F(_e),{style:{color:"red"}})]),default:t(()=>[Ce]),_:2},1032,["title","onConfirm"])]),_:2},1024)):r("",!0)]),_:2},1024)]),default:t(()=>[u("a",{class:"ant-dropdown-link",onClick:e[1]||(e[1]=me(()=>{},["prevent"]))},[n(i,{shape:"circle",icon:fe(F(ye)),size:"small"},null,8,["icon"])])]),_:2},1024)):r("",!0)]),_:1},8,["scroll","data-source","loading"])]),u("div",De,[u("span",null,[n(w,{color:"blue"},{default:t(()=>[u("b",null,N(E.value),1)]),_:1}),m("Ferias Empresariales")]),n(oe,{size:"small",total:E.value,pageSize:k.value,onChange:Z,showSizeChanger:!1},null,8,["total","pageSize"])]),n(le,{open:g.value,"onUpdate:open":e[2]||(e[2]=d=>g.value=d),title:I.value?"Editar Feria":"Nueva Feria",placement:"right",width:"650"},{default:t(()=>[n(he,{onCloseDraw:P,dataRow:I.value},null,8,["dataRow"])]),_:1},8,["open","title"])],64)}}};export{Me as default};
