import{c as n,A as $e,L as pe,y as we,r as h,a as ye,k as Ce,b as y,o as s,d as q,w as o,e as p,F as Z,x as _e,h as x,q as v,s as u,t as S,M as Fe,_ as Ue,i as Y,$ as Se,z as J,f as Ee,m as W,V as Ie,u as Te,a1 as Pe,p as qe,j as Le}from"./index-cad29f5b.js";import{u as ve}from"./selectes-1676adc2.js";import{f as Me,r as Ye,a as Ve}from"./asesorias-23f4c147.js";import"./storage-0b36ba10.js";import"./es-603667aa.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import{S as Ge}from"./DrawerSolicitante.componente-a73148c1.js";var He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};const je=He;function xe($){for(var N=1;N<arguments.length;N++){var E=arguments[N]!=null?Object(arguments[N]):{},c=Object.keys(E);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(E).filter(function(V){return Object.getOwnPropertyDescriptor(E,V).enumerable}))),c.forEach(function(V){Be($,V,E[V])})}return $}function Be($,N,E){return N in $?Object.defineProperty($,N,{value:E,enumerable:!0,configurable:!0,writable:!0}):$[N]=E,$}var ge=function(N,E){var c=xe({},N,E.attrs);return n($e,xe({},c,{icon:je}),null)};ge.displayName="RedoOutlined";ge.inheritAttrs=!1;const Je=ge;const We={class:"wrapper-booking"},Ke={class:"grid-ruc20"},Qe={class:"select-notaries"},Ze={class:"name"},Xe={class:"city"},ea={class:"address"},aa="DD/MM/YYYY",ta={__name:"AllFormalizacion20",props:["info","idCde"],emits:["closeDraw"],setup($,{emit:N}){pe.locale("es");const E=Se({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),c=JSON.parse(localStorage.getItem("profile")),V=JSON.parse(localStorage.getItem("role"));we();const A=$,R=N,P=h(!1),z=h(null);h(null);const a=h(!0),G=h(!1),_=ve(),d=h(null);_.$patch({cities:_.cities}),_.$patch({modalities:_.modalities}),_.$patch({economicSectors:_.economicSectors}),_.$patch({comercialActivities:_.comercialActivities}),_.$patch({regimes:_.regimes}),_.$patch({typeCapital:_.typeCapital}),_.fetchEconomicSectors(),_.fetchComercialActivities(),_.fetchRegimes(),_.fetchModalities(),_.fetchTypeCapital(),_.fetchCities(),h(null);const e=ye({task:1,codesunarp:null,economicsector_id:null,comercialactivity_id:null,regime_id:null,city_id:null,province_id:null,district_id:null,address:null,modality_id:null,user_id:c.user_id,montocapital:null,ruc:null}),T=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}],F=t=>t&&t>pe().endOf("day"),Q=t=>{if(t=="ruc"){const b=e.ruc;(b<2e10||b>20999999999)&&(e.ruc=null)}},j=t=>{(t=="ruc"||t=="montocapital")&&(e[t]=e[t].replace(/\D/g,""))},I=()=>{var K;const{documentnumber:t,city_id:b,province_id:m,district_id:l,address:te}=A.info,k=V.some(ne=>ne.id===7);e.dni=t,k&&(e.modality_id=1,e.notary_id=c.notary_id),e.city_id=b,w(b),e.province_id=m,D(m),e.district_id=l,e.address=te,(K=_.regimes)!=null&&K.length&&(a.value=!1)},U=(t,b)=>{const m=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),l=b.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),te=b.city.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),k=b.province.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),K=b.district.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return l.includes(m)||te.includes(m)||k.includes(m)||K.includes(m)},r=async()=>{try{P.value=!0;const t={name:z.value};(await J({url:"create/comercial-activities",method:"POST",data:t})).status==200&&(z.value=null,_.fetchComercialActivities())}catch(t){console.log(t)}finally{P.value=!1}},w=t=>{e.province_id=null,e.district_id=null,_.fetchProvinces(t)},D=t=>{e.district_id=null,_.fetchDistricts(t)},H=async()=>{try{const t={city_id:e.city_id},{data:b}=await Ee({url:"public/notaries-filters",method:"GET"});d.value=null,e.notary_id=null;const m=b.map(l=>({value:l.id,name:l.name,city:l.city.name,province:l.province.name,district:l.district.name,address:l.address}));d.value=m}catch(t){console.error("Error de red:",t)}},B=(t,b)=>{const m=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return b.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(m)},X=async()=>{if(G.value=!0,!A.info.id)return W.error("Error al registrar, actualiza la página");const t={codesunarp:e.codesunarp,numbernotary:e.numbernotary,address:e.address,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,regime_id:e.regime_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,modality_id:e.modality_id,notary_id:e.notary_id,user_id:c.user_id,people_id:A.info.id,nameMype:e.nameMype,dateReception:e.dateReception?pe(e.dateReception).format("YYYY-MM-DD"):null,dateTramite:e.dateTramite?pe(e.dateTramite).format("YYYY-MM-DD"):null,ruc:e.ruc,dni:e.dni,typecapital_id:e.typecapital_id,isbic:e.isbic,montocapital:e.montocapital,cde_id:A.idCde?A.idCde:null};try{const b=await J({url:"formalization/create-ruc20",method:"POST",data:t});if(b.status===200){const m={razonSocial:null,ruc:e.ruc,createdFrom:"F20"};await J({url:"mype/create",method:"POST",data:m}),await J({url:`mype/update/${e.ruc}`,method:"PUT"}),W.success(b.message),e.codesunarp=null,e.economicsector_id=null,e.comercialactivity_id=null,e.regime_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.modality_id=null,e.nameMype=null,e.dateReception=null,e.dateTramite=null,e.notary_id=null,e.ruc=null,e.numbernotary=null,e.isbic=null,e.montocapital=null,e.typecapital_id=null,R("closeDraw",!0)}}catch(b){console.log("Error: "+b)}finally{G.value=!1}},ae=()=>{W.warning("Debes de completar todos los espacios requeridos")};return Ce(()=>{H()}),(t,b)=>{const m=y("a-select"),l=y("a-form-item"),te=y("a-date-picker"),k=y("a-divider"),K=y("a-input"),ne=y("a-button"),de=y("a-space"),re=y("a-input-number"),fe=y("a-form"),ce=y("a-spin");return s(),q("div",We,[n(ce,{spinning:a.value},{default:o(()=>[n(fe,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:X,onFinishFailed:ae},{default:o(()=>[p("div",Ke,[(s(!0),q(Z,null,_e(x(Me),(i,le)=>(s(),q(Z,{key:le},[i.type==="iSelect"?(s(),v(l,{key:0,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[i.name=="regime_id"?(s(),v(m,{key:0,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:x(_).regimes,"show-search":"","filter-option":B},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="modality_id"?(s(),v(m,{key:1,disabled:i.disabled,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:x(_).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0),i.name=="typecapital_id"?(s(),v(m,{key:2,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:x(_).typeCapital},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="isbic"?(s(),v(m,{key:3,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:T},null,8,["value","onUpdate:value"])):u("",!0),i.name=="notary_id"?(s(),v(m,{key:4,disabled:i.disabled,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,options:d.value,"option-label-prop":"name","show-search":"","filter-option":U},{option:o(({value:f,name:ie,city:O,province:g,district:ee,address:oe})=>[p("div",Qe,[p("span",Ze,S(ie),1),p("span",Xe,S(O)+" - "+S(g)+" - "+S(ee),1),p("span",ea,S(oe),1)])]),_:2},1032,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iDate"?(s(),v(l,{key:1,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(te,{locale:x(Fe),value:e[i.name],"onUpdate:value":f=>e[i.name]=f,style:{width:"100%"},format:aa,placeholder:"día/mes/año","disabled-date":F,disabled:i.disabled,onChange:b[0]||(b[0]=f=>e.birthday=t.birthdateDate)},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iSelectWrite"?(s(),v(l,{key:2,class:"item-max",name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[i.name=="comercialactivity_id"?(s(),v(m,{key:0,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:x(_).comercialActivities,"filter-option":B},{dropdownRender:o(({menuNode:f})=>[n(x(E),{vnodes:f},null,8,["vnodes"]),n(k,{style:{margin:"4px 0"}}),n(de,{style:{padding:"4px 8px"}},{default:o(()=>[n(K,{ref_for:!0,ref:"inputRef",value:z.value,"onUpdate:value":b[1]||(b[1]=ie=>z.value=ie),placeholder:"Nueva actividad"},null,8,["value"]),n(ne,{type:"text",onClick:r,loading:P.value},{icon:o(()=>[n(x(Ue))]),default:o(()=>[Y(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):u("",!0),i.name=="economicsector_id"?(s(),v(m,{key:1,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:x(_).economicSectors,"filter-option":B},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="city_id"?(s(),v(m,{key:2,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:x(_).cities,"filter-option":B,onChange:w},null,8,["value","onUpdate:value","options"])):u("",!0),i.name=="province_id"?(s(),v(m,{key:3,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:x(_).provinces,"filter-option":B,onChange:D,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),i.name=="district_id"?(s(),v(m,{key:4,value:e[i.name],"onUpdate:value":f=>e[i.name]=f,"show-search":"",options:x(_).districts,"filter-option":B,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iText"?(s(),v(l,{key:3,name:i.name,label:i.label,rules:[{required:i.required,message:i.message,type:i.email,max:i.max,min:i.min}]},{default:o(()=>[n(K,{onInput:f=>j(i.name),value:e[i.name],"onUpdate:value":f=>e[i.name]=f,disabled:i.disabled,maxlength:i.max,placeholder:i.placeholder},null,8,["onInput","value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iNumber"?(s(),v(l,{key:4,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(re,{style:{width:"100%"},value:e[i.name],"onUpdate:value":f=>e[i.name]=f,maxlength:11,onChange:f=>Q(i.name)},null,8,["value","onUpdate:value","onChange"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iTextLol"?(s(),v(l,{key:5,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(K,{onInput:f=>j(i.name),value:e.dni,"onUpdate:value":b[2]||(b[2]=f=>e.dni=f),disabled:!A.documentnumber,maxlength:i.max,placeholder:i.placeholder},null,8,["onInput","value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),i.type==="iMoney"?(s(),v(l,{key:6,name:i.name,label:i.label,rules:[{required:i.required,message:i.message}]},{default:o(()=>[n(re,{"min:":0,style:{width:"100%"},value:e[i.name],"onUpdate:value":f=>e[i.name]=f,formatter:f=>`S/ ${f}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:f=>f.replace(/S\/\s?|(,*)/g,"")},null,8,["value","onUpdate:value","formatter","parser"])]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),p("div",null,S(I()),1),n(l,null,{default:o(()=>[n(ne,{class:"btn-produce",type:"primary","html-type":"submit",loading:G.value},{default:o(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},oa=se(ta,[["__scopeId","data-v-5d493f9e"]]);const na={class:"wrapper-booking"},ia={class:"grid-booking"},la={__name:"FormalizacionRUC10",props:["info","idCde"],emits:["closeDraw"],setup($,{emit:N}){const E=JSON.parse(localStorage.getItem("role")),c=Se({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),V=JSON.parse(localStorage.getItem("profile")),A=$,R=N,P=h(!1),z=h(null);h(null),h(!1);const a=ve(),G=h(!1);a.$patch({cities:a.cities}),a.$patch({provinces:a.provinces}),a.$patch({districts:a.districts}),a.$patch({modalities:a.modalities}),a.$patch({detailProcedures:a.detailProcedures}),a.$patch({economicSectors:a.economicSectors}),a.$patch({comercialActivities:a.comercialActivities}),a.fetchDetailProcedures(),a.fetchModalities(),a.fetchEconomicSectors(),a.fetchComercialActivities(),a.fetchCities();const _=h(!0),d=ye({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,address:null,user_id:V.user_id}),e=()=>{const{documentnumber:r,city_id:w,province_id:D,district_id:H,address:B}=A.info;d.dni=r,d.modality_id=E.some(X=>X.id===7)?1:null,d.city_id=w,F(w),d.province_id=D,Q(D),d.district_id=H,d.address=B,a.cities&&(_.value=!1)},T=async()=>{try{G.value=!0;const r={name:z.value};(await J({url:"create/comercial-activities",method:"POST",data:r})).status==200&&(z.value=null,a.fetchComercialActivities())}catch(r){console.log(r)}finally{G.value=!1}},F=r=>{d.province_id=null,d.district_id=null,a.fetchProvinces(r)},Q=r=>{d.district_id=null,a.fetchDistricts(r)},j=(r,w)=>{const D=r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return w.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(D)},I=async()=>{if(P.value=!0,!A.info.id)return W.error("Error al registrar, actualiza la página");const r={dni:d.dni,detailprocedure_id:d.detailprocedure_id,modality_id:d.modality_id,economicsector_id:d.economicsector_id,comercialactivity_id:d.comercialactivity_id,city_id:d.city_id,province_id:d.province_id,district_id:d.district_id,address:d.address,ruc:d.ruc,user_id:V.user_id,people_id:A.info.id,cde_id:A.idCde?A.idCde:null};try{const w=await J({url:"formalization/create-ruc-10",method:"POST",data:r});if(w.status===200){const D={razonSocial:null,ruc:d.ruc,createdFrom:"F10"};await J({url:"mype/create",method:"POST",data:D}),await J({url:`mype/update/${d.ruc}`,method:"PUT"}),W.success(w.message),d.detailprocedure_id=null,d.modality_id=null,d.economicsector_id=null,d.comercialactivity_id=null,d.city_id=null,d.province_id=null,d.district_id=null,d.address=null,d.ruc=null,R("closeDraw",!0)}}catch(w){console.log("Error: "+w)}finally{P.value=!1}},U=()=>{W.warning("Debes de completar todos los espacios requeridos")};return(r,w)=>{const D=y("a-select"),H=y("a-form-item"),B=y("a-input"),X=y("a-divider"),ae=y("a-button"),t=y("a-space"),b=y("a-form"),m=y("a-spin");return s(),q("div",na,[n(m,{spinning:_.value},{default:o(()=>[n(b,{layout:"vertical",model:d,name:"basic",autocomplete:"off",onFinish:I,onFinishFailed:U},{default:o(()=>[p("div",ia,[(s(!0),q(Z,null,_e(x(Ye),(l,te)=>(s(),q(Z,{key:te},[l.type==="iSelect"?(s(),v(H,{key:0,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:o(()=>[l.name=="detailprocedure_id"?(s(),v(D,{key:0,value:d[l.name],"onUpdate:value":k=>d[l.name]=k,options:x(a).detailProcedures},null,8,["value","onUpdate:value","options"])):u("",!0),l.name=="modality_id"?(s(),v(D,{key:1,disabled:l.disabled,value:d[l.name],"onUpdate:value":k=>d[l.name]=k,options:x(a).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),l.type==="iText"?(s(),v(H,{key:1,name:l.name,label:l.label,rules:[{required:l.required,message:l.message,type:l.email,max:l.max}]},{default:o(()=>[n(B,{value:d[l.name],"onUpdate:value":k=>d[l.name]=k,disabled:l.name==="dni"&&!!d[l.name],maxlength:l.max,placeholder:l.placeholder},null,8,["value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):u("",!0),l.type==="iSelectWrite"?(s(),v(H,{key:2,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:o(()=>[l.name=="comercialactivity_id"?(s(),v(D,{key:0,value:d[l.name],"onUpdate:value":k=>d[l.name]=k,"show-search":"",options:x(a).comercialActivities,"filter-option":j},{dropdownRender:o(({menuNode:k})=>[n(x(c),{vnodes:k},null,8,["vnodes"]),n(X,{style:{margin:"4px 0"}}),n(t,{style:{padding:"4px 8px"}},{default:o(()=>[n(B,{ref_for:!0,ref:"inputRef",value:z.value,"onUpdate:value":w[0]||(w[0]=K=>z.value=K),placeholder:"Nueva actividad"},null,8,["value"]),n(ae,{type:"text",onClick:T,loading:G.value},{icon:o(()=>[n(x(Ue))]),default:o(()=>[Y(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):u("",!0),l.name=="economicsector_id"?(s(),v(D,{key:1,value:d[l.name],"onUpdate:value":k=>d[l.name]=k,"show-search":"",options:x(a).economicSectors,"filter-option":j},null,8,["value","onUpdate:value","options"])):u("",!0),l.name=="city_id"?(s(),v(D,{key:2,value:d[l.name],"onUpdate:value":k=>d[l.name]=k,"show-search":"",options:x(a).cities,"filter-option":j,onChange:F},null,8,["value","onUpdate:value","options"])):u("",!0),l.name=="province_id"?(s(),v(D,{key:3,value:d[l.name],"onUpdate:value":k=>d[l.name]=k,"show-search":"",options:x(a).provinces,"filter-option":j,onChange:Q,disabled:!d.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),l.name=="district_id"?(s(),v(D,{key:4,value:d[l.name],"onUpdate:value":k=>d[l.name]=k,"show-search":"",options:x(a).districts,"filter-option":j,disabled:!d.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),n(H,null,{default:o(()=>[n(ae,{type:"primary",class:"btn-produce","html-type":"submit",loading:P.value},{default:o(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),p("div",null,S(e()),1)]),_:1},8,["spinning"])])}}},sa=se(la,[["__scopeId","data-v-523ed909"]]);const da={class:"wrapper-booking"},ra={class:"grid-booking"},ca={__name:"AsesoriaNuevo",props:["info","idCde"],emits:["closeDraw"],setup($,{emit:N}){const E=JSON.parse(localStorage.getItem("role")),c=ve(),V=JSON.parse(localStorage.getItem("profile")),A=h(!1),R=$,P=N;h(!1),h(null),h(null),c.$patch({components:c.components}),c.$patch({componentThemes:c.componentThemes}),c.$patch({modalities:c.modalities}),c.$patch({cities:c.cities}),c.$patch({economicSectors:c.economicSectors}),c.$patch({comercialActivities:c.comercialActivities}),c.fetchEconomicSectors(),c.fetchComercialActivities(),c.fetchComponents(),c.fetchComponentThemes(),c.fetchModalities(),c.fetchCities(),c.fetchGenders();const z=h(!0),a=ye({cde_id:null,dni:null,economicsector_id:null,comercialactivity_id:null,component_id:null,theme_id:null,modality_id:null,ruc:null,city_id:null,province_id:null,district_id:null,observations:null,user_id:V.user_id}),G=I=>{I=="ruc"&&(a[I]=a[I].replace(/\D/g,""))},_=()=>{const{documentnumber:I,city_id:U,province_id:r,district_id:w}=R.info,D=E.some(H=>H.id===7);a.dni=I,a.city_id=U,e(U),a.province_id=r,T(r),a.district_id=w,a.component_id=D?4:null,a.modality_id=D?1:null,D&&c.fetchComponentThemes(4),c.cities&&(z.value=!1)},d=I=>{a.theme_id=null,c.fetchComponentThemes(I)},e=I=>{a.province_id=null,a.district_id=null,c.fetchProvinces(I)},T=I=>{a.district_id=null,c.fetchDistricts(I)},F=(I,U)=>{const r=I.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return U.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(r)},Q=async()=>{if(A.value=!0,!R.info.id)return W.error("Error al registrar actualiza la página");const I={dni:a.dni,economicsector_id:a.economicsector_id,comercialactivity_id:a.comercialactivity_id,observations:a.observations,user_id:V.user_id,people_id:R.info.id,component_id:a.component_id,theme_id:a.theme_id,modality_id:a.modality_id,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,ruc:a.ruc,cde_id:R.idCde?R.idCde:null};try{const U=await J({url:"advisory/create",method:"POST",data:I});if(U.status===200){const r={razonSocial:null,ruc:a.ruc,createdFrom:"asesorias"};await J({url:"mype/create",method:"POST",data:r}),await J({url:`mype/update/${a.ruc}`,method:"PUT"}),W.success(U.message),a.component_id=null,a.theme_id=null,a.modality_id=null,a.city_id=null,a.province_id=null,a.district_id=null,a.observations=null,a.ruc=null,a.economicsector_id=null,a.comercialactivity_id=null,P("closeDraw",!0)}}catch(U){console.log("Error: "+U)}finally{A.value=!1}},j=()=>{W.warning("Debes de completar todos los espacios requeridos")};return(I,U)=>{const r=y("a-select"),w=y("a-form-item"),D=y("a-textarea"),H=y("a-input"),B=y("a-button"),X=y("a-form"),ae=y("a-spin");return s(),q("div",da,[n(ae,{spinning:z.value},{default:o(()=>[n(X,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:Q,onFinishFailed:j},{default:o(()=>[p("div",ra,[(s(!0),q(Z,null,_e(x(Ve),(t,b)=>(s(),q(Z,{key:b},[t.type==="iSelect"?(s(),v(w,{key:0,class:"item-max",name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:o(()=>[t.name=="modality_id"?(s(),v(r,{key:0,disabled:t.disabled,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,options:x(c).modalities},null,8,["disabled","value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),t.type==="iTextarea"?(s(),v(w,{key:1,name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:o(()=>[n(D,{value:a[t.name],"onUpdate:value":m=>a[t.name]=m,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):u("",!0),t.type==="iText"?(s(),v(w,{key:2,name:t.name,label:t.label,rules:[{required:t.required,message:t.message,type:t.email,max:t.max}]},{default:o(()=>[n(H,{value:a[t.name],"onUpdate:value":m=>a[t.name]=m,maxlength:t.max,onInput:m=>G(t.name),placeholder:t.placeholder,disabled:t.name==="dni"&&!!a[t.name]},null,8,["value","onUpdate:value","maxlength","onInput","placeholder","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),t.type==="iSelectWrite"?(s(),v(w,{key:3,class:"item-max",name:t.name,label:t.label,rules:[{required:t.required,message:t.message}]},{default:o(()=>[t.name=="city_id"?(s(),v(r,{key:0,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,"show-search":"",options:x(c).cities,"filter-option":F,onChange:e},null,8,["value","onUpdate:value","options"])):u("",!0),t.name=="province_id"?(s(),v(r,{key:1,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,"show-search":"",options:x(c).provinces,"filter-option":F,onChange:T,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),t.name=="district_id"?(s(),v(r,{key:2,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,"show-search":"",options:x(c).districts,"filter-option":F,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),t.name=="economicsector_id"?(s(),v(r,{key:3,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,"show-search":"",options:x(c).economicSectors,"filter-option":F},null,8,["value","onUpdate:value","options"])):u("",!0),t.name=="comercialactivity_id"?(s(),v(r,{key:4,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,"show-search":"",options:x(c).comercialActivities,"filter-option":F},null,8,["value","onUpdate:value","options"])):u("",!0),t.name=="component_id"?(s(),v(r,{key:5,disabled:t.disabled,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,"show-search":"",options:x(c).components,"filter-option":F,onChange:d},null,8,["disabled","value","onUpdate:value","options"])):u("",!0),t.name=="theme_id"?(s(),v(r,{key:6,value:a[t.name],"onUpdate:value":m=>a[t.name]=m,"show-search":"",options:x(c).componentThemes,"filter-option":F,disabled:!a.component_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),p("div",null,S(_()),1),n(w,null,{default:o(()=>[n(B,{type:"primary",class:"btn-produce","html-type":"submit",loading:A.value},{default:o(()=>[Y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},ua=se(ca,[["__scopeId","data-v-50d3d049"]]);const ma={key:0},pa={key:0},_a={key:0},va={__name:"AsesoriasHistorial",props:["totaladvisories","totalformalization10","totalformalization20"],setup($){const N=$,E=h("1"),c=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Componente",dataIndex:"component",width:20},{title:"Tema",dataIndex:"theme",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:60},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],V=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Detalle del trámite",dataIndex:"detailprocedure",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:100},{title:"RUC",dataIndex:"ruc",width:50},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],A=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Régimen",dataIndex:"regime",width:80,align:"center"},{title:"Número solicitud constancia",dataIndex:"numbernotary",width:100},{title:"Nombre empresa",dataIndex:"mypename",width:160},{title:"RUC",dataIndex:"ruc",width:80},{title:"Modalidad",dataIndex:"modality",align:"center",width:70},{title:"Ciudad",dataIndex:"city",width:30},{title:"Provincia",dataIndex:"province",width:20},{title:"Distrito",dataIndex:"district",width:20},{title:"Dirección",dataIndex:"address",width:200}],R=P=>Ie(P).format("DD/MM/YYYY HH:mm A");return(P,z)=>{const a=y("a-table"),G=y("a-card"),_=y("a-tab-pane"),d=y("a-tabs");return s(),v(d,{activeKey:E.value,"onUpdate:activeKey":z[0]||(z[0]=e=>E.value=e),type:"card",class:"box-hist"},{default:o(()=>[n(_,{key:"1",tab:"ASESORÍAS"},{default:o(()=>[n(G,null,{default:o(()=>[n(a,{columns:c,"data-source":N.totaladvisories,bordered:"",pagination:!1,size:"small",scroll:{x:1200},"expand-column-width":100},{bodyCell:o(({index:e,column:T,record:F})=>[T.dataIndex==="idx"?(s(),q("span",ma,S(e+1),1)):u("",!0),T.dataIndex==="date_start"?(s(),q(Z,{key:1},[Y(S(R(F.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),n(_,{key:"2",tab:"RUC 10"},{default:o(()=>[n(G,null,{default:o(()=>[n(a,{columns:V,"data-source":N.totalformalization10,bordered:"",pagination:!1,size:"small",scroll:{x:1800},"expand-column-width":100},{bodyCell:o(({index:e,column:T,record:F})=>[T.dataIndex==="idx"?(s(),q("span",pa,S(e+1),1)):u("",!0),T.dataIndex==="date_start"?(s(),q(Z,{key:1},[Y(S(R(F.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),n(_,{key:"3",tab:"RUC 20"},{default:o(()=>[n(G,null,{default:o(()=>[n(a,{columns:A,"data-source":N.totalformalization20,bordered:"",pagination:!1,size:"small",scroll:{x:2200},"expand-column-width":100},{bodyCell:o(({index:e,column:T,record:F})=>[T.dataIndex==="idx"?(s(),q("span",_a,S(e+1),1)):u("",!0),T.dataIndex==="date_start"?(s(),q(Z,{key:1},[Y(S(R(F.createDate)),1)],64)):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1},8,["activeKey"])}}},fa=se(va,[["__scopeId","data-v-01e75dfe"]]);const L=$=>(qe("data-v-07b1ea07"),$=$(),Le(),$),ha={class:"asesorias"},ya=L(()=>p("h3",{class:"title-produce"},"REGISTRO DE FORMALIZACIONES Y ASESORÍAS",-1)),ga=L(()=>p("br",null,null,-1)),ba={class:"wrapper-s"},xa=L(()=>p("label",{class:"label"},"Seleccione el tipo de documento",-1)),wa=L(()=>p("label",{class:"label"},"Digite el número de documento",-1)),Ca=L(()=>p("h4",{class:"title-produce"},"RESULTADO DE LA BÚSQUEDA",-1)),Ua=L(()=>p("b",{class:"box-title"},"Apellidos y nombres:",-1)),Sa=L(()=>p("b",{class:"box-title"},"Número de celular:",-1)),Ia=L(()=>p("b",{class:"box-title"},"Correo electrónico:",-1)),Da=L(()=>p("b",{class:"box-title"},"Asesorías:",-1)),ka=L(()=>p("b",{class:"box-title"},"Formalizaciones RUC 20:",-1)),za=L(()=>p("b",{class:"box-title"},"Formalizaciones RUC 10:",-1)),Aa=L(()=>p("h4",{class:"title-produce"},"SELECCIONAR CDE",-1)),Ra=L(()=>p("h4",{class:"title-produce"},"¿DESEA REGISTRAR UN NUEVO SERVICIO?",-1)),Na={key:0,class:"card-as",style:{padding:"1rem"}},Oa=L(()=>p("h4",{class:"title-produce"},"HISTORIAL",-1)),$a=L(()=>p("div",{class:"steps-content"},null,-1)),Fa={class:"pendient"},Ea={class:"info"},Ta=L(()=>p("b",null,"Código SID SUNARP",-1)),Pa={class:"code-number"},qa=L(()=>p("b",null,"Atendido por: ",-1)),La=L(()=>p("b",null,"Fecha de registro: ",-1)),Ma=L(()=>p("div",{style:{"text-align":"center"}},"NUEVO REGISTRO",-1)),Ya=[Ma],Va={__name:"AsesoriasFormalizaciones",setup($){const N=JSON.parse(localStorage.getItem("role")),E=()=>N.some(O=>O.id===7),c=ve(),V=Te(),A=we(),R=h(0),P=h(null),z=h(null),a=h([{value:"asesoria",label:"ASESORÍA"},{value:"ruc20",label:"RUC 20"},{value:"ruc10",label:"RUC 10"}]);c.$patch({cdes:c.cdes}),c.fetchCdes();const G=h(null),_=h(!1),d=h(null),e=h(!1),T=h(!1),F=h(!1),Q=h(!1),j=h(!1),I=h(!1),U=h(""),r=h([]),w=h(!1),D=h(0),H=h(!1),B=h([]);h(null);const X=h([]),ae=h([]),t=h([]),b=h(!1),m=O=>{z.value.cde_id=O,localStorage.setItem("profile",JSON.stringify(z.value))},l=(O,g)=>{const ee=O.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return g.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(ee)},te=()=>{f(U.value),_.value=!1},k=O=>Ie(O).format("DD/MM/YYYY HH:mm A"),K=()=>{de()},ne=()=>{U.value=U.value.replace(/\D/g,"")},de=()=>{b.value=!1,U.value="",r.value=[],B.value=[],V.push({name:"asesorias-formalizaciones"})},re=()=>{if(d.value=null,d.value=r.value,!P.value)return W.warning("Seleccionar un tipo de servicio");P.value=="asesoria"&&(I.value=!0),P.value=="ruc10"&&(j.value=!0),P.value=="ruc20"&&i()},fe=()=>{G.value=r.value,_.value=!0},ce=()=>{D.value=0,Q.value=!0,T.value=!1},i=async()=>{try{H.value=!0;const O=await J({url:`formalization/list-ruc-20/${r.value.id}`,method:"GET"});if(O.length<1)return ce();F.value=O,T.value=!0}catch(O){console.log(O)}finally{H.value=!1}},le=async()=>{w.value=!0;const O=await J({url:`person/found/${R.value}/${U.value}`,method:"GET"});if(O.status==200)return r.value=O.data,ie(r.value.id),w.value=!1},f=async O=>{if(w.value=!0,!O)return W.warning("Ingresa un número de documento"),w.value=!1;if(R.value==0)return W.warning("Seleccionar el tipo de documento"),w.value=!1;if(R.value==1&&U.value.length<8){W.warning("El número de DNI está incompleto"),w.value=!1;return}const g=await J({url:`person/found/${R.value}/${U.value}`,method:"GET"});if(g.status==200)return r.value=g.data,ie(g.data.id),z.value=JSON.parse(localStorage.getItem("profile")),w.value=!1;if(g.status===404){const ee={type:R.value,access:"asesorias",number:U.value};V.push({name:"registrar-persona",query:ee})}},ie=async O=>{try{const{data:g}=await J({url:`historial/registers/${O}`,method:"GET"});X.value=g.advisories,ae.value=g.formalization10,t.value=g.formalization20,b.value=!0}catch(g){console.error("Error de red:",g)}};return Ce(()=>{A.query.type&&(R.value=A.query.type,U.value=A.query.number)}),(O,g)=>{const ee=y("a-radio"),oe=y("a-tooltip"),De=y("a-radio-group"),ke=y("a-input-search"),he=y("a-card"),M=y("a-col"),ue=y("a-row"),be=y("a-select"),ze=y("a-button"),me=y("a-drawer"),Ae=y("a-tag"),Re=y("a-spin"),Ne=y("a-modal");return s(),q(Z,null,[p("div",ha,[ya,ga,n(he,{class:"card-as card-gray"},{default:o(()=>[x(A).query.dni?(s(),v(x(Je),{key:0,class:"ico-reload",onClick:K})):u("",!0),p("div",ba,[p("div",null,[xa,n(De,{value:R.value,"onUpdate:value":g[0]||(g[0]=C=>R.value=C),onChange:de,class:"radio-produce"},{default:o(()=>[n(oe,{color:"cyan"},{title:o(()=>[Y("Documento Nacional de Identidad")]),default:o(()=>[n(ee,{value:"1"},{default:o(()=>[Y("DNI")]),_:1})]),_:1}),n(oe,{color:"cyan"},{title:o(()=>[Y("Carnet de Extranjería")]),default:o(()=>[n(ee,{value:"2"},{default:o(()=>[Y("CE")]),_:1})]),_:1}),n(oe,{color:"cyan"},{title:o(()=>[Y("Pasaporte")]),default:o(()=>[n(ee,{value:"3"},{default:o(()=>[Y("PAS")]),_:1})]),_:1}),n(oe,{color:"cyan"},{title:o(()=>[Y("Permiso Temporal de Permanencia")]),default:o(()=>[n(ee,{value:"4"},{default:o(()=>[Y("PTP")]),_:1})]),_:1})]),_:1},8,["value"])]),p("div",null,[wa,n(ke,{"enter-button":"BUSCAR",value:U.value,"onUpdate:value":g[1]||(g[1]=C=>U.value=C),placeholder:"",loading:w.value,onSearch:f,onInput:ne,class:"search-produce",maxlength:R.value==1?8:20},null,8,["value","loading","maxlength"])])])]),_:1}),n(ue,{gutter:[16,16]},{default:o(()=>[n(M,{xs:24,sm:24,lg:12},{default:o(()=>[r.value.length!=0?(s(),v(he,{key:0},{default:o(()=>[Ca,n(x(Pe),{class:"box-icoedit",onClick:fe}),n(ue,{gutter:[0,2],class:"box-info"},{default:o(()=>[n(M,{xs:12,sm:8},{default:o(()=>[Ua]),_:1}),n(M,{xs:12,sm:12},{default:o(()=>[p("span",null,S(r.value.lastname)+" "+S(r.value.middlename)+", "+S(r.value.name),1)]),_:1}),n(M,{xs:12,sm:8},{default:o(()=>[Sa]),_:1}),n(M,{xs:12,sm:12},{default:o(()=>[p("span",null,S(r.value.phone?r.value.phone:"-"),1)]),_:1}),n(M,{xs:12,sm:8},{default:o(()=>[Ia]),_:1}),n(M,{xs:12,sm:12},{default:o(()=>[p("span",null,S(r.value.email?r.value.email:"-"),1)]),_:1}),n(M,{xs:12,sm:8},{default:o(()=>[Da]),_:1}),n(M,{xs:12,sm:12},{default:o(()=>{var C;return[p("span",null,S((C=r.value)==null?void 0:C.idadvisory.length),1)]}),_:1}),n(M,{xs:12,sm:8},{default:o(()=>[ka]),_:1}),n(M,{xs:12,sm:12},{default:o(()=>{var C;return[p("span",null,S((C=r.value)==null?void 0:C.idformalization20.length),1)]}),_:1}),n(M,{xs:12,sm:8},{default:o(()=>[za]),_:1}),n(M,{xs:12,sm:12},{default:o(()=>{var C;return[p("span",null,S((C=r.value)==null?void 0:C.idformalization10.length),1)]}),_:1})]),_:1})]),_:1})):u("",!0)]),_:1}),n(M,{xs:24,sm:24,lg:12},{default:o(()=>[r.value.length!=0?(s(),v(he,{key:0,style:{height:"100%"}},{default:o(()=>[n(ue,{gutter:[16,24]},{default:o(()=>[E()?u("",!0):(s(),v(M,{key:0,xs:24,sm:18,md:12,lg:12},{default:o(()=>[Aa,n(be,{class:"w-100",value:z.value.cde_id,"onUpdate:value":g[2]||(g[2]=C=>z.value.cde_id=C),options:x(c).cdes,"show-search":"","filter-option":l,onChange:m},null,8,["value","options"])]),_:1})),n(M,{xs:24,sm:18,md:12,lg:17},{default:o(()=>[Ra,n(ue,{gutter:[10,0]},{default:o(()=>[n(M,{xs:17,sm:18},{default:o(()=>[n(be,{class:"w-100",value:P.value,"onUpdate:value":g[3]||(g[3]=C=>P.value=C),options:a.value},null,8,["value","options"])]),_:1}),n(M,{xs:6},{default:o(()=>[n(ze,{type:"primary",onClick:re},{default:o(()=>[Y("REGISTRAR")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):u("",!0)]),_:1})]),_:1}),b.value?(s(),q("div",Na,[Oa,n(fa,{totaladvisories:X.value,totalformalization10:ae.value,totalformalization20:t.value},null,8,["totaladvisories","totalformalization10","totalformalization20"])])):u("",!0)]),p("section",null,[n(me,{title:"Regitsrar una Formalización con RUC 20",open:Q.value,"onUpdate:open":g[5]||(g[5]=C=>Q.value=C),placement:"right",width:"880px"},{default:o(()=>[n(oa,{info:d.value,idCde:z.value.cde_id,onCloseDraw:g[4]||(g[4]=C=>(Q.value=!1,le()))},null,8,["info","idCde"]),$a]),_:1},8,["open"]),n(me,{width:"600px",title:"Regitsrar Formalización con RUC 10",open:j.value,"onUpdate:open":g[7]||(g[7]=C=>j.value=C),placement:"right"},{default:o(()=>[n(sa,{info:r.value,idCde:z.value.cde_id,onCloseDraw:g[6]||(g[6]=C=>(j.value=!1,le()))},null,8,["info","idCde"])]),_:1},8,["open"]),n(me,{width:"600px",title:"Registrar una asesoría",open:I.value,"onUpdate:open":g[9]||(g[9]=C=>I.value=C),placement:"right"},{default:o(()=>[n(ua,{info:r.value,idCde:z.value.cde_id,onCloseDraw:g[8]||(g[8]=C=>(I.value=!1,le()))},null,8,["info","idCde"])]),_:1},8,["open"]),n(Ne,{open:T.value,"onUpdate:open":g[10]||(g[10]=C=>T.value=C),title:"Pendientes",closable:!0,cancelText:"Cerrar",footer:null,maskClosable:!1,width:"380px"},{default:o(()=>[n(Re,{spinning:e.value},{default:o(()=>[(s(!0),q(Z,null,_e(F.value,(C,Oe)=>(s(),q("div",{key:Oe},[p("div",Fa,[p("div",Ea,[Ta,p("span",null,[p("b",Pa,[n(Ae,{color:"error",style:{margin:"0"}},{default:o(()=>[Y(S(C.codesunarp),1)]),_:2},1024)])]),qa,p("span",null,S(C.user.profile.name)+" "+S(C.user.profile.lastname),1),La,p("span",null,S(k(C.updated_at)),1)])])]))),128)),p("div",{class:"pendient pendient-btn btn-produce",onClick:ce},Ya)]),_:1},8,["spinning"])]),_:1},8,["open"]),n(me,{width:"600",open:_.value,"onUpdate:open":g[11]||(g[11]=C=>_.value=C),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:o(()=>[n(Ge,{onCloseDraw:te,updateValues:G.value},null,8,["updateValues"])]),_:1},8,["open"])])],64)}}},Qa=se(Va,[["__scopeId","data-v-07b1ea07"]]);export{Qa as default};
