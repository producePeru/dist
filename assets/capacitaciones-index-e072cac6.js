import{_ as ee}from"./TableComponent-b5e2290e.js";import{p,r as l,a as G,k as z,W as T,o as h,y as M,i as P,L as W,d as A,c as m,m as L,h as N,T as ae,b as w,w as u,e as x,s as te,C as ie,j as y,t as Y,z as k,F as X,x as ne}from"./index-9efe7972.js";import{_ as J}from"./FormComponent-efa81010.js";import{u as K}from"./selectes-5b97efab.js";import"./es-4cb79e05.js";import"./icoexcel-1b303edf.js";import"./SyncOutlined-ac0e435d.js";import"./MoreOutlined-55406c12.js";import"./quill.snow-82b028ba.js";const le={key:1,class:"register-training"},se={__name:"RegistroCapacitaciones",emits:["closeDraw"],setup(U,{emit:S}){p.locale("es");const E=S,v=l(!0),I=l("REGISTRAR"),t=G({}),e=l(!1),d=K(),c=l(null),s=l({meta_id:[],especialista_id:[],dimension_id:[],modalidad:[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}]}),g=o=>{console.log("handleInputEvent",o)},R=async o=>{o=="dateReception"&&(t.dateTramite&&(t.dateTramite=null),b.value.dateTramite.disabled=!1)},O=async(o,r)=>{if(o==="meta_id"){b.value.fecha.allowedMonth=null,t.fecha=null;let a=s.value.meta_id.find(n=>n.value==r);console.log("meta",a),b.value.fecha.allowedMonth=a.label}},D=async o=>{o=="meta_id"&&(s.value.meta_id=d.trainingMetas),o=="especialista_id"&&(s.value.especialista_id=d.trainingSpecialist),o=="dimension_id"&&(s.value.dimension_id=d.trainingDimensions)},H=async()=>{e.value=!0;const o={meta_id:t.meta_id,especialista_id:t.especialista_id,fecha:p(t.fecha).format("YYYY-MM-DD"),horaInicio:p(t.horaInicio).format("HH:mm"),horaFin:p(t.horaFin).format("HH:mm"),dimension_id:t.dimension_id,modalidad:t.modalidad,tema:t.tema,lugar:t.lugar,participantes:t.participantes,empresas:t.empresas,coordinador:t.coordinador,observaciones:t.observaciones,estado:1};try{const r=await L({url:"training/register-training",method:"POST",data:o});r.status===200&&(N.success(r.message),F(),E("closeDraw",!0))}catch(r){r.response&&r.response.data&&r.response.data.message?N.error(r.response.data.message):N.error("OcurriÃ³ un error inesperado.");const a=document.getElementsByClassName("ant-drawer-body")[0];a&&(a.scrollTop=0)}finally{e.value=!1}},F=()=>{t.meta_id=null,t.especialista_id=null,t.fecha=null,t.horaInicio=null,t.horaFin=null,t.dimension_id=null,t.modalidad=null,t.tema=null,t.lugar=null,t.participantes=null,t.empresas=null,t.coordinador=null,t.observaciones=null},b=l({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDateRangeDisabled",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1,allowedMonth:null},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÃ“N",name:"dimension_id",required:!0,message:"Seleccionar dimensiÃ³n",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return z(async()=>{await d.fetchTrainingMetas(),await d.fetchTrainingSpecialist(),await d.fetchTrainingDimensions(),s.value.meta_id=d.trainingMetas,s.value.especialista_id=d.trainingSpecialist,s.value.dimension_id=d.trainingDimensions,v.value=!1}),T("formState",t),T("loadingState",e),(o,r)=>v.value?(h(),M(P(W),{key:0,style:{color:"#00a6db"}})):(h(),A("div",le,[m(J,{fields:b.value,options:s.value,btnSaveName:I.value,onHandleInputEvent:g,resetSelect:c.value,onHandleChangeSelect:O,onHandleFocusSelect:D,onHandleChangeClock:R,onOnSubmit:H,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const oe={key:1,class:"register-training"},re={__name:"EditarCapacitaciones",props:["info"],emits:["closeDraw"],setup(U,{emit:S}){p.locale("es");const E=S,v=U,I=l(!0),t=l("REGISTRAR"),e=G({}),d=l(!1),c=K(),s=l(null),g=l({meta_id:[],especialista_id:[],dimension_id:[],modalidad:[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}]}),R=a=>{console.log("handleInputEvent",a)},O=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),r.value.dateTramite.disabled=!1)},D=async(a,n)=>{if(a==="meta_id"){r.value.fecha.allowedMonth=null,e.fecha=null;let i=g.value.meta_id.find(C=>C.value==n);console.log("meta",i),r.value.fecha.allowedMonth=i.label}},H=async a=>{a=="meta_id"&&(g.value.meta_id=c.trainingMetas),a=="especialista_id"&&(g.value.especialista_id=c.trainingSpecialist),a=="dimension_id"&&(g.value.dimension_id=c.trainingDimensions)},F=async()=>{d.value=!0;const a={meta_id:e.meta_id,especialista_id:e.especialista_id,fecha:p(e.fecha).format("YYYY-MM-DD"),horaInicio:p(e.horaInicio).format("HH:mm"),horaFin:p(e.horaFin).format("HH:mm"),dimension_id:e.dimension_id,modalidad:e.modalidad,tema:e.tema,lugar:e.lugar,participantes:e.participantes,empresas:e.empresas,coordinador:e.coordinador,observaciones:e.observaciones,estado:e.estado};try{const n=await L({url:`training/update-training/${v.info.id}`,method:"PUT",data:a});n.status===200&&(N.success(n.message),b(),E("closeDraw",!0))}catch(n){n.response&&n.response.data&&n.response.data.message?N.error(n.response.data.message):N.error("OcurriÃ³ un error inesperado.");const i=document.getElementsByClassName("ant-drawer-body")[0];i&&(i.scrollTop=0)}finally{d.value=!1}},b=()=>{e.meta_id=null,e.especialista_id=null,e.fecha=null,e.horaInicio=null,e.horaFin=null,e.dimension_id=null,e.modalidad=null,e.tema=null,e.lugar=null,e.participantes=null,e.empresas=null,e.coordinador=null,e.observaciones=null},o=async a=>{a&&(e.meta_id=a.meta_id,e.especialista_id=a.especialista_id,e.dimension_id=a.dimension_id,e.modalidad=a.modalidad,e.tema=a.tema,e.lugar=a.lugar,e.participantes=a.participantes,e.empresas=a.empresas,e.coordinador=a.coordinador,e.observaciones=a.observaciones,e.fecha=p(a.fecha,"YYYY-MM-DD"),e.horaInicio=p(a.horaInicio,"HH:mm"),e.horaFin=p(a.horaFin,"HH:mm"),e.estado=a.estado)},r=l({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDateRangeDisabled",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1,allowedMonth:null},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÃ“N",name:"dimension_id",required:!0,message:"Seleccionar dimensiÃ³n",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return z(async()=>{v.info&&o(v.info),await c.fetchTrainingMetas(),await c.fetchTrainingSpecialist(),await c.fetchTrainingDimensions(),g.value.meta_id=c.trainingMetas,g.value.especialista_id=c.trainingSpecialist,g.value.dimension_id=c.trainingDimensions,I.value=!1}),ae(()=>v.info,a=>{a?o(a):b()}),T("formState",e),T("loadingState",d),(a,n)=>I.value?(h(),M(P(W),{key:0,style:{color:"#00a6db"}})):(h(),A("div",oe,[m(J,{fields:r.value,options:g.value,btnSaveName:t.value,onHandleInputEvent:R,resetSelect:s.value,onHandleChangeSelect:D,onHandleFocusSelect:H,onHandleChangeClock:O,onOnSubmit:F,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const de={class:"layout-content"},ce={href:"https://seguimiento-capacitaciones.soporte-pnte.com",target:"_blank"},ue={key:0,style:{display:"flex","flex-direction":"column"}},me=["onClick"],Ee={__name:"capacitaciones-index",setup(U){const S=l(!1),E=l(!1),v=l([]),I=l(0),t=l(100),e=l(!1),d=l(!1),c=l(null),s=G({asesor:null,month:p(),page:1}),g=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"Fecha/Hora",fixed:"left",dataIndex:"horario",align:"center",width:120},{title:"Especialista",dataIndex:"especialista",width:160},{title:"Tema",dataIndex:"tema",width:170},{title:"Modalidad",dataIndex:"modalidadText",width:120,align:"center"},{title:"Participantes",dataIndex:"participantes",align:"center",width:140},{title:"Estado",dataIndex:"estado",align:"center",width:140},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],R=()=>{c.value=null,S.value=!0},O=async()=>{await a()},D=async()=>{c.value=null,S.value=!1,await a()},H=async()=>{d.value=!0},F=async n=>{s.page=n,await a()},b=async n=>{n&&(s.page=1,await a())},o=n=>{c.value=n,E.value=!0},r=async(n,i)=>{try{const C={estado:i},B=await L({url:`training/update-training-status/${n}`,method:"PUT",data:C});console.log("response",B)}catch(C){console.error("Error de red:",C)}},a=async()=>{e.value=!0;try{const n={page:s.page};s.month&&(n.month=p(s.month).format("MM-YYYY"));const i=await L({url:"training/list-trainings",method:"GET",params:n});i.status==200&&(v.value=i.data.data,I.value=i.data.total,t.value=i.data.per_page)}catch(n){console.error("Error de red:",n)}finally{e.value=!1}};return z(async()=>{await a()}),T("search",s),T("loading",e),T("loadingFile",d),(n,i)=>{const C=w("a-button"),B=w("a-date-picker"),V=w("a-tag"),q=w("a-select-option"),Q=w("a-select"),Z=w("a-menu-item"),j=w("a-drawer");return h(),A("div",de,[m(ee,{title:"CAPACITACIONES UGSE",new:!0,textNuevo:"NUEVO",columns:g,titleSearch:"NÃšMERO DE DOCUMENTO",pageSize:t.value,nameTotal:"Capacitaciones",dataSource:v.value,total:I.value,onHandleNew:R,onHandleDownloadExcel:H,onHandleSearch:b,onHandlePaginator:F},{header:u(()=>[x("div",null,[x("a",ce,[m(C,{type:"text",icon:te(P(ie)),style:{"margin-right":"10px"}},{default:u(()=>i[3]||(i[3]=[y("Ver Calendario")])),_:1},8,["icon"])]),m(B,{value:s.month,"onUpdate:value":i[0]||(i[0]=f=>s.month=f),picker:"month",onChange:O},null,8,["value"])])]),"data-cell":u(({column:f,record:_})=>[f.dataIndex=="horario"?(h(),A("div",ue,[x("b",null,Y(P(p)(_.fecha).format("DD/MM/YYYY")),1),x("span",null,Y(_.horaInicio)+" - "+Y(_.horaFin),1)])):k("",!0),f.dataIndex=="especialista"?(h(),A(X,{key:1},[x("span",{class:"dot-specialist",style:ne(`background-color: ${_.colorEspecialista};`)},null,4),x("span",null,Y(_.especialista),1)],64)):k("",!0),f.dataIndex=="modalidadText"?(h(),A(X,{key:2},[_.modalidad==1?(h(),M(V,{key:0,color:"blue"},{default:u(()=>i[4]||(i[4]=[y(" Presencial ")])),_:1})):_.modalidad==2?(h(),M(V,{key:1,color:"green"},{default:u(()=>i[5]||(i[5]=[y(" Virtual ")])),_:1})):_.modalidad==3?(h(),M(V,{key:2,color:"orange"},{default:u(()=>i[6]||(i[6]=[y(" Mixto ")])),_:1})):k("",!0)],64)):k("",!0),f.dataIndex=="estado"?(h(),M(Q,{key:3,value:_.estado,"onUpdate:value":$=>_.estado=$,style:{width:"150px"},placeholder:"Seleccione estado",onChange:$=>r(_.id,$)},{default:u(()=>[m(q,{value:1},{default:u(()=>i[7]||(i[7]=[y("ðŸ“… Programada")])),_:1}),m(q,{value:2},{default:u(()=>i[8]||(i[8]=[y("â³ En curso")])),_:1}),m(q,{value:3},{default:u(()=>i[9]||(i[9]=[y("âœ… Completado")])),_:1}),m(q,{value:4},{default:u(()=>i[10]||(i[10]=[y("âŒ Cancelado")])),_:1})]),_:2},1032,["value","onUpdate:value","onChange"])):k("",!0)]),"custom-options":u(({record:f})=>[m(Z,null,{default:u(()=>[x("a",{onClick:_=>o(f)},"Editar",8,me)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),m(j,{width:"500",title:"Registro de capacitaciÃ³n",open:S.value,"onUpdate:open":i[1]||(i[1]=f=>S.value=f),placement:"right"},{default:u(()=>[m(se,{onCloseDraw:D})]),_:1},8,["open"]),m(j,{width:"500",title:"Editar capacitaciÃ³n",open:E.value,"onUpdate:open":i[2]||(i[2]=f=>E.value=f),placement:"right"},{default:u(()=>[m(re,{info:c.value,onCloseDraw:D},null,8,["info"])]),_:1},8,["open"])])}}};export{Ee as default};
