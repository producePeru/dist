import{_ as G}from"./TableComponent-5b89f59f.js";import{l as f,r as n,a as U,j as P,X as $,a6 as D,o as c,d as g,c as E,w as p,y as I,R as q,m as j,u as J,b as L,h as z,F as Z,e as S,i as k,t as T,x as H}from"./index-ac0e89a7.js";import{_ as Q}from"./FormComponent-73ceddb7.js";import{u as K}from"./selectes-630adbb5.js";import{U as X}from"./UpImage-d3f6b82b.js";import"./es-aee9a88a.js";import{d as W}from"./downloadExcel-49bffffc.js";import{C as ee}from"./CloudUploadOutlined-f89ade5b.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-2ce84146.js";import"./vue-quill.esm-bundler-5f3ed7f0.js";import"./quill.snow-4b9f668a.js";/* empty css                                                      *//* empty css                                                                */import"./_plugin-vue_export-helper-c27b6911.js";const ae={class:"fairs"},te={key:0},ie={__name:"DrawerFeria",props:["info"],emits:["closeDraw"],setup(V,{emit:b}){f.locale("es");const h=n({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},fairtype_id:{type:"iSelect",label:"TIPO DE EVENTO",name:"fairtype_id",required:!0,message:"Seleccionar tipo de Evento",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DEL EVENTO",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},place:{type:"iText",label:"LUGAR DEL EVENTO",name:"place",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: PRODUCE 2"},fecha:{type:"iText",label:"FECHA DEL EVENTO",name:"fecha",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: Lunes: 12 de mayo"},hours:{type:"iText",label:"HORARIO DEL EVENTO",name:"hours",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm"},messageImgBanner:{type:"iLabel",label:"IMAGEN PARA EL BANER",name:"messageImgBanner"},imgBanner:{type:"iSlot",name:"iSlotOptions"},messageEndForm:{type:"iLabel",label:"CONFIGURACIÓN DE MENSAJES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE DE CIERRE DE INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const v=b,l=V,O=n("GUARDAR"),a=U({}),m=n(!1),y=n(null),t=K(),w=n(null),o=n({city_id:[],fairtype_id:[],modality_id:[]}),C=()=>l.info?{name:l.info.image.name,url:l.info.image.url}:null,Y=e=>{},x=async e=>{e=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),h.value.dateTramite.disabled=!1)},R=async e=>{y.value=e.id},M=async e=>{e=="city_id"&&(await t.fetchCitiesNational(),a.city_id=null,o.value.city_id=t.citiesNational),e=="fairtype_id"&&(await t.fetchFairTypes(),o.value.fairtype_id=t.fairTypes),e=="modality_id"&&(await t.fetchModalities(),o.value.modality_id=t.modalities)},A=e=>{},F=async()=>{m.value=!0;const e={title:a.title,subTitle:a.subTitle,description:a.description,fairtype_id:a.fairtype_id,modality_id:a.modality_id,startDate:f(a.dates.start).format("YYYY-MM-DD"),endDate:f(a.dates.end).format("YYYY-MM-DD"),metaMypes:a.metaMypes,city_id:a.city_id,fecha:a.fecha,place:a.place,hours:a.hours,msgEndForm:a.msgEndForm,msgSendEmail:a.msgSendEmail,image_id:y.value};try{const i=l.info?`fair/update/${l.info.id}`:"fair/create",s=l.info?"PUT":"POST",_=await q({url:i,method:s,data:e});_.status===200&&(j.success(_.message),N(),v("closeDraw",!0))}catch(i){console.error("Error:",i);const s=document.getElementsByClassName("ant-drawer-body")[0];s&&(s.scrollTop=0)}finally{m.value=!1}},N=()=>{a.title=null,a.subTitle=null,a.description="</p>",a.fairtype_id=null,a.modality_id=null,a.dates=null,a.metaMypes=null,a.city_id=null,a.place=null,a.hours=null,a.msgEndForm="</p>",a.msgSendEmail="</p>"},u=async e=>{e&&(a.title=e.title,a.subTitle=e.subTitle,a.description=e.description,await t.fetchFairTypes(),o.value.fairtype_id=t.fairTypes,a.fairtype_id=e.fairtype_id,await t.fetchModalities(),o.value.modality_id=t.modalities,a.modality_id=e.modality_id,a.dates={start:f(e.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:f(e.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},a.metaMypes=e.metaMypes,await t.fetchCitiesNational(),o.value.city_id=t.citiesNational,a.city_id=e.city_id,a.fecha=e.fecha,a.place=e.place,a.hours=e.hours,a.msgEndForm=e.msgEndForm||"</p>",a.msgSendEmail=e.msgSendEmail||"</p>")};return P(()=>{l.info&&u(l.info)}),$(()=>l.info,e=>{e?u(e):N()}),D("formState",a),D("loadingState",m),(e,i)=>(c(),g("div",ae,[E(Q,{fields:h.value,options:o.value,btnSaveName:O.value,onHandleInputEvent:Y,resetSelect:w.value,onHandleFocusSelect:M,onHandleBlurSelect:A,onHandleChangeClock:x,onOnSubmit:F},{default:p(({field:s})=>[s.name=="iSlotOptions"?(c(),g("div",te,[E(X,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:R,imageLoad:C()},null,8,["imageLoad"])])):I("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const le={class:"advisory-table"},ne=["onClick"],se={key:0,style:{"line-height":"1.5"}},re={key:1},oe=["onClick"],de=["onClick"],ce=["href"],Oe={__name:"IndexFerias",setup(V){JSON.parse(localStorage.getItem("role"));const b=n([]),h=n(0),v=n(150),l=n(!1);n(!1);const O=J(),a=n(!1),m=n(null),y=n(!1),t=U({year:f("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:1}),w=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:150},{title:"TIPO DE FERIA",dataIndex:"fairtype_name",width:150,align:"center"},{title:"MODALIDAD",dataIndex:"modality_name",width:140,align:"center"},{title:"FECHAS INSCRIPCIONES",dataIndex:"date",width:150,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:120,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:120,align:"center"},{title:"FECHA DEL EVENTO",dataIndex:"fecha",width:150,align:"center"},{title:"LUGAR EVENTO",dataIndex:"place",width:150,align:"center"},{title:"HORARIO EVENTO",dataIndex:"hours",width:130,align:"center"},{title:"REGIÓN",dataIndex:"city_name",width:150,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description3",width:360},{title:"MENSAJE DE FINALIZACIÓN",dataIndex:"msgEndForm3",width:360},{title:"MENSAJE DE ENVÍO CORREO",dataIndex:"msgSendEmail3",width:360},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],o=n([{value:1,label:"EN CURSO"},{value:2,label:"FINALIZADOS"},{value:3,label:"TODOS"}]),C=e=>{let i=null;return e.fairtype_id==1&&(i=`https://inscripcion.soporte-pnte.com/sed/${e.slug}`,window.open(i,"_blank")),i},Y=e=>{O.push(`/admin/ferias/inscritos/${e.slug}`)},x=e=>{m.value=e,l.value=!0},R=()=>{u(),l.value=!1},M=()=>{m.value=null,l.value=!0},A=async()=>{y.value=!0;try{const e={};t.year&&(e.year=f(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby),t.asesor&&(e.asesor=t.asesor),await W("download/attendance-ugo","eventos-ugo",e)}catch(e){console.error("Error de red:",e)}finally{y.value=!1}},F=async e=>{t.page=e,await u()},N=async e=>{e&&(t.page=1,await u())},u=async()=>{try{a.value=!0;const e={page:t.page};t.year&&(e.year=f(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby);const s=await q({url:"fair/list",method:"GET",params:e});b.value=s.data.data,h.value=s.data.total,v.value=s.data.per_page}catch(e){console.error("Error de red:",e)}finally{a.value=!1}};return P(async()=>{await u()}),D("search",t),D("loading",a),D("loadingFile",y),(e,i)=>{const s=L("a-tag"),_=L("a-menu-item"),B=L("a-drawer");return c(),g("div",le,[E(G,{title:"LISTA DE EVENTOS UGSE",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:w,othersList:o.value,titleSearch:"BUSCAR POR EVENTO",pageSize:v.value,nameTotal:"Eventos UGSE",dataSource:b.value,total:h.value,btnUpdate:!0,onHandleNew:M,onHandleCallFetchData:u,onHandleDownloadExcel:A,onHandleSearch:N,onHandlePaginator:F},{"data-cell":p(({column:r,record:d})=>[r.dataIndex=="link"?(c(),g("a",{key:0,onClick:me=>C(d),href:"javascript:void(0)",target:"_blank"},[E(z(ee),{style:{"font-size":"18px"}})],8,ne)):I("",!0),r.dataIndex=="date"?(c(),g(Z,{key:1},[d.startDate!=d.endDate?(c(),g("span",se,[i[1]||(i[1]=S("b",null,"Desde:",-1)),k(" "+T(d.dateStartFormat)+" ",1),i[2]||(i[2]=S("b",null,"Hasta:",-1)),k(" "+T(d.dateEndFormat),1)])):(c(),g("span",re,T(d.dateStartFormat),1))],64)):I("",!0),r.dataIndex=="registered"?(c(),H(s,{key:2,color:"processing"},{default:p(()=>[k(T(d.registered),1)]),_:2},1024)):I("",!0)]),"custom-options":p(({record:r})=>[E(_,null,{default:p(()=>[S("a",{onClick:d=>Y(r)},"Inscritos",8,oe)]),_:2},1024),E(_,null,{default:p(()=>[S("a",{onClick:d=>x(r)},"Editar",8,de)]),_:2},1024),r.fairtype_id==1?(c(),H(_,{key:0},{default:p(()=>[S("a",{href:`https://inscripcion.soporte-pnte.com/asistencia/${r.slug}`,target:"_blank"},"Asistencia",8,ce)]),_:2},1024)):I("",!0)]),_:1},8,["othersList","pageSize","dataSource","total"]),E(B,{open:l.value,"onUpdate:open":i[0]||(i[0]=r=>l.value=r),title:m.value?"EDITAR EVENTO UGSE":"REGISTRAR UN EVENTO",placement:"right",width:"550"},{default:p(()=>[E(ie,{onCloseDraw:R,info:m.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Oe as default};
