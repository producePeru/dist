import{l as v,r as A,E as j,a as J,U as h,j as Z,b as p,o as n,x as o,w as u,e as K,d as I,F as U,s as X,c as y,y as d,h as _,I as ee,v as ae,i as te,t as le,N as ie,m as R}from"./index-04ec81ed.js";import{Q as se}from"./quill.snow-26414ae2.js";import{u as ne}from"./selectes-110ad443.js";import"./es-aeb4b26c.js";const re={class:"form-fair"},oe="DD/MM/YYYY",pe={__name:"NuevaFeria",props:["dataRow"],emits:["closeDraw"],setup(w,{emit:C}){v.locale("es");const r=ne();r.$patch({cities:r.cities}),r.$patch({provinces:r.provinces}),r.$patch({districts:r.districts}),r.fetchCities();const f=A(!1),T={theme:"snow",modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{color:[]},{background:[]}],["clean"]]},contentType:"html"},b=w,x=C;j();const e=J({}),c=A({title:{type:"iText",label:"NOMBRE DE LA FERIA",name:"title",required:!0,message:"Escribir el nombre de la Feria",disabled:!0,max:100},subTitle:{type:"iText",label:"SUBTÍTULO DE LA FERIA",name:"subTitle",required:!0,message:"Escribir un sub título a la Feria",disabled:!0,max:100},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DE LA FERIA",name:"description",required:!1,message:"Escribir la descripción",disabled:!1},modality:{type:"iSelect",label:"MODALIDAD",name:"modality",required:!0,message:"Seleccionar una opción",disabled:!0},metaMypes:{type:"iNumber",label:"META MYPES PARTICIPANTES",name:"metaMypes",required:!0,message:"Meta MYPEs Participantes",disabled:!0},startDate:{type:"iDate",label:"FECHA INICIO DE LA FERIA",name:"startDate",required:!0,message:"Seleccionar fecha de Inicio",disabled:!1},endDate:{type:"iDate",label:"FECHA FIN DE LA FERIA",name:"endDate",required:!0,message:"Seleccionar fecha de Fin",disabled:!1},powerBy:{type:"iSelect",label:"PERTENECE AL",name:"powerBy",required:!0,message:"Seleccionar una opción",disabled:!0},fairtype_id:{type:"iSelect",label:"TIPO DE FERIA",name:"fairtype_id",required:!0,message:"Seleccionar una opción",disabled:!0},nationalEvent:{type:"iSelect",label:"FERIA TIPO",name:"nationalEvent",required:!0,message:"Seleccionar región",disabled:!1},city_id:{type:"iSelectWrite",label:"REGIÓN",name:"city_id",required:!1,message:"Seleccionar región",disabled:!1,visible:!1}}),M=[{label:"NACIONAL",value:0},{label:"POR REGIÓN",value:1}],P=[{label:"PRESENCIAL",value:"p"},{label:"VIRTUAL",value:"v"}],N=[{label:"PP093",value:"pp093"},{label:"PUNCHE",value:"punche"},{label:"APNOP",value:"apnop"}],O=[{label:"PERÚ PRODUCE EN MACROEVENTO",value:1},{label:"CYBER WOW",value:2},{label:"MUJER PRODUCE ",value:3},{label:"PERÚ PRODUCE REGIONAL",value:4}],Y=t=>s=>{const m=new Date().setHours(0,0,0,0);if(t==="startDate")return s&&s.valueOf()<m;if(t==="endDate"){const i=e.startDate?new Date(e.startDate).setHours(0,0,0,0):null;return s&&(s.valueOf()<m||i&&s.valueOf()<i)}return s&&s.valueOf()<m};h(()=>e.startDate,t=>{e.endDate&&new Date(t)>new Date(e.endDate)&&(e.endDate=null)}),h(()=>e.endDate,t=>{e.startDate&&new Date(t)<new Date(e.startDate)&&(e.startDate=null)});const g=(t,s)=>{const m=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(m)},F=t=>{if(t=="modality")return P;if(t=="powerBy")return N;if(t=="fairtype_id")return O;if(t=="nationalEvent")return M},k=t=>{t=="nationalEvent"&&(e.nationalEvent!=0?(c.value.city_id.visible=!0,c.value.city_id.required=!0):(c.value.city_id.visible=!1,c.value.city_id.required=!1,e.city_id=null))},S=t=>{e.province_id=null,e.district_id=null,r.fetchProvinces(t)},L=t=>{e.district_id=null,r.fetchDistricts(t)},E=()=>{e.title=null,e.subTitle=null,e.description="</span>",e.metaMypes=null,e.metaSales=null,e.startDate=null,e.endDate=null,e.modality=null,e.powerBy=null,e.fairtype_id=null,e.city_id=null,e.province_id=null,e.district_id=null},B=async()=>{f.value=!0;const t={title:e.title,subTitle:e.subTitle,description:e.description,metaMypes:e.metaMypes,metaSales:e.metaSales,startDate:v(e.startDate).format("YYYY-MM-DD"),endDate:v(e.endDate).format("YYYY-MM-DD"),modality:e.modality,powerBy:e.powerBy,fairtype_id:e.fairtype_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id};try{const s=b.dataRow?"PUT":"POST",m=b.dataRow?`fair/update/${b.dataRow.id}`:"fair/create",i=await ie({url:m,method:s,data:t});i.status==200&&(R.success(i.message),x("closeDraw"),E()),i.status==500&&(R.error(i.message),E())}catch{R.error("Se presentó un error, los valores son requeridos")}finally{f.value=!1}},z=t=>{const s=e[t]?e[t].trim():"";e[t]=s};function q(t){t&&(e.title=t.title,e.subTitle=t.subTitle,e.description=t.description,e.metaMypes=t.metaMypes,e.metaSales=t.metaSales,e.startDate=t.startDate?v(t.startDate,"DD/MM/YYYY"):null,e.endDate=t.endDate?v(t.endDate,"DD/MM/YYYY"):null,e.modality=t.modality,e.powerBy=t.powerBy,e.fairtype_id=t.fairtype_id,t.city_id?(e.nationalEvent=1,c.value.city_id.visible=!0,c.value.city_id.required=!0,S(t.city_id),e.city_id=t.city_id):(e.nationalEvent=0,e.city_id=null,c.value.city_id.visible=!1,c.value.city_id.required=!1))}return Z(()=>{b.dataRow&&q(b.dataRow)}),h(()=>b.dataRow,t=>{t?q(t):(E(),e.description='<p><strong style="color: rgb(0, 26, 78);">Lugar:</strong><span style="color: rgb(0, 26, 78);">&nbsp;</span>Centro de Exposiciones Jockey</p><p><strong style="color: rgb(0, 26, 78);">Sectores participantes:</strong></p><ul><li>Textil - confecciones y cuero - calzado relacionados al sector minero.</li></ul><p><strong style="color: rgb(0, 26, 78);">Requisitos:</strong></p><ul><li>RUC activo y habido</li><li>Ser MYPE productora</li><li>Mínimo de 2 años de antigüedad</li><li>Presencia en redes sociales</li><li>Contar con medios de pagos digitales</li><li>Contar con productos de valor agregado</li><li>De preferencia haber realizado ventas anuales mayores a 13 UIT, en el 2022/2023, validado con Reporte Tributario. (PRIORIDAD)</li></ul><p><strong style="color: rgb(0, 26, 78);">Fecha:</strong><span style="color: rgb(0, 102, 204);">&nbsp;</span>Del lunes 28 al jueves 31 de octubre de 2024</p>')}),(t,s)=>{const m=p("a-input"),i=p("a-form-item"),D=p("a-select"),V=p("a-textarea"),$=p("a-input-number"),H=p("a-date-picker"),G=p("a-button"),Q=p("a-form");return n(),o(Q,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:B},{default:u(()=>[K("div",re,[(n(!0),I(U,null,X(c.value,(a,W)=>(n(),I(U,{key:W},[a.type==="iText"?(n(),o(i,{key:0,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,max:a.max}]},{default:u(()=>[y(m,{value:e[a.name],"onUpdate:value":l=>e[a.name]=l,maxlength:a.max,onBlur:l=>z(a.name)},null,8,["value","onUpdate:value","maxlength","onBlur"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iSelect"?(n(),o(i,{key:1,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:u(()=>[y(D,{value:e[a.name],"onUpdate:value":l=>e[a.name]=l,options:F(a.name),onChange:l=>k(a.name)},null,8,["value","onUpdate:value","options","onChange"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iTextarea"?(n(),o(i,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:u(()=>[y(V,{value:e[a.name],"onUpdate:value":l=>e[a.name]=l,rows:3,maxlength:a.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iNumber"?(n(),o(i,{key:3,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:u(()=>[y($,{value:e[a.name],"onUpdate:value":l=>e[a.name]=l,min:1,max:500,style:{width:"100%"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iQuillEditor"?(n(),o(i,{key:4,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:u(()=>[y(_(se),{class:"quill-height-200",content:e[a.name],"onUpdate:content":l=>e[a.name]=l,options:T,contentType:"html"},null,8,["content","onUpdate:content"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iDate"?(n(),o(i,{key:5,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:u(()=>[y(H,{locale:_(ee),value:e[a.name],"onUpdate:value":l=>e[a.name]=l,style:{width:"100%"},format:oe,placeholder:"día/mes/año","disabled-date":Y(a.name)},null,8,["locale","value","onUpdate:value","disabled-date"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iSelectWrite"?(n(),o(i,{key:6,class:"item-max",name:a.name,label:a.label,style:ae({display:a.visible?"block":"none"}),rules:[{required:a.required,message:a.message}]},{default:u(()=>[a.name=="city_id"?(n(),o(D,{key:0,value:e[a.name],"onUpdate:value":l=>e[a.name]=l,options:_(r).cities,"show-search":"","filter-option":g,onChange:S},null,8,["value","onUpdate:value","options"])):d("",!0),a.name=="province_id"?(n(),o(D,{key:1,value:e[a.name],"onUpdate:value":l=>e[a.name]=l,options:_(r).provinces,"show-search":"","filter-option":g,onChange:L,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),a.name=="district_id"?(n(),o(D,{key:2,value:e[a.name],"onUpdate:value":l=>e[a.name]=l,options:_(r).districts,"show-search":"","filter-option":g,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):d("",!0)]),_:2},1032,["name","label","style","rules"])):d("",!0)],64))),128))]),y(i,null,{default:u(()=>[y(G,{type:"primary","html-type":"submit",loading:f.value},{default:u(()=>[te(le(w.dataRow?"ACTUALIZAR":"GUARDAR"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])}}};export{pe as _};
