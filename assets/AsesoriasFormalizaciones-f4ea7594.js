import{_ as Ce}from"./FormComponent-f1ee0b8f.js";import{u as ne}from"./selectes-8fac73d9.js";import{c as i,A as Ie,l as te,r as m,a as ue,j as se,X as me,a6 as ye,o as u,d as L,f as we,R as K,b as y,w as o,e as h,F as J,s as ge,h as N,x as S,y as _,P as Ee,i as M,ab as De,m as H,t as W,a3 as Re,u as Ae,E as Ne,ad as Oe}from"./index-95014ea4.js";import"./es-61417b7a.js";import"./storage-abd7848d.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as Ue}from"./DrawerSolicitante.componente-773c0a56.js";import"./quill.snow-61392682.js";var Te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};const qe=Te;function be(R){for(var O=1;O<arguments.length;O++){var w=arguments[O]!=null?Object(arguments[O]):{},b=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(b=b.concat(Object.getOwnPropertySymbols(w).filter(function(P){return Object.getOwnPropertyDescriptor(w,P).enumerable}))),b.forEach(function(P){ze(R,P,w[P])})}return R}function ze(R,O,w){return O in R?Object.defineProperty(R,O,{value:w,enumerable:!0,configurable:!0,writable:!0}):R[O]=w,R}var pe=function(O,w){var b=be({},O,w.attrs);return i(Ie,be({},b,{icon:qe}),null)};pe.displayName="RedoOutlined";pe.inheritAttrs=!1;const ke=pe;const Pe={class:"f-20"},Fe={__name:"AllFormalizacion20",props:["info","idCde"],emits:["closeDraw"],setup(R,{emit:O}){te.locale("es");const w=m({ruc:{type:"iNumber",label:"RUC",name:"ruc",message:"Escribir número de RUC",disabled:!1,maxlength:11,rules:[{validator:(l,I)=>{if(!I)return Promise.resolve();const E=I.toString();return E.length!==11?Promise.reject(new Error("El número debe tener exactamente 11 dígitos")):E.startsWith("20")?Promise.resolve():Promise.reject(new Error('El número de RUC debe comenzar con "20"'))},trigger:"change"}]},nameMype:{type:"iText",label:"NOMBRE EMPRESA",name:"nameMype",required:!0,message:"Escribir nombre de la empresa",disabled:!1},city_id:{type:"iSelect",label:"REGIÓN DEL NEGOCIO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL NEGOCIO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL NEGOCIO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},address:{type:"iText",label:"DIRECCIÓN DEL NEGOCIO",name:"address",required:!0,message:"Escribir la dirección del negocio",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DE ATENCIÓN",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},regime_id:{type:"iSelect",label:"RÉGIMEN SOCIETARIO",name:"regime_id",required:!0,message:"Seleccionar el régimen societario",disabled:!1},economicsector_id:{type:"iSelect",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},numbernotary:{type:"iText",label:"NÚM. SOLICITUD CONSTANCIA",name:"numbernotary",required:!0,message:"Escribir número de solicitud de constancia",disabled:!1,maxlength:8,rules:[{validator:(l,I)=>{if(!I)return Promise.reject(new Error("El número de notaría es requerido"));const E=I.toString();return/^\d{8}$/.test(E)?Promise.resolve():Promise.reject(new Error("El número debe tener exactamente 8 dígitos numéricos"))},trigger:"change"}]},comercialactivity_id:{type:"iSelect",label:"ACTIVIDAD COMERCIAL",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},notary_id:{type:"iSelectNotary",label:"NOTARÍA",name:"notary_id",required:!0,message:"Seleccionar una notaría",disabled:!1},dateReception:{type:"iDate",label:"FECHA DE RECEPCION PNTE",name:"dateReception",required:!0,disabled:!1,disabledDate:l=>!1},dateTramite:{type:"iDate",label:"FEC. TRÁMITE SID SUNARP-SUNAT",name:"dateTramite",required:!0,disabled:!0,disabledDate:l=>a.dateReception&&l&&te(l).isBefore(te(a.dateReception))},isbic:{type:"iSelect",label:"¿ES UNA SOCIEDAD BIC?",name:"isbic",required:!1,message:"Buscar BIC",disabled:!1},montocapital:{type:"iMoney",label:"MONTO DE CAPITAL SOCIAL",name:"montocapital",required:!1,message:"Escribir el Monto de capital social",disabled:!1},typecapital_id:{type:"iSelect",label:"TIPO DE APORTE DE CAPITAL",name:"typecapital_id",required:!1,message:"Seleccionar BIC",disabled:!1}}),b=JSON.parse(localStorage.getItem("profile")),P=O,r=R,U=m("REGISTRAR"),a=ue({}),A=m(!1),e=ne(),G=m(null),f=m({city_id:[],province_id:[],district_id:[],modality_id:[],comercialactivity_id:[],isbic:[],typecapital_id:[]}),n=l=>{console.log("handleInputEvent",l)},F=async l=>{l=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),w.value.dateTramite.disabled=!1)},x=async l=>{l=="city_id"&&(await e.fetchProvinces(a.city_id),f.value.province_id=e.provinces,w.value.province_id.disabled=!1),l=="province_id"&&(await e.fetchDistricts(a.province_id),f.value.district_id=e.districts,w.value.district_id.disabled=!1)},k=async l=>{console.log("handleFocusSelect",l),l=="city_id"&&(await e.fetchCities(),a.city_id=null,a.province_id=null,a.district_id=null,f.value.province_id=[],f.value.city_id=e.cities),l=="province_id"&&(a.province_id=null,a.district_id=null,f.value.district_id=[]),l=="modality_id"&&(await e.fetchModalities(),f.value.modality_id=e.modalities),l=="regime_id"&&(await e.fetchRegimes(),f.value.regime_id=e.regimes),l=="economicsector_id"&&(await e.fetchEconomicSectors(),f.value.economicsector_id=e.economicSectors),l=="comercialactivity_id"&&(await e.fetchComercialActivities(),f.value.comercialactivity_id=e.comercialActivities),l=="notary_id"&&d(),l=="isbic"&&q(),l=="typecapital_id"&&(await e.fetchTypeCapital(),f.value.typecapital_id=e.typeCapital)},B=l=>{},q=()=>{f.value.isbic=[{value:"SI",label:"SI"},{value:"NO",label:"NO"}]},d=async()=>{try{const{data:l}=await we({url:"public/notaries-filters",method:"GET"}),I=l.map(E=>({value:E.id,name:E.name,city:E.city.name,province:E.province.name,district:E.district.name,address:E.address}));f.value.notary_id=I}catch(l){console.error("Error de red:",l)}},C=async()=>{A.value=!0;const l={ruc:a.ruc,nameMype:a.nameMype,city_id:a.city_id,province_id:a.province_id,district_id:a.district_id,address:a.address,modality_id:a.modality_id,regime_id:a.regime_id,economicsector_id:a.economicsector_id,numbernotary:a.numbernotary,comercialactivity_id:a.comercialactivity_id,notary_id:a.notary_id,dateReception:te(a.dateReception).format("YYYY-MM-DD"),dateTramite:te(a.dateTramite).format("YYYY-MM-DD"),isbic:a.isbic,montocapital:a.montocapital,typecapital_id:a.typecapital_id,user_id:a.user_id,people_id:a.people_id,dni:a.dni,cde_id:a.cde_id};try{(await K({url:"formalization/create-ruc20",method:"POST",data:l})).status===200&&(p(),P("closeDraw",!0))}catch(I){console.error("Error:",I);const E=document.getElementsByClassName("ant-drawer-body")[0];E&&(E.scrollTop=0)}finally{A.value=!1}},p=()=>{a.ruc=null,a.nameMype=null,a.city_id=null,a.province_id=null,a.district_id=null,a.address=null,a.modality_id=null,a.regime_id=null,a.economicsector_id=null,a.numbernotary=null,a.comercialactivity_id=null,a.notary_id=null,a.dateReception=null,a.dateTramite=null,a.isbic=null,a.montocapital=null,a.typecapital_id=null},v=async l=>{l&&(a.user_id=b.user_id,a.people_id=l.id,a.dni=b.documentnumber,a.cde_id=b.cde_id,a.address=l.address,await e.fetchCities(),f.value.city_id=e.cities,a.city_id=l.city_id,await e.fetchProvinces(a.city_id),f.value.province_id=e.provinces,w.value.province_id.disabled=!1,a.province_id=l.province_id,await e.fetchDistricts(a.province_id),f.value.district_id=e.districts,w.value.district_id.disabled=!1,a.district_id=l.district_id)};return se(()=>{r.info&&v(r.info)}),me(()=>r.info,l=>{l&&v(l)}),ye("formState",a),ye("loadingState",A),(l,I)=>(u(),L("div",Pe,[i(Ce,{fields:w.value,options:f.value,btnSaveName:U.value,onHandleInputEvent:n,resetSelect:G.value,onHandleChangeSelect:x,onHandleFocusSelect:k,onHandleBlurSelect:B,onHandleChangeClock:F,onOnSubmit:C},null,8,["fields","options","btnSaveName","resetSelect"])]))}},ce=JSON.parse(localStorage.getItem("role")),$e={dni:{type:"iText",label:"Número de documento de identidad",name:"dni",required:!0,message:"Escribir número de documento",disabled:!1,placeholder:"Número documento"},economicsector_id:{type:"iSelectWrite",label:"Sector económico",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelectWrite",label:"Actividad comercial",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},detailprocedure_id:{type:"iSelect",label:"Detalle del trámite",name:"detailprocedure_id",required:!0,message:"Seleccionar detalle del trámite",disabled:!1},modality_id:{type:"iSelect",label:"Modalidad de atención",name:"modality_id",required:!0,message:"Seleccionar modalidad de atención",disabled:!!ce.some(R=>R.id===7)},ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!0,message:"Escribir el número de RUC",disabled:!1,max:11},city_id:{type:"iSelectWrite",label:"Región del negocio",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelectWrite",label:"Provincia del Negocio",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelectWrite",label:"Distrito del Negocio",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},address:{type:"iText",label:"Direccion del Negocio",name:"address",required:!0,message:"Escribir la direccion del Negocio",disabled:!1}},Me={dni:{type:"iText",label:"Número de documento",name:"dni",required:!0,message:"Escribir número de documento",disabled:!1,placeholder:"Número documento"},economicsector_id:{type:"iSelectWrite",label:"Sector económico",name:"economicsector_id",required:!0,message:"Seleccionar el sector económico",disabled:!1},comercialactivity_id:{type:"iSelectWrite",label:"Actividad comercial",name:"comercialactivity_id",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},component_id:{type:"iSelectWrite",label:"Componente",name:"component_id",required:!0,message:"Seleccionar un componente",disabled:!!ce.some(R=>R.id===7)},theme_id:{type:"iSelectWrite",label:"Tema del componente",name:"theme_id",required:!0,message:"Seleccionar un tema del componente",disabled:!1},modality_id:{type:"iSelect",label:"Modalidad de atención",name:"modality_id",required:!0,message:"Seleccionar modalidad",disabled:!!ce.some(R=>R.id===7)},ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!1,message:"Escribir número de RUC",disabled:!1,placeholder:"Número de RUC (Opcional)",max:11,min:11},city_id:{type:"iSelectWrite",label:"Región del negocio",name:"city_id",required:!0,message:"Seleccionar departamento",disabled:!1},province_id:{type:"iSelectWrite",label:"Provincia del Negocio",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelectWrite",label:"Distrito del Negocio",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},observations:{type:"iTextarea",label:"Nro de Reserva / Observaciones",name:"observations",required:!1,message:"Seleccionar tipo de documento",disabled:!1}};const Le={class:"wrapper-booking"},Ge={class:"grid-booking"},Be={__name:"FormalizacionRUC10",props:["info","idCde"],emits:["closeDraw"],setup(R,{emit:O}){const w=JSON.parse(localStorage.getItem("role")),b=De({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),P=JSON.parse(localStorage.getItem("profile")),r=R,U=O,a=m(!1),A=m(null);m(null),m(!1);const e=ne(),G=m(!1);e.$patch({cities:e.cities}),e.$patch({provinces:e.provinces}),e.$patch({districts:e.districts}),e.$patch({modalities:e.modalities}),e.$patch({detailProcedures:e.detailProcedures}),e.$patch({economicSectors:e.economicSectors}),e.$patch({comercialActivities:e.comercialActivities}),e.fetchDetailProcedures(),e.fetchModalities(),e.fetchEconomicSectors(),e.fetchComercialActivities(),e.fetchCities();const f=m(!0),n=ue({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,address:null,user_id:P.user_id}),F=async()=>{try{G.value=!0;const p={name:A.value};(await K({url:"create/comercial-activities",method:"POST",data:p})).status==200&&(A.value=null,e.fetchComercialActivities())}catch(p){console.log(p)}finally{G.value=!1}},x=p=>{n.province_id=null,n.district_id=null,e.fetchProvinces(p)},k=p=>{n.district_id=null,e.fetchDistricts(p)},B=(p,v)=>{const l=p.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return v.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(l)},q=async()=>{if(a.value=!0,!r.info.id)return H.error("Error al registrar, actualiza la página");const p={dni:n.dni,detailprocedure_id:n.detailprocedure_id,modality_id:n.modality_id,economicsector_id:n.economicsector_id,comercialactivity_id:n.comercialactivity_id,city_id:n.city_id,province_id:n.province_id,district_id:n.district_id,address:n.address,ruc:n.ruc,user_id:P.user_id,people_id:r.info.id,cde_id:r.idCde?r.idCde:null};try{const v=await K({url:"formalization/create-ruc-10",method:"POST",data:p});if(v.status===200){const l={razonSocial:null,ruc:n.ruc,createdFrom:"F10"};H.success(v.message),n.detailprocedure_id=null,n.modality_id=null,n.economicsector_id=null,n.comercialactivity_id=null,n.city_id=null,n.province_id=null,n.district_id=null,n.address=null,n.ruc=null,U("closeDraw",!0)}}catch(v){console.log("Error: "+v)}finally{a.value=!1}},d=()=>{H.warning("Debes de completar todos los espacios requeridos")};function C(){const{documentnumber:p,city_id:v,province_id:l,district_id:I,address:E}=r.info,V=w.some(Y=>Y.id===7);n.dni=p,n.city_id=v,x(v),n.province_id=l,k(l),n.district_id=I,n.address=E,V&&(n.modality_id=1),n.district_id&&setTimeout(()=>{f.value=!1},1500)}return se(()=>{r.info&&C(r.info)}),me(()=>r.info,p=>{p&&C()}),(p,v)=>{const l=y("a-select"),I=y("a-form-item"),E=y("a-input"),V=y("a-divider"),Y=y("a-button"),s=y("a-space"),X=y("a-form"),D=y("a-spin");return u(),L("div",Le,[i(D,{spinning:f.value},{default:o(()=>[i(X,{layout:"vertical",model:n,name:"basic",autocomplete:"off",onFinish:q,onFinishFailed:d},{default:o(()=>[h("div",Ge,[(u(!0),L(J,null,ge(N($e),(c,ae)=>(u(),L(J,{key:ae},[c.type==="iSelect"?(u(),S(I,{key:0,class:"item-max",name:c.name,label:c.label,rules:[{required:c.required,message:c.message}]},{default:o(()=>[c.name=="detailprocedure_id"?(u(),S(l,{key:0,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,options:N(e).detailProcedures},null,8,["value","onUpdate:value","options"])):_("",!0),c.name=="modality_id"?(u(),S(l,{key:1,disabled:c.disabled,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,options:N(e).modalities},null,8,["disabled","value","onUpdate:value","options"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0),c.type==="iText"?(u(),S(I,{key:1,name:c.name,label:c.label,rules:[{required:c.required,message:c.message,type:"string",max:c.max},...c.name==="ruc"?[{validator:(T,Q,Z)=>{Q?/^(10|15|17)\d{9}$/.test(Q)?Z():Z(new Error("El RUC debe comenzar con 10, 15 o 17 y tener 11 caracteres en total")):Z()}}]:[]]},{default:o(()=>[i(E,{value:n[c.name],"onUpdate:value":T=>n[c.name]=T,disabled:c.name==="dni"&&!!n[c.name],maxlength:c.max,placeholder:c.placeholder},null,8,["value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):_("",!0),c.type==="iSelectWrite"?(u(),S(I,{key:2,class:"item-max",name:c.name,label:c.label,rules:[{required:c.required,message:c.message}]},{default:o(()=>[c.name=="comercialactivity_id"?(u(),S(l,{key:0,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).comercialActivities,"filter-option":B},{dropdownRender:o(({menuNode:T})=>[i(N(b),{vnodes:T},null,8,["vnodes"]),i(V,{style:{margin:"4px 0"}}),i(s,{style:{padding:"4px 8px"}},{default:o(()=>[i(E,{ref_for:!0,ref:"inputRef",value:A.value,"onUpdate:value":v[0]||(v[0]=Q=>A.value=Q),placeholder:"Nueva actividad"},null,8,["value"]),i(Y,{type:"text",onClick:F,loading:G.value},{icon:o(()=>[i(N(Ee))]),default:o(()=>[v[1]||(v[1]=M(" Agregar "))]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):_("",!0),c.name=="economicsector_id"?(u(),S(l,{key:1,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).economicSectors,"filter-option":B},null,8,["value","onUpdate:value","options"])):_("",!0),c.name=="city_id"?(u(),S(l,{key:2,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).cities,"filter-option":B,onChange:x},null,8,["value","onUpdate:value","options"])):_("",!0),c.name=="province_id"?(u(),S(l,{key:3,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).provinces,"filter-option":B,onChange:k,disabled:!n.city_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0),c.name=="district_id"?(u(),S(l,{key:4,value:n[c.name],"onUpdate:value":T=>n[c.name]=T,"show-search":"",options:N(e).districts,"filter-option":B,disabled:!n.province_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0)],64))),128))]),i(I,null,{default:o(()=>[i(Y,{type:"primary",class:"btn-produce","html-type":"submit",loading:a.value},{default:o(()=>v[2]||(v[2]=[M("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},We=de(Be,[["__scopeId","data-v-84400cbe"]]);const He={class:"wrapper-booking"},Ve={class:"grid-booking"},Ye={__name:"AsesoriaNuevo",props:["info","idCde"],emits:["closeDraw"],setup(R,{emit:O}){const w=JSON.parse(localStorage.getItem("role")),b=R,P=O,r=ne(),U=JSON.parse(localStorage.getItem("profile")),a=m(!1);m(!1),m(null),m(null),r.$patch({components:r.components}),r.$patch({componentThemes:r.componentThemes}),r.$patch({modalities:r.modalities}),r.$patch({cities:r.cities}),r.$patch({economicSectors:r.economicSectors}),r.$patch({comercialActivities:r.comercialActivities}),r.fetchEconomicSectors(),r.fetchComercialActivities(),r.fetchComponents(),r.fetchModalities(),r.fetchCities();const A=m(!0),e=ue({cde_id:null,dni:null,economicsector_id:null,comercialactivity_id:null,component_id:null,theme_id:null,modality_id:null,ruc:null,city_id:null,province_id:null,district_id:null,observations:null,user_id:U.user_id}),G=d=>{d=="ruc"&&(e[d]=e[d].replace(/\D/g,""))},f=d=>{e.theme_id=null,r.fetchComponentThemes(d)},n=d=>{e.province_id=null,e.district_id=null,r.fetchProvinces(d)},F=d=>{e.district_id=null,r.fetchDistricts(d)},x=(d,C)=>{const p=d.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return C.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(p)},k=async()=>{if(a.value=!0,!b.info.id)return H.error("Error al registrar actualiza la página");const d={dni:e.dni,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,observations:e.observations,user_id:U.user_id,people_id:b.info.id,component_id:e.component_id,theme_id:e.theme_id,modality_id:e.modality_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,ruc:e.ruc,cde_id:b.idCde?b.idCde:null};try{const C=await K({url:"advisory/create",method:"POST",data:d});if(C.status===200){const p={razonSocial:null,ruc:e.ruc,createdFrom:"asesorias"};H.success(C.message),e.component_id=null,e.theme_id=null,e.modality_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.observations=null,e.ruc=null,e.economicsector_id=null,e.comercialactivity_id=null,P("closeDraw",!0)}}catch(C){console.log("Error: "+C)}finally{a.value=!1}},B=()=>{H.warning("Debes de completar todos los espacios requeridos")};function q(){const{documentnumber:d,city_id:C,province_id:p,district_id:v}=b.info,l=w.some(I=>I.id===7);e.dni=d,e.city_id=C,n(C),e.province_id=p,F(p),e.district_id=v,l&&(r.fetchComponentThemes(4),e.component_id=4,e.modality_id=1),e.district_id&&setTimeout(()=>{A.value=!1},1500)}return se(()=>{b.info&&q(b.info)}),me(()=>b.info,d=>{d&&q()}),(d,C)=>{const p=y("a-select"),v=y("a-form-item"),l=y("a-textarea"),I=y("a-input"),E=y("a-button"),V=y("a-form"),Y=y("a-spin");return u(),L("div",He,[i(Y,{spinning:A.value},{default:o(()=>[i(V,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:k,onFinishFailed:B},{default:o(()=>[h("div",Ve,[(u(!0),L(J,null,ge(N(Me),(s,X)=>(u(),L(J,{key:X},[s.type==="iSelect"?(u(),S(v,{key:0,class:"item-max",name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:o(()=>[s.name=="modality_id"?(u(),S(p,{key:0,disabled:s.disabled,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,options:N(r).modalities},null,8,["disabled","value","onUpdate:value","options"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0),s.type==="iTextarea"?(u(),S(v,{key:1,name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:o(()=>[i(l,{value:e[s.name],"onUpdate:value":D=>e[s.name]=D,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):_("",!0),s.type==="iText"?(u(),S(v,{key:2,name:s.name,label:s.label,rules:[{required:s.required,message:s.message,type:s.email,max:s.max}]},{default:o(()=>[i(I,{value:e[s.name],"onUpdate:value":D=>e[s.name]=D,maxlength:s.max,onInput:D=>G(s.name),placeholder:s.placeholder,disabled:s.name==="dni"&&!!e[s.name]},null,8,["value","onUpdate:value","maxlength","onInput","placeholder","disabled"])]),_:2},1032,["name","label","rules"])):_("",!0),s.type==="iSelectWrite"?(u(),S(v,{key:3,class:"item-max",name:s.name,label:s.label,rules:[{required:s.required,message:s.message}]},{default:o(()=>[s.name=="city_id"?(u(),S(p,{key:0,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,"show-search":"",options:N(r).cities,"filter-option":x,onChange:n},null,8,["value","onUpdate:value","options"])):_("",!0),s.name=="province_id"?(u(),S(p,{key:1,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,"show-search":"",options:N(r).provinces,"filter-option":x,onChange:F,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0),s.name=="district_id"?(u(),S(p,{key:2,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,"show-search":"",options:N(r).districts,"filter-option":x,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0),s.name=="economicsector_id"?(u(),S(p,{key:3,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,"show-search":"",options:N(r).economicSectors,"filter-option":x},null,8,["value","onUpdate:value","options"])):_("",!0),s.name=="comercialactivity_id"?(u(),S(p,{key:4,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,"show-search":"",options:N(r).comercialActivities,"filter-option":x},null,8,["value","onUpdate:value","options"])):_("",!0),s.name=="component_id"?(u(),S(p,{key:5,disabled:s.disabled,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,"show-search":"",options:N(r).components,"filter-option":x,onChange:f},null,8,["disabled","value","onUpdate:value","options"])):_("",!0),s.name=="theme_id"?(u(),S(p,{key:6,value:e[s.name],"onUpdate:value":D=>e[s.name]=D,"show-search":"",options:N(r).componentThemes,"filter-option":x,disabled:!e.component_id},null,8,["value","onUpdate:value","options","disabled"])):_("",!0)]),_:2},1032,["name","label","rules"])):_("",!0)],64))),128))]),i(v,null,{default:o(()=>[i(E,{type:"primary",class:"btn-produce","html-type":"submit",loading:a.value},{default:o(()=>C[0]||(C[0]=[M("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},je=de(Ye,[["__scopeId","data-v-7d34e3f3"]]);const Je={key:0},Ke={key:0},Qe={key:0},Xe={__name:"AsesoriasHistorial",props:["totaladvisories","totalformalization10","totalformalization20"],setup(R){const O=R,w=m("1"),b=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110,align:"center"},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Componente",dataIndex:"component",width:20},{title:"Tema",dataIndex:"theme",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:60},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],P=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Detalle del trámite",dataIndex:"detailprocedure",width:100},{title:"Modalidad",dataIndex:"modality",align:"center",width:100},{title:"RUC",dataIndex:"ruc",width:50},{title:"Ciudad",dataIndex:"city",width:40},{title:"Provincia",dataIndex:"province",width:40},{title:"Distrito",dataIndex:"district",width:40}],r=[{title:"#",dataIndex:"idx",width:30,align:"center"},{title:"Fecha registro",dataIndex:"date_start",width:110},{title:"Asesor",dataIndex:"asesor",width:140},{title:"Sector económico",dataIndex:"economicsector",width:100},{title:"Actividad comercial",dataIndex:"comercialactivity",width:100},{title:"Régimen",dataIndex:"regime",width:80,align:"center"},{title:"Número solicitud constancia",dataIndex:"numbernotary",width:100},{title:"Nombre empresa",dataIndex:"mypename",width:160},{title:"RUC",dataIndex:"ruc",width:80},{title:"Modalidad",dataIndex:"modality",align:"center",width:70},{title:"Ciudad",dataIndex:"city",width:30},{title:"Provincia",dataIndex:"province",width:20},{title:"Distrito",dataIndex:"district",width:20},{title:"Dirección",dataIndex:"address",width:200}],U=a=>Re(a).format("DD/MM/YYYY HH:mm A");return(a,A)=>{const e=y("a-table"),G=y("a-card"),f=y("a-tab-pane"),n=y("a-tabs");return u(),S(n,{activeKey:w.value,"onUpdate:activeKey":A[0]||(A[0]=F=>w.value=F),type:"card",class:"box-hist"},{default:o(()=>[i(f,{key:"1",tab:"ASESORÍAS"},{default:o(()=>[i(G,null,{default:o(()=>[i(e,{columns:b,"data-source":O.totaladvisories,bordered:"",pagination:!1,size:"small",scroll:{x:1200},"expand-column-width":100},{bodyCell:o(({index:F,column:x,record:k})=>[x.dataIndex==="idx"?(u(),L("span",Je,W(F+1),1)):_("",!0),x.dataIndex==="date_start"?(u(),L(J,{key:1},[M(W(U(k.createDate)),1)],64)):_("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),i(f,{key:"2",tab:"RUC 10"},{default:o(()=>[i(G,null,{default:o(()=>[i(e,{columns:P,"data-source":O.totalformalization10,bordered:"",pagination:!1,size:"small",scroll:{x:1800},"expand-column-width":100},{bodyCell:o(({index:F,column:x,record:k})=>[x.dataIndex==="idx"?(u(),L("span",Ke,W(F+1),1)):_("",!0),x.dataIndex==="date_start"?(u(),L(J,{key:1},[M(W(U(k.createDate)),1)],64)):_("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1}),i(f,{key:"3",tab:"RUC 20"},{default:o(()=>[i(G,null,{default:o(()=>[i(e,{columns:r,"data-source":O.totalformalization20,bordered:"",pagination:!1,size:"small",scroll:{x:2200},"expand-column-width":100},{bodyCell:o(({index:F,column:x,record:k})=>[x.dataIndex==="idx"?(u(),L("span",Qe,W(F+1),1)):_("",!0),x.dataIndex==="date_start"?(u(),L(J,{key:1},[M(W(U(k.createDate)),1)],64)):_("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1},8,["activeKey"])}}},Ze=de(Xe,[["__scopeId","data-v-01e75dfe"]]);const et={class:"asesorias"},tt={class:"wrapper-s"},at={key:0,class:"card-as",style:{padding:"1rem"}},it={__name:"AsesoriasFormalizaciones",setup(R){const O=JSON.parse(localStorage.getItem("role")),w=()=>O.some($=>$.id===7||$.id===13),b=ne(),P=Ae(),r=Ne(),U=m(0),a=m(null),A=m(null),e=m([{value:"asesoria",label:"ASESORÍA"},{value:"ruc20",label:"RUC 20"},{value:"ruc10",label:"RUC 10"}]);b.$patch({cdes:b.cdes}),b.fetchCdes();const G=m(null),f=m(!1),n=m(null);m(!1);const F=m(!1);m(!1);const x=m(!1),k=m(!1),B=m(!1),q=m(""),d=m([]),C=m(!1),p=m(0);m(!1);const v=m([]);m(null);const l=m([]),I=m([]),E=m([]),V=m(!1),Y=$=>{A.value.cde_id=$,localStorage.setItem("profile",JSON.stringify(A.value))},s=($,t)=>{const j=$.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(j)},X=()=>{_e(q.value),f.value=!1},D=()=>{ae()},c=()=>{q.value=q.value.replace(/\D/g,"")},ae=()=>{V.value=!1,q.value="",d.value=[],v.value=[],P.push({name:"asesorias-formalizaciones"})},T=()=>{if(n.value=null,n.value=d.value,!a.value)return H.warning("Seleccionar un tipo de servicio");a.value=="asesoria"&&(B.value=!0),a.value=="ruc10"&&(k.value=!0),a.value=="ruc20"&&Z()},Q=()=>{const $={id:d.value.id,typedocument_id:d.value.typedocument_id,document:d.value.documentnumber,lastname:d.value.lastname,middlename:d.value.middlename,name:d.value.name,country_id:d.value.country_id,city_id:d.value.city_id,province_id:d.value.province_id,district_id:d.value.district_id,address:d.value.address,birthday:d.value.birthday,phone:d.value.phone,email:d.value.email,gender_id:d.value.gender_id,sick:d.value.sick,hasSoon:d.value.hasSoon};G.value=$,f.value=!0},Z=()=>{p.value=0,x.value=!0,F.value=!1},ie=async()=>{C.value=!0;const $=await K({url:`person/found/${U.value}/${q.value}`,method:"GET"});if($.status==200)return d.value=$.data,ve(d.value.id),C.value=!1},_e=async $=>{if(C.value=!0,!$)return H.warning("Ingresa un número de documento"),C.value=!1;if(U.value==0)return H.warning("Seleccionar el tipo de documento"),C.value=!1;if(U.value==1&&q.value.length<8){H.warning("El número de DNI está incompleto"),C.value=!1;return}const t=await K({url:`person/found/${U.value}/${q.value}`,method:"GET"});if(t.status==200)return d.value=t.data,ve(t.data.id),A.value=JSON.parse(localStorage.getItem("profile")),C.value=!1;if(t.status===404){const j={type:U.value,access:"asesorias",number:q.value};P.push({name:"registrar-persona",query:j})}},ve=async $=>{try{const{data:t}=await K({url:`historial/registers/${$}`,method:"GET"});l.value=t.advisories,I.value=t.formalization10,E.value=t.formalization20,V.value=!0}catch(t){console.error("Error de red:",t)}};return se(()=>{r.query.type&&(U.value=r.query.type,q.value=r.query.number)}),($,t)=>{const j=y("a-radio"),ee=y("a-tooltip"),he=y("a-radio-group"),Se=y("a-input-search"),re=y("a-card"),z=y("a-col"),oe=y("a-row"),fe=y("a-select"),xe=y("a-button"),le=y("a-drawer");return u(),L(J,null,[h("div",et,[t[32]||(t[32]=h("h3",{class:"title-produce"},"REGISTRO DE FORMALIZACIONES Y ASESORÍAS",-1)),t[33]||(t[33]=h("br",null,null,-1)),i(re,{class:"card-as card-gray"},{default:o(()=>[N(r).query.dni?(u(),S(N(ke),{key:0,class:"ico-reload",onClick:D})):_("",!0),h("div",tt,[h("div",null,[t[19]||(t[19]=h("label",{class:"label"},"Seleccione el tipo de documento",-1)),i(he,{value:U.value,"onUpdate:value":t[0]||(t[0]=g=>U.value=g),onChange:ae,class:"radio-produce"},{default:o(()=>[i(ee,{color:"cyan"},{title:o(()=>t[11]||(t[11]=[M("Documento Nacional de Identidad")])),default:o(()=>[i(j,{value:"1"},{default:o(()=>t[12]||(t[12]=[M("DNI")])),_:1})]),_:1}),i(ee,{color:"cyan"},{title:o(()=>t[13]||(t[13]=[M("Carnet de Extranjería")])),default:o(()=>[i(j,{value:"2"},{default:o(()=>t[14]||(t[14]=[M("CE")])),_:1})]),_:1}),i(ee,{color:"cyan"},{title:o(()=>t[15]||(t[15]=[M("Pasaporte")])),default:o(()=>[i(j,{value:"3"},{default:o(()=>t[16]||(t[16]=[M("PAS")])),_:1})]),_:1}),i(ee,{color:"cyan"},{title:o(()=>t[17]||(t[17]=[M("Permiso Temporal de Permanencia")])),default:o(()=>[i(j,{value:"4"},{default:o(()=>t[18]||(t[18]=[M("PTP")])),_:1})]),_:1})]),_:1},8,["value"])]),h("div",null,[t[20]||(t[20]=h("label",{class:"label"},"Digite el número de documento",-1)),i(Se,{"enter-button":"BUSCAR",value:q.value,"onUpdate:value":t[1]||(t[1]=g=>q.value=g),placeholder:"",loading:C.value,onSearch:_e,onInput:c,class:"search-produce",maxlength:U.value==1?8:20},null,8,["value","loading","maxlength"])])])]),_:1}),i(oe,{gutter:[16,16]},{default:o(()=>[i(z,{xs:24,sm:24,lg:12},{default:o(()=>[d.value.length!=0?(u(),S(re,{key:0},{default:o(()=>[t[27]||(t[27]=h("h4",{class:"title-produce"},"RESULTADO DE LA BÚSQUEDA",-1)),i(N(Oe),{class:"box-icoedit",onClick:Q}),i(oe,{gutter:[0,2],class:"box-info"},{default:o(()=>[i(z,{xs:12,sm:8},{default:o(()=>t[21]||(t[21]=[h("b",{class:"box-title"},"Apellidos y nombres:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>[h("span",null,W(d.value.lastname)+" "+W(d.value.middlename)+", "+W(d.value.name),1)]),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[22]||(t[22]=[h("b",{class:"box-title"},"Número de celular:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>[h("span",null,W(d.value.phone?d.value.phone:"-"),1)]),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[23]||(t[23]=[h("b",{class:"box-title"},"Correo electrónico:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>[h("span",null,W(d.value.email?d.value.email:"-"),1)]),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[24]||(t[24]=[h("b",{class:"box-title"},"Asesorías:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>{var g;return[h("span",null,W((g=d.value)==null?void 0:g.idadvisory.length),1)]}),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[25]||(t[25]=[h("b",{class:"box-title"},"Formalizaciones RUC 20:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>{var g;return[h("span",null,W((g=d.value)==null?void 0:g.idformalization20.length),1)]}),_:1}),i(z,{xs:12,sm:8},{default:o(()=>t[26]||(t[26]=[h("b",{class:"box-title"},"Formalizaciones RUC 10:",-1)])),_:1}),i(z,{xs:12,sm:12},{default:o(()=>{var g;return[h("span",null,W((g=d.value)==null?void 0:g.idformalization10.length),1)]}),_:1})]),_:1})]),_:1})):_("",!0)]),_:1}),i(z,{xs:24,sm:24,lg:12},{default:o(()=>[d.value.length!=0?(u(),S(re,{key:0,style:{height:"100%"}},{default:o(()=>[i(oe,{gutter:[16,24]},{default:o(()=>[w()?_("",!0):(u(),S(z,{key:0,xs:24,sm:18,md:12,lg:12},{default:o(()=>[t[28]||(t[28]=h("h4",{class:"title-produce"},"SELECCIONAR CDE",-1)),i(fe,{class:"w-100",value:A.value.cde_id,"onUpdate:value":t[2]||(t[2]=g=>A.value.cde_id=g),options:N(b).cdes,"show-search":"","filter-option":s,onChange:Y},null,8,["value","options"])]),_:1})),i(z,{xs:24,sm:18,md:12,lg:17},{default:o(()=>[t[30]||(t[30]=h("h4",{class:"title-produce"},"¿DESEA REGISTRAR UN NUEVO SERVICIO?",-1)),i(oe,{gutter:[10,0]},{default:o(()=>[i(z,{xs:17,sm:18},{default:o(()=>[i(fe,{class:"w-100",value:a.value,"onUpdate:value":t[3]||(t[3]=g=>a.value=g),options:e.value},null,8,["value","options"])]),_:1}),i(z,{xs:6},{default:o(()=>[i(xe,{type:"primary",onClick:T},{default:o(()=>t[29]||(t[29]=[M("REGISTRAR")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1}),V.value?(u(),L("div",at,[t[31]||(t[31]=h("h4",{class:"title-produce"},"HISTORIAL",-1)),i(Ze,{totaladvisories:l.value,totalformalization10:I.value,totalformalization20:E.value},null,8,["totaladvisories","totalformalization10","totalformalization20"])])):_("",!0)]),h("section",null,[i(le,{title:"Regitsrar una Formalización con RUC 20",open:x.value,"onUpdate:open":t[5]||(t[5]=g=>x.value=g),placement:"right",width:"500px"},{default:o(()=>[i(Fe,{info:n.value,idCde:A.value.cde_id,onCloseDraw:t[4]||(t[4]=g=>(x.value=!1,ie()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(le,{width:"600px",title:"Regitsrar Formalización con RUC 10",open:k.value,"onUpdate:open":t[7]||(t[7]=g=>k.value=g),placement:"right"},{default:o(()=>[i(We,{info:d.value,idCde:A.value.cde_id,onCloseDraw:t[6]||(t[6]=g=>(k.value=!1,ie()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(le,{width:"600px",title:"Registrar una asesoría",open:B.value,"onUpdate:open":t[9]||(t[9]=g=>B.value=g),placement:"right"},{default:o(()=>[i(je,{info:d.value,idCde:A.value.cde_id,onCloseDraw:t[8]||(t[8]=g=>(B.value=!1,ie()))},null,8,["info","idCde"])]),_:1},8,["open"]),i(le,{width:"600",open:f.value,"onUpdate:open":t[10]||(t[10]=g=>f.value=g),class:"draw-notary","root-class-name":"root-class-name",title:"DATOS DEL SOLICITANTE",placement:"right"},{default:o(()=>[i(Ue,{onCloseDraw:X,info:G.value},null,8,["info"])]),_:1},8,["open"])])],64)}}},mt=de(it,[["__scopeId","data-v-e46a76e5"]]);export{mt as default};
