import{_ as M}from"./FormComponent-c3fd012c.js";import{u as R}from"./selectes-57543df9.js";import{U as P}from"./UpImage-8a75c3f5.js";import{p as o,r as c,a as w,k as q,U as H,X as f,o as u,y as k,i as x,L as V,d as E,c as v,w as U,z as B,m as F,h as j}from"./index-3a4aebaa.js";import"./es-8c8baa19.js";const G={key:1,class:"mp"},Z={key:0},Q={__name:"DrawMP",props:["info"],emits:["closeDraw"],setup(S,{emit:g}){o.locale("es");const s=c({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1,max:255},component:{type:"iSelect",label:"TIPO DE COMPONENTE",name:"component",required:!0,message:"Seleccionar tipo de Componente",disabled:!1},capacitador_id:{type:"iSelect",label:"CAPACITADOR",name:"capacitador_id",required:!0,message:"Seleccionar capacitador",disabled:!1},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN AL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},date:{type:"iDate",label:"FECHA DEL EVENTO",name:"date",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: Lunes: 12 de mayo"},training_time:{type:"iNumber",label:"TIEMPO DE LA CAPACITACIÓN - HORAS",name:"training_time",required:!0,message:"Escribir tiempo de la capacitación",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm",min:1},time:{type:"iText",label:"HORARIO DEL EVENTO",name:"hours",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm",max:100},modality_id:{type:"iSelect",label:"MODALIDAD DEL EVENTO",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1}});JSON.parse(localStorage.getItem("profile"));const b=g,l=S,n=c(!0),D=c("GUARDAR"),e=w({}),m=c(!1),h=c(null),t=R(),I=c(null),r=c({city_id:[],fairtype_id:[],modality_id:[],capacitador_id:[]}),C=()=>l.info?{name:l.info.image.name,url:l.info.image.url}:null,N=a=>{a=="modality_id"&&console.log("a9a9a9a99a9a9")},O=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),s.value.dateTramite.disabled=!1)},T=async a=>{h.value=a.id},Y=async a=>{a=="city_id"&&(e.city_id=null),a=="capacitador_id"&&(r.value.capacitadores=t.capacitadores)},A=async(a,i)=>{if(a=="modality_id"){if(i==1)s.value={...s.value,city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA DEL EVENTO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO DEL EVENTO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},place:{type:"iText",label:"LUGAR DEL EVENTO",name:"place",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: PRODUCE 2",max:255}};else if(i==2){const d={...s.value};delete d.city_id,delete d.province_id,delete d.district_id,delete d.place,s.value=d}}a=="city_id"&&(await t.fetchProvinces(e.city_id),r.value.province_id=t.provinces,s.value.province_id.disabled=!1,e.province_id=null,e.district_id=null),a=="province_id"&&(await t.fetchDistricts(e.province_id),r.value.district_id=t.districts,s.value.district_id.disabled=!1,e.district_id=null)},L=async()=>{m.value=!0;try{const a={title:e.title,component:e.component,capacitador_id:e.capacitador_id,startDate:o(e.dates.start).format("YYYY-MM-DD"),endDate:o(e.dates.end).format("YYYY-MM-DD"),training_time:e.training_time,date:o(e.date).format("YYYY-MM-DD"),hours:e.hours,modality_id:e.modality_id,...e.modality_id==1?{city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,place:e.place}:{}},i=l.info?`mp/update-event/${l.info.id}`:"mp/store-event",d=l.info?"PUT":"POST",y=await F({url:i,method:d,data:a});y.status===200&&(j.success(y.message),p(),b("closeDraw",!0))}catch(a){console.error("Error:",a);const i=document.getElementsByClassName("ant-drawer-body")[0];i&&(i.scrollTop=0)}finally{m.value=!1}},p=()=>{e.title=null,e.component=null,e.capacitador_id=null,e.dates=null,e.date=null,e.hours=null,e.modality_id=null,e.training_time=null,e.city_id=null,e.province_id=null,e.district_id=null,e.place=null},_=async a=>{n.value=!0;try{a&&(e.title=a.title,e.component=a.component,e.capacitador_id=a.capacitador_id,e.dates={start:o(a.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:o(a.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.training_time=a.training_time,a.modality_id==1&&(e.city_id=a.city_id,e.province_id=a.province_id,e.district_id=a.district_id,e.place=a.place),e.date=a.date?o(a.date,"YYYY-MM-DD"):null,e.hours=a.hours,e.modality_id=a.modality_id)}catch(i){console.error("Error al cargar la información:",i)}finally{n.value=!1}};return q(async()=>{l.info?_(l.info):n.value=!1,await t.fetchCapacitadores(),r.value.capacitador_id=t.capacitadores,await t.fetchCities(),r.value.city_id=t.cities,await t.fetchModalities(),r.value.modality_id=t.modalities,r.value.component=[{label:"GESTIÓN EMPRESARIAL",value:1},{label:"HABILIDADES PERSONALES",value:2}]}),H(()=>l.info,a=>{a?_(a):p()}),f("formState",e),f("loadingState",m),(a,i)=>n.value?(u(),k(x(V),{key:0,style:{color:"#00a6db"}})):(u(),E("div",G,[v(M,{fields:s.value,options:r.value,btnSaveName:D.value,onHandleInputEvent:N,resetSelect:I.value,onHandleFocusSelect:Y,onHandleChangeSelect:A,onHandleChangeClock:O,onOnSubmit:L},{default:U(({field:d})=>[d.name=="iSlotOptions"?(u(),E("div",Z,[v(P,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:T,imageLoad:C()},null,8,["imageLoad"])])):B("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};export{Q as _};
