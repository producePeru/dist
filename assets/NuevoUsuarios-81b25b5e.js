import{D as A,r as g,G as ae,a as ne,b as _,o as l,d as y,c as i,e as T,w as c,F as h,I as Y,a1 as te,H as N,m as L,y as le,s as u,h as m,v as d,P as oe,i as $,E as se,p as re,j as ue,a3 as de}from"./index-5fd26e4c.js";import{f as ie}from"./nuevoUsuario-39eedf3b.js";import{u as ce}from"./selectes-b1dc16fb.js";import"./es-1738796d.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";const pe=x=>(re("data-v-cb6d7783"),x=x(),ue(),x),ve=pe(()=>T("h3",{class:"title-produce"},"REGISTRO DE USUARIO",-1)),_e={class:"user"},fe={class:"grid-item"},ge="DD/MM/YYYY",be={__name:"NuevoUsuarios",setup(x){A.locale("es");const M=de({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),P=JSON.parse(localStorage.getItem("profile")),C=JSON.parse(localStorage.getItem("role")),t=ce();t.$patch({genders:t.genders}),t.$patch({cdes:t.cdes}),t.$patch({Offices:t.Offices}),t.$patch({roles:t.roles}),t.$patch({supervisores:t.supervisores}),t.fetchGenders(),t.fetchCdes(),t.fetchOffices(),t.fetchRoles();const s=g(ie),U=g(null);ae();const q=g(!1),z=g(!1),B=g(!1),I=g(!1),k=g(null),E=[{label:"Supervisor",value:1},{label:"Asesor",value:2},{label:"Notario",value:7}],G=[{label:"Drive Administrador",value:3},{label:"Drive Usuario",value:4}],a=ne({name:null,lastname:null,middlename:null,documentnumber:null,birthday:null,sick:2,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:P.user_id,email:null,password:null}),j=()=>{a.name=null,a.lastname=null,a.middlename=null,a.documentnumber=null,U.value=null,a.phone=null,a.gender_id=null,a.cde_id=null,a.office_id=null,a.email=null,a.password=null,a.role_id=null},V=o=>{a[o]=a[o].replace(/\D/g,"")},H=async()=>{try{I.value=!0;const o={name:k.value};(await Y({url:"create/office",method:"POST",data:o})).status==200&&(k.value=null,t.fetchOffices())}catch(o){console.log(o)}finally{I.value=!1}},J=(o,r)=>{const f=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(f)},O=o=>{const r={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0},f={type:"iText",label:"Ciudad de la notaría",name:"city",required:!0,message:"Ciudad de la notaría",disabled:!1},p={type:"iText",label:"Provincia de la de la notaría",name:"province",required:!0,message:"Provincia de la de la notaría",disabled:!1},b={type:"iText",label:"Distrito de la notaría",name:"district",required:!0,message:"Distrito de la notaría",disabled:!1},S={type:"iText",label:"Dirección de la notaría",name:"address",required:!1,message:"Dirección de la notaría",disabled:!1};if(o===2){t.fetchSupervisores(),s.value={...s.value,supervisor_id:r};const{city:D,province:v,district:R,address:F,...w}=s.value;s.value=w}else if(o===7){s.value={...s.value,city:f,province:p,district:b,address:S};const{supervisor_id:D,...v}=s.value;s.value=v,s.value.cde_id.required=!1}else{let{city:D,province:v,district:R,address:F,supervisor_id:w,...e}=s.value;s.value=e}},K=async()=>{q.value=!0,a.email=a.name.replace(/\s/g,"").toLowerCase()+a.lastname.replace(/\s/g,"").toLowerCase()+"@pnte.com",a.password=a.documentnumber,a.birthday=U.value?A(U.value).format("YYYY-MM-DD"):null;try{const o=await Y({url:"user/create",method:"POST",data:a});te.success({title:"La cuenta ha sido registrada",content:N("div",{},[N("br"),N("p",`Correo: ${a.email}`),N("p","Contraseña es el número de DNI ingresado")]),onOk(){j(),L.success(o.message);const{supervisor_id:r,...f}=s.value;s.value=f}})}catch{L.error("No se pudo registrar este usuario")}finally{q.value=!1}},Q=()=>{L.error("Debes de completar todos los espacios requeridos")},W=async o=>{console.log("Hello",o)},X=()=>{a.document_number=a.document_number.replace(/\D/g,"")};return(o,r)=>{const f=_("a-divider"),p=_("a-select"),b=_("a-input"),S=_("a-button"),D=_("a-space"),v=_("a-form-item"),R=_("a-input-search"),F=_("a-date-picker"),w=_("a-form");return l(),y(h,null,[ve,i(f),T("div",_e,[i(w,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:K,onFinishFailed:Q},{default:c(()=>[T("div",fe,[(l(!0),y(h,null,le(s.value,(e,Z)=>(l(),y(h,{key:Z},[e.type==="iSelect"?(l(),u(v,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[e.name=="gender_id"?(l(),u(p,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:m(t).genders},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="cde_id"?(l(),u(p,{key:1,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:m(t).cdes},null,8,["value","onUpdate:value","options"])):d("",!0),m(C)[0].id==1?(l(),y(h,{key:2},[e.name=="role_id"?(l(),u(p,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:E,onChange:O},null,8,["value","onUpdate:value"])):d("",!0)],64)):d("",!0),m(C)[0].id==3?(l(),y(h,{key:3},[e.name=="role_id"?(l(),u(p,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:G,onChange:O},null,8,["value","onUpdate:value"])):d("",!0)],64)):d("",!0),m(C)[0].id==5?(l(),y(h,{key:4},[e.name=="role_id"?(l(),u(p,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:m(t).roles,onChange:O},null,8,["value","onUpdate:value","options"])):d("",!0)],64)):d("",!0),e.name=="supervisor_id"?(l(),u(p,{key:5,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:m(t).supervisores},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="office_id"?(l(),u(p,{key:6,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,"show-search":"",options:m(t).Offices,"filter-option":J},{dropdownRender:c(({menuNode:n})=>[i(m(M),{vnodes:n},null,8,["vnodes"]),i(f,{style:{margin:"4px 0"}}),i(D,{style:{padding:"4px 8px"}},{default:c(()=>[i(b,{ref_for:!0,ref:"inputRef",value:k.value,"onUpdate:value":r[0]||(r[0]=ee=>k.value=ee),placeholder:"Nueva actividad"},null,8,["value"]),i(S,{type:"text",onClick:H,loading:I.value},{icon:c(()=>[i(m(oe))]),default:c(()=>[$(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):d("",!0)]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iSearch"?(l(),u(v,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:c(()=>[i(R,{maxlength:15,loading:z.value,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,onSearch:W,onInput:X,disabled:B.value},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iText"?(l(),u(v,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:c(()=>[e.name=="documentnumber"?(l(),u(b,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,onInput:r[1]||(r[1]=n=>V("documentnumber"))},null,8,["value","onUpdate:value","maxlength"])):e.name=="phone"?(l(),u(b,{key:1,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,onInput:r[2]||(r[2]=n=>V("phone"))},null,8,["value","onUpdate:value","maxlength"])):(l(),u(b,{key:2,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"]))]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iDate"?(l(),u(v,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[i(F,{locale:m(se),value:U.value,"onUpdate:value":r[3]||(r[3]=n=>U.value=n),style:{width:"100%"},format:ge},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):d("",!0)],64))),128))]),i(v,null,{default:c(()=>[i(S,{class:"btn-produce",type:"primary","html-type":"submit",loading:q.value},{default:c(()=>[$("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])],64)}}},Se=me(be,[["__scopeId","data-v-cb6d7783"]]);export{Se as default};
