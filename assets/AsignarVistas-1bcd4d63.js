import{_ as B}from"./FormComponent-664846ca.js";import{p as A,r,a as T,W as m,o as c,d as O,e as N,t as b,c as R,m as I,h as k,k as D,T as P,b as z,w as L,y as d,z as i}from"./index-8b7de5e5.js";import"./es-ba278c5d.js";import{_ as V}from"./TableComponent-b5cbeca6.js";const G={class:"password-pnte"},M={style:{color:"#00a6db"}},j={__name:"CambiarContrasena",props:["info"],emits:["closeDraw"],setup(g,{emit:E}){A.locale("es");const h=E,v=g,w=r({password:{type:"iText",label:"CONTRASEÑA",name:"password",required:!0,message:"Ingrese la nueva contraseña",disabled:!1}}),y=r("CAMBIAR"),u=T({}),_=r(!1),S=r(null),C=async()=>{_.value=!0;const x={id:v.info.id,password:u.password};try{const t=await I({url:"user/change-password",method:"POST",data:x});t.status===200&&(k.success(t.message),U(),h("closeDraw",!0))}catch(t){t.response&&t.response.data&&t.response.data.message?k.error(t.response.data.message):k.error("Ocurrió un error inesperado.");const l=document.getElementsByClassName("ant-drawer-body")[0];l&&(l.scrollTop=0)}finally{_.value=!1}},U=()=>{u.password=null};return m("formState",u),m("loadingState",_),(x,t)=>{var l,n,p;return c(),O("div",G,[N("h4",M,b((l=g.info)==null?void 0:l.name)+" "+b((n=g.info)==null?void 0:n.lastname)+" "+b((p=g.info)==null?void 0:p.middlename),1),t[0]||(t[0]=N("br",null,null,-1)),R(B,{fields:w.value,btnSaveName:y.value,resetSelect:S.value,onOnSubmit:C},null,8,["fields","btnSaveName","resetSelect"])])}}},$={class:"advisory-table"},W={__name:"AsignarVistas",props:["info","typeOffice"],emits:["closeDraw"],setup(g,{emit:E}){const h=g,v=r([]),w=r(0),y=r(150),u=r(!1),_=r(!1),S=r([]),C=T({year:A("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),U=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:10},{title:"NOMBRE PÁGINA",dataIndex:"name",fixed:"left",width:50},{title:"VER",dataIndex:"asignar",width:20,align:"center"},{title:"NUEVO",dataIndex:"crear",width:20,align:"center"},{title:"EDITAR",dataIndex:"actualizar",width:20,align:"center"},{title:"ELIMINAR",dataIndex:"eliminar",width:20,align:"center"},{title:"HABILITAR BOTÓN DE DESCARGA - EXCEL",dataIndex:"reporteexcel",width:30,align:"center"}],x=async n=>{C.page=n,await l()},t=async(n,p,o)=>{const s={user_id:h.info.id,page_id:o.id,type:n,value:p.target.checked};try{const a=await I({url:"page/user-assign-view",method:"PUT",data:s});console.log(":)",a.message)}catch(a){a.response&&a.response.data&&a.response.data.message?k.error(a.response.data.message):k.error("Ocurrió un error inesperado.");const e=document.getElementsByClassName("ant-drawer-body")[0];e&&(e.scrollTop=0)}},l=async()=>{try{u.value=!0;let n=null;h.typeOffice=="UGO"&&(n="page/list-ugo"),h.typeOffice=="ALL"&&(n="page/list-all");const[p,o]=await Promise.all([I({url:n,method:"GET"}),I({url:`page/views-to-user/${h.info.id}`,method:"GET"})]),s=p.data.data,a=o.data,e={};a.forEach(f=>{e[f.slug]=f.pivot}),v.value=s.map(f=>({...f,pivot:e[f.slug]||{can_create:!1,can_update:!1,can_delete:!1,can_download:!1,can_finish:!1,can_import:!1}})),w.value=p.data.total,y.value=p.data.per_page}catch(n){console.error("Error al obtener datos:",n)}finally{u.value=!1}};return D(async()=>{h.info&&l()}),P(()=>h.info,n=>{n?l():S.value=[]}),m("search",C),m("loading",u),m("loadingFile",_),(n,p)=>{const o=z("a-checkbox");return c(),O("div",$,[R(V,{nameTotal:"Páginas disponibles",columns:U,pageSize:y.value,dataSource:v.value,total:w.value,onHandleCallFetchData:l,onHandlePaginator:x,cityList:!1},{"data-cell":L(({column:s,record:a})=>[s.dataIndex=="asignar"?(c(),d(o,{key:0,checked:a.pivot.can_view_all,"onUpdate:checked":e=>a.pivot.can_view_all=e,onChange:e=>t("can_view_all",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="crear"?(c(),d(o,{key:1,checked:a.pivot.can_create,"onUpdate:checked":e=>a.pivot.can_create=e,onChange:e=>t("can_create",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="actualizar"?(c(),d(o,{key:2,checked:a.pivot.can_update,"onUpdate:checked":e=>a.pivot.can_update=e,onChange:e=>t("can_update",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="eliminar"?(c(),d(o,{key:3,checked:a.pivot.can_delete,"onUpdate:checked":e=>a.pivot.can_delete=e,onChange:e=>t("can_delete",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="descargar"?(c(),d(o,{key:4,checked:a.pivot.can_download,"onUpdate:checked":e=>a.pivot.can_download=e,onChange:e=>t("can_download",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="finalizar"?(c(),d(o,{key:5,checked:a.pivot.can_finish,"onUpdate:checked":e=>a.pivot.can_finish=e,onChange:e=>t("can_finish",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="importar"?(c(),d(o,{key:6,checked:a.pivot.can_import,"onUpdate:checked":e=>a.pivot.can_import=e,onChange:e=>t("can_import",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="todo"?(c(),d(o,{key:7,checked:a.pivot.download_everything,"onUpdate:checked":e=>a.pivot.download_everything=e,onChange:e=>t("can_download_everything",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="rango"?(c(),d(o,{key:8,checked:a.pivot.can_date_range,"onUpdate:checked":e=>a.pivot.can_date_range=e,onChange:e=>t("can_date_range",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0),s.dataIndex=="reporteexcel"?(c(),d(o,{key:9,checked:a.pivot.can_download_reporte,"onUpdate:checked":e=>a.pivot.can_download_reporte=e,onChange:e=>t("can_download_reporte",e,a)},null,8,["checked","onUpdate:checked","onChange"])):i("",!0)]),_:1},8,["pageSize","dataSource","total"])])}}};export{j as _,W as a};
