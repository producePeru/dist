import{_ as j}from"./TableComponent-a0a95197.js";import{p as g,r as s,a as Y,k as B,U as X,X as E,o as d,d as I,c as r,m as V,h as q,b as S,w as n,e as y,t as R,i as J,z as b,F as U,x as K,y as O,j as f}from"./index-dde6e8ba.js";import{_ as Q}from"./FormComponent-f6341e79.js";import{u as W}from"./selectes-0a881b7c.js";import"./es-bec1faaf.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-d9a55dba.js";import"./quill.snow-cbc5f33d.js";const Z={class:"register-training"},ee={__name:"RegistroCapacitaciones",props:["info"],emits:["closeDraw"],setup(P,{emit:_}){g.locale("es");const x=_,c=P,w=s("REGISTRAR"),e=Y({office_id:1}),h=s(!1),u=W(),C=s(null),i=s({meta_id:[],especialista_id:[],dimension_id:[]}),k=a=>{console.log("handleInputEvent",a)},M=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),p.value.dateTramite.disabled=!1)},A=async a=>{console.log("handleChangeSelect",a)},H=async a=>{a=="meta_id"&&(i.value.meta_id=u.trainingMetas),a=="especialista_id"&&(i.value.especialista_id=u.trainingSpecialist),a=="dimension_id"&&(i.value.dimension_id=u.trainingDimensions),a=="modalidad"&&(i.value.modalidad=[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}])},F=async()=>{h.value=!0;const a={meta_id:e.meta_id,especialista_id:e.especialista_id,fecha:g(e.fecha).format("YYYY-MM-DD"),horaInicio:g(e.horaInicio).format("HH:mm"),horaFin:g(e.horaFin).format("HH:mm"),dimension_id:e.dimension_id,modalidad:e.modalidad,tema:e.tema,lugar:e.lugar,participantes:e.participantes,empresas:e.empresas,coordinador:e.coordinador,observaciones:e.observaciones,estado:1};try{let t,m=null;c.info?(t=`training/update-specialist/${c.info.id}`,m="PUT"):(t="training/register-training",m="POST");const v=await V({url:t,method:m,data:a});v.status===200&&(q.success(v.message),T(),x("closeDraw",!0))}catch(t){t.response&&t.response.data&&t.response.data.message?q.error(t.response.data.message):q.error("Ocurrió un error inesperado.");const m=document.getElementsByClassName("ant-drawer-body")[0];m&&(m.scrollTop=0)}finally{h.value=!1}},T=()=>{e.meta_id=null,e.especialista_id=null,e.fecha=null,e.horaInicio=null,e.horaFin=null,e.dimension_id=null,e.modalidad=null,e.tema=null,e.lugar=null,e.participantes=null,e.empresas=null,e.coordinador=null,e.observaciones=null},N=async a=>{a&&(e.name=a.name,e.ocupation=a.ocupation)},p=s({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDate",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÓN",name:"dimension_id",required:!0,message:"Seleccionar dimensión",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return B(()=>{c.info&&N(c.info),u.fetchTrainingMetas(),u.fetchTrainingSpecialist(),u.fetchTrainingDimensions()}),X(()=>c.info,a=>{a?N(a):T()}),E("formState",e),E("loadingState",h),(a,t)=>(d(),I("div",Z,[r(Q,{fields:p.value,options:i.value,btnSaveName:w.value,onHandleInputEvent:k,resetSelect:C.value,onHandleChangeSelect:A,onHandleFocusSelect:H,onHandleChangeClock:M,onOnSubmit:F,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const ae={class:"layout-content"},te={key:0,style:{display:"flex","flex-direction":"column"}},ie=["onClick"],me={__name:"capacitaciones-registro",setup(P){const _=s(!1),x=s([]),c=s(0),w=s(100),e=s(!1),h=s(!1),u=s(!1),C=s(null),i=Y({asesor:null,month:g(),page:1}),k=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"Fecha/Hora",fixed:"left",dataIndex:"horario",align:"center",width:120},{title:"Especialista",dataIndex:"especialista",width:160},{title:"Tema",dataIndex:"tema",width:170},{title:"Modalidad",dataIndex:"modalidadText",width:120,align:"center"},{title:"Participantes",dataIndex:"participantes",align:"center",width:140},{title:"Estado",dataIndex:"estado",align:"center",width:140},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],M=()=>{_.value=!0},A=async()=>{_.value=!1,await p()},H=async()=>{h.value=!0},F=async a=>{i.page=a,await p()},T=async a=>{a&&(i.page=1,await p())},N=a=>{C.value=a,u.value=!0},p=async()=>{e.value=!0;try{const a={page:i.page};i.year&&(a.year=g(i.year).format("YYYY")),i.asesor&&(a.asesor=i.asesor),i.name&&(a.name=i.name);const t=await V({url:"training/list-trainings",method:"GET"});t.status==200&&(x.value=t.data.data,c.value=t.data.total,w.value=t.data.per_page)}catch(a){console.error("Error de red:",a)}finally{e.value=!1}};return B(async()=>{await p()}),E("search",i),E("loading",e),E("loadingFile",h),(a,t)=>{const m=S("a-date-picker"),v=S("a-tag"),D=S("a-select-option"),$=S("a-select"),L=S("a-menu-item"),z=S("a-drawer");return d(),I("div",ae,[r(j,{title:"SEGUIMIENTO",new:!0,textNuevo:"NUEVO",columns:k,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:w.value,nameTotal:"Capacitaciones",dataSource:x.value,total:c.value,onHandleNew:M,onHandleDownloadExcel:H,onHandleSearch:T,onHandlePaginator:F},{header:n(()=>[y("div",null,[r(m,{value:i.month,"onUpdate:value":t[0]||(t[0]=o=>i.month=o),picker:"month"},null,8,["value"])])]),"data-cell":n(({column:o,record:l})=>[o.dataIndex=="horario"?(d(),I("div",te,[y("b",null,R(J(g)(l.fecha).format("DD/MM/YYYY")),1),y("span",null,R(l.horaInicio)+" - "+R(l.horaFin),1)])):b("",!0),o.dataIndex=="especialista"?(d(),I(U,{key:1},[y("span",{class:"dot-specialist",style:K(`background-color: ${l.colorEspecialista};`)},null,4),y("span",null,R(l.especialista),1)],64)):b("",!0),o.dataIndex=="modalidadText"?(d(),I(U,{key:2},[l.modalidad==1?(d(),O(v,{key:0,color:"blue"},{default:n(()=>t[2]||(t[2]=[f(" Presencial ")])),_:1})):l.modalidad==2?(d(),O(v,{key:1,color:"green"},{default:n(()=>t[3]||(t[3]=[f(" Virtual ")])),_:1})):l.modalidad==3?(d(),O(v,{key:2,color:"orange"},{default:n(()=>t[4]||(t[4]=[f(" Mixto ")])),_:1})):b("",!0)],64)):b("",!0),o.dataIndex=="estado"?(d(),O($,{key:3,value:l.estado,"onUpdate:value":G=>l.estado=G,style:{width:"150px"},placeholder:"Seleccione estado"},{default:n(()=>[r(D,{value:1},{default:n(()=>t[5]||(t[5]=[f("Programada")])),_:1}),r(D,{value:2},{default:n(()=>t[6]||(t[6]=[f("En curso")])),_:1}),r(D,{value:3},{default:n(()=>t[7]||(t[7]=[f("Completado")])),_:1}),r(D,{value:4},{default:n(()=>t[8]||(t[8]=[f("Cancelado")])),_:1})]),_:2},1032,["value","onUpdate:value"])):b("",!0)]),"custom-options":n(({record:o})=>[r(L,null,{default:n(()=>[y("a",{onClick:l=>N(o)},"Editar",8,ie)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),r(z,{width:"500",title:"Registro de Capacitaciones",open:_.value,"onUpdate:open":t[1]||(t[1]=o=>_.value=o),placement:"right"},{default:n(()=>[r(ee,{updateInfoBusinessman:C.value,onCloseDraw:A},null,8,["updateInfoBusinessman"])]),_:1},8,["open"])])}}};export{me as default};
