import{_ as W}from"./TableComponent-91664cc1.js";import{p as u,r as s,a as B,k as $,X as w,o as _,y as A,i as V,L as X,d as M,c as m,m as P,h as N,U as Z,b as x,w as c,e as D,t as Y,z as q,F as z,x as ee,j as C}from"./index-dac8a4c4.js";import{_ as j}from"./FormComponent-d69e8d88.js";import{u as J}from"./selectes-365ec481.js";import"./es-fa122243.js";import"./icoexcel-1b303edf.js";import"./SyncOutlined-102dcbde.js";import"./MoreOutlined-c980a48d.js";import"./quill.snow-a97463ac.js";const ae={key:1,class:"register-training"},ie={__name:"RegistroCapacitaciones",emits:["closeDraw"],setup(U,{emit:S}){u.locale("es");const y=S,v=s(!0),E=s("REGISTRAR"),t=B({}),e=s(!1),r=J(),d=s(null),n=s({meta_id:[],especialista_id:[],dimension_id:[],modalidad:[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}]}),p=o=>{console.log("handleInputEvent",o)},R=async o=>{o=="dateReception"&&(t.dateTramite&&(t.dateTramite=null),b.value.dateTramite.disabled=!1)},T=async(o,l)=>{if(o==="meta_id"){b.value.fecha.allowedMonth=null,t.fecha=null;let a=n.value.meta_id.find(i=>i.value==l);console.log("meta",a),b.value.fecha.allowedMonth=a.label}},O=async o=>{o=="meta_id"&&(n.value.meta_id=r.trainingMetas),o=="especialista_id"&&(n.value.especialista_id=r.trainingSpecialist),o=="dimension_id"&&(n.value.dimension_id=r.trainingDimensions)},H=async()=>{e.value=!0;const o={meta_id:t.meta_id,especialista_id:t.especialista_id,fecha:u(t.fecha).format("YYYY-MM-DD"),horaInicio:u(t.horaInicio).format("HH:mm"),horaFin:u(t.horaFin).format("HH:mm"),dimension_id:t.dimension_id,modalidad:t.modalidad,tema:t.tema,lugar:t.lugar,participantes:t.participantes,empresas:t.empresas,coordinador:t.coordinador,observaciones:t.observaciones,estado:1};try{const l=await P({url:"training/register-training",method:"POST",data:o});l.status===200&&(N.success(l.message),F(),y("closeDraw",!0))}catch(l){l.response&&l.response.data&&l.response.data.message?N.error(l.response.data.message):N.error("Ocurrió un error inesperado.");const a=document.getElementsByClassName("ant-drawer-body")[0];a&&(a.scrollTop=0)}finally{e.value=!1}},F=()=>{t.meta_id=null,t.especialista_id=null,t.fecha=null,t.horaInicio=null,t.horaFin=null,t.dimension_id=null,t.modalidad=null,t.tema=null,t.lugar=null,t.participantes=null,t.empresas=null,t.coordinador=null,t.observaciones=null},b=s({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDateRangeDisabled",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1,allowedMonth:null},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÓN",name:"dimension_id",required:!0,message:"Seleccionar dimensión",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return $(async()=>{await r.fetchTrainingMetas(),await r.fetchTrainingSpecialist(),await r.fetchTrainingDimensions(),n.value.meta_id=r.trainingMetas,n.value.especialista_id=r.trainingSpecialist,n.value.dimension_id=r.trainingDimensions,v.value=!1}),w("formState",t),w("loadingState",e),(o,l)=>v.value?(_(),A(V(X),{key:0,style:{color:"#00a6db"}})):(_(),M("div",ae,[m(j,{fields:b.value,options:n.value,btnSaveName:E.value,onHandleInputEvent:p,resetSelect:d.value,onHandleChangeSelect:T,onHandleFocusSelect:O,onHandleChangeClock:R,onOnSubmit:H,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const te={key:1,class:"register-training"},ne={__name:"EditarCapacitaciones",props:["info"],emits:["closeDraw"],setup(U,{emit:S}){u.locale("es");const y=S,v=U,E=s(!0),t=s("REGISTRAR"),e=B({}),r=s(!1),d=J(),n=s(null),p=s({meta_id:[],especialista_id:[],dimension_id:[],modalidad:[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}]}),R=a=>{console.log("handleInputEvent",a)},T=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),l.value.dateTramite.disabled=!1)},O=async(a,i)=>{if(a==="meta_id"){l.value.fecha.allowedMonth=null,e.fecha=null;let h=p.value.meta_id.find(I=>I.value==i);console.log("meta",h),l.value.fecha.allowedMonth=h.label}},H=async a=>{a=="meta_id"&&(p.value.meta_id=d.trainingMetas),a=="especialista_id"&&(p.value.especialista_id=d.trainingSpecialist),a=="dimension_id"&&(p.value.dimension_id=d.trainingDimensions)},F=async()=>{r.value=!0;const a={meta_id:e.meta_id,especialista_id:e.especialista_id,fecha:u(e.fecha).format("YYYY-MM-DD"),horaInicio:u(e.horaInicio).format("HH:mm"),horaFin:u(e.horaFin).format("HH:mm"),dimension_id:e.dimension_id,modalidad:e.modalidad,tema:e.tema,lugar:e.lugar,participantes:e.participantes,empresas:e.empresas,coordinador:e.coordinador,observaciones:e.observaciones,estado:e.estado};try{const i=await P({url:`training/update-training/${v.info.id}`,method:"PUT",data:a});i.status===200&&(N.success(i.message),b(),y("closeDraw",!0))}catch(i){i.response&&i.response.data&&i.response.data.message?N.error(i.response.data.message):N.error("Ocurrió un error inesperado.");const h=document.getElementsByClassName("ant-drawer-body")[0];h&&(h.scrollTop=0)}finally{r.value=!1}},b=()=>{e.meta_id=null,e.especialista_id=null,e.fecha=null,e.horaInicio=null,e.horaFin=null,e.dimension_id=null,e.modalidad=null,e.tema=null,e.lugar=null,e.participantes=null,e.empresas=null,e.coordinador=null,e.observaciones=null},o=async a=>{a&&(e.meta_id=a.meta_id,e.especialista_id=a.especialista_id,e.dimension_id=a.dimension_id,e.modalidad=a.modalidad,e.tema=a.tema,e.lugar=a.lugar,e.participantes=a.participantes,e.empresas=a.empresas,e.coordinador=a.coordinador,e.observaciones=a.observaciones,e.fecha=u(a.fecha,"YYYY-MM-DD"),e.horaInicio=u(a.horaInicio,"HH:mm"),e.horaFin=u(a.horaFin,"HH:mm"),e.estado=a.estado)},l=s({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDateRangeDisabled",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1,allowedMonth:null},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÓN",name:"dimension_id",required:!0,message:"Seleccionar dimensión",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return $(async()=>{v.info&&o(v.info),await d.fetchTrainingMetas(),await d.fetchTrainingSpecialist(),await d.fetchTrainingDimensions(),p.value.meta_id=d.trainingMetas,p.value.especialista_id=d.trainingSpecialist,p.value.dimension_id=d.trainingDimensions,E.value=!1}),Z(()=>v.info,a=>{a?o(a):b()}),w("formState",e),w("loadingState",r),(a,i)=>E.value?(_(),A(V(X),{key:0,style:{color:"#00a6db"}})):(_(),M("div",te,[m(j,{fields:l.value,options:p.value,btnSaveName:t.value,onHandleInputEvent:R,resetSelect:n.value,onHandleChangeSelect:O,onHandleFocusSelect:H,onHandleChangeClock:T,onOnSubmit:F,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const le={class:"layout-content"},se={key:0,style:{display:"flex","flex-direction":"column"}},oe=["onClick"],he={__name:"capacitaciones-index",setup(U){const S=s(!1),y=s(!1),v=s([]),E=s(0),t=s(100),e=s(!1),r=s(!1),d=s(null),n=B({asesor:null,month:u(),page:1}),p=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"Fecha/Hora",fixed:"left",dataIndex:"horario",align:"center",width:120},{title:"Especialista",dataIndex:"especialista",width:160},{title:"Tema",dataIndex:"tema",width:170},{title:"Modalidad",dataIndex:"modalidadText",width:120,align:"center"},{title:"Participantes",dataIndex:"participantes",align:"center",width:140},{title:"Estado",dataIndex:"estado",align:"center",width:140},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],R=()=>{d.value=null,S.value=!0},T=async()=>{d.value=null,S.value=!1,await l()},O=async()=>{r.value=!0},H=async a=>{n.page=a,await l()},F=async a=>{a&&(n.page=1,await l())},b=a=>{d.value=a,y.value=!0},o=async(a,i)=>{try{const h={estado:i},I=await P({url:`training/update-training-status/${a}`,method:"PUT",data:h});console.log("response",I)}catch(h){console.error("Error de red:",h)}},l=async()=>{e.value=!0;try{const a={page:n.page};n.year&&(a.year=u(n.year).format("YYYY")),n.asesor&&(a.asesor=n.asesor),n.name&&(a.name=n.name);const i=await P({url:"training/list-trainings",method:"GET",params:a});i.status==200&&(v.value=i.data.data,E.value=i.data.total,t.value=i.data.per_page)}catch(a){console.error("Error de red:",a)}finally{e.value=!1}};return $(async()=>{await l()}),w("search",n),w("loading",e),w("loadingFile",r),(a,i)=>{const h=x("a-date-picker"),I=x("a-tag"),k=x("a-select-option"),K=x("a-select"),Q=x("a-menu-item"),G=x("a-drawer");return _(),M("div",le,[m(W,{title:"CAPACITACIONES UGSE",new:!0,textNuevo:"NUEVO",columns:p,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:t.value,nameTotal:"Capacitaciones",dataSource:v.value,total:E.value,onHandleNew:R,onHandleDownloadExcel:O,onHandleSearch:F,onHandlePaginator:H},{header:c(()=>[D("div",null,[m(h,{value:n.month,"onUpdate:value":i[0]||(i[0]=f=>n.month=f),picker:"month"},null,8,["value"])])]),"data-cell":c(({column:f,record:g})=>[f.dataIndex=="horario"?(_(),M("div",se,[D("b",null,Y(V(u)(g.fecha).format("DD/MM/YYYY")),1),D("span",null,Y(g.horaInicio)+" - "+Y(g.horaFin),1)])):q("",!0),f.dataIndex=="especialista"?(_(),M(z,{key:1},[D("span",{class:"dot-specialist",style:ee(`background-color: ${g.colorEspecialista};`)},null,4),D("span",null,Y(g.especialista),1)],64)):q("",!0),f.dataIndex=="modalidadText"?(_(),M(z,{key:2},[g.modalidad==1?(_(),A(I,{key:0,color:"blue"},{default:c(()=>i[3]||(i[3]=[C(" Presencial ")])),_:1})):g.modalidad==2?(_(),A(I,{key:1,color:"green"},{default:c(()=>i[4]||(i[4]=[C(" Virtual ")])),_:1})):g.modalidad==3?(_(),A(I,{key:2,color:"orange"},{default:c(()=>i[5]||(i[5]=[C(" Mixto ")])),_:1})):q("",!0)],64)):q("",!0),f.dataIndex=="estado"?(_(),A(K,{key:3,value:g.estado,"onUpdate:value":L=>g.estado=L,style:{width:"150px"},placeholder:"Seleccione estado",onChange:L=>o(g.id,L)},{default:c(()=>[m(k,{value:1},{default:c(()=>i[6]||(i[6]=[C("📅 Programada")])),_:1}),m(k,{value:2},{default:c(()=>i[7]||(i[7]=[C("⏳ En curso")])),_:1}),m(k,{value:3},{default:c(()=>i[8]||(i[8]=[C("✅ Completado")])),_:1}),m(k,{value:4},{default:c(()=>i[9]||(i[9]=[C("❌ Cancelado")])),_:1})]),_:2},1032,["value","onUpdate:value","onChange"])):q("",!0)]),"custom-options":c(({record:f})=>[m(Q,null,{default:c(()=>[D("a",{onClick:g=>b(f)},"Editar",8,oe)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),m(G,{width:"500",title:"Registro de capacitación",open:S.value,"onUpdate:open":i[1]||(i[1]=f=>S.value=f),placement:"right"},{default:c(()=>[m(ie,{onCloseDraw:T})]),_:1},8,["open"]),m(G,{width:"500",title:"Editar capacitación",open:y.value,"onUpdate:open":i[2]||(i[2]=f=>y.value=f),placement:"right"},{default:c(()=>[m(ne,{info:d.value,onCloseDraw:T},null,8,["info"])]),_:1},8,["open"])])}}};export{he as default};
