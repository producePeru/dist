import{r as t,u as se,x as ie,K as de,k as re,b as u,o as l,d,e as _,c as s,h as C,w as p,F as r,B as S,i as m,t as c,v as i,s as F,X as ce,L as ue,S as pe,p as me,j as _e,m as ve}from"./index-2b74dd24.js";import{u as he}from"./selectes-a99d902a.js";import"./asesorias-581a11a2.js";import{_ as fe}from"./_plugin-vue_export-helper-c27b6911.js";import{S as ge}from"./DrawerSolicitante.componente-5e61a378.js";import{M as xe}from"./MoreOutlined-cbf7fb9a.js";import"./es-950b2508.js";const V=f=>(me("data-v-69e04d44"),f=f(),_e(),f),we=V(()=>_("h3",null,"SOLICITUDES DE FORMALIZACIÓN DIGITAL",-1)),ye={class:"filters-dig"},Ie=["onClick"],ke=["onClick"],be=["onClick"],Ce=V(()=>_("a",null,"Quitar de la lista",-1)),Se={class:"paginator"},U=20,ze={__name:"SolicitudesLista",setup(f){const g=he();g.$patch({cdes:g.cdes}),g.fetchCdes();const x=t(!1),z=t(null);t(!1),t(!1),t(!1),t(0),t(!1);const E=t(!1);t(!1),t("solicitante"),t(5);const D=t([]),y=t(!1),N=t(0),B=se(),w=t({page:1});t("");const I=t("formalization/digital-list");t([]);const L=t(null),T=t(1200),A=t(window.innerHeight-100),k=()=>{A.value=window.innerHeight-300};ie(()=>{window.removeEventListener("resize",k)});const M=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Apellidos",dataIndex:"lastName",fixed:"left",width:150},{title:"Nombres",dataIndex:"name",fixed:"left",width:150},{title:"DNI",dataIndex:"number_document",align:"center",width:90},{title:"Departamento",dataIndex:"department",width:140},{title:"Provincia",dataIndex:"province",width:140},{title:"Distrito",dataIndex:"district",width:140},{title:"CDE Atención",dataIndex:"cde",width:140},{title:"Celular",dataIndex:"phone",width:100},{title:"Correo",dataIndex:"email",width:200},{title:"Atendido",dataIndex:"statu",align:"center",width:100},{title:"Reserva de nombre",dataIndex:"reserva",align:"center",width:160},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],O=e=>{z.value=e.people,x.value=!0},P=()=>{v(),x.value=!1},H=t([{value:1,label:"Aprobado"},{value:2,label:"Desaprobado"},{value:3,label:"Pendiente"}]),q=e=>{w.value.page=e,v()},G=async e=>{const a={type:e.people.typedocument_id,number:e.people.documentnumber,formalizaciondigital:e.id};B.push({name:"asesorias-formalizaciones",query:a})},Q=e=>{if(e!=1e3){I.value=`/formalization-digital?department=${e}`,v();return}I.value="/formalization-digital",v()},X=async e=>{const a={booking:e};await S({url:`/formalization-digital-status/${E.value.documentnumber}`,method:"PATCH",data:a})},j=e=>{E.value=e},K=async e=>{try{const a=await S({url:`formalization/delete/${e.id}`,method:"DELETE"});a.status==200&&(v(),ve.success(a.message))}catch(a){console.error("Error de red:",a)}},v=async()=>{try{y.value=!0;let e=w.value.page==1?"":w.value;const{data:a}=await S({url:I.value,method:"GET",params:e});D.value=a.data,N.value=a.total}catch(e){console.error("Error de red:",e)}finally{y.value=!1}},Y=de(()=>e=>(w.value.page-1)*U+e+1);return re(()=>{v(),window.addEventListener("resize",k),k()}),(e,a)=>{const R=u("a-select"),Z=u("a-checkbox"),J=u("a-button"),b=u("a-menu-item"),W=u("a-popconfirm"),ee=u("a-menu"),te=u("a-dropdown"),ae=u("a-table"),ne=u("a-pagination"),oe=u("a-drawer");return l(),d(r,null,[_("div",null,[we,_("div",ye,[s(R,{value:L.value,"onUpdate:value":a[0]||(a[0]=o=>L.value=o),placeholder:"Filtrar por CDES",options:C(g).cdes,onChange:Q},null,8,["value","options"])]),s(ae,{bordered:"",scroll:{x:T.value,y:A.value},class:"ant-table-striped",columns:M,"data-source":D.value,pagination:!1,loading:y.value,size:"small"},{bodyCell:p(({column:o,record:n,index:le})=>{var $;return[o.dataIndex=="idx"?(l(),d(r,{key:0},[m(c(Y.value(le)),1)],64)):i("",!0),o.dataIndex=="lastName"?(l(),d(r,{key:1},[m(c(n.people.lastname)+" "+c(n.people.middle),1)],64)):i("",!0),o.dataIndex=="name"?(l(),d(r,{key:2},[m(c(n.people.name),1)],64)):i("",!0),o.dataIndex=="number_document"?(l(),d(r,{key:3},[m(c(n.people.documentnumber),1)],64)):i("",!0),o.dataIndex=="department"?(l(),d(r,{key:4},[m(c(n.people.city.name),1)],64)):i("",!0),o.dataIndex=="province"?(l(),d(r,{key:5},[m(c(n.people.province.name),1)],64)):i("",!0),o.dataIndex=="district"?(l(),d(r,{key:6},[m(c(n.people.district.name),1)],64)):i("",!0),o.dataIndex=="phone"?(l(),d(r,{key:7},[m(c(n.people.phone),1)],64)):i("",!0),o.dataIndex=="email"?(l(),d(r,{key:8},[m(c(n.people.email),1)],64)):i("",!0),o.dataIndex=="cde"?(l(),d(r,{key:9},[m(c(($=n.cde)==null?void 0:$.name),1)],64)):i("",!0),o.dataIndex=="statu"?(l(),F(Z,{key:10,checked:n.attended!=0,disabled:""},null,8,["checked"])):i("",!0),o.dataIndex=="reserva"?(l(),d("div",{key:11,onClick:h=>j(n)},[s(R,{disabled:n.attended==0,value:n.status,"onUpdate:value":h=>n.status=h,placeholder:"Escoger el proceso",style:{width:"90%"},options:H.value,onChange:X},null,8,["disabled","value","onUpdate:value","options"])],8,Ie)):i("",!0),o.dataIndex=="actions"?(l(),F(te,{key:12,trigger:["click"]},{overlay:p(()=>[s(ee,null,{default:p(()=>[s(b,null,{default:p(()=>[_("a",{onClick:h=>G(n)},"Formalizar",8,ke)]),_:2},1024),s(b,null,{default:p(()=>[_("a",{onClick:h=>O(n)},"Editar datos",8,be)]),_:2},1024),s(b,null,{default:p(()=>[s(W,{title:"¿Eliminar?",onConfirm:h=>K(n)},{icon:p(()=>[s(C(ce),{style:{color:"red"}})]),default:p(()=>[Ce]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:p(()=>[_("a",{class:"ant-dropdown-link",onClick:a[1]||(a[1]=ue(()=>{},["prevent"]))},[s(J,{shape:"circle",icon:pe(C(xe)),size:"small"},null,8,["icon"])])]),_:2},1024)):i("",!0)]}),_:1},8,["scroll","data-source","loading"])]),_("div",Se,[s(ne,{size:"small",total:N.value,pageSize:U,onChange:q,showSizeChanger:!1},null,8,["total"])]),s(oe,{open:x.value,"onUpdate:open":a[2]||(a[2]=o=>x.value=o),class:"draw-notary","root-class-name":"root-class-name",title:"Datos del solicitante",placement:"right"},{default:p(()=>[s(ge,{onCloseDraw:P,updateValues:z.value},null,8,["updateValues"])]),_:1},8,["open"])],64)}}},Fe=fe(ze,[["__scopeId","data-v-69e04d44"]]);export{Fe as default};
