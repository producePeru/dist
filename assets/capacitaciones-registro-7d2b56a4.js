import{_ as X}from"./TableComponent-cfbe3a53.js";import{p as m,r as l,a as $,k as B,U as J,X as T,o as u,y as C,i as V,L as K,d as w,c,m as P,h as q,b as S,w as s,e as b,t as R,z as x,F as L,x as Q,j as v}from"./index-9d2731e9.js";import{_ as W}from"./FormComponent-bc6bb0af.js";import{u as Z}from"./selectes-4cece6d3.js";import"./es-1580410a.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-ca3bc5f2.js";import"./quill.snow-28709d53.js";const ee={key:1,class:"register-training"},ae={__name:"RegistroCapacitaciones",props:["info"],emits:["closeDraw"],setup(U,{emit:f}){m.locale("es");const D=f,g=U,E=l(!0),I=l("REGISTRAR"),a=$({}),y=l(!1),t=Z(),k=l(null),p=l({meta_id:[],especialista_id:[],dimension_id:[],modalidad:[{label:"PRESECIAL",value:1},{label:"VIRTUAL",value:2},{label:"MIXTO",value:3}]}),A=e=>{console.log("handleInputEvent",e)},H=async e=>{e=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),i.value.dateTramite.disabled=!1)},M=async e=>{console.log("handleChangeSelect",e)},O=async e=>{e=="meta_id"&&(p.value.meta_id=t.trainingMetas),e=="especialista_id"&&(p.value.especialista_id=t.trainingSpecialist),e=="dimension_id"&&(p.value.dimension_id=t.trainingDimensions)},F=async()=>{y.value=!0;const e={meta_id:a.meta_id,especialista_id:a.especialista_id,fecha:m(a.fecha).format("YYYY-MM-DD"),horaInicio:m(a.horaInicio).format("HH:mm"),horaFin:m(a.horaFin).format("HH:mm"),dimension_id:a.dimension_id,modalidad:a.modalidad,tema:a.tema,lugar:a.lugar,participantes:a.participantes,empresas:a.empresas,coordinador:a.coordinador,observaciones:a.observaciones,estado:1};try{let n,o=null;g.info?(n=`training/update-training/${g.info.id}`,o="PUT"):(n="training/register-training",o="POST");const h=await P({url:n,method:o,data:e});h.status===200&&(q.success(h.message),N(),D("closeDraw",!0))}catch(n){n.response&&n.response.data&&n.response.data.message?q.error(n.response.data.message):q.error("Ocurrió un error inesperado.");const o=document.getElementsByClassName("ant-drawer-body")[0];o&&(o.scrollTop=0)}finally{y.value=!1}},N=()=>{a.meta_id=null,a.especialista_id=null,a.fecha=null,a.horaInicio=null,a.horaFin=null,a.dimension_id=null,a.modalidad=null,a.tema=null,a.lugar=null,a.participantes=null,a.empresas=null,a.coordinador=null,a.observaciones=null},_=async e=>{e&&(a.meta_id=e.meta_id,a.especialista_id=e.especialista_id,a.dimension_id=e.dimension_id,a.modalidad=e.modalidad,a.tema=e.tema,a.lugar=e.lugar,a.participantes=e.participantes,a.empresas=e.empresas,a.coordinador=e.coordinador,a.observaciones=e.observaciones,a.fecha=m(e.fecha,"YYYY-MM-DD"),a.horaInicio=m(e.horaInicio,"HH:mm"),a.horaFin=m(e.horaFin,"HH:mm"))},i=l({meta_id:{type:"iSelect",label:"META",name:"meta_id",required:!0,message:"Seleccionar meta",disabled:!1},especialista_id:{type:"iSelect",label:"ESPECIALISTA",name:"especialista_id",required:!0,message:"Seleccionar especialista",disabled:!1},fecha:{type:"iDate",label:"FECHA",name:"fecha",required:!0,message:"Seleccionar fecha",disabled:!1},horaInicio:{type:"iHourOne",label:"HORA INICIO",name:"horaInicio",required:!0,message:"Seleccionar hora inicio",disabled:!1},horaFin:{type:"iHourOne",label:"HORA FIN",name:"horaFin",required:!0,message:"Seleccionar hora fin",disabled:!1},dimension_id:{type:"iSelect",label:"DIMENSIÓN",name:"dimension_id",required:!0,message:"Seleccionar dimensión",disabled:!1},modalidad:{type:"iSelect",label:"MODALIDAD",name:"modalidad",required:!0,message:"Seleccionar modalidad",disabled:!1},tema:{type:"iText",label:"TEMA",name:"tema",required:!0,message:"Escribir tema",disabled:!1},lugar:{type:"iText",label:"LUGAR",name:"lugar",required:!0,message:"Escribir tema",disabled:!1},participantes:{type:"iNumber",label:"PARTICIPANTES",name:"participantes",required:!0,message:"Escribir participantes",disabled:!1,maxlength:5},empresas:{type:"iNumber",label:"EMPRESAS",name:"empresas",required:!0,message:"Escribir empresas",disabled:!1,maxlength:5},coordinador:{type:"iText",label:"NOMBRE DEL COORDINADOR",name:"coordinador",required:!0,message:"Mencionar al coordinador",disabled:!1},observaciones:{type:"iTextArea",label:"OBSERVACIONES",name:"observaciones",required:!1,message:"Escribir observaciones",disabled:!1}});return B(async()=>{g.info&&_(g.info),await t.fetchTrainingMetas(),await t.fetchTrainingSpecialist(),await t.fetchTrainingDimensions(),p.value.meta_id=t.trainingMetas,p.value.especialista_id=t.trainingSpecialist,p.value.dimension_id=t.trainingDimensions,E.value=!1}),J(()=>g.info,e=>{e?_(e):N()}),T("formState",a),T("loadingState",y),(e,n)=>E.value?(u(),C(V(K),{key:0,style:{color:"#00a6db"}})):(u(),w("div",ee,[c(W,{fields:i.value,options:p.value,btnSaveName:I.value,onHandleInputEvent:A,resetSelect:k.value,onHandleChangeSelect:M,onHandleFocusSelect:O,onHandleChangeClock:H,onOnSubmit:F,mayus:!0},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const te={class:"layout-content"},ie={key:0,style:{display:"flex","flex-direction":"column"}},ne=["onClick"],pe={__name:"capacitaciones-registro",setup(U){const f=l(!1),D=l([]),g=l(0),E=l(100),I=l(!1),a=l(!1),y=l(null),t=$({asesor:null,month:m(),page:1}),k=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"Fecha/Hora",fixed:"left",dataIndex:"horario",align:"center",width:120},{title:"Especialista",dataIndex:"especialista",width:160},{title:"Tema",dataIndex:"tema",width:170},{title:"Modalidad",dataIndex:"modalidadText",width:120,align:"center"},{title:"Participantes",dataIndex:"participantes",align:"center",width:140},{title:"Estado",dataIndex:"estado",align:"center",width:140},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],p=()=>{f.value=!0},A=async()=>{f.value=!1,await _()},H=async()=>{a.value=!0},M=async i=>{t.page=i,await _()},O=async i=>{i&&(t.page=1,await _())},F=i=>{y.value=i,f.value=!0},N=async(i,e)=>{try{const n={estado:e},o=await P({url:`training/update-training-status/${i}`,method:"PUT",data:n});console.log("response",o)}catch(n){console.error("Error de red:",n)}},_=async()=>{I.value=!0;try{const i={page:t.page};t.year&&(i.year=m(t.year).format("YYYY")),t.asesor&&(i.asesor=t.asesor),t.name&&(i.name=t.name);const e=await P({url:"training/list-trainings",method:"GET"});e.status==200&&(D.value=e.data.data,g.value=e.data.total,E.value=e.data.per_page)}catch(i){console.error("Error de red:",i)}finally{I.value=!1}};return B(async()=>{await _()}),T("search",t),T("loading",I),T("loadingFile",a),(i,e)=>{const n=S("a-date-picker"),o=S("a-tag"),h=S("a-select-option"),z=S("a-select"),G=S("a-menu-item"),j=S("a-drawer");return u(),w("div",te,[c(X,{title:"CAPACITACIONES UGSE",new:!0,textNuevo:"NUEVO",columns:k,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:E.value,nameTotal:"Capacitaciones",dataSource:D.value,total:g.value,onHandleNew:p,onHandleDownloadExcel:H,onHandleSearch:O,onHandlePaginator:M},{header:s(()=>[b("div",null,[c(n,{value:t.month,"onUpdate:value":e[0]||(e[0]=d=>t.month=d),picker:"month"},null,8,["value"])])]),"data-cell":s(({column:d,record:r})=>[d.dataIndex=="horario"?(u(),w("div",ie,[b("b",null,R(V(m)(r.fecha).format("DD/MM/YYYY")),1),b("span",null,R(r.horaInicio)+" - "+R(r.horaFin),1)])):x("",!0),d.dataIndex=="especialista"?(u(),w(L,{key:1},[b("span",{class:"dot-specialist",style:Q(`background-color: ${r.colorEspecialista};`)},null,4),b("span",null,R(r.especialista),1)],64)):x("",!0),d.dataIndex=="modalidadText"?(u(),w(L,{key:2},[r.modalidad==1?(u(),C(o,{key:0,color:"blue"},{default:s(()=>e[2]||(e[2]=[v(" Presencial ")])),_:1})):r.modalidad==2?(u(),C(o,{key:1,color:"green"},{default:s(()=>e[3]||(e[3]=[v(" Virtual ")])),_:1})):r.modalidad==3?(u(),C(o,{key:2,color:"orange"},{default:s(()=>e[4]||(e[4]=[v(" Mixto ")])),_:1})):x("",!0)],64)):x("",!0),d.dataIndex=="estado"?(u(),C(z,{key:3,value:r.estado,"onUpdate:value":Y=>r.estado=Y,style:{width:"150px"},placeholder:"Seleccione estado",onChange:Y=>N(r.id,Y)},{default:s(()=>[c(h,{value:1},{default:s(()=>e[5]||(e[5]=[v("Programada")])),_:1}),c(h,{value:2},{default:s(()=>e[6]||(e[6]=[v("En curso")])),_:1}),c(h,{value:3},{default:s(()=>e[7]||(e[7]=[v("Completado")])),_:1}),c(h,{value:4},{default:s(()=>e[8]||(e[8]=[v("Cancelado")])),_:1})]),_:2},1032,["value","onUpdate:value","onChange"])):x("",!0)]),"custom-options":s(({record:d})=>[c(G,null,{default:s(()=>[b("a",{onClick:r=>F(d)},"Editar",8,ne)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),c(j,{width:"500",title:"Registro de Capacitaciones",open:f.value,"onUpdate:open":e[1]||(e[1]=d=>f.value=d),placement:"right"},{default:s(()=>[c(ae,{info:y.value,onCloseDraw:A},null,8,["info"])]),_:1},8,["open"])])}}};export{pe as default};
