import{L as Q,r as a,a as W,b as t,o as i,q as A,w as o,c as n,e as d,d as v,F as C,x as Z,h as ee,s as g,i as T,z as N,m as f,u as ae,v as te,I as ne,k as oe,t as U,T as se}from"./index-3f8df86a.js";import{u as le}from"./selectes-de5ace00.js";import"./es-6ef31301.js";const re={token:{type:"iText",label:"Token",name:"token",required:!0,message:"Escribir el token",disabled:!0},name:{type:"iText",label:"Nombre",name:"name",required:!0,message:"Escribir nombre",disabled:!0}},ie={class:"grid-convenios"},ue={__name:"NuevoToken",emits:["closeDraw"],setup(L,{emit:I}){Q.locale("es");const m=I,u=a(!1),h=a(!1),r=W({}),y=()=>{r.token=null,r.name=null},x=async()=>{u.value=!0;const D={token:r.token,name:r.name};try{const c=await N({url:"token/create",method:"POST",data:D});c.status==200&&(f.success(c.message),m("closeDraw",!0),y())}catch(c){f.error("Se originÃ³ un error: "+c.message)}finally{u.value=!1}},p=()=>{f.error("Debes de completar todos los espacios requeridos")};return(D,c)=>{const E=t("a-input"),S=t("a-form-item"),k=t("a-button"),O=t("a-form"),R=t("a-spin");return i(),A(R,{spinning:h.value},{default:o(()=>[n(O,{layout:"vertical",model:r,name:"basic",autocomplete:"off",onFinish:x,onFinishFailed:p},{default:o(()=>[d("div",ie,[(i(!0),v(C,null,Z(ee(re),(l,q)=>(i(),v(C,{key:q},[l.type==="iText"?(i(),A(S,{key:0,name:l.name,label:l.label,rules:[{required:l.required,message:l.message,max:l.max}]},{default:o(()=>[n(E,{value:r[l.name],"onUpdate:value":B=>r[l.name]=B,maxlength:l.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):g("",!0)],64))),128))]),n(S,null,{default:o(()=>[n(k,{type:"primary","html-type":"submit",loading:u.value},{default:o(()=>[T("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}};const ce=d("h3",{class:"title-produce"},"TOKENS",-1),de=d("a",{href:"https://apis.net.pe/app/account/signup",target:"_blank"},"Crear cuenta",-1),me={key:1},pe={class:"paginator"},fe={__name:"MisTokens",setup(L){const I=le();I.$patch({cdes:I.cdes});const m=a(!1),u=a(1);a(null),a(null),a(!1),a(!1),a(0),a("solicitante");const h=a(50),r=a([]),y=a(!1),x=a(0);ae();const p=a({page:0}),D=a("token/list"),c=a(1200),E=a(window.innerHeight-100),S=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:20},{title:"NOMBRE",dataIndex:"name",width:60},{title:"TOKEN",dataIndex:"token",fixed:"left",width:120},{title:"TOTAL",dataIndex:"count",width:30,align:"center"},{title:"CREADO",dataIndex:"date",width:50},{title:"ACTIVADO",dataIndex:"status",width:30,align:"center"},{title:"TEST",dataIndex:"test",width:30,align:"center"}],k=()=>{E.value=window.innerHeight-300};te(()=>{window.removeEventListener("resize",k)});const O=e=>se(e).format("DD/MM/YYYY HH:mm A"),R=async e=>{await N({url:`token/update-status/${e.id}`,method:"PUT"})},l=async()=>{try{const e=await N({url:"user/only-dni/45424747",method:"GET"});if(console.log("response: ",e),e.status==429)return f.warning(e.message);if(e.status==401)return f.error(e.message);f.success("Puedes usar este token")}catch(e){console.error("Error de red:",e)}},q=()=>{m.value=!0},B=()=>{F(),m.value=!1},P=e=>{p.value.page=e,F()},F=async e=>{try{y.value=!0;let s;s=p.value.page==0?"":p.value,s=e?{...s,...e}:s;const w=await N({url:D.value,method:"GET",params:s}),b=w.data;r.value=b.data,x.value=b.total,h.value=b.per_page,u.value=w.id_active}catch(s){console.error("Error de red:",s)}finally{y.value=!1}},V=ne(()=>e=>p.value.page*h.value+e+1);return oe(()=>{F(),window.addEventListener("resize",k),k()}),(e,s)=>{const w=t("a-button"),b=t("a-col"),Y=t("a-row"),$=t("a-radio"),H=t("a-radio-group"),G=t("a-table"),K=t("a-tag"),j=t("a-pagination"),X=t("a-drawer");return i(),v(C,null,[d("div",null,[ce,n(Y,{style:{margin:"1rem 0"}},{default:o(()=>[n(b,{xs:24,md:12,lg:18},{default:o(()=>[n(w,{type:"primary",onClick:q,style:{"margin-right":".5rem"}},{default:o(()=>[T("Nuevo Token")]),_:1}),de]),_:1})]),_:1}),n(G,{bordered:"",scroll:{x:c.value,y:E.value},class:"table-users",columns:S,"data-source":r.value,pagination:!1,loading:y.value,size:"small"},{bodyCell:o(({column:_,record:z,index:J})=>[_.dataIndex=="idx"?(i(),v(C,{key:0},[T(U(V.value(J)),1)],64)):g("",!0),_.dataIndex=="date"?(i(),v("div",me,U(O(z.created_at)),1)):g("",!0),_.dataIndex=="status"?(i(),A(H,{key:2,value:u.value,"onUpdate:value":s[0]||(s[0]=M=>u.value=M),onChange:M=>R(z)},{default:o(()=>[n($,{value:z.id},null,8,["value"])]),_:2},1032,["value","onChange"])):g("",!0),_.dataIndex=="test"?(i(),v(C,{key:3},[u.value==z.id?(i(),A(w,{key:0,primary:"",type:"text",onClick:l,style:{"font-size":"13px"}},{default:o(()=>[T("PROBAR")]),_:1})):g("",!0)],64)):g("",!0)]),_:1},8,["scroll","data-source","loading"])]),d("div",pe,[d("span",null,[n(K,{color:"blue"},{default:o(()=>[d("b",null,U(x.value),1)]),_:1}),T("Itens")]),n(j,{size:"small",total:x.value,pageSize:h.value,onChange:P,showSizeChanger:!1},null,8,["total","pageSize"])]),n(X,{open:m.value,"onUpdate:open":s[1]||(s[1]=_=>m.value=_),class:"draw-notary","root-class-name":"root-class-name",title:"Tokens",placement:"right",width:"500"},{default:o(()=>[n(ue,{onCloseDraw:B})]),_:1},8,["open"])],64)}}};export{fe as default};
