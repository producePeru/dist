import{_ as L}from"./TableComponent-695a5a1a.js";import{p as y,r as n,a as H,k as U,U as q,X as D,o,d as E,c as r,w as g,z as h,m as V,h as $,u as W,b as N,i as G,F as P,e as A,j as C,t as Y,y as j}from"./index-f8debde9.js";import{_ as z}from"./FormComponent-f899db6b.js";import{u as J}from"./selectes-646a85dd.js";import{U as Q}from"./UpImage-99433469.js";import"./es-17a3c5d0.js";import{g as Z}from"./publicInscripcion-ebc9ecb9.js";import{C as K}from"./CloudUploadOutlined-4967ca58.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-33a1be99.js";import"./quill.snow-709b2fe1.js";import"./_plugin-vue_export-helper-c27b6911.js";const X={class:"fairs"},ee={key:0},te={__name:"DrawCyberWow",props:["info"],emits:["closeDraw"],setup(B,{emit:v}){y.locale("es");const b=n({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},messageEndForm:{type:"iLabel",label:"MENSAJES DE INSCRIPCIONES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE AL FINALIZAR INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const T=v,l=B,I=n("GUARDAR"),e=H({}),w=n(!1),d=n(null),s=J(),O=n(null),c=n({city_id:[],fairtype_id:[],modality_id:[]}),M=()=>l.info?{name:l.info.image.name,url:l.info.image.url}:null,x=t=>{},k=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),b.value.dateTramite.disabled=!1)},F=async t=>{d.value=t.id},f=async t=>{t=="city_id"&&(await s.fetchCitiesNational(),e.city_id=null,c.value.city_id=s.citiesNational),t=="fairtype_id"&&(await s.fetchFairTypes(),c.value.fairtype_id=s.fairTypes),t=="modality_id"&&(await s.fetchModalities(),c.value.modality_id=s.modalities)},i=async()=>{w.value=!0;const t={title:e.title,subTitle:e.subTitle,description:e.description,fairtype_id:2,modality_id:1,startDate:y(e.dates.start).format("YYYY-MM-DD"),endDate:y(e.dates.end).format("YYYY-MM-DD"),metaMypes:e.metaMypes,city_id:e.city_id,fecha:null,place:null,hours:null,msgEndForm:e.msgEndForm,msgSendEmail:e.msgSendEmail,image_id:d.value};try{const S=l.info?`fair/update/${l.info.id}`:"events-ugse/cyber-wow-register-event",u=l.info?"PUT":"POST",R=await V({url:S,method:u,data:t});R.status===200&&($.success(R.message),a(),T("closeDraw",!0))}catch(S){console.error("Error:",S);const u=document.getElementsByClassName("ant-drawer-body")[0];u&&(u.scrollTop=0)}finally{w.value=!1}},a=()=>{e.title=null,e.subTitle=null,e.description="</p>",e.fairtype_id=null,e.modality_id=null,e.dates=null,e.metaMypes=null,e.city_id=null,e.place=null,e.hours=null,e.msgEndForm="</p>",e.msgSendEmail="</p>"},_=async t=>{t&&(e.title=t.title,e.subTitle=t.subTitle,e.description=t.description,await s.fetchFairTypes(),c.value.fairtype_id=s.fairTypes,e.fairtype_id=t.fairtype_id,await s.fetchModalities(),c.value.modality_id=s.modalities,e.modality_id=t.modality_id,e.dates={start:y(t.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:y(t.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.metaMypes=t.metaMypes,await s.fetchCitiesNational(),c.value.city_id=s.citiesNational,e.city_id=t.city_id,e.fecha=t.fecha?y(t.fecha,"DD/MM/YYYY"):null,e.place=t.place,e.hours=t.hours,e.msgEndForm=t.msgEndForm||"</p>",e.msgSendEmail=t.msgSendEmail||"</p>")};return U(()=>{l.info&&_(l.info)}),q(()=>l.info,t=>{t?_(t):a()}),D("formState",e),D("loadingState",w),(t,S)=>(o(),E("div",X,[r(z,{fields:b.value,options:c.value,btnSaveName:I.value,onHandleInputEvent:x,resetSelect:O.value,onHandleFocusSelect:f,onHandleChangeClock:k,onOnSubmit:i},{default:g(({field:u})=>[u.name=="iSlotOptions"?(o(),E("div",ee,[r(Q,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:F,imageLoad:M()},null,8,["imageLoad"])])):h("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const ae={class:"layout-content"},le=["onClick"],ie={key:0,style:{"line-height":"1.5"}},se={key:1},ne={key:0},oe=["onClick"],ve={__name:"list-index",setup(B){JSON.parse(localStorage.getItem("role"));const v=n([]),b=n(0),T=n(150),l=n(!1);W();const I=n(!1),e=n(null),w=n(!1),d=H({year:y("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:3}),s=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:50},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:180},{title:"FECHAS INSCRIPCIONES",dataIndex:"date",width:70,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:100,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:100,align:"center"},{title:"FORMULARIO",dataIndex:"registerBtn",width:120,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],O=i=>{const a=`${Z()}/cyber-wow/${i}`;window.open(a,"_blank")},c=i=>{e.value=i,l.value=!0},M=()=>{f(),l.value=!1},x=()=>{e.value=null,l.value=!0},k=async i=>{d.page=i,await f()},F=async i=>{i&&(d.page=1,await f())},f=async()=>{try{I.value=!0;const i={page:d.page};d.year&&(i.year=y(d.year).format("YYYY"));const _=await V({url:"events-ugse/cyber-wow",method:"GET",params:i});v.value=_.data.data,b.value=_.data.total,T.value=_.data.per_page}catch(i){console.error("Error de red:",i)}finally{I.value=!1}};return U(async()=>{await f()}),D("search",d),D("loading",I),D("loadingFile",w),(i,a)=>{const _=N("a-tag"),t=N("a-button"),S=N("router-link"),u=N("a-menu-item"),R=N("a-drawer");return o(),E("div",ae,[r(L,{title:"CYBER WOW",new:!0,textNuevo:"NUEVO",placeholderSearch:"Buscar",searchYear:!0,columns:s,titleSearch:"BUSCAR POR EVENTO",pageSize:T.value,nameTotal:"Eventos CYBER WOW",dataSource:v.value,total:b.value,btnUpdate:!0,onHandleNew:x,onHandleCallFetchData:f,onHandleSearch:F,onHandlePaginator:k},{"data-cell":g(({column:m,record:p})=>[m.dataIndex=="link"?(o(),E("a",{key:0,onClick:re=>O(p.slug),href:"javascript:void(0)",target:"_blank"},[r(G(K),{style:{"font-size":"18px"}})],8,le)):h("",!0),m.dataIndex=="date"?(o(),E(P,{key:1},[p.startDate!=p.endDate?(o(),E("span",ie,[a[1]||(a[1]=A("b",null,"Desde:",-1)),C(" "+Y(p.dateStartFormat)+" ",1),a[2]||(a[2]=A("b",null,"Hasta:",-1)),C(" "+Y(p.dateEndFormat),1)])):(o(),E("span",se,Y(p.dateStartFormat),1))],64)):h("",!0),m.dataIndex=="registered"?(o(),j(_,{key:2,color:"processing"},{default:g(()=>[C(Y(p.registered_wow),1)]),_:2},1024)):h("",!0),m.dataIndex=="registerBtn"?(o(),E(P,{key:3},[v.value[0].id==p.id?(o(),E("div",ne,[r(t,null,{default:g(()=>a[3]||(a[3]=[C("REGISTRAR")])),_:1})])):h("",!0)],64)):h("",!0)]),"custom-options":g(({record:m})=>[r(u,null,{default:g(()=>[r(S,{to:`/admin/ugse/cyber-wow/inscritos/${m.slug}`,target:"_blank"},{default:g(()=>a[4]||(a[4]=[C(" Inscritos ")])),_:2},1032,["to"])]),_:2},1024),r(u,null,{default:g(()=>[A("a",{onClick:p=>c(m)},"Editar",8,oe)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),r(R,{open:l.value,"onUpdate:open":a[0]||(a[0]=m=>l.value=m),title:e.value?"EDITAR EVENTO CYBER WOW":"REGISTRAR UN EVENTO CYBER WOW",placement:"right",width:"550"},{default:g(()=>[r(te,{onCloseDraw:M,info:e.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{ve as default};
