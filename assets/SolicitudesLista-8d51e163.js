import{r as a,u as ye,x as be,I as ke,k as Ie,b as l,o as r,d as w,e as i,c as o,w as s,F as k,z as v,i as R,t as I,s as p,q as C,h as B,S as Ce,J as ze,T as Se,D as Ee,p as De,j as Te,m as Ue}from"./index-ce034a82.js";import{R as Ae}from"./ReservaNombre-e3331811.js";import{_ as Re}from"./_plugin-vue_export-helper-c27b6911.js";import{M as Ne}from"./MoreOutlined-04028758.js";import"./selectes-1cf52435.js";const z=x=>(De("data-v-34daf75e"),x=x(),Te(),x),$e=z(()=>i("h3",null,"SOLICITUDES DE FORMALIZACIÓN DIGITAL",-1)),Fe={class:"filters-dig"},Le=["onClick"],Me=["onClick"],Pe=["onClick"],Be=z(()=>i("a",null,"Quitar de la lista",-1)),Ve={class:"paginator"},qe={class:"steps-content"},Ge=z(()=>i("span",null,"Tiene trámites pendientes",-1)),He=z(()=>i("div",{style:{"text-align":"center"}},"NUEVO TRÁMITE",-1)),Oe=[He],V=20,Qe={__name:"SolicitudesLista",setup(x){const q=a(!1),h=a(!1),m=a(!1),S=a(0),f=a(!1),N=a(!1);a(!1);const G=a("solicitante"),H=a(5),$=a([]),E=a(!1),F=a(0),L=ye(),y=a({page:1}),b=a(""),g=a("/formalization-digital"),D=a([]),M=a(null),O=a(1200),P=a(window.innerHeight-100),T=()=>{P.value=window.innerHeight-300};be(()=>{window.removeEventListener("resize",T)});const Q=[{title:"Reserva de nombre"},{title:"Acto constitutivo"},{title:"Final"}],j=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Apellidos",dataIndex:"lastName",fixed:"left",width:140},{title:"Nombres",dataIndex:"name",fixed:"left",width:120},{title:"DNI",dataIndex:"number_document",align:"center",width:90},{title:"Departamento",dataIndex:"department",width:140},{title:"Provincia",dataIndex:"province",width:140},{title:"Distrito",dataIndex:"district",width:140},{title:"CDE Atención",dataIndex:"gps_name",width:140},{title:"Celular",dataIndex:"phone",width:100},{title:"Correo",dataIndex:"email",width:200},{title:"Atendido",dataIndex:"statu",align:"center",width:100},{title:"Reserva de nombre",dataIndex:"reserva",align:"center",width:160},{title:"",dataIndex:"actions",align:"center",width:50}],J=a([{value:1,label:"Aprobado"},{value:2,label:"Desaprobado"},{value:3,label:"Pendiente"}]),X=e=>{y.value.page=e,c()},Y=e=>{const t={rol:G.value,dni:e.number_document,access:H.value};L.push({name:"actualizar-persona",query:t})},Z=async e=>{try{f.value=null,h.value=!1,m.value=!1;const{data:t}=await v({url:`/my-formalizations20/${e.number_document}`,method:"GET"});f.value={id:e.id_person,dni:e.number_document},t.length>=1?h.value=!0:m.value=!0}catch(t){console.log(t)}},K=()=>{const e={dni:f.value.dni,typedoc:"dni"};L.push({name:"asesorias-formalizaciones",query:e})},W=e=>{if(e!=1e3){g.value=`/formalization-digital?department=${e}`,c();return}g.value="/formalization-digital",c()},ee=()=>{if(b.value){g.value=`/formalization-digital?search=${b.value}`,c();return}g.value="/formalization-digital",c()},te=async e=>{const t={booking:e};await v({url:`/formalization-digital-status/${N.value.number_document}`,method:"PATCH",data:t})},ae=e=>{N.value=e},ne=async()=>{const e={status:1};(await v({url:`/formalization-digital-status/${f.value.dni}`,method:"PATCH",data:e})).status==200&&(m.value=!1,c())},oe=async e=>{try{const t={is_delete:1};(await v({url:`/formalization-digital-status/${e.number_document}`,method:"PATCH",data:t})).status==200&&(c(),Ue.success("Se ha quitado de la lista"))}catch(t){console.error("Error de red:",t)}},c=async()=>{try{E.value=!0;let e=y.value.page==1?"":y.value;const _=(await v({url:g.value,method:"GET",params:e})).data.filter(U=>U!==null);$.value=_,F.value=_.length}catch(e){console.error("Error de red:",e)}finally{E.value=!1}},le=async()=>{try{const{data:e}=await v({url:"/actives-cdes-digitals",method:"GET"}),t={value:1e3,label:"Ver Todos"};D.value=e,D.value.push(t)}catch(e){console.error("Error de red:",e)}},se=ke(()=>e=>(y.value.page-1)*V+e+1);return Ie(()=>{c(),le(),window.addEventListener("resize",T),T()}),(e,t)=>{const _=l("a-select"),U=l("a-input-search"),ie=l("a-checkbox"),de=l("a-tag"),re=l("a-button"),A=l("a-menu-item"),ce=l("a-popconfirm"),ue=l("a-menu"),pe=l("a-dropdown"),me=l("a-table"),_e=l("a-pagination"),ve=l("a-step"),he=l("a-steps"),fe=l("a-drawer"),ge=l("a-spin"),we=l("a-modal");return r(),w(k,null,[i("div",null,[$e,i("div",Fe,[o(_,{value:M.value,"onUpdate:value":t[0]||(t[0]=n=>M.value=n),placeholder:"Filtrar por CDES",options:D.value,onChange:W},null,8,["value","options"]),o(U,{value:b.value,"onUpdate:value":t[1]||(t[1]=n=>b.value=n),placeholder:"","enter-button":"Buscar",onSearch:ee},null,8,["value"])]),o(me,{bordered:"",scroll:{x:O.value,y:P.value},class:"ant-table-striped",columns:j,"data-source":$.value,pagination:!1,loading:E.value,size:"small"},{bodyCell:s(({column:n,record:d,index:xe})=>[n.dataIndex=="idx"?(r(),w(k,{key:0},[R(I(se.value(xe)),1)],64)):p("",!0),n.dataIndex=="lastName"?(r(),w(k,{key:1},[R(I(d.last_name)+" "+I(d.middle_name),1)],64)):p("",!0),n.dataIndex=="statu"?(r(),C(ie,{key:2,checked:d.status,"onUpdate:checked":u=>d.status=u,disabled:""},null,8,["checked","onUpdate:checked"])):p("",!0),n.dataIndex=="reserva"?(r(),w("div",{key:3,onClick:u=>ae(d)},[o(_,{value:d.booking,"onUpdate:value":u=>d.booking=u,placeholder:"Escoger el proceso",style:{width:"90%"},options:J.value,onChange:te},null,8,["value","onUpdate:value","options"])],8,Le)):p("",!0),n.dataIndex=="countx"?(r(),C(de,{key:4,color:"cyan"},{default:s(()=>[R(I(d.count),1)]),_:2},1024)):p("",!0),n.dataIndex=="actions"?(r(),C(pe,{key:5,trigger:["click"]},{overlay:s(()=>[o(ue,null,{default:s(()=>[o(A,null,{default:s(()=>[i("a",{onClick:u=>Z(d)},"Formalizar",8,Me)]),_:2},1024),o(A,null,{default:s(()=>[i("a",{onClick:u=>Y(d)},"Editar datos",8,Pe)]),_:2},1024),o(A,null,{default:s(()=>[o(ce,{title:"¿Eliminar?",onConfirm:u=>oe(d)},{icon:s(()=>[o(B(Ce),{style:{color:"red"}})]),default:s(()=>[Be]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:s(()=>[i("a",{class:"ant-dropdown-link",onClick:t[2]||(t[2]=ze(()=>{},["prevent"]))},[o(re,{shape:"circle",icon:Se(B(Ne)),size:"small"},null,8,["icon"])])]),_:2},1024)):p("",!0)]),_:1},8,["scroll","data-source","loading"])]),i("div",Ve,[o(_e,{size:"small",total:F.value,pageSize:V,onChange:X,showSizeChanger:!1},null,8,["total"])]),o(fe,{width:"510",title:"Formalización con RUC 20",open:m.value,"onUpdate:open":t[3]||(t[3]=n=>m.value=n),placement:"right"},{default:s(()=>[o(he,{current:S.value,size:"small",class:"steps"},{default:s(()=>[(r(),w(k,null,Ee(Q,n=>o(ve,{key:n.title,title:n.title},null,8,["title"])),64))]),_:1},8,["current"]),i("div",qe,[S.value==0?(r(),C(Ae,{key:0,info:f.value,onCloseDraw:ne},null,8,["info"])):p("",!0)])]),_:1},8,["open"]),o(we,{open:h.value,"onUpdate:open":t[5]||(t[5]=n=>h.value=n),title:"Pendientes",closable:!0,cancelText:"Cerrar",footer:null,maskClosable:!1,width:"380px"},{default:s(()=>[o(ge,{spinning:q.value},{default:s(()=>[i("div",{class:"un-tramite"},[Ge,i("span",{class:"go",onClick:K},"Ir a trámites")]),i("div",{class:"pendient pendient-btn",onClick:t[4]||(t[4]=n=>(m.value=!0,h.value=!1,S.value=0))},Oe)]),_:1},8,["spinning"])]),_:1},8,["open"])],64)}}},Ke=Re(Qe,[["__scopeId","data-v-34daf75e"]]);export{Ke as default};
