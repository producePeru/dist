import{c as r,A as x,r as P,u as N,a as b,b as j,d as p,o as z,e as E,f as l,w as i,g as V,m as w,h as $,i as y,C as T,j as S,k as U,p as A,l as B}from"./index-2d9453b9.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import{U as F}from"./UserOutlined-cf681aaf.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const q=J;function O(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),c.forEach(function(s){C(o,s,n[s])})}return o}function C(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var h=function(t,n){var c=O({},t,n.attrs);return r(x,O({},c,{icon:q}),null)};h.displayName="LockOutlined";h.inheritAttrs=!1;const R=h;const v=o=>(A("data-v-cffad875"),o=o(),B(),o),H={class:"container-login"},M=v(()=>l("img",{class:"hero",src:"https://soporte-pnte.com/tuempresa/assets/images/fondo.jpeg",alt:""},null,-1)),G={class:"wrapper-login"},Q=v(()=>l("div",{class:"title"},[l("img",{class:"logo",src:"https://www.tuempresa.gob.pe/wp-content/uploads/2021/10/Produce-TuEmpresa.png",alt:""}),l("h1",null,"Iniciar Sesión"),l("span",null,"Ingrese su usuario y contraseña para ingresar a la plataforma.")],-1)),W=v(()=>l("br",null,null,-1)),X={__name:"LoginPage",setup(o){const t=P(!1),n=N(),c=window.location.hostname=="127.0.0.1"?"http://127.0.0.1:8000/api/v1":"https://apituempresa.soporte-pnte.com/api/v1";b.get("token");const s=j({email:"",password:""}),k=async()=>{t.value=!0;try{const u=s,{data:e}=await V({url:"/login",method:"POST",data:u});b.set("token",e.access_token);const d={access_token:e.access_token,id:e.id,document_number:e.document_number,role:e.role};localStorage.setItem("user",JSON.stringify(d));const a=await w({url:`/personal-data/${e.document_number}`,method:"GET"}),m={id:a.data.id,name:a.data.name,last_name:a.data.last_name,middle_name:a.data.middle_name,email:a.data.email,dni:a.data.number_document};localStorage.setItem("info",JSON.stringify(m));const _=await $.get(`${c}/profile-photo/${a.data.id}/${a.data.number_document}`,{responseType:"blob",headers:{Accept:"application/json",Authorization:`Bearer ${e.access_token}`}}),f=window.URL.createObjectURL(new Blob([_.data]));localStorage.setItem("photo",JSON.stringify(f)),e&&I(e.id)}catch{y.error("Las credenciales son incorrectas")}finally{t.value=!1}},I=async u=>{const{data:e}=await w({url:`/views/${u}`,method:"GET"}),d=T.AES.encrypt(JSON.stringify(e),"appvistas").toString();try{localStorage.setItem("views",d)}catch(a){console.error("Error al guardar en localStorage:",a);return}n.push("/admin/inicio")},L=()=>{y.error("Sin acceso")};return(u,e)=>{const d=p("a-input"),a=p("a-form-item"),m=p("a-input-password"),_=p("a-button"),f=p("a-form");return z(),E("div",H,[M,l("div",G,[Q,r(f,{class:"form-wrapper",model:s,name:"basic",autocomplete:"off",onFinish:k,onFinishFailed:L},{default:i(()=>[r(a,{name:"email",rules:[{required:!0,message:"Ingresa tu cuenta de email"}]},{default:i(()=>[r(d,{value:s.email,"onUpdate:value":e[0]||(e[0]=g=>s.email=g),size:"large"},{prefix:i(()=>[r(S(F),{class:"input-ico"})]),_:1},8,["value"])]),_:1}),r(a,{name:"password",rules:[{required:!0,message:"La contraseña es incorrecta"}]},{default:i(()=>[r(m,{value:s.password,"onUpdate:value":e[1]||(e[1]=g=>s.password=g),size:"large"},{prefix:i(()=>[r(S(R),{class:"input-ico"})]),_:1},8,["value"])]),_:1}),W,r(a,null,{default:i(()=>[r(_,{size:"large",block:"",type:"primary","html-type":"submit",class:"btn-login",loading:t.value},{default:i(()=>[U("Ingresar")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}},ee=D(X,[["__scopeId","data-v-cffad875"]]);export{ee as default};
