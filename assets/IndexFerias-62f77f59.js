import{_ as z}from"./TableComponent-74c1de65.js";import{c as y,A as J,r as o,j as P,X as B,b as R,o as h,d as I,w as b,h as q,e as x,y as A,K as Q,l as w,a as j,a6 as L,R as $,m as Z,u as X,F as K,i as U,t as V,x as W}from"./index-f8d1f2b5.js";import{_ as ee}from"./FormComponent-b415cd92.js";import{u as ae}from"./selectes-fd0ee159.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./es-eebcc750.js";import{d as le}from"./downloadExcel-de9202b7.js";import{C as ie}from"./CloudUploadOutlined-2c94cb08.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-f0237bd8.js";import"./quill.snow-07761e5a.js";var ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"};const se=ne;function H(c){for(var d=1;d<arguments.length;d++){var n=arguments[d]!=null?Object(arguments[d]):{},f=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),f.forEach(function(i){re(c,i,n[i])})}return c}function re(c,d,n){return d in c?Object.defineProperty(c,d,{value:n,enumerable:!0,configurable:!0,writable:!0}):c[d]=n,c}var k=function(d,n){var f=H({},d,n.attrs);return y(J,H({},f,{icon:se}),null)};k.displayName="FileImageOutlined";k.inheritAttrs=!1;const oe=k;const de={class:"clearfix"},ce={key:0},me=["src"],ue={__name:"UpImage",props:{acceptFormats:{type:Array,default:()=>["image/jpeg","image/png","image/jpg","image/gif","image/webp"]},maxImages:{type:Number,default:1},imageLoad:{type:Object,default:()=>null}},emits:["uploadSuccess"],setup(c,{emit:d}){const n=c,f=d,i=o([]),N=o(!1),a=o(""),m=o(""),D=l=>new Promise((s,v)=>{const u=new FileReader;u.readAsDataURL(l),u.onload=()=>s(u.result),u.onerror=g=>v(g)}),t=async l=>{var s;!l.url&&!l.preview&&(l.preview=await D(l.originFileObj)),a.value=l.url||l.preview,N.value=!0,m.value=l.name||((s=l.url)==null?void 0:s.substring(l.url.lastIndexOf("/")+1))},C=()=>{N.value=!1,m.value=""},_=l=>n.acceptFormats.includes(l.type)?i.value.length<n.maxImages:(alert("Formato de imagen no permitido."),!1),F=async({file:l,onSuccess:s,onError:v})=>{const u=new FormData;u.append("file",l),u.append("from_origin","feria");try{const E=(await Q.post("http://127.0.0.1:8000/api/image/upload-image",u,{headers:{"Content-Type":"multipart/form-data"}})).data;if(E.status===200){const r={id:E.data.id};f("uploadSuccess",r)}const e={uid:l.uid,name:l.name,status:"done",url:E.thumb};i.value=[e],s(E,l)}catch(g){console.error(g),v(g)}},Y=async l=>{};function T(l){const s=l.name||"imagen-cargada",v={uid:"-1",name:s,status:"done",url:l.url};i.value=[v],a.value=l.url,m.value=s}return P(()=>{n.imageLoad&&T(n.imageLoad)}),B(()=>n.imageLoad,l=>{l?T(l):(i.value=[],a.value="",m.value="")}),(l,s)=>{const v=R("a-upload"),u=R("a-modal");return h(),I("div",de,[y(v,{"file-list":i.value,"onUpdate:fileList":s[0]||(s[0]=g=>i.value=g),"custom-request":F,"before-upload":_,"on-remove":Y,accept:c.acceptFormats.join(","),"list-type":"picture-card",onPreview:t},{default:b(()=>[i.value.length<n.maxImages?(h(),I("div",ce,[y(q(oe)),s[1]||(s[1]=x("div",{style:{"margin-top":"8px"}},"Cargar",-1))])):A("",!0)]),_:1},8,["file-list","accept"]),y(u,{open:N.value,title:m.value,footer:null,onCancel:C},{default:b(()=>[x("img",{alt:"example",style:{width:"100%"},src:a.value},null,8,me)]),_:1},8,["open","title"])])}}},pe=te(ue,[["__scopeId","data-v-2af5f06b"]]);const fe={class:"fairs"},ge={key:0},Ee={__name:"DrawerFeria",props:["info"],emits:["closeDraw"],setup(c,{emit:d}){w.locale("es");const n=o({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},subTitle:{type:"iText",label:"SUBTÍTULO DEL EVENTO (Opcional)",name:"subTitle",required:!1,message:"Escribir subtítulo del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},fairtype_id:{type:"iSelect",label:"TIPO DE EVENTO",name:"fairtype_id",required:!0,message:"Seleccionar tipo de Evento",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DEL EVENTO",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},place:{type:"iText",label:"LUGAR DEL EVENTO",name:"place",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: PRODUCE 2"},fecha:{type:"iText",label:"FECHA DEL EVENTO",name:"fecha",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: Lunes: 12 de mayo"},hours:{type:"iText",label:"HORARIO DEL EVENTO",name:"hours",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm"},messageImgBanner:{type:"iLabel",label:"IMAGEN PARA EL BANER",name:"messageImgBanner"},imgBanner:{type:"iSlot",name:"iSlotOptions"},messageEndForm:{type:"iLabel",label:"CONFIGURACIÓN DE MENSAJES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE DE CIERRE DE INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const f=d,i=c,N=o("GUARDAR"),a=j({}),m=o(!1),D=o(null),t=ae(),C=o(null),_=o({city_id:[],fairtype_id:[],modality_id:[]}),F=()=>i.info?{name:i.info.image.name,url:i.info.image.url}:null,Y=e=>{},T=async e=>{e=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),n.value.dateTramite.disabled=!1)},l=async e=>{D.value=e.id},s=async e=>{e=="city_id"&&(await t.fetchCitiesNational(),a.city_id=null,_.value.city_id=t.citiesNational),e=="fairtype_id"&&(await t.fetchFairTypes(),_.value.fairtype_id=t.fairTypes),e=="modality_id"&&(await t.fetchModalities(),_.value.modality_id=t.modalities)},v=e=>{},u=async()=>{m.value=!0;const e={title:a.title,subTitle:a.subTitle,description:a.description,fairtype_id:a.fairtype_id,modality_id:a.modality_id,startDate:w(a.dates.start).format("YYYY-MM-DD"),endDate:w(a.dates.end).format("YYYY-MM-DD"),metaMypes:a.metaMypes,city_id:a.city_id,fecha:a.fecha,place:a.place,hours:a.hours,msgEndForm:a.msgEndForm,msgSendEmail:a.msgSendEmail,image_id:D.value};try{const r=i.info?`fair/update/${i.info.id}`:"fair/create",p=i.info?"PUT":"POST",M=await $({url:r,method:p,data:e});M.status===200&&(Z.success(M.message),g(),f("closeDraw",!0))}catch(r){console.error("Error:",r);const p=document.getElementsByClassName("ant-drawer-body")[0];p&&(p.scrollTop=0)}finally{m.value=!1}},g=()=>{a.title=null,a.subTitle=null,a.description="</p>",a.fairtype_id=null,a.modality_id=null,a.dates=null,a.metaMypes=null,a.city_id=null,a.place=null,a.hours=null,a.msgEndForm="</p>",a.msgSendEmail="</p>"},E=async e=>{e&&(a.title=e.title,a.subTitle=e.subTitle,a.description=e.description,await t.fetchFairTypes(),_.value.fairtype_id=t.fairTypes,a.fairtype_id=e.fairtype_id,await t.fetchModalities(),_.value.modality_id=t.modalities,a.modality_id=e.modality_id,a.dates={start:w(e.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:w(e.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},a.metaMypes=e.metaMypes,await t.fetchCitiesNational(),_.value.city_id=t.citiesNational,a.city_id=e.city_id,a.fecha=e.fecha,a.place=e.place,a.hours=e.hours,a.msgEndForm=e.msgEndForm||"</p>",a.msgSendEmail=e.msgSendEmail||"</p>")};return P(()=>{i.info&&E(i.info)}),B(()=>i.info,e=>{e?E(e):g()}),L("formState",a),L("loadingState",m),(e,r)=>(h(),I("div",fe,[y(ee,{fields:n.value,options:_.value,btnSaveName:N.value,onHandleInputEvent:Y,resetSelect:C.value,onHandleFocusSelect:s,onHandleBlurSelect:v,onHandleChangeClock:T,onOnSubmit:u},{default:b(({field:p})=>[p.name=="iSlotOptions"?(h(),I("div",ge,[y(pe,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:l,imageLoad:F()},null,8,["imageLoad"])])):A("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const ye={class:"advisory-table"},_e=["onClick"],ve={key:0,style:{"line-height":"1.5"}},he={key:1},Se=["onClick"],be=["onClick"],Ae={__name:"IndexFerias",setup(c){JSON.parse(localStorage.getItem("role"));const d=o([]),n=o(0),f=o(150),i=o(!1);o(!1);const N=X(),a=o(!1),m=o(null),D=o(!1),t=j({year:w("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),C=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:200},{title:"SUB TÍTULO DEL EVENTO",dataIndex:"subTitle",width:200},{title:"TIPO DE FERIA",dataIndex:"fairtype_name",width:150,align:"center"},{title:"MODALIDAD",dataIndex:"modality_name",width:140,align:"center"},{title:"FECHAS",dataIndex:"date",width:160,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:120,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:120,align:"center"},{title:"REGIÓN",dataIndex:"city_name",width:150,align:"center"},{title:"LUGAR",dataIndex:"place",width:150,align:"center"},{title:"HORARIO",dataIndex:"hours",width:150,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description3",width:360},{title:"MENSAJE DE FINALIZACIÓN",dataIndex:"msgEndForm3",width:360},{title:"MENSAJE DE ENVÍO CORREO",dataIndex:"msgSendEmail3",width:360},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],_=o([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]),F=e=>{console.log("lalala",e);let r=null;return e.fairtype_id==1&&(r=`https://inscripcion.soporte-pnte.com/sed/${e.slug}`,window.open(r,"_blank")),r},Y=e=>{N.push(`/admin/ferias/inscritos/${e.slug}`)},T=e=>{m.value=e,i.value=!0},l=()=>{E(),i.value=!1},s=()=>{m.value=null,i.value=!0},v=async()=>{D.value=!0;try{const e={};t.year&&(e.year=w(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby),t.asesor&&(e.asesor=t.asesor),await le("download/attendance-ugo","eventos-ugo",e)}catch(e){console.error("Error de red:",e)}finally{D.value=!1}},u=async e=>{t.page=e,await E()},g=async e=>{e&&(t.page=1,await E())},E=async()=>{try{a.value=!0;const e={page:t.page};t.year&&(e.year=w(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby);const p=await $({url:"fair/list",method:"GET",params:e});d.value=p.data.data,n.value=p.data.total,f.value=p.data.per_page}catch(e){console.error("Error de red:",e)}finally{a.value=!1}};return P(async()=>{await E()}),L("search",t),L("loading",a),L("loadingFile",D),(e,r)=>{const p=R("a-tag"),M=R("a-menu-item"),G=R("a-drawer");return h(),I("div",ye,[y(z,{title:"LISTA DE EVENTOS UGSE",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:C,othersList:_.value,titleSearch:"BUSCAR POR EVENTO",pageSize:f.value,nameTotal:"Eventos UGSE",dataSource:d.value,total:n.value,onHandleNew:s,onHandleDownloadExcel:v,onHandleSearch:g,onHandlePaginator:u},{"data-cell":b(({column:O,record:S})=>[O.dataIndex=="link"?(h(),I("a",{key:0,onClick:Ie=>F(S),href:"javascript:void(0)",target:"_blank"},[y(q(ie),{style:{"font-size":"18px"}})],8,_e)):A("",!0),O.dataIndex=="date"?(h(),I(K,{key:1},[S.startDate!=S.endDate?(h(),I("span",ve,[r[1]||(r[1]=x("b",null,"Desde:",-1)),U(" "+V(S.dateStartFormat)+" ",1),r[2]||(r[2]=x("b",null,"Hasta:",-1)),U(" "+V(S.dateEndFormat),1)])):(h(),I("span",he,V(S.dateStartFormat),1))],64)):A("",!0),O.dataIndex=="registered"?(h(),W(p,{key:2,color:"processing"},{default:b(()=>[U(V(S.registered),1)]),_:2},1024)):A("",!0)]),"custom-options":b(({record:O})=>[y(M,null,{default:b(()=>[x("a",{onClick:S=>Y(O)},"Inscritos",8,Se)]),_:2},1024),y(M,null,{default:b(()=>[x("a",{onClick:S=>T(O)},"Editar",8,be)]),_:2},1024)]),_:1},8,["othersList","pageSize","dataSource","total"]),y(G,{open:i.value,"onUpdate:open":r[0]||(r[0]=O=>i.value=O),title:m.value?"EDITAR EVENTO UGSE":"REGISTRAR UN EVENTO",placement:"right",width:"550"},{default:b(()=>[y(Ee,{onCloseDraw:l,info:m.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Ae as default};
