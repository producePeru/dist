import{r as j,u as D}from"./xlsx-04f2268f.js";import{r as m,a as O,k as R,b as f,o as r,d as _,c as y,w as v,e as a,j as h,t as b,z as w,m as k,s as E,i as S,y as T,F as I,v as M,h as C}from"./index-0c10d00d.js";import{F as P}from"./FileExcelOutlined-ba6ea42f.js";import{M as U}from"./MailOutlined-896600a1.js";const q={class:"email-wrapper"},z={style:{display:"flex","justify-content":"space-between"}},G={class:"email-list"},$={key:0},H={style:{display:"flex",gap:"10px","align-items":"center"}},J={style:{color:"#00a6db"}},Z={__name:"capacitaciones-provincia",setup(K){const i=m(!1),A=m([]),s=m([]),o=m(null),N=O({message:""}),F=async t=>{const e=["xls","xlsx"],c=t.name.split(".").pop().toLowerCase();if(!e.includes(c))return alert("Por favor, sube un archivo en formato Excel (.xls o .xlsx)."),!1;const u=new FileReader;return u.onload=g=>{const x=new Uint8Array(g.target.result),l=j(x,{type:"array"}),d=l.Sheets[l.SheetNames[0]],p=D.sheet_to_json(d);s.value=p.map(n=>n.Email).filter(n=>!!n)},u.readAsArrayBuffer(t),!1},B=async()=>{i.value=!0;const t={emails:s.value,message:N.message};try{const e=await k({url:"automatic/correos-sed",method:"POST",data:t});e.status==200&&(C.success(e.message),s.value=[])}catch(e){C.error("error"),console.log("error",e)}finally{i.value=!1}},L=async()=>{try{const e=await k({url:"email/pp03/provincia/capacitaciones_tuempresa@produce.gob.pe",method:"GET"});o.value=e.data[0]}catch(t){console.error("Error de red:",t)}finally{i.value=!1}};return R(async()=>{await L()}),(t,e)=>{var l,d,p;const c=f("a-button"),u=f("a-upload"),g=f("a-card"),x=f("a-image");return r(),_("div",q,[y(g,{title:"SED"},{default:v(()=>[a("div",z,[y(u,{"before-upload":F,"file-list":A.value,"show-upload-list":!1,accept:".xls,.xlsx"},{default:v(()=>[y(c,{type:"primary",icon:E(S(P)),style:{"background-color":"#006e37"}},{default:v(()=>e[0]||(e[0]=[h(" SELECCIONAR LISTA ")])),_:1},8,["icon"])]),_:1},8,["file-list"]),s.value.length>=1?(r(),T(c,{key:0,onClick:B,loading:i.value,class:"email-btn-send",type:"primary",icon:E(S(U))},{default:v(()=>e[1]||(e[1]=[h("ENVIAR")])),_:1},8,["loading","icon"])):w("",!0)]),e[2]||(e[2]=a("br",null,null,-1)),a("div",G,[a("ol",null,[(r(!0),_(I,null,M(s.value,(n,V)=>(r(),_("li",{key:V},b(n),1))),128))])])]),_:1}),o.value?(r(),_("div",$,[a("p",null,[e[3]||(e[3]=h("Correo: ")),a("b",null,b((l=o.value)==null?void 0:l.emailAccount),1)]),a("div",H,[e[4]||(e[4]=a("p",null,"Cantidad: ",-1)),a("h3",J,b((d=o.value)==null?void 0:d.count),1)]),y(x,{width:200,src:(p=o.value)==null?void 0:p.image},null,8,["src"])])):w("",!0)])}}};export{Z as default};
