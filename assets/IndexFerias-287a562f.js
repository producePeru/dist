import{_ as J}from"./TableComponent-883a2f1e.js";import{c as y,A as Q,r as o,j as k,X as q,b as A,o as v,d as D,w as b,h as B,e as T,y as F,K as Z,l as w,a as $,a6 as L,R as G,m as X,u as K,F as W,i as P,t as V,x as U}from"./index-7e9acb77.js";import{_ as ee}from"./FormComponent-b7237ebc.js";import{u as ae}from"./selectes-a3dddb5f.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./es-9e9e6cdd.js";import{d as le}from"./downloadExcel-431bd710.js";import{C as ie}from"./CloudUploadOutlined-0d19f1f2.js";import"./icoexcel-1b303edf.js";import"./UploadOutlined-0ed0ebd7.js";import"./MoreOutlined-2b91a63f.js";import"./quill.snow-a1b71635.js";var ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"};const se=ne;function j(c){for(var d=1;d<arguments.length;d++){var n=arguments[d]!=null?Object(arguments[d]):{},g=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(g=g.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),g.forEach(function(i){re(c,i,n[i])})}return c}function re(c,d,n){return d in c?Object.defineProperty(c,d,{value:n,enumerable:!0,configurable:!0,writable:!0}):c[d]=n,c}var H=function(d,n){var g=j({},d,n.attrs);return y(Q,j({},g,{icon:se}),null)};H.displayName="FileImageOutlined";H.inheritAttrs=!1;const oe=H;const de={class:"clearfix"},ce={key:0},me=["src"],ue={__name:"UpImage",props:{acceptFormats:{type:Array,default:()=>["image/jpeg","image/png","image/jpg","image/gif","image/webp"]},maxImages:{type:Number,default:1},imageLoad:{type:Object,default:()=>null}},emits:["uploadSuccess"],setup(c,{emit:d}){const n=c,g=d,i=o([]),O=o(!1),a=o(""),m=o(""),N=l=>new Promise((s,h)=>{const u=new FileReader;u.readAsDataURL(l),u.onload=()=>s(u.result),u.onerror=E=>h(E)}),t=async l=>{var s;!l.url&&!l.preview&&(l.preview=await N(l.originFileObj)),a.value=l.url||l.preview,O.value=!0,m.value=l.name||((s=l.url)==null?void 0:s.substring(l.url.lastIndexOf("/")+1))},Y=()=>{O.value=!1,m.value=""},_=l=>n.acceptFormats.includes(l.type)?i.value.length<n.maxImages:(alert("Formato de imagen no permitido."),!1),R=async({file:l,onSuccess:s,onError:h})=>{const u=new FormData;u.append("file",l),u.append("from_origin","feria");try{const p=(await Z.post("http://127.0.0.1:8000/api/image/upload-image",u,{headers:{"Content-Type":"multipart/form-data"}})).data;if(p.status===200){const r={id:p.data.id};g("uploadSuccess",r)}const e={uid:l.uid,name:l.name,status:"done",url:p.thumb};i.value=[e],s(p,l)}catch(E){console.error(E),h(E)}},M=async l=>{};function x(l){const s=l.name||"imagen-cargada",h={uid:"-1",name:s,status:"done",url:l.url};i.value=[h],a.value=l.url,m.value=s}return k(()=>{n.imageLoad&&x(n.imageLoad)}),q(()=>n.imageLoad,l=>{l?x(l):(i.value=[],a.value="",m.value="")}),(l,s)=>{const h=A("a-upload"),u=A("a-modal");return v(),D("div",de,[y(h,{"file-list":i.value,"onUpdate:fileList":s[0]||(s[0]=E=>i.value=E),"custom-request":R,"before-upload":_,"on-remove":M,accept:c.acceptFormats.join(","),"list-type":"picture-card",onPreview:t},{default:b(()=>[i.value.length<n.maxImages?(v(),D("div",ce,[y(B(oe)),s[1]||(s[1]=T("div",{style:{"margin-top":"8px"}},"Cargar",-1))])):F("",!0)]),_:1},8,["file-list","accept"]),y(u,{open:O.value,title:m.value,footer:null,onCancel:Y},{default:b(()=>[T("img",{alt:"example",style:{width:"100%"},src:a.value},null,8,me)]),_:1},8,["open","title"])])}}},pe=te(ue,[["__scopeId","data-v-2af5f06b"]]);const fe={class:"fairs"},ge={key:0},Ee={__name:"DrawerFeria",props:["info"],emits:["closeDraw"],setup(c,{emit:d}){w.locale("es");const n=o({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},fairtype_id:{type:"iSelect",label:"TIPO DE EVENTO",name:"fairtype_id",required:!0,message:"Seleccionar tipo de Evento",disabled:!1},modality_id:{type:"iSelect",label:"MODALIDAD DEL EVENTO",name:"modality_id",required:!0,message:"Seleccionar la modalidad",disabled:!1},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},place:{type:"iText",label:"LUGAR DEL EVENTO",name:"place",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: PRODUCE 2"},fecha:{type:"iText",label:"FECHA DEL EVENTO",name:"fecha",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: Lunes: 12 de mayo"},hours:{type:"iText",label:"HORARIO DEL EVENTO",name:"hours",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm"},messageImgBanner:{type:"iLabel",label:"IMAGEN PARA EL BANER",name:"messageImgBanner"},imgBanner:{type:"iSlot",name:"iSlotOptions"},messageEndForm:{type:"iLabel",label:"CONFIGURACIÓN DE MENSAJES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE DE CIERRE DE INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const g=d,i=c,O=o("GUARDAR"),a=$({}),m=o(!1),N=o(null),t=ae(),Y=o(null),_=o({city_id:[],fairtype_id:[],modality_id:[]}),R=()=>i.info?{name:i.info.image.name,url:i.info.image.url}:null,M=e=>{},x=async e=>{e=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),n.value.dateTramite.disabled=!1)},l=async e=>{N.value=e.id},s=async e=>{e=="city_id"&&(await t.fetchCitiesNational(),a.city_id=null,_.value.city_id=t.citiesNational),e=="fairtype_id"&&(await t.fetchFairTypes(),_.value.fairtype_id=t.fairTypes),e=="modality_id"&&(await t.fetchModalities(),_.value.modality_id=t.modalities)},h=e=>{},u=async()=>{m.value=!0;const e={title:a.title,subTitle:a.subTitle,description:a.description,fairtype_id:a.fairtype_id,modality_id:a.modality_id,startDate:w(a.dates.start).format("YYYY-MM-DD"),endDate:w(a.dates.end).format("YYYY-MM-DD"),metaMypes:a.metaMypes,city_id:a.city_id,fecha:a.fecha,place:a.place,hours:a.hours,msgEndForm:a.msgEndForm,msgSendEmail:a.msgSendEmail,image_id:N.value};try{const r=i.info?`fair/update/${i.info.id}`:"fair/create",f=i.info?"PUT":"POST",C=await G({url:r,method:f,data:e});C.status===200&&(X.success(C.message),E(),g("closeDraw",!0))}catch(r){console.error("Error:",r);const f=document.getElementsByClassName("ant-drawer-body")[0];f&&(f.scrollTop=0)}finally{m.value=!1}},E=()=>{a.title=null,a.subTitle=null,a.description="</p>",a.fairtype_id=null,a.modality_id=null,a.dates=null,a.metaMypes=null,a.city_id=null,a.place=null,a.hours=null,a.msgEndForm="</p>",a.msgSendEmail="</p>"},p=async e=>{e&&(a.title=e.title,a.subTitle=e.subTitle,a.description=e.description,await t.fetchFairTypes(),_.value.fairtype_id=t.fairTypes,a.fairtype_id=e.fairtype_id,await t.fetchModalities(),_.value.modality_id=t.modalities,a.modality_id=e.modality_id,a.dates={start:w(e.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:w(e.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},a.metaMypes=e.metaMypes,await t.fetchCitiesNational(),_.value.city_id=t.citiesNational,a.city_id=e.city_id,a.fecha=e.fecha,a.place=e.place,a.hours=e.hours,a.msgEndForm=e.msgEndForm||"</p>",a.msgSendEmail=e.msgSendEmail||"</p>")};return k(()=>{i.info&&p(i.info)}),q(()=>i.info,e=>{e?p(e):E()}),L("formState",a),L("loadingState",m),(e,r)=>(v(),D("div",fe,[y(ee,{fields:n.value,options:_.value,btnSaveName:O.value,onHandleInputEvent:M,resetSelect:Y.value,onHandleFocusSelect:s,onHandleBlurSelect:h,onHandleChangeClock:x,onOnSubmit:u},{default:b(({field:f})=>[f.name=="iSlotOptions"?(v(),D("div",ge,[y(pe,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:l,imageLoad:R()},null,8,["imageLoad"])])):F("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const ye={class:"advisory-table"},_e=["onClick"],he={key:0,style:{"line-height":"1.5"}},ve={key:1},Se=["onClick"],be=["onClick"],Ie=["href"],Ve={__name:"IndexFerias",setup(c){JSON.parse(localStorage.getItem("role"));const d=o([]),n=o(0),g=o(150),i=o(!1);o(!1);const O=K(),a=o(!1),m=o(null),N=o(!1),t=$({year:w("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),Y=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:150},{title:"TIPO DE FERIA",dataIndex:"fairtype_name",width:150,align:"center"},{title:"MODALIDAD",dataIndex:"modality_name",width:140,align:"center"},{title:"FECHAS INSCRIPCIONES",dataIndex:"date",width:150,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:120,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:120,align:"center"},{title:"FECHA DEL EVENTO",dataIndex:"fecha",width:150,align:"center"},{title:"LUGAR EVENTO",dataIndex:"place",width:150,align:"center"},{title:"HORARIO EVENTO",dataIndex:"hours",width:130,align:"center"},{title:"REGIÓN",dataIndex:"city_name",width:150,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description3",width:360},{title:"MENSAJE DE FINALIZACIÓN",dataIndex:"msgEndForm3",width:360},{title:"MENSAJE DE ENVÍO CORREO",dataIndex:"msgSendEmail3",width:360},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],_=o([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]),R=e=>{let r=null;return e.fairtype_id==1&&(r=`https://inscripcion.soporte-pnte.com/sed/${e.slug}`,window.open(r,"_blank")),r},M=e=>{O.push(`/admin/ferias/inscritos/${e.slug}`)},x=e=>{m.value=e,i.value=!0},l=()=>{p(),i.value=!1},s=()=>{m.value=null,i.value=!0},h=async()=>{N.value=!0;try{const e={};t.year&&(e.year=w(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby),t.asesor&&(e.asesor=t.asesor),await le("download/attendance-ugo","eventos-ugo",e)}catch(e){console.error("Error de red:",e)}finally{N.value=!1}},u=async e=>{t.page=e,await p()},E=async e=>{e&&(t.page=1,await p())},p=async()=>{try{a.value=!0;const e={page:t.page};t.year&&(e.year=w(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby);const f=await G({url:"fair/list",method:"GET",params:e});d.value=f.data.data,n.value=f.data.total,g.value=f.data.per_page}catch(e){console.error("Error de red:",e)}finally{a.value=!1}};return k(async()=>{await p()}),L("search",t),L("loading",a),L("loadingFile",N),(e,r)=>{const f=A("a-tag"),C=A("a-menu-item"),z=A("a-drawer");return v(),D("div",ye,[y(J,{title:"LISTA DE EVENTOS UGSE",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:Y,othersList:_.value,titleSearch:"BUSCAR POR EVENTO",pageSize:g.value,nameTotal:"Eventos UGSE",dataSource:d.value,total:n.value,btnUpdate:!0,onHandleNew:s,onHandleCallFetchData:p,onHandleDownloadExcel:h,onHandleSearch:E,onHandlePaginator:u},{"data-cell":b(({column:S,record:I})=>[S.dataIndex=="link"?(v(),D("a",{key:0,onClick:De=>R(I),href:"javascript:void(0)",target:"_blank"},[y(B(ie),{style:{"font-size":"18px"}})],8,_e)):F("",!0),S.dataIndex=="date"?(v(),D(W,{key:1},[I.startDate!=I.endDate?(v(),D("span",he,[r[1]||(r[1]=T("b",null,"Desde:",-1)),P(" "+V(I.dateStartFormat)+" ",1),r[2]||(r[2]=T("b",null,"Hasta:",-1)),P(" "+V(I.dateEndFormat),1)])):(v(),D("span",ve,V(I.dateStartFormat),1))],64)):F("",!0),S.dataIndex=="registered"?(v(),U(f,{key:2,color:"processing"},{default:b(()=>[P(V(I.registered),1)]),_:2},1024)):F("",!0)]),"custom-options":b(({record:S})=>[y(C,null,{default:b(()=>[T("a",{onClick:I=>M(S)},"Inscritos",8,Se)]),_:2},1024),y(C,null,{default:b(()=>[T("a",{onClick:I=>x(S)},"Editar",8,be)]),_:2},1024),S.fairtype_id==1?(v(),U(C,{key:0},{default:b(()=>[T("a",{href:`https://inscripcion.soporte-pnte.com/asistencia/${S.slug}`,target:"_blank"},"Asistencia",8,Ie)]),_:2},1024)):F("",!0)]),_:1},8,["othersList","pageSize","dataSource","total"]),y(z,{open:i.value,"onUpdate:open":r[0]||(r[0]=S=>i.value=S),title:m.value?"EDITAR EVENTO UGSE":"REGISTRAR UN EVENTO",placement:"right",width:"550"},{default:b(()=>[y(Ee,{onCloseDraw:l,info:m.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Ve as default};
