import{_ as K}from"./tuempresa-7c20bfb9.js";import{R as Q}from"./ModalRegistroMYPE-3e686bb1.js";import{i as W,r as v,u as X,a as $,s as Z,j,b as _,o as f,d as g,e,c as l,g as c,t as i,w as u,v as ee,m as y,k as m,n as P,F as q,q as O,p as oe,h as te}from"./index-96f21589.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";const r=w=>(oe("data-v-e33c2fc6"),w=w(),te(),w),se={class:"background"},ne={class:"container"},le={class:"questionary"},re={class:"box"},ue=r(()=>e("div",{class:"text-center"},[e("img",{src:K,alt:""}),e("h1",{class:"title"},"Test de entrada")],-1)),ce={class:"box-info-workshop"},ie=r(()=>e("b",null,"Taller: ",-1)),de=r(()=>e("b",null,"Expositor: ",-1)),_e=r(()=>e("b",null,"Fecha del taller:",-1)),pe=r(()=>e("b",null,"Fecha de expiración del cuestionario:",-1)),me={class:"box"},he={key:0,class:"personal-info"},ve=r(()=>e("h4",{class:"c-primary"},"Mis Datos",-1)),fe=r(()=>e("span",{class:"name"},"Nombres y Apellidos: ",-1)),ge=r(()=>e("span",{class:"name"},"Correo electrónico: ",-1)),ye=r(()=>e("span",{class:"name"},"Número de contácto: ",-1)),we=r(()=>e("br",null,null,-1)),be={key:0},ke={class:"box-mensagge"},Ee={class:"box-title"},Te={class:"box"},Se=r(()=>e("span",{class:"box-mensagge"},"Opcional",-1)),xe=r(()=>e("h3",{class:"box-title"},"¿Cómo te enteraste del taller?",-1)),De={class:"box-btn"},$e={__name:"TestEntrada",setup(w){const Y=W(),I=v(null),E=v(!1),T=v(!1),S=v(!1),b=v(null),z=X(),n=$({id:null,exponent:null,idIn:null,idOut:null,dateTestIn:null,dateTestOut:null,title:null,workShopDate:null}),o=$({name:null,email:null,phone:null,ruc:null,dni:null}),s=$({te1:null,te2:null,te3:null,te4:null,te5:null,social:null}),G=Z(()=>ee(n.dateTestIn).format("DD-MM-YYYY")),V=()=>{s.ruc=s.ruc.replace(/\D/g,"")},B=t=>{o.name=t.name_complete,o.email=t.email,o.phone=t.phone,o.ruc=t.ruc,o.dni=t.dni_number},C=async()=>{o.ruc=null,o.dni=null;let t=s.ruc;if(!t)return y.warning("Ingresa el número de RUC");T.value=!0;try{const{data:a}=await m({url:`/data-mype/${t}`,method:"GET"});a.ruc&&(o.ruc=a.ruc,o.name=a.name_complete,o.email=a.email,o.phone=a.phone,o.dni=a.dni_number)}catch(a){if(console.error("Error de red:",a.response.status),o.name=null,o.email=null,o.phone=null,o.dni=null,a.response.status==404)try{const{data:p}=await m({url:`/api-data-mype/${s.ruc}`,method:"GET"}),x={razonSocial:p.razonSocial,numeroDocumento:p.numeroDocumento};I.value=x,E.value=!0}catch(p){y.warning("El número de RUC no es válido"),console.error("Error de red:",p)}}finally{T.value=!1}},L=async()=>{if(o.name==null&&o.dni==null&&o.ruc==null){C(),y.warning("Revisando sus respuestas"),R();return}const t={te1:s.te1,te2:s.te2,te3:s.te3,te4:s.te4,te5:s.te5,social:s.social,ruc_mype:o.ruc,dni_mype:o.dni,workshop_id:n.id};S.value=!0;try{const a=await m({url:`/sending-test-answers/${n.id}`,method:"POST",data:t});y.success(a.message),z.push({name:"enviado"}),await m({url:`/addPoint/${n.id}/${s.social}`,method:"PUT"})}catch(a){console.error("Error:",a.response.data.errors[0])}finally{S.value=!1}},R=()=>{window.scrollTo({top:200,behavior:"smooth"})},A=()=>{y.error("Debes de completar todos los datos"),R()},H=async t=>{try{const{data:a}=await m({url:`/testin/${t}`,method:"GET"});b.value=a}catch(a){console.error("Error de red:",a)}};return j(async()=>{try{const t=await m({url:`/get-workshop-slug/${Y.params.slug}`,method:"GET"});n.id=t.workshop.id,n.exponent=t.workshop.exponent_name,n.idIn=t.workshop.id_in,n.idOut=t.workshop.id_out,n.dateTestIn=t.workshop.test_in_date,n.dateTestOut=t.workshop.test_out_date,n.title=t.workshop.title,n.workShopDate=t.workshop.workshop_date,await H(t.workshop.id)}catch(t){console.error("Error de red:",t)}}),(t,a)=>{const p=_("a-divider"),x=_("a-input-search"),F=_("a-form-item"),U=_("a-button"),k=_("a-radio"),M=_("a-radio-group"),J=_("a-form");return f(),g("div",se,[e("section",ne,[e("div",le,[e("div",re,[ue,l(p),e("div",ce,[e("span",null,[ie,c(i(n.title),1)]),e("span",null,[de,c(i(n.exponent),1)]),e("span",null,[_e,c(" "+i(n.workShopDate),1)]),e("span",null,[pe,c(" "+i(G.value),1)])])]),l(J,{layout:"vertical",model:s,autocomplete:"off",onFinish:L,onFinishFailed:A},{default:u(()=>[e("div",me,[l(F,{class:"search-ruc f-15",name:"ruc",label:"Número de RUC",rules:[{required:!0,message:"Es importante el número de RUC"}]},{default:u(()=>[l(x,{maxlength:15,loading:T.value,size:"large",value:s.ruc,"onUpdate:value":a[0]||(a[0]=h=>s.ruc=h),"enter-button":"",onSearch:C,onInput:V},null,8,["loading","value"])]),_:1}),o.name?(f(),g("div",he,[ve,e("div",null,[fe,e("span",null,i(o.name),1)]),e("div",null,[ge,e("span",null,i(o.email),1)]),e("div",null,[ye,e("span",null,i(o.phone),1)]),we,l(U,null,{default:u(()=>[c("Editar datos")]),_:1})])):P("",!0)]),b.value?(f(),g("div",be,[(f(),g(q,null,O(5,(h,d)=>e("div",{class:"box",key:d},[e("span",ke,"Pregunta "+i(d+1),1),e("h3",Ee,i(b.value["question"+(d+1)]),1),l(F,{name:`te${d+1}`,rules:[{required:!0,message:"Escoge una respuesta"}]},{default:u(()=>[l(M,{class:"group-radios",value:s[`te${d+1}`],"onUpdate:value":N=>s[`te${d+1}`]=N},{default:u(()=>[(f(),g(q,null,O(3,(N,D)=>l(k,{key:D,class:"item-radio",value:D+1},{default:u(()=>[c(i(b.value[`question${d+1}_opt${D+1}`]),1)]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["name"])])),64))])):P("",!0),e("div",Te,[Se,xe,l(M,{class:"group-radios",value:s.social,"onUpdate:value":a[1]||(a[1]=h=>s.social=h)},{default:u(()=>[l(k,{class:"item-radio",value:"rrss"},{default:u(()=>[c("Redes sociales")]),_:1}),l(k,{class:"item-radio",value:"sms"},{default:u(()=>[c("SMS")]),_:1}),l(k,{class:"item-radio",value:"correo"},{default:u(()=>[c("Correo")]),_:1})]),_:1},8,["value"])]),e("div",De,[l(U,{type:"primary","html-type":"submit",size:"large",loading:S.value},{default:u(()=>[c("Enviar respuestas")]),_:1},8,["loading"])])]),_:1},8,["model"])])]),l(Q,{open:E.value,onHandleCloseModal:a[2]||(a[2]=h=>E.value=!1),rucProp:I.value,onHandleSetData:B},null,8,["open","rucProp"])])}}},Me=ae($e,[["__scopeId","data-v-e33c2fc6"]]);export{Me as default};
