import{r as o,u as z,a as j,l as v,j as q,a6 as g,b as m,o as w,d as Q,c as l,w as r,R as E,f as J,e as f,O as K,i as W,x as S,y as N,h as X,a2 as Z,m as T}from"./index-eb3603aa.js";import{_ as ee}from"./TableComponent-06bb58af.js";import{_ as ae}from"./EventosUgo-8b699966.js";import{d as te}from"./downloadExcel-47799232.js";import{g as ne}from"./usePermissions-eb381e2f.js";import"./es-2d8dc67a.js";import{g as oe}from"./publicInscripcion-623ff37e.js";import"./icoexcel-1b303edf.js";import"./selectes-9d31b299.js";import"./MoreOutlined-c6fe206f.js";const re={class:"events-ugo"},se=["onClick"],le=["onClick"],ie=["onClick"],Ee={__name:"list-index",setup(de){JSON.parse(localStorage.getItem("role"));const y=o([]),I=o(0),D=o(150),c=o({}),d=o(!1);z();const p=o(!1),u=o(null),_=o(!1),C=o([]),a=j({year:v("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),k=[{title:"ASESOR",dataIndex:"asesor",fixed:"left",width:180},{title:"DESCRIPCIÓN",dataIndex:"description",width:450},{title:"NOMBRE DE LA ACTIVIDAD",dataIndex:"title",width:220},{title:"INSCRITOS",dataIndex:"attendance_list_count",width:100,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:150},{title:"DISTRITO",dataIndex:"district",width:150},{title:"LUGAR",dataIndex:"address",width:180},{title:"FECHA CREACIÓN",dataIndex:"created_at",width:140,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],O=o([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]);function A(e,t){if(e==3){const n=`${oe()}/fortalece-tu-mercado/${t}`;window.open(n,"_blank")}else{const n=`/asistencias/${t}`;window.open(n,"_blank")}}const R=e=>{u.value=e,d.value=!0},b=()=>{i(),d.value=!1},V=()=>{u.value=null,d.value=!0},M=async e=>{try{const t=await E({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(i(),T.success(t.message))}catch(t){console.error("Error de red:",t)}},$=async e=>{try{const t=await E({url:`attendance/event-finally/${e.id}`,method:"PUT"});t.status==200&&(i(),T.success(t.message))}catch(t){console.error("Error de red:",t)}},F=async()=>{_.value=!0;try{const e={};a.year&&(e.year=v(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor),await te("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{_.value=!1}},L=async e=>{a.page=e,await i()},U=async e=>{e&&(a.page=1,await i())},i=async()=>{try{p.value=!0;const e={page:a.page};a.year&&(e.year=v(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor);const n=await E({url:"attendance/list",method:"GET",params:e});y.value=n.data.data,I.value=n.data.total,D.value=n.data.per_page}catch(e){console.error("Error de red:",e)}finally{p.value=!1}},G=async()=>{try{const e=await J({url:"select/asesores",method:"GET"});e.status==200&&(C.value=e.data)}catch{console.log("Failed to delete")}};return q(async()=>{await i(),c.value=await ne("eventos-ugo-lista"),await G()}),g("search",a),g("loading",p),g("loadingFile",_),(e,t)=>{const n=m("a-menu-item"),B=m("router-link"),H=m("a-popconfirm"),P=m("a-drawer");return w(),Q("div",re,[l(ee,{title:"LISTA EVENTOS UGO",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:k,othersList:O.value,titleSearch:"BUSCAR POR EVENTO",pageSize:D.value,nameTotal:"Eventos UGO",asesoresList:C.value,dataSource:y.value,total:I.value,btnUpdate:!0,onHandleNew:V,onHandleDownloadExcel:F,onHandleSearch:U,permisos:c.value,onHandleCallFetchData:i,onHandlePaginator:L,btnImport:!0},{"custom-options":r(({record:s})=>{var Y,x;return[l(n,null,{default:r(()=>[f("a",{href:"#",onClick:K(h=>A(s.eventsoffice_id,s.slug),["prevent"])}," Ver Link ",8,se)]),_:2},1024),l(n,null,{default:r(()=>[l(B,{to:`inscritos/${s.slug}`},{default:r(()=>t[1]||(t[1]=[W("Inscritos")])),_:2},1032,["to"])]),_:2},1024),l(n,null,{default:r(()=>[f("a",{onClick:h=>R(s)},"Editar",8,le)]),_:2},1024),(Y=c.value)!=null&&Y.can_finish?(w(),S(n,{key:0},{default:r(()=>[f("span",{style:{color:"#ff4d4f"},onClick:h=>$(s)},"Finalizar",8,ie)]),_:2},1024)):N("",!0),(x=c.value)!=null&&x.can_delete?(w(),S(n,{key:1},{default:r(()=>[l(H,{placement:"rightBottom",title:`¿Quieres eliminar ${s.title} ?`,onConfirm:h=>M(s)},{icon:r(()=>[l(X(Z),{style:{color:"red"}})]),default:r(()=>[t[2]||(t[2]=f("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):N("",!0)]}),_:1},8,["othersList","pageSize","asesoresList","dataSource","total","permisos"]),l(P,{open:d.value,"onUpdate:open":t[0]||(t[0]=s=>d.value=s),title:u.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD",placement:"right",width:"550"},{default:r(()=>[l(ae,{onCloseDraw:b,dataRow:u.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{Ee as default};
