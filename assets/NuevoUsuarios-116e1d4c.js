import{K as I,r as f,y as G,a as j,b as d,o as l,d as U,c as p,e as D,w as c,F as q,z,a4 as H,T as y,m as k,D as J,q as o,h as v,s as u,L as K,i as P,p as Q,j as W}from"./index-8a727612.js";import"./es-55f0b379.js";import{u as X}from"./selectes-6be265a6.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const ee={email:{type:"iText",label:"Correo",name:"email",required:!1,email:"email",message:"Escribe el correo del usuario",disabled:!0},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribe el apellido paterno"},lastname:{type:"iText",label:"Apellido paterno",name:"lastname",required:!0,message:"Escribe el apellido paterno"},middlename:{type:"iText",label:"Apellido materno",name:"middlename",required:!0,message:"Escribe el apellido paterno"},documentnumber:{type:"iText",label:"Número de DNI",name:"documentnumber",required:!0,message:"Escribe el apellido paterno",max:8},birthday:{type:"iDate",label:"Fecha de nacimiento",name:"birthday",required:!1,message:"año-mes-día"},phone:{type:"iText",label:"Ingresar número celular",name:"phone",required:!0,message:"Escribe número de documento",disabled:!1,max:9},gender_id:{type:"iSelect",label:"Género",name:"gender_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0},cde_id:{type:"iSelect",label:"CDE",name:"cde_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0},office_id:{type:"iSelect",label:"Oficina",name:"office_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0},role_id:{type:"iSelect",label:"Rol",name:"role_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0}};const ae=g=>(Q("data-v-dd8fb4f9"),g=g(),W(),g),ne=ae(()=>D("h3",null,"REGISTRO DE USUARIO",-1)),te={class:"user"},le={class:"grid-item"},oe="YYYY-MM-DD",se={__name:"NuevoUsuarios",setup(g){I.locale("es");const w=JSON.parse(localStorage.getItem("profile")),t=X();t.$patch({genders:t.genders}),t.$patch({cdes:t.cdes}),t.$patch({Offices:t.Offices}),t.$patch({roles:t.roles}),t.$patch({supervisores:t.supervisores}),t.fetchGenders(),t.fetchCdes(),t.fetchOffices(),t.fetchRoles();const i=f(ee),_=f(null);G();const x=f(!1),C=f(!1),O=f(!1),a=j({name:null,lastname:null,middlename:null,documentnumber:null,birthday:null,sick:2,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:w.user_id,email:null,password:null}),T=()=>{a.name=null,a.lastname=null,a.middlename=null,a.documentnumber=null,_.value=null,a.phone=null,a.gender_id=null,a.cde_id=null,a.office_id=null,a.email=null,a.password=null,a.role_id=null},N=s=>{a[s]=a[s].replace(/\D/g,"")},E=s=>{const r={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0};if(s===2)t.fetchSupervisores(),i.value={...i.value,supervisor_id:r};else{const{supervisor_id:h,...m}=i.value;i.value=m}},F=async()=>{x.value=!0,a.email=a.name.substring(0,2).toLowerCase()+a.lastname.toLowerCase()+"@pnte.com",a.password=a.documentnumber,a.birthday=_.value?I(_.value).format("YYYY-MM-DD"):null;try{const s=await z({url:"user/create",method:"POST",data:a});H.success({title:"La cuenta ha sido registrada",content:y("div",{},[y("br"),y("p",`Correo: ${a.email}`),y("p","Contraseña es el número de DNI ingresado")]),onOk(){T(),k.success(s.message);const{supervisor_id:r,...h}=i.value;i.value=h}})}catch{k.error("No se pudo registrar este usuario")}finally{x.value=!1}},R=()=>{k.error("Debes de completar todos los espacios requeridos")},Y=async s=>{console.log("Hello",s)},$=()=>{a.document_number=a.document_number.replace(/\D/g,"")};return(s,r)=>{const h=d("a-divider"),m=d("a-select"),b=d("a-form-item"),A=d("a-input-search"),S=d("a-input"),L=d("a-date-picker"),V=d("a-button"),M=d("a-form");return l(),U(q,null,[ne,p(h),D("div",te,[p(M,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:F,onFinishFailed:R},{default:c(()=>[D("div",le,[(l(!0),U(q,null,J(i.value,(e,B)=>(l(),U(q,{key:B},[e.type==="iSelect"?(l(),o(b,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[e.name=="gender_id"?(l(),o(m,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:v(t).genders},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="cde_id"?(l(),o(m,{key:1,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:v(t).cdes},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="office_id"?(l(),o(m,{key:2,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:v(t).Offices},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="role_id"?(l(),o(m,{key:3,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:v(t).roles,onChange:E},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="supervisor_id"?(l(),o(m,{key:4,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:v(t).supervisores},null,8,["value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSearch"?(l(),o(b,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:c(()=>[p(A,{maxlength:15,loading:C.value,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,onSearch:Y,onInput:$,disabled:O.value},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iText"?(l(),o(b,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:c(()=>[e.name=="documentnumber"?(l(),o(S,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,onInput:r[0]||(r[0]=n=>N("documentnumber"))},null,8,["value","onUpdate:value","maxlength"])):e.name=="phone"?(l(),o(S,{key:1,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,onInput:r[1]||(r[1]=n=>N("phone"))},null,8,["value","onUpdate:value","maxlength"])):(l(),o(S,{key:2,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"]))]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iDate"?(l(),o(b,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[p(L,{locale:v(K),value:_.value,"onUpdate:value":r[2]||(r[2]=n=>_.value=n),style:{width:"100%"},format:oe},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),p(b,null,{default:c(()=>[p(V,{class:"btn-produce",type:"primary","html-type":"submit",loading:x.value},{default:c(()=>[P("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])],64)}}},me=Z(se,[["__scopeId","data-v-dd8fb4f9"]]);export{me as default};
