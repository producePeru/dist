import{p as m,a6 as D,r as b,G as te,a9 as le,k as oe,b as i,o,d as p,e as l,y as h,w as d,c as n,i as t,ab as ne,t as _,j as N,z as c,s as I,a8 as x,F as L,L as se,O as ie}from"./index-4f077e75.js";import{_ as re}from"./icoexcel-1b303edf.js";import{u as de}from"./selectes-8f1e8a22.js";import"./es-3007cd26.js";import{S as ce}from"./SyncOutlined-6811d69d.js";import{M as ue}from"./MoreOutlined-9e806808.js";const pe={class:"table-component"},me={class:"title-produce"},_e={key:1,class:"title-produce"},he={class:"table-custom-header"},ve={class:"table-filters"},ge={class:"table-filters"},fe={key:0,class:"filter-year"},be={key:1,class:"filter-offices"},ye={key:2,class:"filter-range-date"},ke={key:3,class:"filter-asesor"},we={key:4,class:"filter-asesor"},Se={class:"filter-search"},Ce={key:1},ze={class:"paginator"},Oe="DD/MM/YYYY",Ue={__name:"TableComponent",props:["title","bread","routeBack","btnUpdate","btnImport","permisos","new","textNuevo","columns","search","dataSource","total","placeholderSearch","nameTotal","pageSize","titleSearch","othersList","tipoformalizacion","searchYear","rangeDate","tipooficina","downloadExcel","cityList","heightTable"],emits:["handleNew","handleDownloadExcel","handleSearch","handlePaginator","handleCallFetchData"],setup(v,{emit:T}){m.locale("es");const y=de(),e=v,g=T;JSON.parse(localStorage.getItem("role")),y.$patch({cities:y.cities}),e.cityList&&y.fetchCities();const r=D("search"),E=D("loading"),A=D("loadingFile"),k=b(window.innerHeight-100),w=b({page:1}),B=b(1200),R=b([{label:"Últimos 7 días",value:[m().add(-7,"d"),m()]},{label:"Últimos 14 días",value:[m().add(-14,"d"),m()]},{label:"Último mes",value:[m().add(-30,"d"),m()]}]),P=b([{label:"UGO",value:1},{label:"UGSE",value:2},{label:"TODOS",value:3}]),Y=te(()=>u=>(w.value.page-1)*e.pageSize+u+1),M=()=>{g("handleCallFetchData")},G=()=>{g("handleNew")},H=async()=>{g("handleDownloadExcel")},V=()=>{w.value.page=1,g("handleSearch",!0)},$=u=>{w.value.page=u,g("handlePaginator",u)},S=()=>{if(e.heightTable)return k.value=window.innerHeight-e.heightTable;k.value=window.innerHeight-310},F=(u,a)=>{const C=u.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(C)};return le(()=>{window.removeEventListener("resize",S)}),oe(()=>{window.addEventListener("resize",S),S()}),(u,a)=>{const C=i("router-link"),z=i("a-breadcrumb-item"),j=i("a-breadcrumb"),f=i("a-button"),J=i("a-date-picker"),O=i("a-select"),X=i("a-range-picker"),q=i("a-input"),K=i("a-menu"),Q=i("a-dropdown"),W=i("a-table"),Z=i("a-tag"),ee=i("a-pagination");return o(),p(L,null,[l("div",pe,[v.bread?(o(),h(j,{key:0},{default:d(()=>[n(z,null,{default:d(()=>[n(C,{to:v.routeBack},{default:d(()=>[n(t(ne)),a[7]||(a[7]=l("span",{class:"fs-13"}," Atrás",-1))]),_:1},8,["to"])]),_:1}),n(z,null,{default:d(()=>[l("h3",me,_(e.title),1)]),_:1})]),_:1})):(o(),p("h3",_e,_(e.title),1)),l("div",he,[l("div",ve,[e.new?(o(),h(f,{key:0,type:"primary",onClick:G},{default:d(()=>[N(_(e.textNuevo),1)]),_:1})):c("",!0),v.downloadExcel?(o(),h(f,{key:1,class:"btn-excel",onClick:H,loading:t(A),type:"primary"},{default:d(()=>a[8]||(a[8]=[l("img",{width:"20",src:re},null,-1)])),_:1},8,["loading"])):c("",!0),v.btnUpdate?(o(),h(f,{key:2,icon:I(t(ce)),onClick:M},null,8,["icon"])):c("",!0)]),l("div",ge,[x(u.$slots,"header"),e.searchYear?(o(),p("div",fe,[a[9]||(a[9]=l("small",null,"AÑO",-1)),n(J,{allowClear:!1,value:t(r).year,"onUpdate:value":a[0]||(a[0]=s=>t(r).year=s),picker:"year",placeholder:"Seleccionar año"},null,8,["value"])])):c("",!0),e.tipooficina?(o(),p("div",be,[a[10]||(a[10]=l("small",null,"OFICINA",-1)),n(O,{value:t(r).offices,"onUpdate:value":a[1]||(a[1]=s=>t(r).offices=s),options:P.value},null,8,["value","options"])])):c("",!0),e.rangeDate?(o(),p("div",ye,[a[11]||(a[11]=l("small",null,"POR RANGO DE FECHAS",-1)),n(X,{value:t(r).range,"onUpdate:value":a[2]||(a[2]=s=>t(r).range=s),presets:R.value,format:Oe},null,8,["value","presets"])])):c("",!0),e.cityList?(o(),p("div",ke,[a[12]||(a[12]=l("small",null,"POR REGIÓN",-1)),n(O,{allowClear:!0,value:t(r).city_id,"onUpdate:value":a[3]||(a[3]=s=>t(r).city_id=s),placeholder:"Selecciona región","show-search":"",options:t(y).cities,"filter-option":F},null,8,["value","options"])])):c("",!0),e.othersList?(o(),p("div",we,[a[13]||(a[13]=l("small",null,"ORDENAR POR",-1)),n(O,{allowClear:!0,value:t(r).orderby,"onUpdate:value":a[4]||(a[4]=s=>t(r).orderby=s),placeholder:"Filtrador por:","show-search":"",options:e.othersList,"filter-option":F},null,8,["value","options"])])):c("",!0),e.placeholderSearch?(o(),p(L,{key:5},[l("div",Se,[l("small",null,_(e.titleSearch),1),n(q,{value:t(r).name,"onUpdate:value":a[5]||(a[5]=s=>t(r).name=s),placeholder:e.placeholderSearch},null,8,["value","placeholder"])]),n(f,{class:"filter-search-btn",type:"primary",onClick:V},{default:d(()=>[t(E)?(o(),h(t(se),{key:0})):(o(),p("span",Ce,"BUSCAR"))]),_:1})],64)):c("",!0)])]),n(W,{bordered:"",scroll:{x:B.value,y:k.value},class:"table-pnte",columns:e==null?void 0:e.columns,"data-source":e==null?void 0:e.dataSource,pagination:!1,loading:t(E),size:"small"},{bodyCell:d(({column:s,record:U,index:ae})=>[s.dataIndex=="idx"?(o(),p(L,{key:0},[N(_(Y.value(ae)),1)],64)):c("",!0),x(u.$slots,"data-cell",{column:s,record:U}),s.dataIndex=="actions"?(o(),h(Q,{key:1,trigger:["click"]},{overlay:d(()=>[n(K,null,{default:d(()=>[x(u.$slots,"custom-options",{record:U})]),_:2},1024)]),default:d(()=>[l("a",{class:"ant-dropdown-link",onClick:a[6]||(a[6]=ie(()=>{},["prevent"]))},[n(f,{shape:"circle",icon:I(t(ue)),size:"small"},null,8,["icon"])])]),_:2},1024)):c("",!0)]),_:3},8,["scroll","columns","data-source","loading"])]),l("div",ze,[l("span",null,[n(Z,{color:"blue"},{default:d(()=>[l("b",null,_(e==null?void 0:e.total),1)]),_:1}),N(_(e.nameTotal),1)]),n(ee,{size:"small",total:e==null?void 0:e.total,pageSize:e.pageSize,onChange:$,showSizeChanger:!1},null,8,["total","pageSize"])])],64)}}};export{Ue as _};
