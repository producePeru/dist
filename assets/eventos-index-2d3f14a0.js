import{r as s,a as se,p as x,k as de,X as C,b as d,o as p,d as M,c as r,w as n,m as O,f as ce,s as ue,i as T,z as y,e as m,y as h,a1 as pe,O as me,j as fe,a2 as _e,h as D}from"./index-1ce4b719.js";import{_ as ve}from"./TableComponent-4c388ccb.js";import{_ as Ee}from"./EventosUgo-e6c4e8e1.js";import{d as $}from"./downloadExcel-4fdf0e83.js";import{g as ye}from"./usePermissions-aa526334.js";import"./es-428734aa.js";import{g as F,a as we}from"./publicInscripcion-ebc9ecb9.js";import{F as he}from"./FileExcelOutlined-be3c780d.js";import"./icoexcel-1b303edf.js";import"./selectes-a0a85987.js";import"./SyncOutlined-abbc7ce8.js";import"./MoreOutlined-de2fccfc.js";const De={class:"layout-content"},Ie={key:0},ge={class:"filter-asesor",style:{width:"280px"}},Ae=["onClick"],xe=["onClick"],Ce=["onClick"],Ue={__name:"eventos-index",setup(Oe){const k=s([]),b=s(0),S=s(150),i=s({}),f=s(!1),I=s(!1),w=s(null),u=s(!1),Y=s([]),a=se({year:x("2026","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),U=[{title:"",dataIndex:"copy",fixed:"left",width:50},{title:"TIPO DE ACTIVIDAD",dataIndex:"tipo_actividad",width:180},{title:"NOMBRE DE ACTIVIDAD",dataIndex:"nombre_actividad",width:180},{title:"TEMA DE ACTIVIDAD",dataIndex:"tema",width:180},{title:"NOMBRE DE ENTIDAD ORGANIZADORA",dataIndex:"entidad_aliada",width:180},{title:"ASESOR",dataIndex:"asesor",width:180},{title:"MYPE Y/O EMPRENDEDORES BENEFICIADOS ESPERADOS",dataIndex:"beneficiarios",align:"center",width:180},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:120},{title:"REGIÓN DE LA ACTIVIDAD",dataIndex:"city",width:120},{title:"PROVINCIA DE LA ACTIVIDAD",dataIndex:"province",width:120},{title:"DISTRITO DE LA ACTIVIDAD",dataIndex:"district",width:120},{title:"LUGAR DE LA ACTIVIDAD",dataIndex:"address",width:120},{title:"¿REQUERIRÁ PASAJES?",dataIndex:"pasaje",align:"center",width:100},{title:"MONTO DE GASTOS",dataIndex:"monto",align:"center",width:100},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],P=(e,t)=>{const o=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)};async function z(e,t){const o=G(e,t);await B(o)?D.success("Link copiado"):D.error("No se pudo copiar el link")}function G(e,t){return e===3?`${F()}/fortalece-tu-mercado/${t}`:`${we()}/asistencias/${t}`}async function B(e){var t;try{if((t=navigator.clipboard)!=null&&t.writeText)return await navigator.clipboard.writeText(e),!0;const o=document.createElement("textarea");o.value=e,o.setAttribute("readonly",""),o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select();const _=document.execCommand("copy");return document.body.removeChild(o),_}catch{return!1}}const H=s([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]);function j(e,t){if(e==3){const o=`${F()}/fortalece-tu-mercado/${t}`;window.open(o,"_blank")}else{const o=`/asistencias/${t}`;window.open(o,"_blank")}}const Q=e=>{w.value=e,f.value=!0},q=()=>{c(),f.value=!1},J=()=>{w.value=null,f.value=!0},X=async e=>{try{const t=await O({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(c(),D.success(t.message))}catch(t){console.error("Error de red:",t)}},Z=async e=>{try{const t=await O({url:`attendance/event-finally/${e.id}`,method:"PUT"});t.status==200&&(c(),D.success(t.message))}catch(t){console.error("Error de red:",t)}},K=async()=>{u.value=!0;try{const e={};a.year&&(e.year=x(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor),await $("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{u.value=!1}},W=async()=>{u.value=!0;try{await $("download/all-activities-the-year","Actividades-UGO-2025")}catch(e){console.error("Error de red:",e)}finally{u.value=!1}},ee=async e=>{a.page=e,await c()},te=async e=>{e&&(a.page=1,await c())},c=async()=>{try{I.value=!0;const e={page:a.page};a.year&&(e.year=x(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor);const o=await O({url:"events-ugo/list",method:"GET",params:e});k.value=o.data.data,b.value=o.data.total,S.value=o.data.per_page}catch(e){console.error("Error de red:",e)}finally{I.value=!1}},ae=async()=>{try{const e=await ce({url:"select/asesores",method:"GET"});e.status==200&&(Y.value=e.data)}catch{console.log("Failed to delete")}};return de(async()=>{var e;i.value=await ye("eventos-ugo"),(e=i.value)!=null&&e.can_view_all&&(await c(),await ae())}),C("search",a),C("loading",I),C("loadingFile",u),(e,t)=>{var N,R,L;const o=d("a-button"),_=d("a-select"),oe=d("a-tooltip"),ne=d("a-input-group"),v=d("a-menu-item"),le=d("router-link"),re=d("a-popconfirm"),ie=d("a-drawer");return p(),M("div",De,[r(ve,{title:"LISTA ACTIVIDADES UGO",textNuevo:"NUEVO EVENTO",new:(N=i.value)==null?void 0:N.can_create,searchYear:!0,rangeDate:(R=i.value)==null?void 0:R.can_date_range,btnUpdate:!0,btnImport:!0,downloadExcel:(L=i.value)==null?void 0:L.can_download_reporte,placeholderSearch:"Buscar",columns:U,othersList:H.value,titleSearch:"BUSCAR POR EVENTO",pageSize:S.value,nameTotal:"Actividades UGO",dataSource:k.value,total:b.value,onHandleNew:J,onHandleDownloadExcel:K,onHandleSearch:te,permisos:i.value,onHandleCallFetchData:c,onHandlePaginator:ee},{header:n(()=>[i.value.can_download_everything?(p(),M("div",Ie,[r(o,{loading:u.value,type:"text",icon:ue(T(he)),onClick:W},null,8,["loading","icon"])])):y("",!0),m("div",ge,[t[2]||(t[2]=m("small",null,"POR ASESOR",-1)),r(_,{allowClear:!0,value:a.asesor,"onUpdate:value":t[0]||(t[0]=l=>a.asesor=l),placeholder:"Selecciona Asesor","show-search":"",options:Y.value,"filter-option":P},null,8,["value","options"])])]),"data-cell":n(({column:l,record:E})=>[l.dataIndex=="copy"?(p(),h(ne,{key:0,compact:""},{default:n(()=>[r(oe,{title:"copiar link"},{default:n(()=>[r(o,{type:"text",onClick:g=>z(E.eventsoffice_id,E.slug)},{icon:n(()=>[r(T(pe),{style:{"font-size":"11px"}})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):y("",!0)]),"custom-options":n(({record:l})=>{var E,g,V;return[r(v,null,{default:n(()=>[m("a",{href:"#",onClick:me(A=>j(l.eventsoffice_id,l.slug),["prevent"])}," Ver Link ",8,Ae)]),_:2},1024),r(v,null,{default:n(()=>[r(le,{to:`eventos-inscritos/${l.slug}`},{default:n(()=>t[3]||(t[3]=[fe("Inscritos")])),_:2},1032,["to"])]),_:2},1024),(E=i.value)!=null&&E.can_update?(p(),h(v,{key:0},{default:n(()=>[m("a",{onClick:A=>Q(l)},"Editar",8,xe)]),_:2},1024)):y("",!0),(g=i.value)!=null&&g.can_finish?(p(),h(v,{key:1},{default:n(()=>[m("span",{style:{color:"#ff4d4f"},onClick:A=>Z(l)},"Finalizar",8,Ce)]),_:2},1024)):y("",!0),(V=i.value)!=null&&V.can_delete?(p(),h(v,{key:2},{default:n(()=>[r(re,{placement:"rightBottom",title:`¿Quieres eliminar ${l.title} ?`,onConfirm:A=>X(l)},{icon:n(()=>[r(T(_e),{style:{color:"red"}})]),default:n(()=>[t[4]||(t[4]=m("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):y("",!0)]}),_:1},8,["new","rangeDate","downloadExcel","othersList","pageSize","dataSource","total","permisos"]),r(ie,{open:f.value,"onUpdate:open":t[1]||(t[1]=l=>f.value=l),title:w.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD",placement:"right",width:"550"},{default:n(()=>[r(Ee,{onCloseDraw:q,dataRow:w.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{Ue as default};
