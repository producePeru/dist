import{E as x,r as i,a as le,U as se,x as re,j as ie,b as o,o as u,d as v,e as c,c as t,w as n,i as d,F as g,N as V,v as z,q as p,I as H,h as D,S as de,t as f,a0 as ue,K as ce,m as me}from"./index-b5ab390b.js";import{_ as pe}from"./DrawEventosCalendario-e5ad280d.js";import"./es-3cc9689e.js";import{M as _e}from"./MoreOutlined-7f5904ad.js";const ve={class:"paginator"},ye={__name:"EventosCalendario",setup(ge){x.locale("es");const F=JSON.parse(localStorage.getItem("role"))||[],w=i(!1),y=i(null),C=i(0),I=i(50),h=i({page:0}),T=i(1200),b=i([]),k=i(!1),S=i(window.innerHeight-100),B=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"NOMBRE EVENTO",fixed:"left",dataIndex:"summary",width:100},{title:"FECHA INICIO",dataIndex:"startDate",width:100,align:"center"},{title:"FECHA FIN",dataIndex:"endDate",width:120,align:"center"},{title:"HORARIO",dataIndex:"hours",width:120,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description",width:240},{title:"",dataIndex:"actions",width:30,align:"center",fixed:"right"}],_=le({search:""}),M=a=>F.some(e=>a.includes(e.id)),U=()=>{m(),w.value=!1},A=()=>{y.value=null,w.value=!0},Y=()=>{let a={search:_.search};m(a)},$=()=>{_.search||m()},O=a=>x(a).format("DD/MM/YYYY"),L=(a,e)=>{const l=x(a).format("HH:mm"),E=x(e).format("HH:mm");return l==="00:00"&&E==="00:00"?"Todo el día":`${l} hasta ${E}`},P=a=>{h.value.page=a,m()},N=()=>{S.value=window.innerHeight-330},j=async a=>{try{const e=await V({url:`google/delete-event-pnte/${a.id}/event`,method:"DELETE"});e.status==200&&(m(),me.success(e.message))}catch(e){console.error("Error de red:",e)}},q=se(()=>a=>h.value.page*I.value+a+1),m=async a=>{try{k.value=!0;let e;e=h.value.page==0?"":h.value,e=a?{...e,...a}:e;const l=await V({url:"google/events-pnte/events",method:"GET",params:e});b.value=l==null?void 0:l.data,C.value=l.total,I.value=l.per_page}catch(e){console.error("Error de red:",e)}finally{k.value=!1}};return re(()=>{window.removeEventListener("resize",N)}),ie(()=>{window.addEventListener("resize",N),N(),m()}),(a,e)=>{const l=o("a-button"),E=o("router-link"),R=o("a-col"),Q=o("a-input"),G=o("a-input-group"),J=o("a-row"),K=o("a-popconfirm"),X=o("a-menu-item"),W=o("a-menu"),Z=o("a-dropdown"),ee=o("a-table"),te=o("a-tag"),ae=o("a-pagination"),ne=o("a-drawer");return u(),v(g,null,[c("div",null,[e[7]||(e[7]=c("h3",{class:"title-produce"},"EVENTOS PNTE",-1)),t(J,{style:{margin:"1rem 0"}},{default:n(()=>[t(R,{xs:24,md:12,lg:18},{default:n(()=>[M([5,10,11])?(u(),z(l,{key:0,type:"primary",onClick:A,class:"box-btn-add"},{default:n(()=>e[3]||(e[3]=[d(" NUEVO EVENTO ")])),_:1})):p("",!0),t(E,{to:"/calendario/eventos",target:"_blank",style:{"margin-left":"1rem"}},{default:n(()=>[t(l,{type:"dashed",icon:H(D(de))},{default:n(()=>e[4]||(e[4]=[d("Ver Calendario")])),_:1},8,["icon"])]),_:1})]),_:1}),t(R,{xs:24,md:12,lg:6},{default:n(()=>[t(G,{compact:""},{default:n(()=>[t(Q,{value:_.search,"onUpdate:value":e[0]||(e[0]=r=>_.search=r),style:{width:"calc(100% - 80px)"},onInput:$},null,8,["value"]),t(l,{type:"primary",disabled:_.search==="",onClick:Y},{default:n(()=>e[5]||(e[5]=[d("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),t(ee,{bordered:"",scroll:{x:T.value,y:S.value},class:"table-events-google",columns:B,"data-source":b.value,pagination:!1,loading:k.value,size:"small"},{bodyCell:n(({column:r,record:s,index:oe})=>[r.dataIndex=="idx"?(u(),v(g,{key:0},[d(f(q.value(oe)),1)],64)):p("",!0),r.dataIndex=="startDate"?(u(),v(g,{key:1},[d(f(O(s==null?void 0:s.start)),1)],64)):p("",!0),r.dataIndex=="endDate"?(u(),v(g,{key:2},[d(f(O(s==null?void 0:s.end)),1)],64)):p("",!0),r.dataIndex=="hours"?(u(),v(g,{key:3},[d(f(L(s==null?void 0:s.start,s==null?void 0:s.end)),1)],64)):p("",!0),r.dataIndex=="actions"?(u(),z(Z,{key:4,trigger:["click"]},{overlay:n(()=>[t(W,null,{default:n(()=>[t(X,null,{default:n(()=>[t(K,{placement:"rightBottom",title:"¿Quieres eliminar este evento ?",onConfirm:fe=>j(s)},{icon:n(()=>[t(D(ue),{style:{color:"red"}})]),default:n(()=>[e[6]||(e[6]=c("a",null,"Eliminar",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:n(()=>[c("a",{class:"ant-dropdown-link",onClick:e[1]||(e[1]=ce(()=>{},["prevent"]))},[t(l,{shape:"circle",icon:H(D(_e)),size:"small"},null,8,["icon"])])]),_:2},1024)):p("",!0)]),_:1},8,["scroll","data-source","loading"])]),c("div",ve,[c("span",null,[t(te,{color:"blue"},{default:n(()=>[c("b",null,f(C.value),1)]),_:1}),e[8]||(e[8]=d("Eventos creados"))]),t(ae,{size:"small",total:C.value,pageSize:I.value,onChange:P,showSizeChanger:!1},null,8,["total","pageSize"])]),t(ne,{open:w.value,"onUpdate:open":e[2]||(e[2]=r=>w.value=r),title:y.value?"Editar Evento":"NUEVO EVENTO",placement:"right",width:"450"},{default:n(()=>[t(pe,{onCloseDraw:U,dataRow:y.value,type:"events"},null,8,["dataRow"])]),_:1},8,["open","title"])],64)}}};export{ye as default};
