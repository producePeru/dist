import{r as c,a as ve,p as k,k as fe,W as b,b as r,o as s,d as z,c as i,w as l,m as O,f as ye,e as u,y as d,s as he,i as T,z as h,a1 as Ee,j as U,t as ge,O as we,a2 as De,h as I}from"./index-4d8c910a.js";import{_ as Ie}from"./TableComponent-c0651f2f.js";import{_ as xe}from"./EventosUgo-43cf6c7f.js";import{d as $}from"./downloadExcel-058a6513.js";import{g as Ae}from"./usePermissions-2b91e5fe.js";import"./es-e28260b3.js";import{g as G}from"./publicInscripcion-623ff37e.js";import{F as Ce}from"./FileExcelOutlined-05bc6cb5.js";import"./icoexcel-1b303edf.js";import"./selectes-4cbab4f8.js";import"./SyncOutlined-9965ed00.js";import"./MoreOutlined-434dcd1a.js";const ke={class:"layout-content"},be={style:{margin:".6rem 0 .6rem"}},Oe={class:"stat-box"},Te={class:"stat-box"},Ye={class:"stat-box"},Se={class:"stat-box"},Ne={key:0},Re={class:"draw-filter-item"},Le=["onClick"],Me=["onClick"],Ve=["onClick"],Je={__name:"eventos-index",setup(Fe){const Y=c([]),S=c(0),N=c(150),_=c(null),p=c({}),E=c(!1),x=c(!1),w=c(null),f=c(!1),R=c([]),t=ve({year:k("2026","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),B=[{title:"",dataIndex:"copy",fixed:"left",width:50},{title:"TIPO DE ACTIVIDAD",dataIndex:"tipo_actividad",width:180},{title:"NOMBRE DE ACTIVIDAD",dataIndex:"nombre_actividad",width:180},{title:"TEMA DE ACTIVIDAD",dataIndex:"tema",width:180},{title:"NOMBRE DE ENTIDAD ORGANIZADORA",dataIndex:"entidad_aliada",width:180},{title:"ASESOR",dataIndex:"asesor",width:180},{title:"MYPE Y/O EMPRENDEDORES BENEFICIADOS ESPERADOS",dataIndex:"beneficiarios",align:"center",width:180},{title:"MYPE Y/O EMPRENDEDORES INSCRITOS",dataIndex:"attendance_list_count",align:"center",width:180},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:120},{title:"REGIÓN DE LA ACTIVIDAD",dataIndex:"city",width:120},{title:"PROVINCIA DE LA ACTIVIDAD",dataIndex:"province",width:120},{title:"DISTRITO DE LA ACTIVIDAD",dataIndex:"district",width:120},{title:"LUGAR DE LA ACTIVIDAD",dataIndex:"address",width:120},{title:"FECHA CREACIÓN",dataIndex:"created_at",width:140,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],H=(e,a)=>{const o=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)};async function j(e,a){const o=q(e,a);await Q(o)?I.success("Link copiado"):I.error("No se pudo copiar el link")}function q(e,a){return`${G()}/actividades-ugo/${a}`}async function Q(e){var a;try{if((a=navigator.clipboard)!=null&&a.writeText)return await navigator.clipboard.writeText(e),!0;const o=document.createElement("textarea");o.value=e,o.setAttribute("readonly",""),o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select();const m=document.execCommand("copy");return document.body.removeChild(o),m}catch{return!1}}const W=c([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]);function Z(e,a){const o=`${G()}/actividades-ugo/${a}`;window.open(o,"_blank")}const J=e=>{w.value=e,E.value=!0},K=()=>{v(),E.value=!1},X=()=>{w.value=null,E.value=!0},ee=async e=>{try{const a=await O({url:`attendance/delete/${e.id}`,method:"DELETE"});a.status==200&&(v(),I.success(a.message))}catch(a){console.error("Error de red:",a)}},ae=async e=>{try{const a=await O({url:`attendance/event-finally/${e.id}`,method:"PUT"});a.status==200&&(v(),I.success(a.message))}catch(a){console.error("Error de red:",a)}},te=async()=>{f.value=!0;try{const e={};t.year&&(e.year=k(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby),t.asesor&&(e.asesor=t.asesor),await $("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{f.value=!1}},ne=async()=>{f.value=!0;try{await $("download/all-activities-the-year","Actividades-UGO-2025")}catch(e){console.error("Error de red:",e)}finally{f.value=!1}},oe=async e=>{t.page=e,await v()},le=async e=>{e&&(t.page=1,await v())},v=async()=>{try{x.value=!0;const e={page:t.page};t.year&&(e.year=k(t.year).format("YYYY")),t.range&&(e.dateStart=t.range[0].format("YYYY/MM/DD"),e.dateEnd=t.range[1].format("YYYY/MM/DD")),t.name&&(e.name=t.name),t.orderby&&(e.orderby=t.orderby),t.asesor&&(e.asesor=t.asesor);const o=await O({url:"events-ugo/list",method:"GET",params:e});Y.value=o.data.data,S.value=o.data.total,N.value=o.data.per_page,_.value=o.statisti}catch(e){console.error("Error de red:",e)}finally{x.value=!1}},ie=async()=>{try{const e=await ye({url:"select/asesores",method:"GET"});e.status==200&&(R.value=e.data)}catch{console.log("Failed to delete")}};return fe(async()=>{var e;p.value=await Ae("eventos-ugo"),(e=p.value)!=null&&e.can_view_all&&(await v(),await ie())}),b("search",t),b("loading",x),b("loadingFile",f),(e,a)=>{var M,V,F;const o=r("a-statistic"),m=r("a-skeleton"),D=r("a-col"),se=r("a-row"),L=r("a-button"),re=r("a-select"),de=r("a-tooltip"),ce=r("a-input-group"),ue=r("a-tag"),g=r("a-menu-item"),pe=r("router-link"),_e=r("a-popconfirm"),me=r("a-drawer");return s(),z("div",ke,[i(Ie,{title:"LISTA ACTIVIDADES UGO",textNuevo:"NUEVO",new:(M=p.value)==null?void 0:M.can_create,searchYear:!0,rangeDate:(V=p.value)==null?void 0:V.can_date_range,btnUpdate:!0,btnImport:!0,downloadExcel:(F=p.value)==null?void 0:F.can_download_reporte,placeholderSearch:"Buscar",columns:B,othersList:W.value,titleSearch:"BUSCAR POR EVENTO",pageSize:N.value,nameTotal:"Actividades UGO",dataSource:Y.value,total:S.value,onHandleNew:X,onHandleDownloadExcel:te,onHandleSearch:le,permisos:p.value,onHandleCallFetchData:v,onHandlePaginator:oe,heightTable:440},{statics:l(()=>[u("div",be,[i(se,{gutter:16},{default:l(()=>[i(D,{span:6},{default:l(()=>{var n;return[u("div",Oe,[(n=_.value)!=null&&n.diaria?(s(),d(o,{key:0,title:"Programación diaria",value:_.value.diaria},null,8,["value"])):(s(),d(m,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1}),i(D,{span:6},{default:l(()=>{var n;return[u("div",Te,[(n=_.value)!=null&&n.consolidada?(s(),d(o,{key:0,title:"Programación consolidada",value:_.value.consolidada},null,8,["value"])):(s(),d(m,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1}),i(D,{span:6},{default:l(()=>{var n;return[u("div",Ye,[(n=_.value)!=null&&n.pendiente?(s(),d(o,{key:0,title:"Pendiente para resultado",value:_.value.pendiente},null,8,["value"])):(s(),d(m,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1}),i(D,{span:6},{default:l(()=>{var n;return[u("div",Se,[(n=_.value)!=null&&n.finalizadas?(s(),d(o,{key:0,title:"Finalizadas",value:_.value.finalizadas},null,8,["value"])):(s(),d(m,{key:1,active:"",paragraph:{rows:1}}))])]}),_:1})]),_:1})])]),header:l(()=>[p.value.can_download_everything?(s(),z("div",Ne,[i(L,{loading:f.value,type:"text",icon:he(T(Ce)),onClick:ne},null,8,["loading","icon"])])):h("",!0),u("div",Re,[a[2]||(a[2]=u("span",null,"POR ASESOR",-1)),i(re,{allowClear:!0,value:t.asesor,"onUpdate:value":a[0]||(a[0]=n=>t.asesor=n),placeholder:"Selecciona Asesor","show-search":"",options:R.value,"filter-option":H},null,8,["value","options"])])]),"data-cell":l(({column:n,record:y})=>[n.dataIndex=="copy"?(s(),d(ce,{key:0,compact:""},{default:l(()=>[i(de,{title:"copiar link"},{default:l(()=>[i(L,{type:"text",onClick:A=>j(y.eventsoffice_id,y.slug)},{icon:l(()=>[i(T(Ee),{style:{"font-size":"11px"}})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):h("",!0),n.dataIndex=="attendance_list_count"?(s(),d(ue,{key:1},{default:l(()=>[U(ge(y.attendance_list_count),1)]),_:2},1024)):h("",!0)]),"custom-options":l(({record:n})=>{var y,A,P;return[i(g,null,{default:l(()=>[u("a",{href:"#",onClick:we(C=>Z(n.eventsoffice_id,n.slug),["prevent"])}," Ver Link ",8,Le)]),_:2},1024),i(g,null,{default:l(()=>[i(pe,{to:`eventos-inscritos/${n.slug}`},{default:l(()=>a[3]||(a[3]=[U("Inscritos")])),_:2},1032,["to"])]),_:2},1024),(y=p.value)!=null&&y.can_update?(s(),d(g,{key:0},{default:l(()=>[u("a",{onClick:C=>J(n)},"Editar",8,Me)]),_:2},1024)):h("",!0),(A=p.value)!=null&&A.can_finish?(s(),d(g,{key:1},{default:l(()=>[u("span",{style:{color:"#ff4d4f"},onClick:C=>ae(n)},"Finalizar",8,Ve)]),_:2},1024)):h("",!0),(P=p.value)!=null&&P.can_delete?(s(),d(g,{key:2},{default:l(()=>[i(_e,{placement:"rightBottom",title:`¿Quieres eliminar ${n.title} ?`,onConfirm:C=>ee(n)},{icon:l(()=>[i(T(De),{style:{color:"red"}})]),default:l(()=>[a[4]||(a[4]=u("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):h("",!0)]}),_:1},8,["new","rangeDate","downloadExcel","othersList","pageSize","dataSource","total","permisos"]),i(me,{open:E.value,"onUpdate:open":a[1]||(a[1]=n=>E.value=n),title:w.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD - UGO",placement:"right",width:"550"},{default:l(()=>[i(xe,{onCloseDraw:K,dataRow:w.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{Je as default};
