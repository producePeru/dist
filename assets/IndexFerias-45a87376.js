import{l as S,r as m,E as me,a as le,X as ee,j as ne,b as u,o as i,x as p,w as n,e as h,d as R,F as k,s as ye,c as s,y as c,h as C,M as _e,v as ve,i as x,t as N,R as ae,m as V,u as fe,g as ge,G as be,Z as Ee,a2 as De,O as he,q as we}from"./index-83e70800.js";import{Q as Ie}from"./quill.snow-52908c69.js";import{u as ie}from"./selectes-68e17202.js";import"./es-c19fb304.js";import{C as xe}from"./CloudOutlined-f0d4c718.js";import{M as Re}from"./MoreOutlined-c1194e6e.js";const Se={class:"form-fair"},Ce="DD/MM/YYYY",Te={__name:"DrawerFeria",props:["dataRow"],emits:["closeDraw"],setup(z,{emit:$}){S.locale("es");const _=ie();_.$patch({cities:_.cities}),_.$patch({provinces:_.provinces}),_.$patch({districts:_.districts}),_.fetchCities();const w=m(!1),A={theme:"snow",modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{color:[]},{background:[]}],["clean"]]},contentType:"html"},E=z,M=$;me();const e=le({}),f=m({title:{type:"iText",label:"NOMBRE DE LA EVENTO",name:"title",required:!0,message:"Escribir el nombre de la EVENTO",disabled:!0,max:100},subTitle:{type:"iText",label:"SUBTÍTULO DE LA EVENTO",name:"subTitle",required:!0,message:"Escribir un sub título a la EVENTO",disabled:!0,max:100},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DE LA EVENTO",name:"description",required:!1,message:"Escribir la descripción",disabled:!1},modality:{type:"iSelect",label:"MODALIDAD",name:"modality",required:!0,message:"Seleccionar una opción",disabled:!0},metaMypes:{type:"iNumber",label:"META MYPES PARTICIPANTES",name:"metaMypes",required:!0,message:"Meta MYPEs Participantes",disabled:!0},startDate:{type:"iDate",label:"FECHA INICIO DE LA EVENTO",name:"startDate",required:!0,message:"Seleccionar fecha de Inicio",disabled:!1},endDate:{type:"iDate",label:"FECHA FIN DE LA EVENTO",name:"endDate",required:!0,message:"Seleccionar fecha de Fin",disabled:!1},powerBy:{type:"iSelect",label:"PERTENECE AL",name:"powerBy",required:!0,message:"Seleccionar una opción",disabled:!0},fairtype_id:{type:"iSelect",label:"TIPO DE EVENTO",name:"fairtype_id",required:!0,message:"Seleccionar una opción",disabled:!0},nationalEvent:{type:"iSelect",label:"EVENTO TIPO",name:"nationalEvent",required:!0,message:"Seleccionar región",disabled:!1},city_id:{type:"iSelectWrite",label:"REGIÓN",name:"city_id",required:!1,message:"Seleccionar región",disabled:!1,visible:!1}}),P=[{label:"NACIONAL",value:0},{label:"POR REGIÓN",value:1}],U=[{label:"PRESENCIAL",value:"p"},{label:"VIRTUAL",value:"v"}],L=[{label:"PP093",value:"pp093"},{label:"PUNCHE",value:"punche"},{label:"APNOP",value:"apnop"}],H=[{label:"PERÚ PRODUCE EN MACROEVENTO",value:1},{label:"CYBER WOW",value:2},{label:"MUJER PRODUCE ",value:3},{label:"PERÚ PRODUCE REGIONAL",value:4}],T=t=>y=>{const g=new Date().setHours(0,0,0,0);if(t==="startDate")return y&&y.valueOf()<g;if(t==="endDate"){const o=e.startDate?new Date(e.startDate).setHours(0,0,0,0):null;return y&&(y.valueOf()<g||o&&y.valueOf()<o)}return y&&y.valueOf()<g};ee(()=>e.startDate,t=>{e.endDate&&new Date(t)>new Date(e.endDate)&&(e.endDate=null)}),ee(()=>e.endDate,t=>{e.startDate&&new Date(t)<new Date(e.startDate)&&(e.startDate=null)});const O=(t,y)=>{const g=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return y.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(g)},G=t=>{if(t=="modality")return U;if(t=="powerBy")return L;if(t=="fairtype_id")return H;if(t=="nationalEvent")return P},Q=t=>{t=="nationalEvent"&&(e.nationalEvent!=0?(f.value.city_id.visible=!0,f.value.city_id.required=!0):(f.value.city_id.visible=!1,f.value.city_id.required=!1,e.city_id=null))},F=t=>{e.province_id=null,e.district_id=null,_.fetchProvinces(t)},Y=t=>{e.district_id=null,_.fetchDistricts(t)},q=()=>{e.title=null,e.subTitle=null,e.description="</span>",e.metaMypes=null,e.metaSales=null,e.startDate=null,e.endDate=null,e.modality=null,e.powerBy=null,e.fairtype_id=null,e.city_id=null,e.province_id=null,e.district_id=null},W=async()=>{w.value=!0;const t={title:e.title,subTitle:e.subTitle,description:e.description,metaMypes:e.metaMypes,metaSales:e.metaSales,startDate:S(e.startDate).format("YYYY-MM-DD"),endDate:S(e.endDate).format("YYYY-MM-DD"),modality:e.modality,powerBy:e.powerBy,fairtype_id:e.fairtype_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id};try{const y=E.dataRow?"PUT":"POST",g=E.dataRow?`fair/update/${E.dataRow.id}`:"fair/create",o=await ae({url:g,method:y,data:t});o.status==200&&(V.success(o.message),M("closeDraw"),q()),o.status==500&&(V.error(o.message),q())}catch{V.error("Se presentó un error, los valores son requeridos")}finally{w.value=!1}},j=t=>{const y=e[t]?e[t].trim():"";e[t]=y};function B(t){t&&(e.title=t.title,e.subTitle=t.subTitle,e.description=t.description,e.metaMypes=t.metaMypes,e.metaSales=t.metaSales,e.startDate=t.startDate?S(t.startDate,"DD/MM/YYYY"):null,e.endDate=t.endDate?S(t.endDate,"DD/MM/YYYY"):null,e.modality=t.modality,e.powerBy=t.powerBy,e.fairtype_id=t.fairtype_id,t.city_id?(e.nationalEvent=1,f.value.city_id.visible=!0,f.value.city_id.required=!0,F(t.city_id),e.city_id=t.city_id):(e.nationalEvent=0,e.city_id=null,f.value.city_id.visible=!1,f.value.city_id.required=!1))}return ne(()=>{E.dataRow&&B(E.dataRow)}),ee(()=>E.dataRow,t=>{t?B(t):(q(),e.description='<p><strong style="color: rgb(0, 26, 78);">Lugar:</strong><span style="color: rgb(0, 26, 78);">&nbsp;</span>Centro de Exposiciones Jockey</p><p><strong style="color: rgb(0, 26, 78);">Sectores participantes:</strong></p><ul><li>Textil - confecciones y cuero - calzado relacionados al sector minero.</li></ul><p><strong style="color: rgb(0, 26, 78);">Requisitos:</strong></p><ul><li>RUC activo y habido</li><li>Ser MYPE productora</li><li>Mínimo de 2 años de antigüedad</li><li>Presencia en redes sociales</li><li>Contar con medios de pagos digitales</li><li>Contar con productos de valor agregado</li><li>De preferencia haber realizado ventas anuales mayores a 13 UIT, en el 2022/2023, validado con Reporte Tributario. (PRIORIDAD)</li></ul><p><strong style="color: rgb(0, 26, 78);">Fecha:</strong><span style="color: rgb(0, 102, 204);">&nbsp;</span>Del lunes 28 al jueves 31 de octubre de 2024</p>')}),(t,y)=>{const g=u("a-input"),o=u("a-form-item"),r=u("a-select"),l=u("a-textarea"),v=u("a-input-number"),I=u("a-date-picker"),J=u("a-button"),Z=u("a-form");return i(),p(Z,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:W},{default:n(()=>[h("div",Se,[(i(!0),R(k,null,ye(f.value,(a,X)=>(i(),R(k,{key:X},[a.type==="iText"?(i(),p(o,{key:0,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,max:a.max}]},{default:n(()=>[s(g,{value:e[a.name],"onUpdate:value":d=>e[a.name]=d,maxlength:a.max,onBlur:d=>j(a.name)},null,8,["value","onUpdate:value","maxlength","onBlur"])]),_:2},1032,["name","label","rules"])):c("",!0),a.type==="iSelect"?(i(),p(o,{key:1,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:n(()=>[s(r,{value:e[a.name],"onUpdate:value":d=>e[a.name]=d,options:G(a.name),onChange:d=>Q(a.name)},null,8,["value","onUpdate:value","options","onChange"])]),_:2},1032,["name","label","rules"])):c("",!0),a.type==="iTextarea"?(i(),p(o,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:n(()=>[s(l,{value:e[a.name],"onUpdate:value":d=>e[a.name]=d,rows:3,maxlength:a.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):c("",!0),a.type==="iNumber"?(i(),p(o,{key:3,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:n(()=>[s(v,{value:e[a.name],"onUpdate:value":d=>e[a.name]=d,min:1,max:500,style:{width:"100%"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):c("",!0),a.type==="iQuillEditor"?(i(),p(o,{key:4,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:n(()=>[s(C(Ie),{class:"quill-height-200",content:e[a.name],"onUpdate:content":d=>e[a.name]=d,options:A,contentType:"html"},null,8,["content","onUpdate:content"])]),_:2},1032,["name","label","rules"])):c("",!0),a.type==="iDate"?(i(),p(o,{key:5,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:n(()=>[s(I,{locale:C(_e),value:e[a.name],"onUpdate:value":d=>e[a.name]=d,style:{width:"100%"},format:Ce,placeholder:"día/mes/año","disabled-date":T(a.name)},null,8,["locale","value","onUpdate:value","disabled-date"])]),_:2},1032,["name","label","rules"])):c("",!0),a.type==="iSelectWrite"?(i(),p(o,{key:6,class:"item-max",name:a.name,label:a.label,style:ve({display:a.visible?"block":"none"}),rules:[{required:a.required,message:a.message}]},{default:n(()=>[a.name=="city_id"?(i(),p(r,{key:0,value:e[a.name],"onUpdate:value":d=>e[a.name]=d,options:C(_).cities,"show-search":"","filter-option":O,onChange:F},null,8,["value","onUpdate:value","options"])):c("",!0),a.name=="province_id"?(i(),p(r,{key:1,value:e[a.name],"onUpdate:value":d=>e[a.name]=d,options:C(_).provinces,"show-search":"","filter-option":O,onChange:Y,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0),a.name=="district_id"?(i(),p(r,{key:2,value:e[a.name],"onUpdate:value":d=>e[a.name]=d,options:C(_).districts,"show-search":"","filter-option":O,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):c("",!0)]),_:2},1032,["name","label","style","rules"])):c("",!0)],64))),128))]),s(o,null,{default:n(()=>[s(J,{type:"primary","html-type":"submit",loading:w.value},{default:n(()=>[x(N(z.dataRow?"ACTUALIZAR":"GUARDAR"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])}}};const Oe={key:1},ke=["onClick"],Ae=["onClick"],Ne={class:"paginator"},Ye={__name:"IndexFerias",props:["idConvenio"],setup(z){S.locale("es");const $=fe(),_=JSON.parse(localStorage.getItem("role"))||[];ie(),ge.get("token");const w=m(!1),A=m(null);m(!1),m(null);const E=m(0),M=m(50),e=m({page:0}),f=m(1200),P=m([]),U=m(!1);m(!1),m(!1),m(!1),m(!1),m(null);const L=m(window.innerHeight-100),H=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"FERIA",fixed:"left",dataIndex:"title",width:280},{title:"LINK",dataIndex:"slug",width:100,align:"center"},{title:"META MYPES",dataIndex:"metaMypes",width:120,align:"center"},{title:"INSCRITOS",dataIndex:"countMypes",width:120,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"DÍAS RESTANTES",dataIndex:"dateDiff",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"CREADO POR",dataIndex:"profile",width:170},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],T=le({search:""}),O=r=>_.some(l=>r.includes(l.id)),G=()=>{o(),w.value=!1},Q=r=>{A.value=r,w.value=!0},F=()=>{A.value=null,w.value=!0},Y=r=>{const l=S().startOf("day"),I=S(r).startOf("day").diff(l,"days");return I<=-1?I:I===0?1:I},q=()=>{let r={search:T.search};o(r)},W=()=>{T.search||o()},j=r=>{console.log("Inscriptos"),$.push(`/admin/ferias/inscritos/${r.slug}`)},B=r=>{e.value.page=r,o()},t=()=>{L.value=window.innerHeight-320},y=async r=>{try{const l=await ae({url:`agreement/delete/${r.id}`,method:"DELETE"});l.status==200&&(o(),V.success(l.message))}catch(l){console.error("Error de red:",l)}},g=be(()=>r=>e.value.page*M.value+r+1),o=async r=>{try{U.value=!0;let l;l=e.value.page==0?"":e.value,l=r?{...l,...r}:l;const{data:v}=await ae({url:"fair/list",method:"GET",params:l});P.value=v==null?void 0:v.data,E.value=v.total,M.value=v.per_page}catch(l){console.error("Error de red:",l)}finally{U.value=!1}};return Ee(()=>{window.removeEventListener("resize",t)}),ne(()=>{window.addEventListener("resize",t),t(),o()}),(r,l)=>{const v=u("a-button"),I=u("a-col"),J=u("a-input"),Z=u("a-input-group"),a=u("a-row"),X=u("router-link"),d=u("a-tag"),K=u("a-menu-item"),se=u("a-popconfirm"),oe=u("a-menu"),re=u("a-dropdown"),de=u("a-table"),ue=u("a-pagination"),ce=u("a-drawer");return i(),R(k,null,[h("div",null,[l[9]||(l[9]=h("h3",{class:"title-produce"},"FERIAS EMPRESARIALES",-1)),s(a,{style:{margin:"1rem 0"}},{default:n(()=>[s(I,{xs:24,md:12,lg:18},{default:n(()=>[O([5,10,11])?(i(),p(v,{key:0,type:"primary",onClick:F,style:{"margin-right":".5rem"}},{default:n(()=>l[3]||(l[3]=[x("NUEVA FERIA")])),_:1})):c("",!0)]),_:1}),s(I,{xs:24,md:12,lg:6},{default:n(()=>[s(Z,{compact:""},{default:n(()=>[s(J,{value:T.search,"onUpdate:value":l[0]||(l[0]=D=>T.search=D),style:{width:"calc(100% - 80px)"},onInput:W},null,8,["value"]),s(v,{type:"primary",disabled:T.search==="",onClick:q},{default:n(()=>l[4]||(l[4]=[x("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),s(de,{bordered:"",scroll:{x:f.value,y:L.value},class:"table-fairs",columns:H,"data-source":P.value,pagination:!1,loading:U.value,size:"small"},{bodyCell:n(({column:D,record:b,index:pe})=>[D.dataIndex=="idx"?(i(),R(k,{key:0},[x(N(g.value(pe)),1)],64)):c("",!0),D.dataIndex=="title"?(i(),R(k,{key:1},[x(N(b.title)+" ▪ "+N(b.subTitle),1)],64)):c("",!0),D.dataIndex=="slug"?(i(),p(X,{key:2,to:`/feria/${b.slug}`,target:"_blank"},{default:n(()=>[s(C(xe),{class:"fair-link"})]),_:2},1032,["to"])):c("",!0),D.dataIndex=="modality"?(i(),R(k,{key:3},[b.modality=="p"?(i(),p(d,{key:0,color:"blue"},{default:n(()=>l[5]||(l[5]=[x("PRESENCIAL")])),_:1})):c("",!0),b.modality=="v"?(i(),p(d,{key:1,color:"orange"},{default:n(()=>l[6]||(l[6]=[x("VIRTUAL")])),_:1})):c("",!0)],64)):c("",!0),D.dataIndex=="dateDiff"?(i(),R(k,{key:4},[Y(b.endDate2)<0?(i(),p(d,{key:0,color:"red"},{default:n(()=>l[7]||(l[7]=[x(" FINALIZADO ")])),_:1})):(i(),R("span",Oe,N(Y(b.endDate2)),1))],64)):c("",!0),D.dataIndex=="actions"?(i(),p(re,{key:5,trigger:["click"]},{overlay:n(()=>[s(oe,null,{default:n(()=>[O([5,10,11])?(i(),p(K,{key:0},{default:n(()=>[h("a",{onClick:te=>Q(b)},"Editar",8,ke)]),_:2},1024)):c("",!0),s(K,null,{default:n(()=>[h("a",{onClick:te=>j(b)},"Inscritos",8,Ae)]),_:2},1024),O([5,10,11])?(i(),p(K,{key:1},{default:n(()=>[s(se,{placement:"rightBottom",title:`¿Quieres eliminar ${b.title} ?`,onConfirm:te=>y(b)},{icon:n(()=>[s(C(De),{style:{color:"red"}})]),default:n(()=>[l[8]||(l[8]=h("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):c("",!0)]),_:2},1024)]),default:n(()=>[h("a",{class:"ant-dropdown-link",onClick:l[1]||(l[1]=he(()=>{},["prevent"]))},[s(v,{shape:"circle",icon:we(C(Re)),size:"small"},null,8,["icon"])])]),_:2},1024)):c("",!0)]),_:1},8,["scroll","data-source","loading"])]),h("div",Ne,[h("span",null,[s(d,{color:"blue"},{default:n(()=>[h("b",null,N(E.value),1)]),_:1}),l[10]||(l[10]=x("Ferias Empresariales"))]),s(ue,{size:"small",total:E.value,pageSize:M.value,onChange:B,showSizeChanger:!1},null,8,["total","pageSize"])]),s(ce,{open:w.value,"onUpdate:open":l[2]||(l[2]=D=>w.value=D),title:A.value?"EDITAR EVENTO":"REGISTRAR NUEVO EVENTO",placement:"right",width:"650"},{default:n(()=>[s(Te,{onCloseDraw:G,dataRow:A.value},null,8,["dataRow"])]),_:1},8,["open","title"])],64)}}};export{Ye as default};
