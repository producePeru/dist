import{_ as ee}from"./icoexcel-a1d0882d.js";import{f as ae,r as m,L as te,E as ie,k as ne,b as y,o as n,d as l,e as h,n as N,c as k,w as U,F as d,m as V,M as oe,g as le,i as o,t,s,q as de,p as se,j as re}from"./index-3e84d68c.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";const ue=f=>(se("data-v-9d750746"),f=f(),re(),f),me={class:"header-rep"},pe={class:"filters-dig"},ve=ue(()=>h("img",{width:"20",style:{"margin-right":"6px"},src:ee},null,-1)),_e={class:"paginator"},G=20,he={__name:"AsesoriasLista",setup(f){const j="https://apituempresa.soporte-pnte.com/api/",q="http://127.0.0.1:8000/api/",H=window.location.hostname=="127.0.0.1"?q:j,Z=ae.get("token"),b=m([]),w=m(!1),S=m(!1),C=m(0),u=m({page:0}),c=m("asesorias"),v=m(""),X=m(1200),L=m(window.innerHeight-100),A=()=>{L.value=window.innerHeight-315};te(()=>{window.removeEventListener("resize",A)});const _=m([]),z=m([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:200},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante Email",dataIndex:"sol_email",width:200},{title:"Solicitante Celular",dataIndex:"sol_phone",width:160},{title:"Supervisor",dataIndex:"misupervisor",width:200},{title:"Región",dataIndex:"mype_region",width:140},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Componente",dataIndex:"componente",width:180},{title:"Tema",dataIndex:"tema_componente",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),D=m([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:200},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante Celular",dataIndex:"sol_phone",width:160},{title:"Solicitante Email",dataIndex:"sol_email",width:200},{title:"Supervisor",dataIndex:"misupervisor",width:180},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Detalle del trámite",dataIndex:"detalle_tramite",width:180},{title:"Sector económico",dataIndex:"sector_economico",width:180},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),$=m([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:180},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Código SUNARP",dataIndex:"codesunarp",width:140,align:"center"},{title:"Solicitante Celular",dataIndex:"sol_phone",width:160},{title:"Supervisor",dataIndex:"misupervisor",width:180},{title:"Tipo de formalización",dataIndex:"tipo_formalizacion",width:130},{title:"Sector económico",dataIndex:"sector_economico",width:130},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:160},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Dirección",dataIndex:"mype_direccion",width:230},{title:"Nombre empresa",dataIndex:"mype_nombre",width:180},{title:"Régimen",dataIndex:"tipo_regimen",width:80,align:"center"},{title:"Número de notaría",dataIndex:"numero_envio_notaria",width:140},{title:"Notaría",dataIndex:"notaria",width:150},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"RUC",dataIndex:"ruc",width:100,align:"center"}]),Y=r=>{u.value.page=r,g()},J=async()=>{w.value=!0;let r=null;c.value=="ruc20"&&(u.value.page=0,c.value="ruc20",_.value=$.value,r=`/formalizations-20?search=${v.value}`,v.value==""&&(r="/formalizations-20")),c.value=="ruc10"&&(u.value.page=0,c.value="ruc10",_.value=D.value,r=`/formalizations-10?search=${v.value}`,v.value==""&&(r="/formalizations-10")),c.value=="asesorias"&&(u.value.page=0,c.value="asesorias",_.value=z.value,r=`/asesorias?search=${v.value}`,v.value==""&&(r="/asesorias"));let i=u.value.page==0?"":u.value;const p=await V({url:r,method:"GET",params:i});b.value=p.data,C.value=p.total,w.value=!1},K=async()=>{S.value=!0;const r={};let i="",p="";c.value=="asesorias"&&(i="download-asesorias",p="asesorias.xlsx"),c.value=="ruc10"&&(i="download-formalizations-10",p="formalizacionesRUC10.xlsx"),c.value=="ruc20"&&(i="download-formalizations-20",p="formalizacionesRUC20.xlsx");try{const{data:x}=await oe.post(`${H}/${i}`,r,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${Z}`},responseType:"blob"}),R=new Blob([x]),E=window.URL.createObjectURL(R),I=document.createElement("a");I.href=E,I.download=p,document.body.appendChild(I),I.click(),document.body.removeChild(I)}catch{le.error("Error")}finally{S.value=!1}},g=async r=>{try{w.value=!0;let i="historial/advisories/2";_.value=z.value,r=="asesorias"&&(u.value.page=0,c.value=r,_.value=z.value,i="historial/advisories/2"),r=="ruc10"&&(u.value.page=0,c.value=r,_.value=D.value,i="historial/formalizations-10/2"),r=="ruc20"&&(u.value.page=0,c.value=r,_.value=$.value,i="historial/formalizations-20/2");let p=u.value.page==0?"":u.value;const x=await V({url:i,method:"GET",params:p});b.value=x.data,C.value=x.total}catch(i){console.error("Error de red:",i)}finally{w.value=!1}},Q=ie(()=>r=>((u.value.page==0?1:u.value.page)-1)*G+r+1);return ne(()=>{g(),window.addEventListener("resize",A),A()}),(r,i)=>{const p=y("a-button"),x=y("a-input-search"),R=y("a-tag"),E=y("a-table"),I=y("a-pagination");return n(),l(d,null,[h("div",null,[h("div",me,[h("h3",{class:N({hdactive:c.value=="asesorias"}),onClick:i[0]||(i[0]=a=>g("asesorias"))},"ASESORÍAS",2),h("h3",{class:N({hdactive:c.value=="ruc10"}),onClick:i[1]||(i[1]=a=>g("ruc10"))},"FORMALIZACIONES RUC 10",2),h("h3",{class:N({hdactive:c.value=="ruc20"}),onClick:i[2]||(i[2]=a=>g("ruc20"))},"FORMALIZACIONES RUC 20",2)]),h("div",pe,[k(p,{onClick:K,loading:S.value},{default:U(()=>[ve,o(" DESCARGAR ")]),_:1},8,["loading"]),k(x,{class:"asesorias-search",value:v.value,"onUpdate:value":i[3]||(i[3]=a=>v.value=a),placeholder:"","enter-button":"Buscar",onSearch:J},null,8,["value"])]),k(E,{bordered:"",scroll:{x:X.value,y:L.value},class:"ant-table-striped",columns:_.value,"data-source":b.value,pagination:!1,loading:w.value,size:"small"},{bodyCell:U(({column:a,record:e,index:W})=>{var B,F,M,T,O,P;return[a.dataIndex=="idx"?(n(),l(d,{key:0},[o(t(Q.value(W)),1)],64)):s("",!0),a.dataIndex=="ase_fecha"?(n(),l(d,{key:1},[o(t(e.created_at),1)],64)):s("",!0),a.dataIndex=="reg_nombres"?(n(),l(d,{key:2},[o(t(e.user.profile.name)+" "+t(e.user.profile.lastname)+" "+t(e.user.profile.middlename),1)],64)):s("",!0),a.dataIndex=="sol_apellidos"?(n(),l(d,{key:3},[o(t(e.people.lastname)+" "+t(e.people.middlename),1)],64)):s("",!0),a.dataIndex=="sol_nombres"?(n(),l(d,{key:4},[o(t(e.people.name),1)],64)):s("",!0),a.dataIndex=="sol_email"?(n(),l(d,{key:5},[o(t(e.people.email),1)],64)):s("",!0),a.dataIndex=="sol_phone"?(n(),l(d,{key:6},[o(t(e.people.phone),1)],64)):s("",!0),a.dataIndex=="mype_region"?(n(),l(d,{key:7},[o(t(e.city.name),1)],64)):s("",!0),a.dataIndex=="mype_provincia"?(n(),l(d,{key:8},[o(t(e.province.name),1)],64)):s("",!0),a.dataIndex=="mype_distrito"?(n(),l(d,{key:9},[o(t(e.district.name),1)],64)):s("",!0),a.dataIndex=="componente"?(n(),l(d,{key:10},[o(t(e.component.name),1)],64)):s("",!0),a.dataIndex=="tema_componente"?(n(),l(d,{key:11},[o(t(e.theme.name),1)],64)):s("",!0),a.dataIndex=="detalle_tramite"?(n(),l(d,{key:12},[o(t((B=e.detailprocedure)==null?void 0:B.name),1)],64)):s("",!0),a.dataIndex=="sector_economico"?(n(),l(d,{key:13},[o(t((F=e.economicsector)==null?void 0:F.name),1)],64)):s("",!0),a.dataIndex=="atividad_comercial"?(n(),l(d,{key:14},[o(t((M=e==null?void 0:e.comercialactivity)==null?void 0:M.name),1)],64)):s("",!0),a.dataIndex=="mype_direccion"?(n(),l(d,{key:15},[o(t(e==null?void 0:e.address),1)],64)):s("",!0),a.dataIndex=="mype_nombre"?(n(),l(d,{key:16},[o(t((T=e.mype)==null?void 0:T.name),1)],64)):s("",!0),a.dataIndex=="tipo_regimen"?(n(),l(d,{key:17},[o(t((O=e.regime)==null?void 0:O.name),1)],64)):s("",!0),a.dataIndex=="numero_envio_notaria"?(n(),l(d,{key:18},[o(t(e.numbernotary),1)],64)):s("",!0),a.dataIndex=="notaria"?(n(),l(d,{key:19},[o(t((P=e.notary)==null?void 0:P.name),1)],64)):s("",!0),a.dataIndex=="codesunarp"?(n(),l(d,{key:20},[o(t(e.codesunarp),1)],64)):s("",!0),a.dataIndex==="modality"?(n(),de(R,{key:21,color:e.modality.name=="Presencial"?"green":"orange"},{default:U(()=>[o(t(e.modality.name),1)]),_:2},1032,["color"])):s("",!0)]}),_:1},8,["scroll","columns","data-source","loading"])]),h("div",_e,[k(I,{size:"small",total:C.value,pageSize:G,onChange:Y,showSizeChanger:!1,defaultCurrent:2},null,8,["total"])])],64)}}},ge=ce(he,[["__scopeId","data-v-9d750746"]]);export{ge as default};
