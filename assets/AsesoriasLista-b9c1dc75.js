import{_ as q}from"./icoexcel-a1d0882d.js";import{a as G,r as i,K as Z,Q as K,l as Q,d as v,o as p,e as b,f as r,q as A,c as C,w as h,F as R,L as X,h as Y,m as J,j as u,t as c,v as x,s as k,p as W,k as ee}from"./index-79c492b1.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";const ae=w=>(W("data-v-0fab51b4"),w=w(),ee(),w),ie={class:"header-rep"},oe={class:"filters"},de=ae(()=>r("img",{width:"20",style:{"margin-right":"6px"},src:q},null,-1)),ne={class:"paginator"},U=20,le={__name:"AsesoriasLista",setup(w){const D="https://apituempresa.soporte-pnte.com/api/v1",B="http://127.0.0.1:8000/api/v1",F=window.location.hostname=="127.0.0.1"?B:D,O=G.get("token"),z=i([]),g=i(!1),I=i(!1),N=i(0),l=i({page:0}),o=i("asesorias"),T=i(1200),E=i(window.innerHeight-100),f=()=>{E.value=window.innerHeight-315};Z(()=>{window.removeEventListener("resize",f)});const m=i([]),L=i([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:180},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante género",dataIndex:"sol_genero",width:140,align:"center"},{title:"Solicitante discapacidad",dataIndex:"sol_discapacidad",width:176,align:"center"},{title:"Solicitante telf.",dataIndex:"sol_telefono",width:120,align:"center"},{title:"Solicitante correo",dataIndex:"sol_correo",width:180},{title:"Supervisor",dataIndex:"misupervisor",width:180},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Componente",dataIndex:"componente",width:180},{title:"Tema",dataIndex:"tema_componente",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),M=i([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:180},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante género",dataIndex:"sol_genero",width:140,align:"center"},{title:"Solicitante discapacidad",dataIndex:"sol_discapacidad",width:176,align:"center"},{title:"Solicitante telf.",dataIndex:"sol_telefono",width:120,align:"center"},{title:"Solicitante correo",dataIndex:"sol_correo",width:180},{title:"Supervisor",dataIndex:"misupervisor",width:180},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Detalle del trámite",dataIndex:"detalle_tramite",width:180},{title:"Sector económico",dataIndex:"sector_economico",width:180},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"}]),$=i([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"Fecha",dataIndex:"ase_fecha",fixed:"left",align:"center",width:100},{title:"Asesor",dataIndex:"reg_nombres",width:180},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:180},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:180},{title:"Solicitante género",dataIndex:"sol_genero",width:140,align:"center"},{title:"Solicitante discapacidad",dataIndex:"sol_discapacidad",width:176,align:"center"},{title:"Solicitante telf.",dataIndex:"sol_telefono",width:120,align:"center"},{title:"Solicitante correo",dataIndex:"sol_correo",width:180},{title:"Supervisor",dataIndex:"misupervisor",width:180},{title:"Tipo de formalización",dataIndex:"tipo_formalizacion",width:130},{title:"Sector económico",dataIndex:"sector_economico",width:130},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:160},{title:"Región",dataIndex:"mype_region",width:130},{title:"Provincia",dataIndex:"mype_provincia",width:180},{title:"Distrito",dataIndex:"mype_distrito",width:180},{title:"Dirección",dataIndex:"mype_direccion",width:230},{title:"Nombre empresa",dataIndex:"mype_nombre",width:180},{title:"Régimen",dataIndex:"tipo_regimen",width:80,align:"center"},{title:"Número de notaría",dataIndex:"numero_envio_notaria",width:140},{title:"Notaría",dataIndex:"notaria",width:150},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"RUC",dataIndex:"ruc",width:100,align:"center"}]),V=a=>{l.value.page=a,_()},P=async()=>{I.value=!0;const a={};let e="",s="";o.value=="asesorias"&&(e="download-asesorias",s="asesorias.xlsx"),o.value=="ruc10"&&(e="download-formalizations-10",s="formalizacionesRUC10.xlsx"),o.value=="ruc20"&&(e="download-formalizations-20",s="formalizacionesRUC20.xlsx");try{const{data:d}=await X.post(`${F}/${e}`,a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${O}`},responseType:"blob"}),y=new Blob([d]),S=window.URL.createObjectURL(y),t=document.createElement("a");t.href=S,t.download=s,document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch{Y.error("Error")}finally{I.value=!1}},_=async a=>{try{g.value=!0;let e="/asesorias";m.value=L.value,a=="asesorias"&&(l.value.page=0,o.value=a,m.value=L.value,e="/asesorias"),a=="ruc10"&&(l.value.page=0,o.value=a,m.value=M.value,e="/formalizations-10"),a=="ruc20"&&(l.value.page=0,o.value=a,m.value=$.value,e="/formalizations-20");let s=l.value.page==0?"":l.value;const d=await J({url:e,method:"GET",params:s});z.value=d.data,N.value=d.total}catch(e){console.error("Error de red:",e)}finally{g.value=!1}},H=K(()=>a=>((l.value.page==0?1:l.value.page)-1)*U+a+1);return Q(()=>{_(),window.addEventListener("resize",f),f()}),(a,e)=>{const s=v("a-button"),d=v("a-tag"),y=v("a-table"),S=v("a-pagination");return p(),b(R,null,[r("div",null,[r("div",ie,[r("h3",{class:A({hdactive:o.value=="asesorias"}),onClick:e[0]||(e[0]=t=>_("asesorias"))},"ASESORÍAS",2),r("h3",{class:A({hdactive:o.value=="ruc10"}),onClick:e[1]||(e[1]=t=>_("ruc10"))},"FORMALIZACIONES RUC 10",2),r("h3",{class:A({hdactive:o.value=="ruc20"}),onClick:e[2]||(e[2]=t=>_("ruc20"))},"FORMALIZACIONES RUC 20",2)]),r("div",oe,[C(s,{onClick:P,loading:I.value},{default:h(()=>[de,u(" DESCARGAR ")]),_:1},8,["loading"])]),C(y,{bordered:"",scroll:{x:T.value,y:E.value},class:"ant-table-striped",columns:m.value,"data-source":z.value,pagination:!1,loading:g.value,size:"small"},{bodyCell:h(({column:t,record:n,index:j})=>[t.dataIndex=="idx"?(p(),b(R,{key:0},[u(c(H.value(j)),1)],64)):x("",!0),t.dataIndex=="solName"?(p(),b(R,{key:1},[u(c(n.person.last_name)+" "+c(n.person.middle_name)+", "+c(n.person.name),1)],64)):x("",!0),t.dataIndex==="sol_discapacidad"?(p(),k(d,{key:2,color:n.sol_discapacidad=="NO"?"blue":"pink"},{default:h(()=>[u(c(n.sol_discapacidad),1)]),_:2},1032,["color"])):x("",!0),t.dataIndex==="sol_genero"?(p(),k(d,{key:3,class:"uppercase",color:n.sol_genero=="H"?"default":"error"},{default:h(()=>[u(c(n.sol_genero),1)]),_:2},1032,["color"])):x("",!0),t.dataIndex==="modality"?(p(),k(d,{key:4,color:n.modalidad=="VIRTUAL"?"orange":"green"},{default:h(()=>[u(c(n.modalidad),1)]),_:2},1032,["color"])):x("",!0)]),_:1},8,["scroll","columns","data-source","loading"])]),r("div",ne,[C(S,{size:"small",total:N.value,pageSize:U,onChange:V,showSizeChanger:!1,defaultCurrent:2},null,8,["total"])])],64)}}},pe=te(le,[["__scopeId","data-v-0fab51b4"]]);export{pe as default};
