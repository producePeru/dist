import{_ as $}from"./TableComponent-32216e6f.js";import{p as f,r as n,a as H,k as j,U as B,X as N,o as p,d as _,c as E,w as u,z as D,m as q,h as G,u as J,b as C,i as z,F as Z,e as O,j as R,t as w,y as U}from"./index-53150821.js";import{_ as Q}from"./FormComponent-d65be6f0.js";import{u as K}from"./selectes-cdb60cdc.js";import{U as X}from"./UpImage-ee229c52.js";import"./es-03a6d968.js";import"./downloadExcel-ecb7bcb4.js";import{g as V}from"./publicInscripcion-ebc9ecb9.js";import{C as W}from"./CloudUploadOutlined-d8d47da1.js";import"./icoexcel-1b303edf.js";import"./SyncOutlined-ff6f5519.js";import"./MoreOutlined-b8f3f9c3.js";import"./quill.snow-01741efa.js";import"./_plugin-vue_export-helper-c27b6911.js";const ee={class:"fairs"},ae={key:0},te={__name:"DrawMujerProduce",props:["info"],emits:["closeDraw"],setup(P,{emit:I}){f.locale("es");const h=n({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir descripción del evento",disabled:!1,class:"quill-height-250"},dates:{type:"iDatePicker",label:"SELECCIONAR FECHA DE INICIO Y FIN DE INSCRIPCIÓN DEL EVENTO",name:"dates",required:!0,message:"Seleccionar fecha",disabled:!1},metaMypes:{type:"iNumber",label:"META MYPES PARA ESTE EVENTO",name:"metaMypes",required:!0,message:"Seleccionar la meta MYPES",disabled:!1,rules:[{required:!0,message:"Seleccionar la meta MYPES"},{type:"number",min:1,message:"El valor mínimo debe ser 1"}]},city_id:{type:"iSelect",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},place:{type:"iText",label:"LUGAR DEL EVENTO",name:"place",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: PRODUCE 2"},fecha:{type:"iDate",label:"FECHA DEL EVENTO",name:"fecha",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: Lunes: 12 de mayo"},hours:{type:"iText",label:"HORARIO DEL EVENTO",name:"hours",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm"},messageEndForm:{type:"iLabel",label:"MENSAJES DE INSCRIPCIONES",name:"messageEndForm"},msgEndForm:{type:"iQuillEditor",label:"MENSAJE AL FINALIZAR INSCRIPCIÓN",name:"msgEndForm",required:!0,message:"Escribir mensaje de cierre de inscripción",disabled:!1,class:"quill-height-250"},msgSendEmail:{type:"iQuillEditor",label:"MENSAJE DE ENVÍO DE CORREO",name:"msgSendEmail",required:!0,message:"Escribir mensaje de envío de correo",disabled:!1,class:"quill-height-250"}});JSON.parse(localStorage.getItem("profile"));const T=I,l=P,S=n("GUARDAR"),e=H({}),v=n(!1),i=n(null),r=K(),Y=n(null),d=n({city_id:[],fairtype_id:[],modality_id:[]}),M=()=>l.info?{name:l.info.image.name,url:l.info.image.url}:null,x=a=>{},F=async a=>{a=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),h.value.dateTramite.disabled=!1)},A=async a=>{i.value=a.id},k=async a=>{a=="city_id"&&(await r.fetchCitiesNational(),e.city_id=null,d.value.city_id=r.citiesNational),a=="fairtype_id"&&(await r.fetchFairTypes(),d.value.fairtype_id=r.fairTypes),a=="modality_id"&&(await r.fetchModalities(),d.value.modality_id=r.modalities)},L=a=>{},g=async()=>{var b;const a={title:e.title,subTitle:e.subTitle,description:e.description,fairtype_id:(b=l.info)!=null&&b.fairtype_id?l.info.fairtype_id:3,modality_id:1,startDate:f(e.dates.start).format("YYYY-MM-DD"),endDate:f(e.dates.end).format("YYYY-MM-DD"),metaMypes:e.metaMypes,city_id:e.city_id,fecha:e.fecha,place:e.place,hours:e.hours,msgEndForm:e.msgEndForm,msgSendEmail:e.msgSendEmail,image_id:i.value};try{v.value=!0;const c=l.info?`fair/update/${l.info.id}`:"fair/create",y=l.info?"PUT":"POST",o=await q({url:c,method:y,data:a});o.status===200&&(G.success(o.message),t(),T("closeDraw",!0))}catch(c){console.error("Error:",c);const y=document.getElementsByClassName("ant-drawer-body")[0];y&&(y.scrollTop=0)}finally{v.value=!1}},t=()=>{e.title=null,e.subTitle=null,e.description="</p>",e.fairtype_id=null,e.modality_id=null,e.dates=null,e.metaMypes=null,e.city_id=null,e.place=null,e.hours=null,e.msgEndForm="</p>",e.msgSendEmail="</p>"},s=async a=>{a&&(e.title=a.title,e.subTitle=a.subTitle,e.description=a.description,await r.fetchFairTypes(),d.value.fairtype_id=r.fairTypes,e.fairtype_id=a.fairtype_id?a.fairtype_id:1,await r.fetchModalities(),d.value.modality_id=r.modalities,e.modality_id=a.modality_id,e.dates={start:f(a.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:f(a.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},e.metaMypes=a.metaMypes,await r.fetchCitiesNational(),d.value.city_id=r.citiesNational,e.city_id=a.city_id,console.log("iaiaiiaiaia",a),a.fecha&&(e.fecha=f(a.fecha,"YYYY-MM-DD")),e.place=a.place,e.hours=a.hours,e.msgEndForm=a.msgEndForm||"</p>",e.msgSendEmail=a.msgSendEmail||"</p>")};return j(()=>{l.info&&s(l.info)}),B(()=>l.info,a=>{a?s(a):t()}),N("formState",e),N("loadingState",v),(a,b)=>(p(),_("div",ee,[E(Q,{fields:h.value,options:d.value,btnSaveName:S.value,onHandleInputEvent:x,resetSelect:Y.value,onHandleFocusSelect:k,onHandleBlurSelect:L,onHandleChangeClock:F,onOnSubmit:g},{default:u(({field:c})=>[c.name=="iSlotOptions"?(p(),_("div",ae,[E(X,{"accept-formats":["image/jpeg","image/png"],maxImages:1,onUploadSuccess:A,imageLoad:M()},null,8,["imageLoad"])])):D("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}};const le={class:"layout-content"},ie=["onClick"],se={key:0,style:{"line-height":"1.5"}},ne={key:1},re=["onClick"],oe=["href"],Ne={__name:"mujer-produce-index",setup(P){JSON.parse(localStorage.getItem("role"));const I=n([]),h=n(0),T=n(150),l=n(!1);n(!1),J();const S=n(!1),e=n(null),v=n(!1),i=H({year:f("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:3}),r=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"LINK",dataIndex:"link",fixed:"left",width:70,align:"center"},{title:"NOMBRE DEL EVENTO",fixed:"left",dataIndex:"title",width:180},{title:"FECHAS INSCRIPCIONES",dataIndex:"date",width:120,align:"center"},{title:"REGISTRADOS",dataIndex:"registered",width:100,align:"center"},{title:"META DE REGISTRO",dataIndex:"metaMypes",width:100,align:"center"},{title:"REGIÓN",dataIndex:"city_name",width:120,align:"center"},{title:"LUGAR EVENTO",dataIndex:"place",width:180},{title:"FECHA DEL EVENTO",dataIndex:"fecha_dashboard",width:120,align:"center"},{title:"HORARIO EVENTO",dataIndex:"hours",width:130,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],Y=n([{value:1,label:"EN CURSO"},{value:2,label:"FINALIZADOS"},{value:3,label:"TODOS"}]),d=(t,s)=>{console.log("type",s);let a=null;if(s==1)a=`${V()}/sed/${t}`;else if(s==5)a=`${V()}/foro/${t}`;else return alert("x");window.open(a,"_blank")},M=t=>{e.value=t,l.value=!0},x=()=>{g(),l.value=!1},F=()=>{e.value=null,l.value=!0},A=async()=>{},k=async t=>{i.page=t,await g()},L=async t=>{t&&(i.page=1,await g())},g=async()=>{try{S.value=!0;const t={page:i.page};i.year&&(t.year=f(i.year).format("YYYY")),i.range&&(t.dateStart=i.range[0].format("YYYY/MM/DD"),t.dateEnd=i.range[1].format("YYYY/MM/DD")),i.name&&(t.name=i.name),i.orderby&&(t.orderby=i.orderby);const a=await q({url:"events-ugse/mujer-produce",method:"GET",params:t});I.value=a.data.data,h.value=a.data.total,T.value=a.data.per_page}catch(t){console.error("Error de red:",t)}finally{S.value=!1}};return j(async()=>{await g()}),N("search",i),N("loading",S),N("loadingFile",v),(t,s)=>{const a=C("a-tag"),b=C("router-link"),c=C("a-menu-item"),y=C("a-drawer");return p(),_("div",le,[E($,{title:"MUJER PRODUCE",new:!0,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:r,othersList:Y.value,titleSearch:"BUSCAR POR EVENTO",pageSize:T.value,nameTotal:"Eventos SED",dataSource:I.value,total:h.value,btnUpdate:!0,onHandleNew:F,onHandleCallFetchData:g,onHandleDownloadExcel:A,onHandleSearch:L,onHandlePaginator:k},{"data-cell":u(({column:o,record:m})=>[o.dataIndex=="link"?(p(),_("a",{key:0,onClick:de=>d(m.slug,m.fairtype_id),href:"javascript:void(0)",target:"_blank"},[E(z(W),{style:{"font-size":"18px"}})],8,ie)):D("",!0),o.dataIndex=="date"?(p(),_(Z,{key:1},[m.startDate!=m.endDate?(p(),_("span",se,[s[1]||(s[1]=O("b",null,"Desde:",-1)),R(" "+w(m.dateStartFormat)+" ",1),s[2]||(s[2]=O("b",null,"Hasta:",-1)),R(" "+w(m.dateEndFormat),1)])):(p(),_("span",ne,w(m.dateStartFormat),1))],64)):D("",!0),o.dataIndex=="registered"?(p(),U(a,{key:2,color:"processing"},{default:u(()=>[R(w(m.registered),1)]),_:2},1024)):D("",!0)]),"custom-options":u(({record:o})=>[E(c,null,{default:u(()=>[E(b,{to:`/admin/ugse/mujer-produce-inscritos/${o.slug}`},{default:u(()=>s[3]||(s[3]=[R(" Inscritos ")])),_:2},1032,["to"])]),_:2},1024),E(c,null,{default:u(()=>[O("a",{onClick:m=>M(o)},"Editar",8,re)]),_:2},1024),o.fairtype_id==3?(p(),U(c,{key:0},{default:u(()=>[O("a",{href:`https://inscripcion.soporte-pnte.com/asistencia-mujer-produce/${o.slug}`,target:"_blank"},"Asistencia",8,oe)]),_:2},1024)):D("",!0)]),_:1},8,["othersList","pageSize","dataSource","total"]),E(y,{open:l.value,"onUpdate:open":s[0]||(s[0]=o=>l.value=o),title:e.value?"EDITAR EVENTO MUJER PRODUCE":"REGISTRAR UN EVENTO MUJER PRODUCE",placement:"right",width:"550"},{default:u(()=>[E(te,{onCloseDraw:x,info:e.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Ne as default};
