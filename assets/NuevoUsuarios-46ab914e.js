import{K as F,r as f,x as ae,a as ne,b as c,o as t,d as y,c as u,e as I,w as i,F as h,y as T,X as le,M as k,m as D,B as te,q as r,h as p,s as d,Y as oe,i as A,L as se,p as re,j as ue,Z as de}from"./index-eded9fee.js";import{u as ie}from"./selectes-3ed29e18.js";import"./es-5dd7c48d.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";const ce={email:{type:"iText",label:"Correo",name:"email",required:!1,email:"email",message:"Escribe el correo del usuario",disabled:!0},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Ingresar los nombres"},lastname:{type:"iText",label:"Apellido paterno",name:"lastname",required:!0,message:"Escribe el apellido paterno"},middlename:{type:"iText",label:"Apellido materno",name:"middlename",required:!0,message:"Escribe el apellido paterno"},documentnumber:{type:"iText",label:"Número de DNI",name:"documentnumber",required:!0,message:"Ingresa el número de DNI",max:8},birthday:{type:"iDate",label:"Fecha de nacimiento - día/mes/año",name:"birthday",required:!1,message:"año-mes-día"},phone:{type:"iText",label:"Ingresar número celular",name:"phone",required:!0,message:"Escribe número de documento",disabled:!1,max:9},gender_id:{type:"iSelect",label:"Género",name:"gender_id",required:!0,message:"Seleccionar un tipo de género",disabled:!0},cde_id:{type:"iSelect",label:"CDE",name:"cde_id",required:!0,message:"Seleccionar la sede",disabled:!0},office_id:{type:"iSelect",label:"Oficina",name:"office_id",required:!0,message:"Seleccionar la oficina",disabled:!0},role_id:{type:"iSelect",label:"Rol",name:"role_id",required:!0,message:"Seleccionar un rol de usuario",disabled:!0}};const pe=x=>(re("data-v-df28a037"),x=x(),ue(),x),ve=pe(()=>I("h3",{class:"title-produce"},"REGISTRO DE USUARIO",-1)),_e={class:"user"},fe={class:"grid-item"},be="DD/MM/YYYY",ge={__name:"NuevoUsuarios",setup(x){F.locale("es");const L=de({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),Y=JSON.parse(localStorage.getItem("profile")),w=JSON.parse(localStorage.getItem("role")),l=ie();l.$patch({genders:l.genders}),l.$patch({cdes:l.cdes}),l.$patch({Offices:l.Offices}),l.$patch({roles:l.roles}),l.$patch({supervisores:l.supervisores}),l.fetchGenders(),l.fetchCdes(),l.fetchOffices(),l.fetchRoles();const v=f(ce),b=f(null);ae();const q=f(!1),E=f(!1),$=f(!1),N=f(!1),S=f(null),M=[{label:"Supervisor",value:1},{label:"Asesor",value:2}],V=[{label:"Drive Administrador",value:3},{label:"Drive Usuario",value:4}],a=ne({name:null,lastname:null,middlename:null,documentnumber:null,birthday:null,sick:2,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:Y.user_id,email:null,password:null}),z=()=>{a.name=null,a.lastname=null,a.middlename=null,a.documentnumber=null,b.value=null,a.phone=null,a.gender_id=null,a.cde_id=null,a.office_id=null,a.email=null,a.password=null,a.role_id=null},C=o=>{a[o]=a[o].replace(/\D/g,"")},B=async()=>{try{N.value=!0;const o={name:S.value};(await T({url:"create/office",method:"POST",data:o})).status==200&&(S.value=null,l.fetchOffices())}catch(o){console.log(o)}finally{N.value=!1}},G=(o,s)=>{const _=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(_)},O=o=>{const s={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0};if(o===2)l.fetchSupervisores(),v.value={...v.value,supervisor_id:s};else{const{supervisor_id:_,...m}=v.value;v.value=m}},j=async()=>{q.value=!0,a.email=a.name.replace(/\s/g,"").toLowerCase()+a.lastname.replace(/\s/g,"").toLowerCase()+"@pnte.com",a.password=a.documentnumber,a.birthday=b.value?F(b.value).format("YYYY-MM-DD"):null;try{const o=await T({url:"user/create",method:"POST",data:a});le.success({title:"La cuenta ha sido registrada",content:k("div",{},[k("br"),k("p",`Correo: ${a.email}`),k("p","Contraseña es el número de DNI ingresado")]),onOk(){z(),D.success(o.message);const{supervisor_id:s,..._}=v.value;v.value=_}})}catch{D.error("No se pudo registrar este usuario")}finally{q.value=!1}},P=()=>{D.error("Debes de completar todos los espacios requeridos")},J=async o=>{console.log("Hello",o)},K=()=>{a.document_number=a.document_number.replace(/\D/g,"")};return(o,s)=>{const _=c("a-divider"),m=c("a-select"),U=c("a-input"),R=c("a-button"),H=c("a-space"),g=c("a-form-item"),X=c("a-input-search"),Z=c("a-date-picker"),Q=c("a-form");return t(),y(h,null,[ve,u(_),I("div",_e,[u(Q,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:j,onFinishFailed:P},{default:i(()=>[I("div",fe,[(t(!0),y(h,null,te(v.value,(e,W)=>(t(),y(h,{key:W},[e.type==="iSelect"?(t(),r(g,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:i(()=>[e.name=="gender_id"?(t(),r(m,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:p(l).genders},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="cde_id"?(t(),r(m,{key:1,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:p(l).cdes},null,8,["value","onUpdate:value","options"])):d("",!0),p(w)[0].id==1?(t(),y(h,{key:2},[e.name=="role_id"?(t(),r(m,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:M,onChange:O},null,8,["value","onUpdate:value"])):d("",!0)],64)):d("",!0),p(w)[0].id==3?(t(),y(h,{key:3},[e.name=="role_id"?(t(),r(m,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:V,onChange:O},null,8,["value","onUpdate:value"])):d("",!0)],64)):d("",!0),e.name=="supervisor_id"?(t(),r(m,{key:4,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,options:p(l).supervisores},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="office_id"?(t(),r(m,{key:5,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,"show-search":"",options:p(l).Offices,"filter-option":G},{dropdownRender:i(({menuNode:n})=>[u(p(L),{vnodes:n},null,8,["vnodes"]),u(_,{style:{margin:"4px 0"}}),u(H,{style:{padding:"4px 8px"}},{default:i(()=>[u(U,{ref_for:!0,ref:"inputRef",value:S.value,"onUpdate:value":s[0]||(s[0]=ee=>S.value=ee),placeholder:"Nueva actividad"},null,8,["value"]),u(R,{type:"text",onClick:B,loading:N.value},{icon:i(()=>[u(p(oe))]),default:i(()=>[A(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):d("",!0)]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iSearch"?(t(),r(g,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:i(()=>[u(X,{maxlength:15,loading:E.value,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,onSearch:J,onInput:K,disabled:$.value},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iText"?(t(),r(g,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:i(()=>[e.name=="documentnumber"?(t(),r(U,{key:0,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,onInput:s[1]||(s[1]=n=>C("documentnumber"))},null,8,["value","onUpdate:value","maxlength"])):e.name=="phone"?(t(),r(U,{key:1,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,onInput:s[2]||(s[2]=n=>C("phone"))},null,8,["value","onUpdate:value","maxlength"])):(t(),r(U,{key:2,value:a[e.name],"onUpdate:value":n=>a[e.name]=n,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"]))]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iDate"?(t(),r(g,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:i(()=>[u(Z,{locale:p(se),value:b.value,"onUpdate:value":s[3]||(s[3]=n=>b.value=n),style:{width:"100%"},format:be},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):d("",!0)],64))),128))]),u(g,null,{default:i(()=>[u(R,{class:"btn-produce",type:"primary","html-type":"submit",loading:q.value},{default:i(()=>[A("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])],64)}}},Ue=me(ge,[["__scopeId","data-v-df28a037"]]);export{Ue as default};
