import{r as d,a as G,l as x,b as s,o as i,d as m,c as t,w as o,e as u,F as w,s as re,x as N,y as f,i as p,U as ie,V as de,m as B,I as $,B as ue,W as me,j as ce,p as M,h as Y,Q as pe,t as k,$ as fe,H as _e}from"./index-d686466f.js";import{u as ve}from"./selectes-f14ede07.js";import"./quill.snow-24bb3da0.js";import"./es-eac34791.js";import{M as ge}from"./MoreOutlined-f95a476c.js";const ye={class:"grid-events"},he={key:3,class:"grid-events-hour"},be={class:"event-all-day"},we={style:{display:"flex","margin-bottom":"1rem"}},xe={__name:"DrawEventosCalendario",props:["type"],emits:["closeDraw"],setup(Q,{emit:C}){const y=ve();y.$patch({officesPnte:y.officesPnte}),y.fetchOfficesPnte();const h=d(!1),S=d([{dates:new Date}]),D=d({office:{type:"iSelect",label:"ÁREA DE",name:"office",required:!0,message:"",disabled:!1},title:{type:"iText",label:"TÍTULO",name:"title",required:!0,message:"",disabled:!1,max:150},date:{type:"iDate",label:"FECHA",name:"date",required:!1,message:"ssss",disabled:!1},allDay:{type:"iSwitch",label:"",name:"allDay",required:!1,message:"Adenda"},description:{type:"iTextArea",label:"DESCRIPCIÓN",name:"description",required:!1,message:"Escribe descripción del evento",max:250},nameUser:{type:"iText",label:"RESPONSABLE",name:"nameUser",required:!1,message:"",disabled:!1,max:100}}),n=G({allDay:1}),T=d([{start:null,end:x().subtract(0,"day").format("YYYY-MM-DD")}]),I=_=>_==="office"?y.officesPnte:[],A=_=>{},V=(_,l)=>{const U=_.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return l.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(U)},b=async()=>{if(!n.date)return B.error("Debes de seleccionar una fecha");const _={pnte_id:n.office,title:n.title,date:x(n.date).format("YYYY-MM-DD"),allDay:n.allDay,...n.allDay==0&&{start:x(n.hours[0]).format("HH:mm"),end:x(n.hours[1]).format("HH:mm")},description:n.description,nameUser:n.nameUser};h.value=!0;try{const l=await $({url:"event/create",method:"POST",data:_});l.status===200&&(B.success(l.message),n.title="")}catch(l){console.error("Failed to update record",l)}finally{h.value=!1}};return(_,l)=>{const U=s("a-select"),g=s("a-form-item"),H=s("a-input"),R=s("VDatePicker"),z=s("a-switch"),q=s("a-time-range-picker"),O=s("a-textarea"),L=s("a-button"),P=s("a-form");return i(),m("div",null,[t(P,{class:"form-events",layout:"vertical",model:n,name:"basic",autocomplete:"off",onFinish:b},{default:o(()=>[u("div",ye,[(i(!0),m(w,null,re(D.value,(a,r)=>(i(),m(w,{key:r},[a.type==="iSelect"?(i(),N(g,{key:0,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:o(()=>[t(U,{value:n[a.name],"onUpdate:value":e=>n[a.name]=e,options:I(a.name),"show-search":"","filter-option":V,onChange:A},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name","label","rules"])):f("",!0),a.type==="iText"?(i(),N(g,{key:1,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:o(()=>[t(H,{value:n[a.name],"onUpdate:value":e=>n[a.name]=e,maxlength:a.max,disabled:a.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):f("",!0),a.type==="iDate"?(i(),N(g,{key:2,name:a.name,label:a.label},{default:o(()=>[t(R,{modelValue:n[a.name],"onUpdate:modelValue":e=>n[a.name]=e,mode:"date",attributes:S.value,"disabled-dates":T.value},null,8,["modelValue","onUpdate:modelValue","attributes","disabled-dates"])]),_:2},1032,["name","label"])):f("",!0),a.type==="iSwitch"?(i(),m("div",he,[u("div",be,[l[4]||(l[4]=u("label",{for:""},"TODO EL DÍA ",-1)),t(z,{checked:n.allDay,"onUpdate:checked":l[0]||(l[0]=e=>n.allDay=e),"checked-value":1,"un-checked-value":0},{checkedChildren:o(()=>l[2]||(l[2]=[p("Si")])),unCheckedChildren:o(()=>l[3]||(l[3]=[p("No")])),_:1},8,["checked"])]),ie(u("div",we,[u("div",null,[l[5]||(l[5]=u("label",{style:{display:"block"},for:""},"HORA DE INICIO",-1)),t(q,{"use12-hours":"",value:n.hours,"onUpdate:value":l[1]||(l[1]=e=>n.hours=e),format:"h:mm a"},null,8,["value"])])],512),[[de,n.allDay===0]])])):f("",!0),a.type==="iTextArea"?(i(),N(g,{key:4,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:o(()=>[t(O,{value:n[a.name],"onUpdate:value":e=>n[a.name]=e,rows:4,maxlength:a.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):f("",!0)],64))),128))]),t(g,null,{default:o(()=>[t(L,{type:"primary","html-type":"submit",loading:h.value,style:{"margin-top":"1rem"}},{default:o(()=>l[6]||(l[6]=[p("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}};const De={key:0},Ee={key:1},ke={class:"paginator"},Te={__name:"EventosCalendario",setup(Q){x.locale("es"),JSON.parse(localStorage.getItem("role"));const C=d(!1),y=d(null),h=d(0),S=d(50),D=d({page:0}),n=d(1200),T=d([]),I=d(!1),A=d(window.innerHeight-100),V=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"ÁREA",fixed:"left",dataIndex:"office",width:100},{title:"TÍTULO",dataIndex:"title",width:200},{title:"FECHA",dataIndex:"date",width:120,align:"center"},{title:"HORARIO",dataIndex:"hours",width:120,align:"center"},{title:"DESCRIPCIÓN",dataIndex:"description",width:240},{title:"RESPONSABLE",dataIndex:"nameUser",width:240},{title:"",dataIndex:"actions",width:30,align:"center",fixed:"right"}],b=G({search:""}),_=()=>{a(),C.value=!1},l=()=>{C.value=!0},U=()=>{let r={search:b.search};a(r)},g=()=>{b.search||a()},H=r=>x(r).format("DD/MM/YYYY"),R=r=>x(r,"HH:mm:ss").format("HH:mm"),z=r=>({ferias:"FERIAS",rd:"RUTA DIGITAL",ugse:"UGSE",uger:"UGGER",ugo:"UGO"})[r],q=r=>{D.value.page=r,a()},O=()=>{A.value=window.innerHeight-330},L=async r=>{},P=ue(()=>r=>D.value.page*S.value+r+1),a=async r=>{try{I.value=!0;let e;e=D.value.page==0?"":D.value,e=r?{...e,...r}:e;const{data:c}=await $({url:"event/list",method:"GET",params:e});T.value=c==null?void 0:c.data,h.value=c.total,S.value=c.per_page}catch(e){console.error("Error de red:",e)}finally{I.value=!1}};return me(()=>{window.removeEventListener("resize",O)}),ce(()=>{window.addEventListener("resize",O),O(),a()}),(r,e)=>{const c=s("a-button"),j=s("router-link"),F=s("a-col"),J=s("a-input"),W=s("a-input-group"),X=s("a-row"),K=s("a-popconfirm"),Z=s("a-menu-item"),ee=s("a-menu"),ae=s("a-dropdown"),te=s("a-table"),ne=s("a-tag"),oe=s("a-pagination"),le=s("a-drawer");return i(),m(w,null,[u("div",null,[e[7]||(e[7]=u("h3",{class:"title-produce"},"EVENTOS PNTE 2025",-1)),t(X,{style:{margin:"1rem 0"}},{default:o(()=>[t(F,{xs:24,md:12,lg:18},{default:o(()=>[t(c,{type:"primary",onClick:l,class:"box-btn-add"},{default:o(()=>e[3]||(e[3]=[p(" NUEVO EVENTO ")])),_:1}),t(j,{to:"/calendario/eventos",target:"_blank",style:{"margin-left":"1rem"}},{default:o(()=>[t(c,{type:"dashed",icon:M(Y(pe))},{default:o(()=>e[4]||(e[4]=[p("Ver Calendario")])),_:1},8,["icon"])]),_:1})]),_:1}),t(F,{xs:24,md:12,lg:6},{default:o(()=>[t(W,{compact:""},{default:o(()=>[t(J,{value:b.search,"onUpdate:value":e[0]||(e[0]=v=>b.search=v),style:{width:"calc(100% - 80px)"},onInput:g},null,8,["value"]),t(c,{type:"primary",disabled:b.search==="",onClick:U},{default:o(()=>e[5]||(e[5]=[p("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),t(te,{bordered:"",scroll:{x:n.value,y:A.value},class:"table-events-google",columns:V,"data-source":T.value,pagination:!1,loading:I.value,size:"small"},{bodyCell:o(({column:v,record:E,index:se})=>[v.dataIndex=="idx"?(i(),m(w,{key:0},[p(k(P.value(se)),1)],64)):f("",!0),v.dataIndex=="date"?(i(),m(w,{key:1},[p(k(H(E.date)),1)],64)):f("",!0),v.dataIndex=="office"?(i(),m(w,{key:2},[p(k(z(E.office)),1)],64)):f("",!0),v.dataIndex=="hours"?(i(),m(w,{key:3},[E.allDay==1?(i(),m("span",De,"Todo el día")):(i(),m("span",Ee,k(R(E.start))+" - "+k(R(E.end)),1))],64)):f("",!0),v.dataIndex=="actions"?(i(),N(ae,{key:4,trigger:["click"]},{overlay:o(()=>[t(ee,null,{default:o(()=>[t(Z,null,{default:o(()=>[t(K,{placement:"rightBottom",title:"¿Quieres eliminar este evento ?",onConfirm:Ce=>L(E)},{icon:o(()=>[t(Y(fe),{style:{color:"red"}})]),default:o(()=>[e[6]||(e[6]=u("a",null,"Eliminar",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:o(()=>[u("a",{class:"ant-dropdown-link",onClick:e[1]||(e[1]=_e(()=>{},["prevent"]))},[t(c,{shape:"circle",icon:M(Y(ge)),size:"small"},null,8,["icon"])])]),_:2},1024)):f("",!0)]),_:1},8,["scroll","data-source","loading"])]),u("div",ke,[u("span",null,[t(ne,{color:"blue"},{default:o(()=>[u("b",null,k(h.value),1)]),_:1}),e[8]||(e[8]=p("Eventos creados"))]),t(oe,{size:"small",total:h.value,pageSize:S.value,onChange:q,showSizeChanger:!1},null,8,["total","pageSize"])]),t(le,{open:C.value,"onUpdate:open":e[2]||(e[2]=v=>C.value=v),title:y.value?"Editar Evento":"NUEVO EVENTO",placement:"right",width:"450"},{default:o(()=>[t(xe,{onCloseDraw:_,dataRow:y.value,type:"events"},null,8,["dataRow"])]),_:1},8,["open","title"])],64)}}};export{Te as default};
