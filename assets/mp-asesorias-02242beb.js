import{_ as F}from"./TableComponent-c13ea256.js";import{p as l,r as o,a as M,k as P,T as Y,W as A,o as d,y as z,i as U,L as G,d as p,c as f,w as _,z as y,e as H,t as T,m as B,h as V,u as $,b as q,F as j}from"./index-26aec2ba.js";import{_ as Q}from"./FormComponent-5f77f4b7.js";import{u as J}from"./selectes-73927ffb.js";import{U as K}from"./UpImage-b60e55a5.js";import"./es-b107d97b.js";import{u as W,t as Z}from"./timezone-d4f98714.js";import"./downloadExcel-601a9f6e.js";import{G as X}from"./GlobalOutlined-1f861240.js";import"./icoexcel-1b303edf.js";import"./SyncOutlined-9e7f0e3b.js";import"./MoreOutlined-f8695466.js";import"./quill.snow-9cbcf991.js";import"./_plugin-vue_export-helper-c27b6911.js";const ee={key:1,class:"mp-asesoria"},ae={key:0},te={__name:"DrawMPAsesorias",props:["info"],emits:["closeDraw"],setup(N,{emit:I}){l.locale("es"),l.extend(W),l.extend(Z);const h=o({title:{type:"iText",label:"NOMBRE DEL EVENTO",name:"title",required:!0,message:"Escribir nombre del evento",disabled:!1,max:255},description:{type:"iTextArea",label:"DESCRIPCIÓN DEL EVENTO",name:"description",required:!0,message:"Escribir nombre del evento",disabled:!1,rows:6,max:250},requirements:{type:"iQuillEditor",label:"MENSAJE DE LOS REQUISITOS",name:"requirements",required:!0,message:"Escribir los requisitos",disabled:!1,class:"quill-height-200"},capacitador_id:{type:"iSelect",label:"ASESOR DE LA ASESORÍA",name:"capacitador_id",required:!0,message:"Seleccionar capacitador",disabled:!1},date:{type:"iDate",label:"FECHA DE LA ASESORÍA",name:"date",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: Lunes: 12 de mayo"},hours:{type:"iHour",label:"HORARIO DE LA ASESORÍA",name:"hours",required:!0,message:"Escribir nombre del evento",disabled:!1,placeholder:"Ejemplo: 5:00 pm a 8:00 pm",max:100},link:{type:"iText",label:"LINK DE LA SALA",name:"link",required:!0,message:"Ingresar link de la sala",disabled:!1,rules:[{required:!0,message:"Ingresar link"},{type:"url",message:"Ingrese un link válido (https://...)",trigger:"blur"}]},messageImgBanner:{type:"iLabel",label:"CARGAR IMAGEN",name:"messageImgBanner"},imgBanner:{type:"iSlot",name:"iSlotOptions"}}),g=J(),c=I,s=N,i=o(!0),w=o("GUARDAR"),a=M({}),S=o(!1),E=o(null),D=o(null),v=o({city_id:[],fairtype_id:[],modality_id:[],capacitador_id:[]}),b=()=>s.info?{name:s.info.image_name,url:s.info.image_url}:null,R=e=>{e=="modality_id"&&console.log("a9a9a9a99a9a9")},k=async e=>{e=="dateReception"&&(a.dateTramite&&(a.dateTramite=null),h.value.dateTramite.disabled=!1)},C=async e=>{E.value=e.id},m=async e=>{e=="city_id"&&(a.city_id=null),e=="capacitador_id"&&(v.value.capacitadores=g.capacitadores)},t=async(e,n)=>{},r=async()=>{S.value=!0;try{const e={title:a.title,description:a.description,requirements:a.requirements,capacitador_id:a.capacitador_id,date:l(a.date).format("YYYY-MM-DD"),hourStart:l(a.hours[0]).format("HH:mm"),hourEnd:l(a.hours[1]).format("HH:mm"),image_id:E.value??s.info.image.id,link:a.link},n=s.info?`mp/update-event/${s.info.id}`:"mp/create-personalized-advice",O=s.info?"PUT":"POST",L=await B({url:n,method:O,data:e});L.status===200&&(V.success(L.message),u(),c("closeDraw",!0))}catch(e){console.error("Error:",e);const n=document.getElementsByClassName("ant-drawer-body")[0];n&&(n.scrollTop=0)}finally{S.value=!1}},u=()=>{},x=async e=>{i.value=!0;try{e&&(a.title=e.title,a.description=e.description,a.requirements=e.requirements,a.capacitador_id=e.capacitador_id,a.date=e.date?l(e.date,"YYYY-MM-DD"):null,a.hours=[l(e.hourStart,"HH:mm"),l(e.hourEnd,"HH:mm")],a.link=e.link)}catch(n){console.error("Error al cargar la información:",n)}finally{i.value=!1}};return P(async()=>{s.info?x(s.info):i.value=!1,await g.fetchCapacitadores(),v.value.capacitador_id=g.capacitadores}),Y(()=>s.info,e=>{e&&x(e)}),A("formState",a),A("loadingState",S),(e,n)=>i.value?(d(),z(U(G),{key:0,style:{color:"#00a6db"}})):(d(),p("div",ee,[f(Q,{fields:h.value,options:v.value,btnSaveName:w.value,onHandleInputEvent:R,resetSelect:D.value,onHandleFocusSelect:m,onHandleChangeSelect:t,onHandleChangeClock:k,onOnSubmit:r},{default:_(({field:O})=>[O.name=="iSlotOptions"?(d(),p("div",ae,[f(K,{"accept-formats":["image/jpeg","image/png"],maxImages:1,nameType:"mp",onUploadSuccess:C,imageLoad:b()},null,8,["imageLoad"])])):y("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"]),H("pre",null,T(b()),1)]))}};const ne={class:"layout-content"},oe=["href"],se={key:1},le=["innerHTML"],ie=["onClick"],Ae={__name:"mp-asesorias",setup(N){JSON.parse(localStorage.getItem("role"));const I=o([]),h=o(0),g=o(150),c=o(!1);o(!1),$();const s=o(!1),i=o(null),w=o(!1),a=M({page:1}),S=[{title:"#",dataIndex:"idx",align:"center",width:50,fixed:"left"},{title:"LINK SALA",dataIndex:"link",align:"center",width:70},{title:"TEMA",dataIndex:"title",width:140},{title:"DESCRIPCIÓN",dataIndex:"description",width:200},{title:"FECHA DE LA ASESORÍA",dataIndex:"date_format",align:"center",width:120},{title:"HORA DE LA ASESORÍA",dataIndex:"hours",align:"center",width:160},{title:"REQUISITOS",dataIndex:"requirements",width:160},{title:"CAPACITADOR",dataIndex:"capacitador_name",width:160},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],E=t=>t?l(t,["HH:mm:ss","HH:mm"]).format("hh:mm A"):null,D=t=>{i.value=t,c.value=!0},v=()=>{m(),c.value=!1},b=()=>{i.value=null,c.value=!0},R=async()=>{},k=async t=>{a.page=t,await m()},C=async t=>{t&&(a.page=1,await m())},m=async()=>{try{s.value=!0;const t={page:a.page},r=await B({url:"mp/mp-index-advice",method:"GET",params:t}),{data:u}=r;I.value=u.data,h.value=u.total,g.value=u.per_page}catch(t){console.error("Error de red:",t)}finally{s.value=!1}};return P(async()=>{await m()}),A("search",a),A("loading",s),A("loadingFile",w),(t,r)=>{const u=q("a-menu-item"),x=q("a-drawer");return d(),p("div",ne,[f(F,{title:"ASESORÍAS PERSONALIZADAS",new:!0,textNuevo:"NUEVO",placeholderSearch:"Buscar",columns:S,titleSearch:"BUSCAR POR EVENTO",pageSize:g.value,nameTotal:"Capacitaciones",dataSource:I.value,total:h.value,btnUpdate:!0,onHandleNew:b,onHandleCallFetchData:m,onHandleDownloadExcel:R,onHandleSearch:C,onHandlePaginator:k},{header:_(()=>r[1]||(r[1]=[])),"data-cell":_(({column:e,record:n})=>[e.dataIndex=="link"?(d(),p(j,{key:0},[n.link?(d(),p("a",{key:0,target:"'_blank'",href:n.link,style:{color:"#7d4fc6","font-size":"16px","margin-top":"-2px"}},[f(U(X))],8,oe)):y("",!0)],64)):y("",!0),e.dataIndex=="hours"?(d(),p("span",se,[H("span",null,T(E(n.hourStart))+" - "+T(E(n.hourEnd)),1)])):y("",!0),e.dataIndex=="requirements"?(d(),p("div",{key:2,innerHTML:n.requirements},null,8,le)):y("",!0)]),"custom-options":_(({record:e})=>[f(u,null,{default:_(()=>[H("a",{onClick:n=>D(e)},"Editar",8,ie)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),f(x,{open:c.value,"onUpdate:open":r[0]||(r[0]=e=>c.value=e),title:i.value?"EDITAR EVENTO MP":"REGISTRAR UNA ASESORÍA",placement:"right",width:"550"},{default:_(()=>[f(te,{onCloseDraw:v,info:i.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{Ae as default};
