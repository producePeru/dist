import{r as U,a as xe,b as w,o as i,d as h,c as r,w as d,e as D,F as k,x as we,h as I,q as g,s as n,t as p,i as b,z as ae,m as Q,K as M,y as ea,k as je,L as aa,Y as ta,Z as ia,f as oa,g as na,v as la,H as sa,n as be,G as da,Q as ra,I as ca,M as ua,_ as He,p as ma,j as pa}from"./index-b9a4a8cb.js";import{_ as _a}from"./icoexcel-1b303edf.js";import"./es-befce324.js";import{u as ce}from"./selectes-39ccac6b.js";import{a as va,r as fa,f as ya}from"./asesorias-6c011677.js";import{_ as ue}from"./_plugin-vue_export-helper-c27b6911.js";import{M as ha}from"./MoreOutlined-bcfb934c.js";const ga={class:"wrapper-booking"},ba={class:"grid-booking"},xa={__name:"EditarAsesoria",props:["info"],emits:["closeDraw"],setup(H,{emit:V}){const _=ce(),O=JSON.parse(localStorage.getItem("profile")),u=U(!1),E=H,G=V;_.$patch({components:_.components}),_.$patch({componentThemes:_.componentThemes}),_.$patch({modalities:_.modalities}),_.$patch({cities:_.cities}),_.$patch({economicSectors:_.economicSectors}),_.$patch({comercialActivities:_.comercialActivities}),_.fetchEconomicSectors(),_.fetchComercialActivities(),_.fetchComponents(),_.fetchComponentThemes(),_.fetchModalities(),_.fetchCities();const v=U(!0),e=xe({observations:null,user_id:O.user_id,people_id:null,component_id:null,theme_id:null,modality_id:null,city_id:null,province_id:null,district_id:null}),j=()=>{_.cities&&(v.value=!1),e.economicsector_id=E.info.economicsector_id,e.comercialactivity_id=E.info.comercialactivity_id,e.ruc=E.info.ruc,e.component_id=E.info.component_id,y(E.info.component_id),e.theme_id=E.info.theme_id,e.modality_id=E.info.modality_id,e.city_id=E.info.city_id,P(E.info.city_id),e.province_id=E.info.province_id,t(E.info.province_id),e.district_id=E.info.district_id,e.observations=E.info.observations},y=S=>{e.theme_id=null,_.fetchComponentThemes(S)},P=S=>{e.province_id=null,e.district_id=null,_.fetchProvinces(S)},t=S=>{e.district_id=null,_.fetchDistricts(S)},L=(S,A)=>{const N=S.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return A.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(N)},J=S=>{S=="ruc"&&(e[S]=e[S].replace(/\D/g,""))},q=async()=>{u.value=!0;const S={economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,ruc:e.ruc,observations:e.observations,component_id:e.component_id,theme_id:e.theme_id,modality_id:e.modality_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,updated_by:O.user_id};try{const A=await ae({url:`advisory/update/${E.info.id}`,method:"PUT",data:S});A.status===200&&(Q.success(A.message),e.component_id=null,e.theme_id=null,e.modality_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.observations=null,G("closeDraw",!0))}catch(A){console.log("Error: "+A)}finally{u.value=!1}},f=()=>{Q.warning("Debes de completar todos los espacios requeridos")};return(S,A)=>{const N=w("a-select"),Y=w("a-form-item"),T=w("a-textarea"),X=w("a-input"),C=w("a-button"),o=w("a-form"),z=w("a-spin");return i(),h("div",ga,[r(z,{spinning:v.value},{default:d(()=>[r(o,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:q,onFinishFailed:f},{default:d(()=>[D("div",ba,[(i(!0),h(k,null,we(I(va),(a,K)=>(i(),h(k,{key:K},[a.type==="iSelect"?(i(),g(Y,{key:0,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:d(()=>[a.name=="modality_id"?(i(),g(N,{key:0,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,options:I(_).modalities},null,8,["value","onUpdate:value","options"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),a.type==="iTextarea"?(i(),g(Y,{key:1,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:d(()=>[r(T,{value:e[a.name],"onUpdate:value":R=>e[a.name]=R,rows:3},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):n("",!0),a.type==="iText"?(i(),g(Y,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,type:a.email,max:a.max}]},{default:d(()=>[r(X,{value:e[a.name],"onUpdate:value":R=>e[a.name]=R,maxlength:a.max,onInput:R=>J(a.name),placeholder:a.placeholder},null,8,["value","onUpdate:value","maxlength","onInput","placeholder"])]),_:2},1032,["name","label","rules"])):n("",!0),a.type==="iSelectWrite"?(i(),g(Y,{key:3,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:d(()=>[a.name=="theme_id"?(i(),g(N,{key:0,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,"show-search":"",options:I(_).componentThemes,"filter-option":L,disabled:!e.component_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),a.name=="city_id"?(i(),g(N,{key:1,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,"show-search":"",options:I(_).cities,"filter-option":L,onChange:P},null,8,["value","onUpdate:value","options"])):n("",!0),a.name=="province_id"?(i(),g(N,{key:2,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,"show-search":"",options:I(_).provinces,"filter-option":L,onChange:t,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),a.name=="district_id"?(i(),g(N,{key:3,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,"show-search":"",options:I(_).districts,"filter-option":L,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),a.name=="component_id"?(i(),g(N,{key:4,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,options:I(_).components,onChange:y},null,8,["value","onUpdate:value","options"])):n("",!0),a.name=="economicsector_id"?(i(),g(N,{key:5,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,"show-search":"",options:I(_).economicSectors,"filter-option":L},null,8,["value","onUpdate:value","options"])):n("",!0),a.name=="comercialactivity_id"?(i(),g(N,{key:6,value:e[a.name],"onUpdate:value":R=>e[a.name]=R,"show-search":"",options:I(_).comercialActivities,"filter-option":L},null,8,["value","onUpdate:value","options"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0)],64))),128))]),D("div",null,p(j()),1),r(Y,null,{default:d(()=>[r(C,{type:"primary",class:"btn-produce","html-type":"submit",loading:u.value},{default:d(()=>[b("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},wa=ue(xa,[["__scopeId","data-v-fe1afd70"]]);const Ia={class:"wrapper-booking"},ka={class:"grid-booking"},Ca={__name:"EditarFormalizacionRUC10",props:["info"],emits:["closeDraw"],setup(H,{emit:V}){const _=U(!0),O=JSON.parse(localStorage.getItem("profile")),u=H,E=V,G=U(!1),v=ce();v.$patch({cities:v.cities}),v.$patch({provinces:v.provinces}),v.$patch({districts:v.districts}),v.$patch({modalities:v.modalities}),v.$patch({detailProcedures:v.detailProcedures}),v.$patch({economicSectors:v.economicSectors}),v.$patch({comercialActivities:v.comercialActivities}),v.fetchDetailProcedures(),v.fetchModalities(),v.fetchEconomicSectors(),v.fetchComercialActivities(),v.fetchCities();const e=xe({detailprocedure_id:null,modality_id:null,economicsector_id:null,comercialactivity_id:null,city_id:null,province_id:null,district_id:null,user_id:O.user_id}),j=()=>{e.detailprocedure_id=u.info.detailprocedure_id,e.modality_id=u.info.modality_id,e.economicsector_id=u.info.economicsector_id,e.comercialactivity_id=u.info.comercialactivity_id,e.city_id=u.info.city_id,P(u.info.city_id),e.province_id=u.info.province_id,t(u.info.province_id),e.district_id=u.info.district_id,e.ruc=u.info.ruc,e.address=u.info.address,v.cities&&(_.value=!1)},y=f=>{f=="ruc"&&(e[f]=e[f].replace(/\D/g,""))},P=f=>{e.province_id=null,e.district_id=null,v.fetchProvinces(f)},t=f=>{e.district_id=null,v.fetchDistricts(f)},L=(f,S)=>{const A=f.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return S.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(A)},J=async()=>{G.value=!0;const f={detailprocedure_id:e.detailprocedure_id,modality_id:e.modality_id,economicsector_id:e.economicsector_id,comercialactivity_id:e.comercialactivity_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,ruc:e.ruc,updated_by:O.user_id};try{const S=await ae({url:`formalization/update-ruc-10/${u.info.id}`,method:"PUT",data:f});S.status===200&&(Q.success(S.message),e.detailprocedure_id=null,e.modality_id=null,e.economicsector_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.ruc=null,E("closeDraw",!0))}catch(S){console.log("Error: "+S)}finally{G.value=!1}},q=()=>{Q.warning("Debes de completar todos los espacios requeridos")};return(f,S)=>{const A=w("a-select"),N=w("a-form-item"),Y=w("a-input"),T=w("a-button"),X=w("a-form"),C=w("a-spin");return i(),h("div",Ia,[r(C,{spinning:_.value},{default:d(()=>[r(X,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:J,onFinishFailed:q},{default:d(()=>[D("div",ka,[(i(!0),h(k,null,we(I(fa),(o,z)=>(i(),h(k,{key:z},[o.type==="iSelect"?(i(),g(N,{key:0,class:"item-max",name:o.name,label:o.label,rules:[{required:o.required,message:o.message}]},{default:d(()=>[o.name=="detailprocedure_id"?(i(),g(A,{key:0,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:I(v).detailProcedures},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="modality_id"?(i(),g(A,{key:1,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:I(v).modalities},null,8,["value","onUpdate:value","options"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),o.type==="iText"?(i(),g(N,{key:1,name:o.name,label:o.label,rules:[{required:o.required,message:o.message,type:o.email,max:o.max}]},{default:d(()=>[r(Y,{value:e[o.name],"onUpdate:value":a=>e[o.name]=a,disabled:o.disabled,maxlength:o.max,onInput:a=>y(o.name)},null,8,["value","onUpdate:value","disabled","maxlength","onInput"])]),_:2},1032,["name","label","rules"])):n("",!0),o.type==="iSelectWrite"?(i(),g(N,{key:2,class:"item-max",name:o.name,label:o.label,rules:[{required:o.required,message:o.message}]},{default:d(()=>[o.name=="economicsector_id"?(i(),g(A,{key:0,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:I(v).economicSectors},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="comercialactivity_id"?(i(),g(A,{key:1,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,options:I(v).comercialActivities},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="city_id"?(i(),g(A,{key:2,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,"show-search":"",options:I(v).cities,"filter-option":L,onChange:P},null,8,["value","onUpdate:value","options"])):n("",!0),o.name=="province_id"?(i(),g(A,{key:3,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,"show-search":"",options:I(v).provinces,"filter-option":L,onChange:t,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),o.name=="district_id"?(i(),g(A,{key:4,value:e[o.name],"onUpdate:value":a=>e[o.name]=a,"show-search":"",options:I(v).districts,"filter-option":L,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0)],64))),128))]),D("div",null,p(j()),1),r(N,null,{default:d(()=>[r(T,{type:"primary",class:"btn-produce","html-type":"submit",loading:G.value},{default:d(()=>[b("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},Ua=ue(Ca,[["__scopeId","data-v-4855a03a"]]);const Da={class:"wrapper-booking"},Sa={class:"grid-booking"},za={class:"select-notaries"},Ra={class:"name"},$a={class:"city"},Ea={class:"address"},Aa="DD/MM/YYYY",Na={__name:"EditarFormalizacionRUC20",props:["info"],emits:["closeDraw"],setup(H,{emit:V}){M.locale("es");const _=ia({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}});ea();const O=JSON.parse(localStorage.getItem("profile")),u=H,E=V,G=U(!1),v=U(null);U(null);const e=U(!0),j=U(!1),y=ce(),P=U(null);y.$patch({cities:y.cities}),y.$patch({modalities:y.modalities}),y.$patch({economicSectors:y.economicSectors}),y.$patch({comercialActivities:y.comercialActivities}),y.$patch({regimes:y.regimes}),y.fetchEconomicSectors(),y.fetchComercialActivities(),y.fetchRegimes(),y.fetchModalities(),y.fetchCities();const t=xe({city_id:null,province_id:null,district_id:null,address:null,modality_id:null,nameMype:null,ruc:null,economicsector_id:null,comercialactivity_id:null,regime_id:null,numbernotary:null,notary_id:null,dateReception:null,dateTramite:null}),L=C=>{C=="ruc"&&(t[C]=t[C].replace(/\D/g,""))},J=()=>{var C;t.city_id=u.info.city_id,S(u.info.city_id),t.province_id=u.info.province_id,A(u.info.province_id),t.district_id=u.info.district_id,t.address=u.info.address,t.modality_id=u.info.modality_id,t.nameMype=u.info.nameMype,t.ruc=u.info.ruc,t.economicsector_id=u.info.economicsector_id,t.comercialactivity_id=u.info.comercialactivity_id,t.regime_id=u.info.regime_id,t.numbernotary=u.info.numbernotary,t.notary_id=u.info.notary_id,u.info.dateReception&&(t.dateReception=M(u.info.dateReception,"YYYY-MM-DD")),u.info.dateTramite&&(t.dateTramite=M(u.info.dateTramite,"YYYY-MM-DD")),(C=y.regimes)!=null&&C.length&&(e.value=!1)},q=(C,o)=>{const z=C.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=o.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),K=o.city.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),R=o.province.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),ee=o.district.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.includes(z)||K.includes(z)||R.includes(z)||ee.includes(z)},f=async()=>{try{G.value=!0;const C={name:v.value};(await ae({url:"create/comercial-activities",method:"POST",data:C})).status==200&&(v.value=null,y.fetchComercialActivities())}catch(C){console.log(C)}finally{G.value=!1}},S=C=>{t.province_id=null,t.district_id=null,y.fetchProvinces(C)},A=C=>{t.district_id=null,y.fetchDistricts(C)},N=async()=>{try{const C={city_id:t.city_id},{data:o}=await oa({url:"public/notaries-filters",method:"GET"});P.value=null;const z=o.map(a=>({value:a.id,name:a.name,city:a.city.name,province:a.province.name,district:a.district.name,address:a.address}));P.value=z}catch(C){console.error("Error de red:",C)}},Y=(C,o)=>{const z=C.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return o.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(z)},T=async()=>{j.value=!0;const C={city_id:t.city_id,province_id:t.province_id,district_id:t.district_id,address:t.address,modality_id:t.modality_id,nameMype:t.nameMype,ruc:t.ruc,economicsector_id:t.economicsector_id,comercialactivity_id:t.comercialactivity_id,regime_id:t.regime_id,numbernotary:t.numbernotary,notary_id:t.notary_id,dateReception:t.dateReception?M(t.dateReception).format("YYYY-MM-DD"):null,dateTramite:t.dateTramite?M(t.dateTramite).format("YYYY-MM-DD"):null,userupdated_id:O.user_id};try{const o=await ae({url:`formalization/update-ruc-20/${u.info.id}`,method:"PUT",data:C});o.status===200&&(Q.success(o.message),t.codesunarp=null,t.economicsector_id=null,t.comercialactivity_id=null,t.regime_id=null,t.city_id=null,t.province_id=null,t.district_id=null,t.address=null,t.modality_id=null,t.nameMype=null,t.dateReception=null,t.dateTramite=null,t.notary_id=null,t.ruc=null,t.numbernotary=null,E("closeDraw",!0))}catch(o){console.log("Error: "+o)}finally{j.value=!1}},X=()=>{Q.warning("Debes de completar todos los espacios requeridos")};return je(()=>{N()}),(C,o)=>{const z=w("a-select"),a=w("a-form-item"),K=w("a-date-picker"),R=w("a-divider"),ee=w("a-input"),oe=w("a-button"),pe=w("a-space"),_e=w("a-form"),ve=w("a-spin");return i(),h("div",Da,[r(ve,{spinning:e.value},{default:d(()=>[r(_e,{layout:"vertical",model:t,name:"basic",autocomplete:"off",onFinish:T,onFinishFailed:X},{default:d(()=>[D("div",Sa,[(i(!0),h(k,null,we(I(ya),(l,fe)=>(i(),h(k,{key:fe},[l.type==="iSelect"?(i(),g(a,{key:0,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:d(()=>[l.name=="regime_id"?(i(),g(z,{key:0,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,options:I(y).regimes,"show-search":"","filter-option":Y},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="modality_id"?(i(),g(z,{key:1,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,options:I(y).modalities},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="notary_id"?(i(),g(z,{key:2,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,options:P.value,"option-label-prop":"name",disabled:!t.city_id,"show-search":"","filter-option":q},{option:d(({value:$,name:ie,city:B,province:ye,district:x,address:s})=>[D("div",za,[D("span",Ra,p(ie),1),D("span",$a,p(B)+" - "+p(ye)+" - "+p(x),1),D("span",Ea,p(s),1)])]),_:2},1032,["value","onUpdate:value","options","disabled"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),l.type==="iDate"?(i(),g(a,{key:1,name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:d(()=>[r(K,{locale:I(aa),value:t[l.name],"onUpdate:value":$=>t[l.name]=$,style:{width:"100%"},format:Aa,placeholder:"día/mes/año",onChange:o[0]||(o[0]=$=>t.birthday=C.birthdateDate),disabled:l.disabled},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):n("",!0),l.type==="iSelectWrite"?(i(),g(a,{key:2,class:"item-max",name:l.name,label:l.label,rules:[{required:l.required,message:l.message}]},{default:d(()=>[l.name=="comercialactivity_id"?(i(),g(z,{key:0,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,"show-search":"",options:I(y).comercialActivities,"filter-option":Y},{dropdownRender:d(({menuNode:$})=>[r(I(_),{vnodes:$},null,8,["vnodes"]),r(R,{style:{margin:"4px 0"}}),r(pe,{style:{padding:"4px 8px"}},{default:d(()=>[r(ee,{ref_for:!0,ref:"inputRef",value:v.value,"onUpdate:value":o[1]||(o[1]=ie=>v.value=ie),placeholder:"Nueva actividad"},null,8,["value"]),r(oe,{type:"text",onClick:f,loading:G.value},{icon:d(()=>[r(I(ta))]),default:d(()=>[b(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):n("",!0),l.name=="economicsector_id"?(i(),g(z,{key:1,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,"show-search":"",options:I(y).economicSectors,"filter-option":Y},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="city_id"?(i(),g(z,{key:2,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,"show-search":"",options:I(y).cities,"filter-option":Y,onChange:S},null,8,["value","onUpdate:value","options"])):n("",!0),l.name=="province_id"?(i(),g(z,{key:3,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,"show-search":"",options:I(y).provinces,"filter-option":Y,onChange:A,disabled:!t.city_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0),l.name=="district_id"?(i(),g(z,{key:4,value:t[l.name],"onUpdate:value":$=>t[l.name]=$,"show-search":"",options:I(y).districts,"filter-option":Y,disabled:!t.province_id},null,8,["value","onUpdate:value","options","disabled"])):n("",!0)]),_:2},1032,["name","label","rules"])):n("",!0),l.type==="iText"?(i(),g(a,{key:3,name:l.name,label:l.label,rules:[{required:l.required,message:l.message,type:l.email,max:l.max}]},{default:d(()=>[r(ee,{onInput:$=>L(l.name),value:t[l.name],"onUpdate:value":$=>t[l.name]=$,disabled:l.disabled,maxlength:l.max,placeholder:l.placeholder},null,8,["onInput","value","onUpdate:value","disabled","maxlength","placeholder"])]),_:2},1032,["name","label","rules"])):n("",!0)],64))),128))]),D("div",null,p(J()),1),r(a,null,{default:d(()=>[r(oe,{class:"btn-produce",type:"primary","html-type":"submit",loading:j.value},{default:d(()=>[b("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},Fa=ue(Na,[["__scopeId","data-v-98a2c81f"]]);const me=H=>(ma("data-v-a69f3022"),H=H(),pa(),H),Ya={class:"header-rep"},Ma={class:"filters-dig"},La=me(()=>D("img",{width:"20",style:{margin:"-2px 4px 0 0"},src:_a},null,-1)),Ta={class:"filters"},qa={class:"rango"},Oa=me(()=>D("label",null,"Buscar por rango de Fechas",-1)),Pa={key:0,class:"asesor",style:{width:"300px"}},Ba=me(()=>D("label",null,"Buscar por Asesores",-1)),Ga=["onClick"],Ha=me(()=>D("a",null,"Eliminar",-1)),Va={style:{padding:"8px"}},ja={class:"paginator-asesories"},Ve=50,Ja={__name:"AsesoriasLista",setup(H){M.locale("es");const V=U(!1),_=U(!1),O=U(!1),u=U(null),E=JSON.parse(localStorage.getItem("role")),G=na.get("token"),v="https://apituempresa.soporte-pnte.com/api/",e="http://127.0.0.1:8000/api/",j=window.location.hostname=="localhost"||window.location.hostname=="127.0.0.1"?e:v,y=ce(),P=U([]),t=U(!1),L=U(!1),J=U(0),q=U({page:0}),f=U("asesorias"),S=U(1200),A=U(window.innerHeight-100),N=U("historial/advisories/filters"),Y=U([]),T=U(null);U(null),y.$patch({asesores:y.asesores}),y.fetchAsesores();const X=U([{label:"Últimos 7 días",value:[M().add(-7,"d"),M()]},{label:"Últimos 14 días",value:[M().add(-14,"d"),M()]},{label:"Último mes",value:[M().add(-30,"d"),M()]},{label:"Último 3 meses",value:[M().add(-90,"d"),M()]}]),C=(x,s)=>{const F=x.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return s.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(F)},o=()=>{A.value=window.innerHeight-360};la(()=>{window.removeEventListener("resize",o)});const z=U([]),a=U([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"FECHA",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"ASESOR (a) - Nombre Completo",dataIndex:"asesor",width:150},...E[0].id===1?[{title:"SUPERVISOR",dataIndex:"misupervisor",width:140}]:[],{title:"Tipo doc.",dataIndex:"sol_tipo_doc",width:60,align:"center"},{title:"Número de Documento",dataIndex:"sol_num_doc",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:160},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:160},{title:"Correo electrónico",dataIndex:"sol_email",width:220},{title:"Celular",dataIndex:"sol_phone",width:90,align:"center"},{title:"Región",dataIndex:"mype_region",width:120},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Componente",dataIndex:"componente",width:180},{title:"Tema",dataIndex:"tema_componente",width:160},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}]),K=U([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"FECHA",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"ASESOR (a) - Nombre Completo",dataIndex:"asesor",width:150},...E[0].id===1?[{title:"SUPERVISOR",dataIndex:"misupervisor",width:140}]:[],{title:"Tipo doc.",dataIndex:"sol_tipo_doc",width:60,align:"center"},{title:"Número de Documento",dataIndex:"sol_num_doc",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:160},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:160},{title:"Correo electrónico",dataIndex:"sol_email",width:220},{title:"Celular",dataIndex:"sol_phone",width:90,align:"center"},{title:"Región",dataIndex:"mype_region",width:120},{title:"Provincia",dataIndex:"mype_provincia",width:160},{title:"Distrito",dataIndex:"mype_distrito",width:160},{title:"Detalle del trámite",dataIndex:"detalle_tramite",width:180},{title:"Sector económico",dataIndex:"sector_economico",width:180},{title:"Actividad comercial",dataIndex:"atividad_comercial",width:180},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}]),R=U([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"FECHA",dataIndex:"ase_fecha",fixed:"left",align:"center",width:130},{title:"ASESOR (a) - Nombre Completo",dataIndex:"asesor",width:150},...E[0].id===1?[{title:"SUPERVISOR",dataIndex:"misupervisor",width:140}]:[],{title:"Tipo doc.",dataIndex:"sol_tipo_doc",width:60,align:"center"},{title:"Número de Documento",dataIndex:"sol_num_doc",width:100},{title:"Solicitante Apellidos",dataIndex:"sol_apellidos",width:140},{title:"Solicitante Nombres",dataIndex:"sol_nombres",width:140},{title:"Correo electrónico",dataIndex:"sol_email",width:220},{title:"Celular",dataIndex:"sol_phone",width:90,align:"center"},{title:"Región del negocio",dataIndex:"mype_region",width:140},{title:"Provincia del Negocio",dataIndex:"mype_provincia",width:160},{title:"Distrito del Negocio",dataIndex:"mype_distrito",width:160},{title:"Direccion del Negocio",dataIndex:"mype_direccion",width:230},{title:"N_RUC",dataIndex:"ruc",width:100,align:"center"},{title:"Nombre de Empresa Constituida",dataIndex:"mype_nombre",width:240,customFilterDropdown:!0},{title:"Régimen",dataIndex:"tipo_regimen",width:74,align:"center"},{title:"Notaría",dataIndex:"notaria",width:150},{title:"Modalidad",dataIndex:"modality",width:120,align:"center"},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}]),ee=(x,s,F)=>{console.log("handleSearch",F)},oe=x=>{},pe=async()=>{B(f.value)},_e=x=>{q.value.page=x,B()},ve=x=>M(x).format("DD-MM-YYYY HH:mm"),l=x=>({asesorias:"Asesorías",ruc10:"Formalizaciones RUC 10",ruc20:"Formalizaciones RUC 20"})[x],fe=async x=>{try{let s=null;f.value=="asesorias"&&(s=`advisory/delete/${x.id}`),f.value=="ruc10"&&(s=`formalization/delete-ruc-10/${x.id}`),f.value=="ruc20"&&(s=`formalization/delete-ruc-20/${x.id}`);const F=await ae({url:s,method:"DELETE"});B(),Q.success(F.message)}catch(s){console.error("Error de red:",s)}},$=async x=>{try{let s=null;f.value=="asesorias"&&(s=`advisory/find/${x.id}`),f.value=="ruc10"&&(s=`formalization/find-ruc-10/${x.id}`),f.value=="ruc20"&&(s=`formalization/find-ruc-20/${x.id}`);const F=await ae({url:s,method:"GET"});F.status==200&&(u.value=F.data,f.value=="asesorias"&&(V.value=!0),f.value=="ruc10"&&(_.value=!0),f.value=="ruc20"&&(O.value=!0))}catch(s){console.error("Error de red:",s)}},ie=async()=>{L.value=!0;let x="",s="";f.value=="asesorias"&&(x="download/asesories",s="asesorias.xlsx"),f.value=="ruc10"&&(x="download/formalizations-ruc10",s="formalizacionesRUC10.xlsx"),f.value=="ruc20"&&(x="download/formalizations-ruc20",s="formalizacionesRUC20.xlsx");try{const F={};T.value&&(F.dateStart=M(T.value[0]).format("YYYY-MM-DD"),F.dateEnd=M(T.value[1]).format("YYYY-MM-DD")),Y.value&&(F.idAsesor=Y.value[0]);const{data:ne}=await da.get(`${j}${x}`,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${G}`},params:F,responseType:"blob"}),he=new Blob([ne]),le=window.URL.createObjectURL(he),W=document.createElement("a");W.href=le,W.download=s,document.body.appendChild(W),W.click(),document.body.removeChild(W)}catch{Q.error("Error")}finally{L.value=!1}},B=async x=>{try{t.value=!0;const s={...Y.value.length>=1&&{user_id:Y.value.toString()},...T.value&&{dateStart:M(T.value[0]).format("YYYY-MM-DD")},...T.value&&{dateEnd:M(T.value[1]).format("YYYY-MM-DD")},...q.value.page!=0&&{page:q.value.page}};f.value=="asesorias"&&(z.value=a.value),x=="asesorias"&&(q.value.page=0,f.value=x,z.value=a.value,N.value="historial/advisories/filters"),x=="ruc10"&&(q.value.page=0,f.value=x,z.value=K.value,N.value="historial/formalizations-10/filters"),x=="ruc20"&&(q.value.page=0,f.value=x,z.value=R.value,N.value="historial/formalizations-20/filters");const F=await ae({url:N.value,method:"GET",params:s});P.value=F.data,J.value=F.total}catch(s){console.error("Error de red:",s)}finally{t.value=!1}},ye=sa(()=>x=>((q.value.page==0?1:q.value.page)-1)*Ve+x+1);return je(()=>{B(),window.addEventListener("resize",o),o()}),(x,s)=>{const F=w("a-button"),ne=w("a-range-picker"),he=w("a-select"),le=w("a-tag"),W=w("a-menu-item"),Je=w("a-popconfirm"),We=w("a-menu"),Ze=w("a-dropdown"),Qe=w("a-input"),Xe=w("a-table"),Ke=w("a-pagination"),ge=w("a-drawer");return i(),h(k,null,[D("div",null,[D("div",Ya,[D("h3",{class:be({hdactive:f.value=="asesorias"}),onClick:s[0]||(s[0]=c=>B("asesorias"))},"ASESORÍAS",2),D("h3",{class:be({hdactive:f.value=="ruc10"}),onClick:s[1]||(s[1]=c=>B("ruc10"))},"FORMALIZACIONES RUC 10",2),D("h3",{class:be({hdactive:f.value=="ruc20"}),onClick:s[2]||(s[2]=c=>B("ruc20"))},"FORMALIZACIONES RUC 20",2)]),D("div",Ma,[D("div",null,[D("div",null,[r(F,{class:"btn-excel",onClick:ie,loading:L.value,type:"primary"},{default:d(()=>[La,b(" DESCARGAR ")]),_:1},8,["loading"])])]),D("div",Ta,[D("div",qa,[Oa,r(ne,{value:T.value,"onUpdate:value":s[3]||(s[3]=c=>T.value=c),presets:X.value},null,8,["value","presets"])]),I(E)[0].id==1?(i(),h("div",Pa,[Ba,r(he,{value:Y.value,"onUpdate:value":s[4]||(s[4]=c=>Y.value=c),mode:"multiple",placeholder:"Selecciona asesores","max-tag-count":"responsive",options:I(y).asesores,"filter-option":C},null,8,["value","options"])])):n("",!0),r(F,{onClick:pe},{default:d(()=>[b("BUSCAR")]),_:1})])]),r(Xe,{bordered:"",scroll:{x:S.value,y:A.value},class:"table-historial",columns:z.value,"data-source":P.value,pagination:!1,loading:t.value,size:"small"},{bodyCell:d(({column:c,record:m,index:se})=>{var de,te,Z,Ie,ke,Ce,Ue,De,Se,ze,Re,$e,Ee,Ae,Ne,Fe,Ye,Me,Le,Te,qe,Oe,Pe,Be,Ge;return[c.dataIndex=="idx"?(i(),h(k,{key:0},[b(p(ye.value(se)),1)],64)):n("",!0),c.dataIndex=="ase_fecha"?(i(),h(k,{key:1},[b(p(ve(m.created_at)),1)],64)):n("",!0),c.dataIndex=="sol_apellidos"?(i(),h(k,{key:2},[b(p((de=m.people)==null?void 0:de.lastname)+" "+p((te=m.people)==null?void 0:te.middlename),1)],64)):n("",!0),c.dataIndex=="sol_nombres"?(i(),h(k,{key:3},[b(p((Z=m.people)==null?void 0:Z.name),1)],64)):n("",!0),c.dataIndex=="sol_tipo_doc"?(i(),h(k,{key:4},[b(p((ke=(Ie=m.people)==null?void 0:Ie.typedocument)==null?void 0:ke.avr),1)],64)):n("",!0),c.dataIndex=="sol_num_doc"?(i(),h(k,{key:5},[b(p((Ce=m.people)==null?void 0:Ce.documentnumber),1)],64)):n("",!0),c.dataIndex=="sol_email"?(i(),h(k,{key:6},[b(p((Ue=m.people)!=null&&Ue.email?m.people.email:"-"),1)],64)):n("",!0),c.dataIndex=="sol_phone"?(i(),h(k,{key:7},[b(p((De=m.people)==null?void 0:De.phone),1)],64)):n("",!0),c.dataIndex=="asesor"?(i(),h(k,{key:8},[b(p((Se=m.user)==null?void 0:Se.profile.name)+" "+p((ze=m.user)==null?void 0:ze.profile.lastname)+" "+p((Re=m.user)==null?void 0:Re.profile.middlename),1)],64)):n("",!0),c.dataIndex=="misupervisor"?(i(),h(k,{key:9},[b(p(($e=m.supervisor)==null?void 0:$e.supervisor_user.profile.name)+" "+p((Ee=m.supervisor)==null?void 0:Ee.supervisor_user.profile.lastname)+" "+p((Ae=m.supervisor)==null?void 0:Ae.supervisor_user.profile.middlename),1)],64)):n("",!0),c.dataIndex=="mype_region"?(i(),h(k,{key:10},[b(p((Ne=m.city)==null?void 0:Ne.name),1)],64)):n("",!0),c.dataIndex=="mype_provincia"?(i(),h(k,{key:11},[b(p((Fe=m.province)==null?void 0:Fe.name),1)],64)):n("",!0),c.dataIndex=="mype_distrito"?(i(),h(k,{key:12},[b(p((Ye=m.district)==null?void 0:Ye.name),1)],64)):n("",!0),c.dataIndex=="componente"?(i(),h(k,{key:13},[b(p((Me=m.component)==null?void 0:Me.name),1)],64)):n("",!0),c.dataIndex=="tema_componente"?(i(),h(k,{key:14},[b(p((Le=m.theme)==null?void 0:Le.name),1)],64)):n("",!0),c.dataIndex=="detalle_tramite"?(i(),h(k,{key:15},[b(p((Te=m.detailprocedure)==null?void 0:Te.name),1)],64)):n("",!0),c.dataIndex=="sector_economico"?(i(),h(k,{key:16},[b(p((qe=m.economicsector)==null?void 0:qe.name),1)],64)):n("",!0),c.dataIndex=="atividad_comercial"?(i(),h(k,{key:17},[b(p((Oe=m.comercialactivity)==null?void 0:Oe.name),1)],64)):n("",!0),c.dataIndex=="mype_direccion"?(i(),h(k,{key:18},[b(p(m==null?void 0:m.address),1)],64)):n("",!0),c.dataIndex=="mype_nombre"?(i(),h(k,{key:19},[b(p(m.nameMype),1)],64)):n("",!0),c.dataIndex=="tipo_regimen"?(i(),h(k,{key:20},[b(p((Pe=m.regime)==null?void 0:Pe.name),1)],64)):n("",!0),c.dataIndex=="numero_envio_notaria"?(i(),h(k,{key:21},[b(p(m.numbernotary),1)],64)):n("",!0),c.dataIndex=="notaria"?(i(),h(k,{key:22},[b(p((Be=m.notary)==null?void 0:Be.name),1)],64)):n("",!0),c.dataIndex=="codesunarp"?(i(),h(k,{key:23},[b(p(m.codesunarp),1)],64)):n("",!0),c.dataIndex==="modality"?(i(),g(le,{key:24,color:((Ge=m.modality)==null?void 0:Ge.name)=="PRESENCIAL"?"green":"orange"},{default:d(()=>{var re;return[b(p((re=m.modality)==null?void 0:re.name),1)]}),_:2},1032,["color"])):n("",!0),c.dataIndex=="ruc"?(i(),h(k,{key:25},[b(p(m.ruc?m.ruc:"EN TRÁMITE"),1)],64)):n("",!0),c.dataIndex=="actions"?(i(),g(Ze,{key:26,trigger:["click"]},{overlay:d(()=>[r(We,null,{default:d(()=>[r(W,null,{default:d(()=>[D("a",{onClick:re=>$(m)},"Editar",8,Ga)]),_:2},1024),r(W,null,{default:d(()=>[r(Je,{title:"¿Seguro de eliminar?",onConfirm:re=>fe(m),class:"prod-alert"},{icon:d(()=>[r(I(ra),{style:{color:"red"}})]),default:d(()=>[Ha]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:d(()=>[D("a",{class:"ant-dropdown-link",onClick:s[5]||(s[5]=ca(()=>{},["prevent"]))},[r(F,{shape:"circle",icon:ua(I(ha)),size:"small"},null,8,["icon"])])]),_:2},1024)):n("",!0)]}),customFilterDropdown:d(({setSelectedKeys:c,selectedKeys:m,confirm:se,clearFilters:de,column:te})=>[D("div",Va,[r(Qe,{ref:"searchInput",placeholder:`${te.title}`,value:m[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:Z=>c(Z.target.value?[Z.target.value]:[]),onPressEnter:Z=>ee(m,se,te.dataIndex)},null,8,["placeholder","value","onChange","onPressEnter"]),r(F,{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:Z=>ee(m,se,te.dataIndex)},{icon:d(()=>[r(I(He))]),default:d(()=>[b(" Buscar ")]),_:2},1032,["onClick"]),r(F,{size:"small",style:{width:"90px"},onClick:Z=>oe(de)},{default:d(()=>[b("Cancelar")]),_:2},1032,["onClick"])])]),customFilterIcon:d(({filtered:c})=>[r(I(He),{style:{color:"var(--secondary)"}})]),_:1},8,["scroll","columns","data-source","loading"])]),D("div",ja,[D("span",null,[r(le,{color:"blue"},{default:d(()=>[D("b",null,p(J.value),1)]),_:1}),b(p(l(f.value)),1)]),r(Ke,{size:"small",total:J.value,pageSize:Ve,onChange:_e,showSizeChanger:!1,defaultCurrent:2},null,8,["total"])]),r(ge,{width:"600",title:"Editar asesoría",open:V.value,"onUpdate:open":s[7]||(s[7]=c=>V.value=c),placement:"right"},{default:d(()=>[r(wa,{info:u.value,onCloseDraw:s[6]||(s[6]=c=>(V.value=!1,B()))},null,8,["info"])]),_:1},8,["open"]),r(ge,{width:"650",title:"Editar Formalización RUC 10",open:_.value,"onUpdate:open":s[9]||(s[9]=c=>_.value=c),placement:"right"},{default:d(()=>[r(Ua,{info:u.value,onCloseDraw:s[8]||(s[8]=c=>(_.value=!1,B()))},null,8,["info"])]),_:1},8,["open"]),r(ge,{width:"820",title:"Editar Formalización RUC 20",open:O.value,"onUpdate:open":s[11]||(s[11]=c=>O.value=c),placement:"right"},{default:d(()=>[r(Fa,{info:u.value,onCloseDraw:s[10]||(s[10]=c=>(O.value=!1,B()))},null,8,["info"])]),_:1},8,["open"])],64)}}},tt=ue(Ja,[["__scopeId","data-v-a69f3022"]]);export{tt as default};
