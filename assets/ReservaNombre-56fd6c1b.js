import{r as u,b as K,l as Q,d as p,o as i,e as U,c as s,w as d,f as X,F as W,B as Y,i as b,s as c,v as m,U as Z,j as E,V as ee,m as g,h as S,g as w}from"./index-1d39f797.js";import{r as ae,e as te}from"./selects-0fbcf7fc.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";const oe={code_sid_sunarp:{type:"iText",label:"Código SID sunarp",name:"code_sid_sunarp",required:!0,message:"Escribir apellido",disabled:!1},economy_sector:{type:"iSelect",label:"Sector económico",name:"economy_sector",required:!0,message:"Seleccionar tipo de documento",disabled:!1},category:{type:"iSelectWrite",label:"Actividad comercial",name:"category",required:!0,message:"Seleccionar tipo de documento",disabled:!1},type_regimen:{type:"iSelect",label:"Tipo de régimen societario",name:"type_regimen",required:!0,message:"Seleccionar tipo de documento",disabled:!1},department:{type:"iSelectWrite",label:"Departamento",name:"department",required:!0,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelectWrite",label:"Provincia",name:"province",required:!0,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelectWrite",label:"Distrito",name:"district",required:!0,message:"Seleccionar distrito",disabled:!1},address:{type:"iText",label:"Dirección del negocio",name:"address",required:!1,message:"Escribir apellido",disabled:!1}},me={social_reason:{type:"iText",label:"Nombre empresa",name:"social_reason",required:!0,message:"Escribir apellido",disabled:!1},num_notary:{type:"iText",label:"Número de solicitud de envio a Notaría",name:"num_notary",required:!1,message:"Seleccionar departamento",disabled:!1},id_notary:{type:"iSelect",label:"Notaría",name:"id_notary",required:!1,message:"Seleccionar notaría",disabled:!1},modality:{type:"iSelect",label:"Modalidad de atención",name:"modality",required:!1,message:"Seleccionar modalidad",disabled:!1}},ue={ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!0,message:"Escribir número de RUC",disabled:!1,max:9,min:9}},pe={detail_procedure:{type:"iSelect",label:"Detalle del trámite",name:"detail_procedure",required:!0,message:"Escribir número de RUC",disabled:!1},modality:{type:"iSelect",label:"Modalidad de atención",name:"modality",required:!0,message:"Seleccionar modalidad",disabled:!1},economy_sector:{type:"iSelect",label:"Sector económico",name:"economy_sector",required:!0,message:"Seleccionar el sector económico",disabled:!1},category:{type:"iSelectWrite",label:"Actividad comercial",name:"category",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},department:{type:"iSelectWrite",label:"Departamento",name:"department",required:!0,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelectWrite",label:"Provincia",name:"province",required:!0,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelectWrite",label:"Distrito",name:"district",required:!0,message:"Seleccionar distrito",disabled:!1}},ve={component:{type:"iSelect",label:"Componente",name:"component",required:!0,message:"Seleccionar un componente",disabled:!1},tema_compoment:{type:"iSelectWrite",label:"Tema del componente",name:"tema_compoment",required:!0,message:"Seleccionar un tema del componente",disabled:!1},modality:{type:"iSelect",label:"Modalidad de atención",name:"modality",required:!0,message:"Seleccionar modalidad",disabled:!1},department:{type:"iSelectWrite",label:"Departamento",name:"department",required:!0,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelectWrite",label:"Provincia",name:"province",required:!0,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelectWrite",label:"Distrito",name:"district",required:!0,message:"Seleccionar distrito",disabled:!1},description:{type:"iTextarea",label:"Observaciones",name:"description",required:!1,message:"Seleccionar tipo de documento",disabled:!1}};const le={class:"wrapper-booking"},ie={class:"grid-booking"},ne={__name:"ReservaNombre",props:["info"],emits:["closeDraw"],setup(O,{emit:F}){const P=ee({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}});JSON.parse(localStorage.getItem("user"));const k=JSON.parse(localStorage.getItem("info")),q=O,A=F,h=u([]),y=u([]),v=u([]),D=u([]),x=u(!1),_=u(),N=u(!1),a=K({id_person:null,dni:null,step:1,type_regimen:null,code_sid_sunarp:null,economy_sector:null,department:null,province:null,district:null,address:null,created_by:k.id,created_dni:k.dni}),z=async()=>{N.value=!0;try{await g({url:"/create-comercial-activities",method:"POST",data:{name:_.value}}),T(),_.value=""}catch{S.error("Error al registrar")}finally{N.value=!1}},I=async()=>{a.id_person=q.info.id,a.dni=q.info.dni,x.value=!0;const t={number:q.info.dni,id_post:3};try{const r=await g({url:"/formalization20",method:"POST",data:a});await g({url:"/person-post",method:"POST",data:t}),r&&(S.success("Registro exitoso"),a.type_regimen=null,a.code_sid_sunarp=null,a.economy_sector=null,a.department=null,a.province=null,a.district=null,a.address=null,A("closeDraw",!0))}catch{S.error("Error al registrar")}finally{x.value=!1}},V=()=>{S.error("Debes de completar todos los espacios requeridos")},f=(t,r)=>{const o=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)},B=async()=>{try{const{data:t}=await w({url:"/departaments",method:"GET"});let r=t.map(o=>({label:o.label,value:o.id}));h.value=[...h.value,...r]}catch(t){console.log(t)}},G=async t=>{a.province=null,a.district=null,y.value=[],v.value=[];try{const{data:r}=await w({url:`/province/${t}`,method:"GET"});let o=r.map(n=>({label:n.label,value:n.id}));y.value=[...y.value,...o]}catch(r){console.log(r)}},L=async t=>{a.district=null,v.value=[];try{const{data:r}=await w({url:`/district/${t}`,method:"GET"});let o=r.map(n=>({label:n.label,value:n.id}));v.value=[...v.value,...o]}catch(r){console.log(r)}},T=async()=>{try{const{data:t}=await g({url:"/comercial-activities",method:"GET"});D.value=t}catch(t){console.log(t)}};return Q(()=>{B(),T()}),(t,r)=>{const o=p("a-select"),n=p("a-form-item"),M=p("a-divider"),C=p("a-input"),R=p("a-button"),j=p("a-space"),J=p("a-form");return i(),U("div",le,[s(J,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:I,onFinishFailed:V},{default:d(()=>[X("div",ie,[(i(!0),U(W,null,Y(b(oe),(e,$)=>(i(),U(W,{key:$},[e.type==="iSelect"?(i(),c(n,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[e.name=="type_regimen"?(i(),c(o,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:b(ae)},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="economy_sector"?(i(),c(o,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:b(te)},null,8,["value","onUpdate:value","options"])):m("",!0)]),_:2},1032,["name","label","rules"])):m("",!0),e.type==="iSelectWrite"?(i(),c(n,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[e.name=="category"?(i(),c(o,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:D.value,"filter-option":f},{dropdownRender:d(({menuNode:l})=>[s(b(P),{vnodes:l},null,8,["vnodes"]),s(M,{style:{margin:"4px 0"}}),s(j,{style:{padding:"4px 8px"}},{default:d(()=>[s(C,{ref_for:!0,ref:"inputRef",value:_.value,"onUpdate:value":r[0]||(r[0]=H=>_.value=H),placeholder:"Nueva actividad"},null,8,["value"]),s(R,{type:"text",onClick:z,loading:N.value},{icon:d(()=>[s(b(Z))]),default:d(()=>[E(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):m("",!0),e.name=="department"?(i(),c(o,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:h.value,"filter-option":f,onChange:G},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="province"?(i(),c(o,{key:2,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:y.value,"filter-option":f,onChange:L},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="district"?(i(),c(o,{key:3,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:v.value,"filter-option":f},null,8,["value","onUpdate:value","options"])):m("",!0)]),_:2},1032,["name","label","rules"])):m("",!0),e.type==="iText"?(i(),c(n,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email,max:e.max}]},{default:d(()=>[s(C,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,disabled:e.disabled},null,8,["value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):m("",!0)],64))),128))]),s(n,null,{default:d(()=>[s(R,{type:"primary","html-type":"submit",loading:x.value},{default:d(()=>[E("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}},be=re(ne,[["__scopeId","data-v-e4cbef69"]]);export{be as R,me as a,ve as b,ue as f,pe as r};
