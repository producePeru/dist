import{_ as L}from"./TableComponent-4dcfdfea.js";import{E as F,r,u as H,a as z,p as O,k as j,W as v,b as E,o as _,d as x,c as m,w as p,m as S,y as q,z as C,e as i,t as l,h as G}from"./index-7c6eb53c.js";import{d as J}from"./downloadExcel-e1507034.js";import{g as W}from"./publicInscripcion-623ff37e.js";import"./es-54c8f561.js";import{_ as K}from"./ParticipanteSed-181ca7da.js";import"./icoexcel-1b303edf.js";import"./selectes-ebde9b56.js";import"./SyncOutlined-69ebeb9a.js";import"./MoreOutlined-ad296fb6.js";import"./FormComponent-82105699.js";import"./quill.snow-9071d684.js";const Q={class:"layout-content mp-table"},X={key:1,class:"mp-empresario"},Z={key:2,class:"mp-empresario"},ee=["onClick"],ae=["onClick"],he={__name:"mp-asistentes",setup(te){const g=F();JSON.parse(localStorage.getItem("role"));const D=r([]),R=r(0),k=r(150),h=r(!1);H();const f=r(!1),w=r(null),y=r(!1),A=r({name:"Cargando..."}),n=z({year:O("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),b=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"ASISTIÃ“",dataIndex:"asistio",width:80,align:"center",fixed:"left"},{title:"EMPRESARIO",dataIndex:"empresario",width:360},{title:"DISCAPACIDAD",dataIndex:"sick",width:120,align:"center"},{title:"VINCULACIÃ“N CON LA MYPE",dataIndex:"roleCompany",width:200,align:"center"},{title:"EMPRESA",dataIndex:"empresa",width:360},{title:"SECTOR ECONÃ“MICO",dataIndex:"economicSector",align:"center",width:120},{title:"RUBRO",dataIndex:"rubro",align:"center",width:180},{title:"ACTIVIDAD COMERCIAL",dataIndex:"comercialActivity",align:"center",width:180},{title:"DNI OBS",dataIndex:"obs_dni",align:"center",width:100},{title:"RUC OBS",dataIndex:"obs_ruc",align:"center",width:100},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],T=e=>{const o=new URLSearchParams(e).toString(),t=`${W()}/mujer-produce?${o}`;window.open(t,"_blank")},Y=()=>{c(),h.value=!1},P=()=>{w.value=null,h.value=!0},U=async(e,o)=>{const u={slug:g.params.slug,ruc:o.ruc,doc_number:o.dni};try{const d=await S({url:"mp/toggle-attendance",method:"PUT",data:u});d.status==200&&console.log("status",d.message)}catch(d){console.error("Error de red:",d)}},M=async e=>{const o={event_slug:g.params.slug,participant_id:e.participant_id};try{const t=await S({url:"mp/delete-assistant",method:"POST",data:o});t.status==200&&(c(),G.success(t.message))}catch(t){console.error("Error de red:",t)}},B=async()=>{y.value=!0;try{const e={},o=g.params.slug;n.name&&(e.name=n.name);let t=`download/mp-attendance-export/${o}`;await J(t,"inscritos",e)}catch(e){console.error("Error de red:",e)}finally{y.value=!1}},$=async e=>{n.page=e,await c()},V=async e=>{e&&(n.page=1,await c())},c=async()=>{try{f.value=!0;const e={page:n.page},o=g.params.slug;n.year&&(e.year=O(n.year).format("YYYY")),n.range&&(e.dateStart=n.range[0].format("YYYY/MM/DD"),e.dateEnd=n.range[1].format("YYYY/MM/DD")),n.name&&(e.name=n.name),n.orderby&&(e.orderby=n.orderby);const t=await S({url:`mp/attendance-event/${o}`,method:"GET",params:e});A.value.name=t.eventTitle,D.value=t.data.data,R.value=t.data.total,k.value=t.data.per_page}catch(e){console.error("Error de red:",e)}finally{f.value=!1}};return j(async()=>{await c()}),v("search",n),v("loading",f),v("loadingFile",y),(e,o)=>{var N;const t=E("a-checkbox"),u=E("a-menu-item"),d=E("a-drawer");return _(),x("div",Q,[m(L,{title:`ðŸ‘© INSCRITOS EN : ${(N=A.value)==null?void 0:N.name}`,new:!1,textNuevo:"NUEVO EVENTO",downloadExcel:!0,placeholderSearch:"Buscar",bread:!0,routeBack:"/admin/mp/capacitaciones",searchYear:!1,rangeDate:!1,columns:b,titleSearch:"FILTRAR POR RUC O DNI",pageSize:k.value,nameTotal:"Inscritos",dataSource:D.value,total:R.value,btnUpdate:!0,onHandleNew:P,onHandleCallFetchData:c,onHandleDownloadExcel:B,onHandleSearch:V,onHandlePaginator:$},{"data-cell":p(({column:s,record:a})=>[s.dataIndex=="asistio"?(_(),q(t,{key:0,checked:a.attendance,"onUpdate:checked":I=>a.attendance=I,onChange:I=>U(I,a)},null,8,["checked","onUpdate:checked","onChange"])):C("",!0),s.dataIndex=="empresario"?(_(),x("div",X,[i("b",null,l(a.name)+" "+l(a.last_name)+" "+l(a.middle_name),1),i("span",null,l(a.typeDocument)+" "+l(a.dni)+" / "+l(a.phone)+" / "+l(a.email),1)])):C("",!0),s.dataIndex=="empresa"?(_(),x("div",Z,[i("b",null,l(a.socialReason),1),i("span",null,l(a.ruc),1),i("span",null,l(a.city)+" - "+l(a.province)+" - "+l(a.district),1)])):C("",!0)]),"custom-options":p(({record:s})=>[m(u,null,{default:p(()=>[i("a",{onClick:a=>T(s)},"Editar",8,ee)]),_:2},1024),m(u,null,{default:p(()=>[i("a",{onClick:a=>M(s)},"Eliminar",8,ae)]),_:2},1024)]),_:1},8,["title","pageSize","dataSource","total"]),m(d,{open:h.value,"onUpdate:open":o[0]||(o[0]=s=>h.value=s),title:w.value?"EDITAR DATOS DEL PARTICIPANTE":"NUEVO REGISTRO",placement:"right",width:"650"},{default:p(()=>[m(K,{onCloseDraw:Y,info:w.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{he as default};
