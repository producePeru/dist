import{r as u,b as K,l as Q,d as p,o as n,e as N,c as s,w as d,f as X,F as W,B as Y,i as v,s as c,v as m,T as Z,j as E,U as ee,m as f,h as S,g as k}from"./index-c5dd4cba.js";import{r as ae,e as te,m as re}from"./selects-0fbcf7fc.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";const le={code_sid_sunarp:{type:"iText",label:"Código SID sunarp",name:"code_sid_sunarp",required:!0,message:"Escribir apellido",disabled:!1},economy_sector:{type:"iSelect",label:"Sector económico",name:"economy_sector",required:!0,message:"Seleccionar tipo de documento",disabled:!1},category:{type:"iSelectWrite",label:"Actividad comercial",name:"category",required:!0,message:"Seleccionar tipo de documento",disabled:!1},type_regimen:{type:"iSelect",label:"Tipo de régimen societario",name:"type_regimen",required:!0,message:"Seleccionar tipo de documento",disabled:!1},department:{type:"iSelectWrite",label:"Departamento",name:"department",required:!0,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelectWrite",label:"Provincia",name:"province",required:!0,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelectWrite",label:"Distrito",name:"district",required:!0,message:"Seleccionar distrito",disabled:!1},address:{type:"iText",label:"Dirección del negocio",name:"address",required:!1,message:"Escribir apellido",disabled:!1},modality:{type:"iSelect",label:"Modalidad de atención",name:"modality",required:!0,message:"Seleccionar modalidad",disabled:!1}},ue={social_reason:{type:"iText",label:"Nombre empresa",name:"social_reason",required:!0,message:"Escribir apellido",disabled:!1},num_notary:{type:"iText",label:"Número de solicitud de envio a Notaría",name:"num_notary",required:!1,message:"Seleccionar departamento",disabled:!1},id_notary:{type:"iSelect",label:"Notaría",name:"id_notary",required:!1,message:"Seleccionar notaría",disabled:!1}},pe={ruc:{type:"iText",label:"Número de RUC",name:"ruc",required:!0,message:"Escribir número de RUC",disabled:!1,max:9,min:9}},ve={detail_procedure:{type:"iSelect",label:"Detalle del trámite",name:"detail_procedure",required:!0,message:"Escribir número de RUC",disabled:!1},modality:{type:"iSelect",label:"Modalidad de atención",name:"modality",required:!0,message:"Seleccionar modalidad",disabled:!1},economy_sector:{type:"iSelect",label:"Sector económico",name:"economy_sector",required:!0,message:"Seleccionar el sector económico",disabled:!1},category:{type:"iSelectWrite",label:"Actividad comercial",name:"category",required:!0,message:"Seleccionar la actividad comercial",disabled:!1},department:{type:"iSelectWrite",label:"Departamento",name:"department",required:!0,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelectWrite",label:"Provincia",name:"province",required:!0,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelectWrite",label:"Distrito",name:"district",required:!0,message:"Seleccionar distrito",disabled:!1}},ye={component:{type:"iSelect",label:"Componente",name:"component",required:!0,message:"Seleccionar un componente",disabled:!1},tema_compoment:{type:"iSelectWrite",label:"Tema del componente",name:"tema_compoment",required:!0,message:"Seleccionar un tema del componente",disabled:!1},modality:{type:"iSelect",label:"Modalidad de atención",name:"modality",required:!0,message:"Seleccionar modalidad",disabled:!1},department:{type:"iSelectWrite",label:"Departamento",name:"department",required:!0,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelectWrite",label:"Provincia",name:"province",required:!0,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelectWrite",label:"Distrito",name:"district",required:!0,message:"Seleccionar distrito",disabled:!1},description:{type:"iTextarea",label:"Observaciones",name:"description",required:!1,message:"Seleccionar tipo de documento",disabled:!1}};const ne={class:"wrapper-booking"},ie={class:"grid-booking"},se={__name:"ReservaNombre",props:["info"],emits:["closeDraw"],setup(O,{emit:F}){const P=ee({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}});JSON.parse(localStorage.getItem("user"));const w=JSON.parse(localStorage.getItem("info")),q=O,A=F,h=u([]),b=u([]),y=u([]),T=u([]),x=u(!1),_=u(),U=u(!1),a=K({id_person:null,dni:null,step:1,type_regimen:null,code_sid_sunarp:null,economy_sector:null,department:null,province:null,district:null,address:null,modality:null,created_by:w.id,created_dni:w.dni}),z=async()=>{U.value=!0;try{await f({url:"/create-comercial-activities",method:"POST",data:{name:_.value}}),D(),_.value=""}catch{S.error("Error al registrar")}finally{U.value=!1}},I=async()=>{a.id_person=q.info.id,a.dni=q.info.dni,x.value=!0;const t={number:q.info.dni,id_post:3};try{const r=await f({url:"/formalization20",method:"POST",data:a});await f({url:"/person-post",method:"POST",data:t}),r&&(S.success("Registro exitoso"),a.type_regimen=null,a.code_sid_sunarp=null,a.economy_sector=null,a.department=null,a.province=null,a.district=null,a.address=null,a.modality=null,A("closeDraw",!0))}catch{S.error("Error al registrar")}finally{x.value=!1}},B=()=>{S.error("Debes de completar todos los espacios requeridos")},g=(t,r)=>{const l=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return r.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(l)},G=async()=>{try{const{data:t}=await k({url:"/departaments",method:"GET"});let r=t.map(l=>({label:l.label,value:l.id}));h.value=[...h.value,...r]}catch(t){console.log(t)}},L=async t=>{a.province=null,a.district=null,b.value=[],y.value=[];try{const{data:r}=await k({url:`/province/${t}`,method:"GET"});let l=r.map(i=>({label:i.label,value:i.id}));b.value=[...b.value,...l]}catch(r){console.log(r)}},V=async t=>{a.district=null,y.value=[];try{const{data:r}=await k({url:`/district/${t}`,method:"GET"});let l=r.map(i=>({label:i.label,value:i.id}));y.value=[...y.value,...l]}catch(r){console.log(r)}},D=async()=>{try{const{data:t}=await f({url:"/comercial-activities",method:"GET"});T.value=t}catch(t){console.log(t)}};return Q(()=>{G(),D()}),(t,r)=>{const l=p("a-select"),i=p("a-form-item"),M=p("a-divider"),C=p("a-input"),R=p("a-button"),j=p("a-space"),J=p("a-form");return n(),N("div",ne,[s(J,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:I,onFinishFailed:B},{default:d(()=>[X("div",ie,[(n(!0),N(W,null,Y(v(le),(e,$)=>(n(),N(W,{key:$},[e.type==="iSelect"?(n(),c(i,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[e.name=="type_regimen"?(n(),c(l,{key:0,value:a[e.name],"onUpdate:value":o=>a[e.name]=o,options:v(ae)},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="economy_sector"?(n(),c(l,{key:1,value:a[e.name],"onUpdate:value":o=>a[e.name]=o,options:v(te)},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="modality"?(n(),c(l,{key:2,value:a[e.name],"onUpdate:value":o=>a[e.name]=o,options:v(re)},null,8,["value","onUpdate:value","options"])):m("",!0)]),_:2},1032,["name","label","rules"])):m("",!0),e.type==="iSelectWrite"?(n(),c(i,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[e.name=="category"?(n(),c(l,{key:0,value:a[e.name],"onUpdate:value":o=>a[e.name]=o,"show-search":"",options:T.value,"filter-option":g},{dropdownRender:d(({menuNode:o})=>[s(v(P),{vnodes:o},null,8,["vnodes"]),s(M,{style:{margin:"4px 0"}}),s(j,{style:{padding:"4px 8px"}},{default:d(()=>[s(C,{ref_for:!0,ref:"inputRef",value:_.value,"onUpdate:value":r[0]||(r[0]=H=>_.value=H),placeholder:"Nueva actividad"},null,8,["value"]),s(R,{type:"text",onClick:z,loading:U.value},{icon:d(()=>[s(v(Z))]),default:d(()=>[E(" Agregar ")]),_:1},8,["loading"])]),_:1})]),_:2},1032,["value","onUpdate:value","options"])):m("",!0),e.name=="department"?(n(),c(l,{key:1,value:a[e.name],"onUpdate:value":o=>a[e.name]=o,"show-search":"",options:h.value,"filter-option":g,onChange:L},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="province"?(n(),c(l,{key:2,value:a[e.name],"onUpdate:value":o=>a[e.name]=o,"show-search":"",options:b.value,"filter-option":g,onChange:V},null,8,["value","onUpdate:value","options"])):m("",!0),e.name=="district"?(n(),c(l,{key:3,value:a[e.name],"onUpdate:value":o=>a[e.name]=o,"show-search":"",options:y.value,"filter-option":g},null,8,["value","onUpdate:value","options"])):m("",!0)]),_:2},1032,["name","label","rules"])):m("",!0),e.type==="iText"?(n(),c(i,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email,max:e.max}]},{default:d(()=>[s(C,{value:a[e.name],"onUpdate:value":o=>a[e.name]=o,disabled:e.disabled},null,8,["value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):m("",!0)],64))),128))]),s(i,null,{default:d(()=>[s(R,{type:"primary","html-type":"submit",loading:x.value},{default:d(()=>[E("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}},be=oe(se,[["__scopeId","data-v-2a5e8c32"]]);export{be as R,ue as a,ye as b,pe as f,ve as r};
