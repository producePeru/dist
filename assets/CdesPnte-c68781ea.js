import{_ as $}from"./TableComponent-245476c0.js";import{l as q,r as n,a as O,j as R,U as V,a6 as p,o as w,x as A,h as F,L as H,d as P,c as m,N as x,m as M,b as T,w as S,y as z,e as G}from"./index-f2399586.js";import{_ as L}from"./FormComponent-c0246b6d.js";import"./es-b8c7d40c.js";import{d as j}from"./downloadExcel-b7fbbde8.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-15933f35.js";import"./quill.snow-9dde125c.js";const J={key:1,class:"f-20"},Z={__name:"EditarCde",props:["info"],emits:["closeDraw"],setup(D,{emit:f}){q.locale("es");const v=n({name:{type:"iText",label:"NOMBRE CDE",name:"name",required:!0,message:"Escribir nombre de CDE",disabled:!1},city:{type:"iText",label:"REGIÓN",name:"city",required:!0,message:"Escribir nombre de la región",disabled:!1},province:{type:"iText",label:"PROVINCIA",name:"province",required:!0,message:"Escribir nombre de la provincia",disabled:!1},district:{type:"iText",label:"DISTRITO",name:"district",required:!0,message:"Escribir nombre del distrito",disabled:!1},address:{type:"iTextArea",label:"DIRECCIÓN",name:"address",required:!0,message:"Escribir la dirección del CDE",disabled:!1,rows:3}}),y=f,s=D,i=n(!0),d=n("ACTUALIZAR"),e=O({}),r=n(!1),C=n(null),I=async()=>{r.value=!0;const t={name:e.name,city:e.city,province:e.province,district:e.district,address:e.address};try{const o=await x({url:`config/cde/${s.info.id}`,method:"PUT",data:t});o.status===200&&(b(),M.success(o.message),y("closeDraw",!0))}catch(o){console.error("Error:",o);const g=document.getElementsByClassName("ant-drawer-body")[0];g&&(g.scrollTop=0)}finally{r.value=!1}},b=()=>{e.name=null,e.city=null,e.province=null,e.district=null},_=async t=>{i.value=!0;try{t&&(e.name=t.name,e.city=t.city,e.province=t.province,e.district=t.district,e.address=t.address)}catch(o){console.error("Error al cargar la información:",o)}finally{i.value=!1}};return R(()=>{s.info&&_(s.info)}),V(()=>s.info,t=>{t&&_(t)}),p("formState",e),p("loadingState",r),(t,o)=>i.value?(w(),A(F(H),{key:0,style:{color:"#00a6db"}})):(w(),P("div",J,[m(L,{fields:v.value,btnSaveName:d.value,resetSelect:C.value,onOnSubmit:I},null,8,["fields","btnSaveName","resetSelect"])]))}};const K={class:"cde-table"},Q=["onClick"],oe={__name:"CdesPnte",setup(D){JSON.parse(localStorage.getItem("role"));const f=n([]),v=n(0),y=n(150);n(!1);const s=n(!1),i=n(!1),d=n(!1),e=n(null),r=O({asesor:null,name:null,page:1}),C=[{title:"#",dataIndex:"idx",align:"center",width:70},{title:"NOMBRE CDE",dataIndex:"name",width:220},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:120},{title:"DISTRITO",dataIndex:"district",width:120},{title:"DIRECCIÓN",dataIndex:"address",width:250},{title:"TIPO",dataIndex:"cdeType",align:"center",width:200},{title:"",dataIndex:"actions",width:40,align:"center",fixed:"right"}],I=()=>{console.log("handleNew...")},b=n([{label:"CDE",value:1},{label:"CDEAI INSTITUCIONES",value:2},{label:"CDEAN NOTARÍAS",value:3}]),_=a=>{e.value=a,d.value=!0},t=async()=>{i.value=!0;try{await j("download/cdes","cdes-pnte",{})}catch(a){console.error("Error de red:",a)}finally{i.value=!1}},o=async a=>{r.page=a,await h()},g=async a=>{a&&(r.page=1,await h())},h=async()=>{s.value=!0;try{const a={page:r.page},l=await x({url:"config/cdes",method:"GET",params:a});f.value=l.data.data,v.value=l.data.total,y.value=l.data.per_page}catch(a){console.error("Error de red:",a)}finally{s.value=!1}},U=async(a,l)=>{try{const u={value:a};await x({url:`config/chooseCde/${l.id}`,method:"PUT",data:u})}catch{console.log("Failed to delete")}};return R(async()=>{await h()}),p("search",r),p("loading",s),p("loadingFile",i),(a,l)=>{const u=T("a-select"),k=T("a-menu-item"),B=T("a-drawer");return w(),P("div",K,[m($,{title:"CDE PNTE",new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",columns:C,titleSearch:"NOMBRE CDE",pageSize:y.value,nameTotal:"Solicitantes",dataSource:f.value,total:v.value,onHandleNew:I,onHandleDownloadExcel:t,onHandleSearch:g,onHandlePaginator:o},{"data-cell":S(({column:c,record:E})=>[c.dataIndex=="cdeType"?(w(),A(u,{key:0,style:{width:"100%"},value:E.cdetype_id,"onUpdate:value":N=>E.cdetype_id=N,options:b.value,onChange:N=>U(N,E)},null,8,["value","onUpdate:value","options","onChange"])):z("",!0)]),"custom-options":S(({record:c})=>[m(k,null,{default:S(()=>[G("a",{onClick:E=>_(c)},"Editar",8,Q)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),m(B,{width:"500",title:"EDITAR DATOS DE CDE",open:d.value,"onUpdate:open":l[1]||(l[1]=c=>d.value=c),placement:"right"},{default:S(()=>[m(Z,{info:e.value,onCloseDraw:l[0]||(l[0]=c=>(d.value=!1,h()))},null,8,["info"])]),_:1},8,["open"])])}}};export{oe as default};
