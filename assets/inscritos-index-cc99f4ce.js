import{l as Z,r,a as K,j as Y,X as ve,a6 as Q,o as w,d as P,x as W,h as M,L as be,c as n,e as u,t as U,F,R as G,E as Ee,u as he,g as ye,G as we,Z as xe,b as i,w as l,i as k,a9 as Ce,y as X,a2 as Se,O as Oe,q as Re,m as Ie,K as Ne}from"./index-735c7ce9.js";import{_ as De}from"./icoexcel-1b303edf.js";import{_ as Te}from"./FormComponent-04f7d723.js";import{u as Ae}from"./selectes-bf599c4c.js";import"./es-0a4e9cad.js";import{M as Le}from"./MoreOutlined-696528f1.js";import"./vue-quill.esm-bundler-29c6dc83.js";import"./quill.snow-43dc0299.js";/* empty css                                                      */const ke={key:1,class:"f-20"},Me={__name:"EventosUgoAsistentes",props:["info"],emits:["closeDraw"],setup(V,{emit:I}){Z.locale("es");const m=Ae(),N=JSON.parse(localStorage.getItem("role"));m.fetchCities();const D=r({typedocument_id:{type:"iSelect",label:"TIPO DE DOCUMENTO",name:"typedocument_id",required:!0,message:"Seleccionar tipo de documento",disabled:!N.some(t=>t.id==1||t.id==5)},documentnumber:{type:"iText",label:"NÚMERO DE DOCUMENTO",name:"documentnumber",required:!0,message:"Escribe número de documento",disabled:!N.some(t=>t.id==1||t.id==5),rules:[{validator:(t,s)=>{if(!s)return Promise.reject(new Error("Escribe número de documento"));const d=String(s);if(!/^\d+$/.test(d))return Promise.reject(new Error("Solo números son permitidos"));if(e.typedocument_id===1){if(d.length!==8)return Promise.reject(new Error("Debe tener exactamente 8 dígitos"))}else if(d.length<3||d.length>10)return Promise.reject(new Error("Debe tener entre 3 y 10 dígitos"));return Promise.resolve()},trigger:"change"}]},lastname:{type:"iText",label:"APELLIDO PATERNO",name:"lastname",required:!0,message:"Escribir apellido",disabled:!1},middlename:{type:"iText",label:"APELLIDO MATERNO",name:"middlename",required:!0,message:"Escribir apellido",disabled:!1},name:{type:"iText",label:"NOMBRES",name:"name",required:!0,message:"Escribir nombre",disabled:!1},gender_id:{type:"iSelect",label:"GÉNERO",name:"gender_id",required:!0,message:"Seleccionar tipo de documento"},phone:{type:"iNumber",label:"NÚMERO DE CELULAR",name:"phone",required:!0,message:"Escribe un número de contacto de 9 dígitos",maxlength:9,disabled:!1,rules:[{validator:(t,s)=>{if(!s)return Promise.reject(new Error("El número es requerido"));const d=s.toString();return d.length!==9?Promise.reject(new Error("El número debe tener exactamente 9 dígitos")):d.substring(0,1)!=="9"?Promise.reject(new Error("El número debe comenzar con 9")):Promise.resolve()},trigger:"change"}]},email:{type:"iText",label:"CORREO ELECTRÓNICO",name:"email",required:!1,message:"Escribir un email válido",disabled:!1,rules:[{validator:(t,s)=>s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?Promise.resolve():Promise.reject(new Error("Debe ingresar un email válido")):Promise.resolve(),trigger:"change"}]},ruc:{type:"iText",label:"RUC",name:"ruc",required:!1,message:"Escribir nombre",disabled:!1},comercialName:{type:"iText",label:"NOMBRE COMERCIAL",name:"comercialName",required:!1,message:"Escribir nombre",disabled:!1},comercialActivity:{type:"iText",label:"ACTIVIDAD COMERCIAL",name:"comercialActivity",required:!1,message:"Escribir nombre",disabled:!1},mercado:{type:"iText",label:"MERCADO",name:"mercado",required:!1,message:"Escribir nombre",disabled:!1}}),B=I,f=V,v=r(!0),T=r("ACTUALIZAR"),e=K({}),b=r(!1),x=r(null),p=r({typedocument_id:[],gender_id:[]}),C=t=>{console.log("handleInputEvent",t)},E=async t=>{t=="dateReception"&&(e.dateTramite&&(e.dateTramite=null),D.value.dateTramite.disabled=!1)},$=async t=>{},A=async t=>{t=="typedocument_id"&&(p.value.typedocument_id=m.typeDocuments),t=="gender_id"&&(p.value.gender_id=m.genders)},S=t=>{},L=async()=>{b.value=!0;const t={typedocument_id:e.typedocument_id,documentnumber:e.documentnumber,lastname:e.lastname,middlename:e.middlename,name:e.name,gender_id:e.gender_id,phone:e.phone,email:e.email,ruc:e.ruc,comercialName:e.comercialName,comercialActivity:e.comercialActivity,mercado:e.mercado};try{(await G({url:`events-ugo/update-participant-data-ugo-event/${f.info.id}`,method:"PUT",data:t})).status===200&&(q(),B("closeDraw",!0))}catch(s){console.error("Error:",s);const d=document.getElementsByClassName("ant-drawer-body")[0];d&&(d.scrollTop=0)}finally{b.value=!1}},q=()=>{e.typedocument_id=null,e.documentnumber=null,e.lastname=null,e.middlename=null,e.name=null,e.country_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.birthday=null,e.phone=null,e.email=null,e.gender_id=null,e.sick=null,e.hasSoon=null},_=async t=>{v.value=!0;try{t&&(await m.fetchTypeDocuments(),p.value.typedocument_id=m.typeDocuments,e.typedocument_id=t.typedocument_id,e.documentnumber=t.documentnumber,e.lastname=t.lastname,e.middlename=t.middlename,e.name=t.name,e.phone=t.phone,e.email=t.email,await m.fetchGenders(),p.value.gender_id=m.genders,e.gender_id=t.gender_id,e.ruc=t.ruc,e.comercialName=t.comercialName,e.comercialActivity=t.comercialActivity,e.mercado=t.mercado)}catch(s){console.error("Error al cargar la información:",s)}finally{v.value=!1}};return Y(()=>{f.info&&_(f.info)}),ve(()=>f.info,t=>{t&&_(t)}),Q("formState",e),Q("loadingState",b),(t,s)=>(w(),P(F,null,[v.value?(w(),W(M(be),{key:0,style:{color:"#00a6db"}})):(w(),P("div",ke,[n(Te,{fields:D.value,options:p.value,btnSaveName:T.value,onHandleInputEvent:C,resetSelect:x.value,onHandleChangeSelect:$,onHandleFocusSelect:A,onHandleBlurSelect:S,onHandleChangeClock:E,onOnSubmit:L},null,8,["fields","options","btnSaveName","resetSelect"])])),u("pre",null,U(),1)],64))}};const Ue={class:"title-produce"},Pe={style:{color:"var(--secondary)"}},Be=["onClick"],$e={class:"paginator"},Xe={__name:"inscritos-index",props:["idConvenio"],setup(V){Z.locale("es");const I=Ee();he();const m=JSON.parse(localStorage.getItem("role"))||[],N=ye.get("token"),D="https://apituempresa.soporte-pnte.com/api/",B="http://127.0.0.1:8000/api/",f=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?B:D;m.some(o=>o.id===10||o.id===11||o.id===5);const v=r(""),T=r(null),e=r(!1),b=r(null),x=r(!1),p=r(0),C=r(50),E=r({page:0}),$=r(1200),A=r([]),S=r(!1);r(!1);const L=r(window.innerHeight-100),q=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:70},{title:"REGISTRADO",dataIndex:"created_at",fixed:"left",width:120,align:"center"},{title:"APELLIDOS",dataIndex:"lastname",fixed:"left",width:160},{title:"NOMBRES ",dataIndex:"name",width:160,fixed:"left"},{title:"TIPO DOCUMENTO",dataIndex:"typedocument_name",width:100,align:"center"},{title:"NÚMERO DE DOCUMENTO",dataIndex:"documentnumber",align:"center",width:140},{title:"CELULAR",dataIndex:"phone",width:150,align:"center"},{title:"CORREO",dataIndex:"email",width:250},{title:"GÉNERO",dataIndex:"gender_name",align:"center",width:100},{title:"RUC",dataIndex:"ruc",align:"center",width:120},{title:"NOMBRE COMERCIAL",dataIndex:"comercialName",align:"center",width:140},{title:"RUBRO / ACTIVIDAD COMERCIAL",dataIndex:"comercialActivity",align:"center",width:200},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],_=K({search:""}),t=()=>{h(),e.value=!1},s=o=>{b.value=o,e.value=!0},d=()=>{let o={search:_.search};h(o)},ee=()=>{_.search||h()},te=o=>{E.value.page=o,h()},j=()=>{L.value=window.innerHeight-320},ae=async o=>{try{const a=await G({url:`events-ugo/remove-participant-ugo-event/${o.id}`,method:"DELETE"});a.status==200&&(h(),Ie.success(a.message))}catch(a){console.error("Error de red:",a)}},ne=we(()=>o=>E.value.page*C.value+o+1),h=async o=>{try{S.value=!0;let a;a=E.value.page==0?"":E.value,a=o?{...a,...o}:a;const O=I.params.slug,g=await G({url:`attendance/applicants/${O}`,method:"GET",params:a});v.value=g.nameEvent,T.value=g.typeEvent;const c=g.data;A.value=c==null?void 0:c.data,p.value=c.total,C.value=c.per_page}catch(a){console.error("Error de red:",a)}finally{S.value=!1}},oe=async()=>{x.value=!0;try{const o=I.params.slug;let a=null;T.value==3?a=`${f}download/attendance-mercado/${o}`:a=`${f}download/attendance/${o}`;const O=await Ne({url:a,method:"GET",responseType:"blob",headers:{Authorization:`Bearer ${N}`}}),g=window.URL.createObjectURL(new Blob([O.data])),c=document.createElement("a"),R=`${o}.xlsx`;c.href=g,c.setAttribute("download",R),document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(g),document.body.removeChild(c)}catch(o){console.error("Error downloading file:",o)}finally{x.value=!1}};return xe(()=>{window.removeEventListener("resize",j)}),Y(()=>{window.addEventListener("resize",j),j(),h()}),(o,a)=>{const O=i("router-link"),g=i("a-breadcrumb-item"),c=i("a-breadcrumb"),R=i("a-button"),H=i("a-col"),le=i("a-input"),re=i("a-input-group"),se=i("a-row"),J=i("a-menu-item"),ie=i("a-popconfirm"),de=i("a-menu"),ce=i("a-dropdown"),ue=i("a-table"),me=i("a-tag"),pe=i("a-pagination"),ge=i("a-drawer");return w(),P(F,null,[u("div",null,[n(c,null,{default:l(()=>[n(g,null,{default:l(()=>[n(O,{to:"/admin/eventos-ugo/lista"},{default:l(()=>[n(M(Ce)),a[3]||(a[3]=u("span",{class:"fs-13"},"Atrás",-1))]),_:1})]),_:1}),n(g,null,{default:l(()=>[u("h3",Ue,[a[4]||(a[4]=k("EVENTOS REGISTRO DE ASISTENCIA - ")),u("span",Pe,U(v.value),1)])]),_:1})]),_:1}),n(se,{style:{margin:"1rem 0"}},{default:l(()=>[n(H,{xs:24,md:12,lg:18},{default:l(()=>[a[6]||(a[6]=u("span",null,null,-1)),n(R,{class:"btn-excel",onClick:oe,loading:x.value,type:"primary"},{default:l(()=>a[5]||(a[5]=[u("img",{width:"20",style:{margin:"-2px 0 0 0"},src:De},null,-1)])),_:1},8,["loading"])]),_:1}),n(H,{xs:24,md:12,lg:6},{default:l(()=>[n(re,{compact:""},{default:l(()=>[n(le,{onPressEnter:d,value:_.search,"onUpdate:value":a[0]||(a[0]=y=>_.search=y),style:{width:"calc(100% - 80px)"},onInput:ee,placeholder:"Buscar por NOMBRE, DNI o RUC"},null,8,["value"]),n(R,{type:"primary",disabled:_.search==="",onClick:d},{default:l(()=>a[7]||(a[7]=[k("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),n(ue,{bordered:"",scroll:{x:$.value,y:L.value},class:"table-agreements-ugse",columns:q,"data-source":A.value,pagination:!1,loading:S.value,size:"small"},{bodyCell:l(({column:y,record:z,index:_e})=>[y.dataIndex=="idx"?(w(),P(F,{key:0},[k(U(ne.value(_e)),1)],64)):X("",!0),y.dataIndex=="actions"?(w(),W(ce,{key:1,trigger:["click"]},{overlay:l(()=>[n(de,null,{default:l(()=>[n(J,null,{default:l(()=>[u("a",{onClick:fe=>s(z)},"Editar",8,Be)]),_:2},1024),n(J,null,{default:l(()=>[n(ie,{placement:"rightBottom",title:`¿Quieres eliminar ${z.documentnumber} ?`,onConfirm:fe=>ae(z)},{icon:l(()=>[n(M(Se),{style:{color:"red"}})]),default:l(()=>[a[8]||(a[8]=u("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:2},1024)]),default:l(()=>[u("a",{class:"ant-dropdown-link",onClick:a[1]||(a[1]=Oe(()=>{},["prevent"]))},[n(R,{shape:"circle",icon:Re(M(Le)),size:"small"},null,8,["icon"])])]),_:2},1024)):X("",!0)]),_:1},8,["scroll","data-source","loading"])]),u("div",$e,[u("span",null,[n(me,{color:"blue"},{default:l(()=>[u("b",null,U(p.value),1)]),_:1}),a[9]||(a[9]=k("Inscritos"))]),n(pe,{size:"small",total:p.value,pageSize:C.value,onChange:te,showSizeChanger:!1},null,8,["total","pageSize"])]),n(ge,{open:e.value,"onUpdate:open":a[2]||(a[2]=y=>e.value=y),title:"Nueva Feria",placement:"right",width:"650"},{default:l(()=>[n(Me,{onCloseDraw:t,info:b.value},null,8,["info"])]),_:1},8,["open"])],64)}}};export{Xe as default};
