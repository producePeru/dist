import{_ as R}from"./TableComponent-b5e2290e.js";import{r as n,a as U,p as V,k as H,W as g,b as h,o as l,d as m,c as f,w as i,m as I,y as S,j as P,t as s,z as p,F as z,v as Y,i as $,a2 as M,e as j,h as G}from"./index-9efe7972.js";import"./es-4cb79e05.js";/* empty css                                                   */import{g as L}from"./usePermissions-e5990c2a.js";import"./icoexcel-1b303edf.js";import"./selectes-5b97efab.js";import"./SyncOutlined-ac0e435d.js";import"./MoreOutlined-55406c12.js";const Q={class:"layout-content"},q={key:1},oe={__name:"auditorias-index",setup(W){const v=n([]),y=n(0),w=n(150),d=n({}),x=n(!1),_=n(!1),C=n(null),E=n(!1),c=U({year:V("2026","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),k=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:50},{title:"TIPO",dataIndex:"action",width:80},{title:"USUARIO",dataIndex:"user_id",width:100},{title:"CAMBIOS",dataIndex:"changes",width:180},{title:"FECHA DE CAMBIOS",dataIndex:"created_at",width:100}],D=()=>{C.value=null,x.value=!0},T=async e=>{try{const t=await I({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(r(),G.success(t.message))}catch(t){console.error("Error de red:",t)}},A=async e=>{c.page=e,await r()},B=async e=>{e&&(c.page=1,await r())},r=async()=>{try{_.value=!0;const e={page:c.page,table_name:"attendancelist"},t=await I({url:"page/audit-logs",method:"GET",params:e});v.value=t.data,y.value=t.total,w.value=t.per_page}catch(e){console.error("Error de red:",e)}finally{_.value=!1}};return H(async()=>{var e;d.value=await L("eventos-ugo"),(e=d.value)!=null&&e.can_view_all&&await r()}),g("search",c),g("loading",_),g("loadingFile",E),(e,t)=>{const O=h("a-tag"),b=h("a-popconfirm"),F=h("a-menu-item");return l(),m("div",Q,[f(R,{title:"AUDITORIAS ACTIVIDADES UGO",btnUpdate:!0,btnImport:!0,placeholderSearch:"Buscar",columns:k,titleSearch:"BUSCAR POR EVENTO",pageSize:w.value,nameTotal:"Registros",dataSource:v.value,total:y.value,onHandleNew:D,onHandleSearch:B,permisos:d.value,onHandleCallFetchData:r,onHandlePaginator:A,heightTable:440},{"data-cell":i(({column:o,record:a})=>[o.dataIndex=="action"?(l(),S(O,{key:0},{default:i(()=>[P(s(a.action),1)]),_:2},1024)):p("",!0),o.dataIndex=="user_id"?(l(),m("span",q,s(a==null?void 0:a.user.name)+" "+s(a.user.lastname)+" "+s(a.user.middlename),1)):p("",!0),o.dataIndex=="changes"?(l(!0),m(z,{key:2},Y(a==null?void 0:a.changes,(u,N)=>(l(),m("div",{key:N},s(u.field)+" : "+s(u.before)+" --> "+s(u.after),1))),128)):p("",!0)]),"custom-options":i(({record:o})=>{var a;return[(a=d.value)!=null&&a.can_delete?(l(),S(F,{key:0},{default:i(()=>[f(b,{placement:"rightBottom",title:`Â¿Quieres eliminar ${o.title} ?`,onConfirm:u=>T(o)},{icon:i(()=>[f($(M),{style:{color:"red"}})]),default:i(()=>[t[0]||(t[0]=j("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):p("",!0)]}),_:1},8,["pageSize","dataSource","total","permisos"])])}}};export{oe as default};
