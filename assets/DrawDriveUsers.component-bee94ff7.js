import{r,a as I,M as N,k as B,b as c,o as O,s as R,w as i,e as l,c as d,i as T,B as g,m as k,p as V,j}from"./index-a3bfdba3.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";const u=a=>(V("data-v-6a9c0127"),a=a(),j(),a),F=u(()=>l("b",null,"Seleccionar todos",-1)),G=u(()=>l("br",null,null,-1)),M=u(()=>l("br",null,null,-1)),P=u(()=>l("br",null,null,-1)),q={__name:"DrawDriveUsers.component",props:["idFile","selectedUsers"],emits:["handleCloseDrawer"],setup(a,{emit:f}){const m=a,b=f,w=JSON.parse(localStorage.getItem("profile")),p=r(!1),_=r(!0),o=r([]),h=r(!1),s=I({indeterminate:!1,checkAll:!1,checkedList:m.selectedUsers}),y=t=>{Object.assign(s,{checkedList:t.target.checked?o.value.map(e=>e.value):[],indeterminate:!1})},v=()=>{s.checkedList=[],_.value=!1,b("handleCloseDrawer")};N(()=>s.checkedList,t=>{t.length===0&&console.log("state.checkedList está vacío"),s.indeterminate=!!t.length&&t.length<o.value.length,s.checkAll=t.length===o.value.length});const D=async()=>{h.value=!0;const t={drive_id:m.idFile,user_ids:s.checkedList};try{const e=await g({url:"drive/visible-users",method:"PUT",data:t});e.status==200&&k.success(e.message),v()}catch{k.error("No tienes permisos")}finally{h.value=!1}},x=async()=>{p.value=!0;try{const t=await g({url:"drive/users",method:"GET"});o.value=t.filter(e=>e.value!==w.user_id)}catch(t){console.error("Error de red:",t)}finally{p.value=!1}};return B(()=>{x()}),(t,e)=>{const C=c("a-checkbox"),U=c("a-checkbox-group"),L=c("a-spin"),S=c("a-button"),A=c("a-drawer");return O(),R(A,{open:_.value,"onUpdate:open":e[2]||(e[2]=n=>_.value=n),title:"Seleccionar usuarios",placement:"right",onClose:v},{default:i(()=>[l("div",null,[d(C,{checked:s.checkAll,"onUpdate:checked":e[0]||(e[0]=n=>s.checkAll=n),indeterminate:s.indeterminate,onChange:y},{default:i(()=>[F]),_:1},8,["checked","indeterminate"])]),G,d(L,{spinning:p.value},{default:i(()=>[d(U,{value:s.checkedList,"onUpdate:value":e[1]||(e[1]=n=>s.checkedList=n),options:o.value,class:"vertical-options"},null,8,["value","options"])]),_:1},8,["spinning"]),M,P,d(S,{class:"btn-produce",type:"primary",loading:h.value,onClick:D},{default:i(()=>[T("GUARDAR")]),_:1},8,["loading"])]),_:1},8,["open"])}}},H=E(q,[["__scopeId","data-v-6a9c0127"]]);export{H as D};
