import{L as pe,r as o,a as me,b as u,o as l,q as h,w as p,e as x,d as f,F as v,x as _e,h as b,s as i,c as d,M as fe,t as _,i as y,D as T,m as F,u as ve,z as he,J as ge,k as ye,S as be,K as xe,T as we,p as Ue,j as ke}from"./index-e793c6fa.js";import{u as W}from"./selectes-3b53c067.js";import{f as Se}from"./actualizarUsuario-dcb6b189.js";import"./es-9951cf97.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import{M as Ie}from"./MoreOutlined-c7100045.js";const Ce={class:"grid-profile"},De="YYYY-MM-DD",Ee={__name:"EditarPerfil.componente",props:["updateUser"],emits:["closeDraw"],setup(C,{emit:D}){pe.locale("es");const n=W(),L=JSON.parse(localStorage.getItem("profile")),z=D;n.$patch({genders:n.genders}),n.$patch({cdes:n.cdes}),n.$patch({Offices:n.Offices}),n.$patch({roles:n.roles}),n.$patch({supervisores:n.supervisores}),n.fetchGenders(),n.fetchCdes(),n.fetchOffices(),n.fetchRoles();const E=C,S=o(!1),w=o(Se),I=o(null),a=me({name:null,lastname:null,middlename:null,birthday:null,sick:null,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:L.id}),$=s=>{s&&(a.name=s.profile.name,a.lastname=s.profile.lastname,a.middlename=s.profile.middlename,a.birthday=s.profile.birthday,a.sick=s.profile.sick,a.phone=s.profile.phone,a.gender_id=s.profile.gender_id,a.cde_id=s.profile.cde_id,a.office_id=s.profile.office_id,a.email=s.email)},O=s=>{const g={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0};if(s===2)n.fetchSupervisores(),w.value={...w.value,supervisor_id:g};else{const{supervisor_id:U,...k}=w.value;w.value=k}},N=async()=>{S.value=!0;let s=a;delete s.email;try{const g=await T({url:`user/update/${E.updateUser.profile.id}`,method:"PUT",data:s});F.success(g.message),z("closeDraw",!0)}catch{F.error("No se pudo registrar este usuario")}finally{S.value=!1}},q=()=>{F.error("Debes de completar todos los espacios requeridos")};return(s,g)=>{const U=u("a-select"),k=u("a-form-item"),M=u("a-input"),A=u("a-date-picker"),B=u("a-button"),P=u("a-form");return l(),h(P,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:N,onFinishFailed:q},{default:p(()=>[x("div",Ce,[(l(!0),f(v,null,_e(w.value,(e,R)=>(l(),f(v,{key:R},[e.type==="iSelect"?(l(),h(k,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:p(()=>[e.name=="gender_id"?(l(),h(U,{key:0,value:a[e.name],"onUpdate:value":t=>a[e.name]=t,options:b(n).genders},null,8,["value","onUpdate:value","options"])):i("",!0),e.name=="cde_id"?(l(),h(U,{key:1,value:a[e.name],"onUpdate:value":t=>a[e.name]=t,options:b(n).cdes},null,8,["value","onUpdate:value","options"])):i("",!0),e.name=="office_id"?(l(),h(U,{key:2,value:a[e.name],"onUpdate:value":t=>a[e.name]=t,options:b(n).Offices},null,8,["value","onUpdate:value","options"])):i("",!0),e.name=="role_id"?(l(),h(U,{key:3,value:a[e.name],"onUpdate:value":t=>a[e.name]=t,options:b(n).roles,onChange:O},null,8,["value","onUpdate:value","options"])):i("",!0),e.name=="supervisor_id"?(l(),h(U,{key:4,value:a[e.name],"onUpdate:value":t=>a[e.name]=t,options:b(n).supervisores},null,8,["value","onUpdate:value","options"])):i("",!0)]),_:2},1032,["name","label","rules"])):i("",!0),e.type==="iText"?(l(),h(k,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:p(()=>[d(M,{value:a[e.name],"onUpdate:value":t=>a[e.name]=t,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):i("",!0),e.type==="iDate"?(l(),h(k,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:p(()=>[d(A,{locale:b(fe),value:I.value,"onUpdate:value":g[0]||(g[0]=t=>I.value=t),style:{width:"100%"},format:De},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):i("",!0)],64))),128))]),x("div",null,_($(E.updateUser)),1),d(k,null,{default:p(()=>[d(B,{class:"btn-produce",type:"primary","html-type":"submit",loading:S.value},{default:p(()=>[y("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])}}},$e=Z(Ee,[["__scopeId","data-v-c713d2dc"]]);const ee=C=>(Ue("data-v-943b7b95"),C=C(),ke(),C),ze=ee(()=>x("h3",null,"USUARIOS",-1)),Oe={class:"filters-dig"},qe=["onClick"],Fe=ee(()=>x("a",null,"Eliminar",-1)),Le={class:"paginator"},X=20,Ne={__name:"ListaUsuarios",setup(C){const D=W();D.$patch({cdes:D.cdes});const n=o(!1),L=t=>{console.log("open",t)},z=o(null);o(!1),o(!1),o(!1),o(0),o(!1),o(!1),o(!1),o("solicitante"),o(5);const E=o([]),S=o(!1),w=o(0);ve();const I=o({page:1}),a=o(""),$=o("user/list");o([]);const O=o(null),N=o(1200),q=o(window.innerHeight-100),s=()=>{q.value=window.innerHeight-300};he(()=>{window.removeEventListener("resize",s)});const g=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"DNI",dataIndex:"documentnumber",fixed:"left",width:100},{title:"Nombres",dataIndex:"name",width:120},{title:"Apellidos",dataIndex:"lastname",width:120},{title:"Celular",dataIndex:"email",width:180},{title:"Correo",dataIndex:"phone",width:180,align:"center"},{title:"Oficina",dataIndex:"office",width:140},{title:"CDE",dataIndex:"cde",width:140},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],U=()=>{e(),n.value=!1},k=t=>{I.value.page=t,e()},M=t=>{z.value=t,n.value=!0},A=t=>{},B=()=>{if(a.value){$.value=`/formalization-digital?search=${a.value}`,e();return}$.value="/formalization-digital",e()},P=async t=>{try{const r=await T({url:`user/delete/${t.id}`,method:"DELETE"});r&&(e(),F.success(r.message))}catch(r){console.error("Error de red:",r)}},e=async()=>{try{S.value=!0;let t=I.value.page==1?"":I.value;const r=await T({url:$.value,method:"GET",params:t});E.value=r.data,w.value=r.total}catch(t){console.error("Error de red:",t)}finally{S.value=!1}},R=ge(()=>t=>(I.value.page-1)*X+t+1);return ye(()=>{e(),window.addEventListener("resize",s),s()}),(t,r)=>{const ae=u("a-select"),te=u("a-input-search"),ne=u("a-button"),V=u("a-menu-item"),oe=u("a-popconfirm"),se=u("a-menu"),le=u("a-dropdown"),ie=u("a-table"),re=u("a-pagination"),de=u("a-drawer");return l(),f(v,null,[x("div",null,[ze,x("div",Oe,[d(ae,{value:O.value,"onUpdate:value":r[0]||(r[0]=c=>O.value=c),placeholder:"Filtrar por CDES",options:b(D).cdes,onChange:A},null,8,["value","options"]),d(te,{value:a.value,"onUpdate:value":r[1]||(r[1]=c=>a.value=c),placeholder:"","enter-button":"Buscar",onSearch:B},null,8,["value"])]),d(ie,{bordered:"",scroll:{x:N.value,y:q.value},class:"ant-table-striped",columns:g,"data-source":E.value,pagination:!1,loading:S.value,size:"small"},{bodyCell:p(({column:c,record:m,index:ue})=>{var Y,G,j,H,J,K,Q;return[c.dataIndex=="idx"?(l(),f(v,{key:0},[y(_(R.value(ue)),1)],64)):i("",!0),c.dataIndex=="lastName"?(l(),f(v,{key:1},[y(_(m.last_name)+" "+_(m.middle_name),1)],64)):i("",!0),c.dataIndex=="documentnumber"?(l(),f(v,{key:2},[y(_((Y=m.profile)==null?void 0:Y.documentnumber),1)],64)):i("",!0),c.dataIndex=="name"?(l(),f(v,{key:3},[y(_((G=m.profile)==null?void 0:G.name),1)],64)):i("",!0),c.dataIndex=="lastname"?(l(),f(v,{key:4},[y(_((j=m.profile)==null?void 0:j.lastname)+" "+_((H=m.profile)==null?void 0:H.middlename),1)],64)):i("",!0),c.dataIndex=="phone"?(l(),f(v,{key:5},[y(_((J=m.profile)==null?void 0:J.phone),1)],64)):i("",!0),c.dataIndex=="office"?(l(),f(v,{key:6},[y(_((K=m.profile)==null?void 0:K.office.name),1)],64)):i("",!0),c.dataIndex=="cde"?(l(),f(v,{key:7},[y(_((Q=m.profile)==null?void 0:Q.cde.name),1)],64)):i("",!0),c.dataIndex=="actions"?(l(),h(le,{key:8,trigger:["click"]},{overlay:p(()=>[d(se,null,{default:p(()=>[d(V,null,{default:p(()=>[x("a",{onClick:ce=>M(m)},"Editar",8,qe)]),_:2},1024),d(V,null,{default:p(()=>[d(oe,{title:"Â¿Seguro de eliminar?",onConfirm:ce=>P(m)},{icon:p(()=>[d(b(be),{style:{color:"red"}})]),default:p(()=>[Fe]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:p(()=>[x("a",{class:"ant-dropdown-link",onClick:r[2]||(r[2]=xe(()=>{},["prevent"]))},[d(ne,{shape:"circle",icon:we(b(Ie)),size:"small"},null,8,["icon"])])]),_:2},1024)):i("",!0)]}),_:1},8,["scroll","data-source","loading"])]),x("div",Le,[d(re,{size:"small",total:w.value,pageSize:X,onChange:k,showSizeChanger:!1},null,8,["total"])]),d(de,{open:n.value,"onUpdate:open":r[3]||(r[3]=c=>n.value=c),class:"draw-notary",title:"Editar Perfil",placement:"right",onAfterOpenChange:L},{default:p(()=>[d($e,{updateUser:z.value,onCloseDraw:U},null,8,["updateUser"])]),_:1},8,["open"])],64)}}},Ve=Z(Ne,[["__scopeId","data-v-943b7b95"]]);export{Ve as default};
