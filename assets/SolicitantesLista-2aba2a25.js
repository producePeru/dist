import{_ as C,a as Y}from"./EditarAsesoria-a99f0a7b.js";import{r as n,a as L,j as M,a5 as f,b as I,o as z,d as k,c as d,w as p,l as P,K as E,f as U,e as G}from"./index-cc0124c1.js";import{d as B}from"./downloadExcel-092afab9.js";import"./es-82ab1b78.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-e98d8e08.js";import"./FormComponent-555efea9.js";import"./selectes-df222431.js";const F={class:"advisory-table"},H=["onClick"],X={__name:"SolicitantesLista",setup(V){JSON.parse(localStorage.getItem("role"));const m=n([]),h=n(0),w=n(150),c=n(!1),u=n(!1);n("Asesorías");const i=n(!1),x=n(!1),S=n(!1),g=n(null),a=L({asesor:null,name:null,page:1}),v=n([]),y=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"TIPO DOCUMENTO",fixed:"left",dataIndex:"typedocument",align:"center",width:120},{title:"NUM. DOC",dataIndex:"document",fixed:"left",width:120,align:"center"},{title:"NOMBRES",dataIndex:"name",width:170},{title:"APELLIDOS",dataIndex:"last_name",width:180},{title:"REGIÓN",dataIndex:"city",align:"center",width:140},{title:"PROVINCIA",dataIndex:"province",align:"center",width:140},{title:"DISTRITO",dataIndex:"district",align:"center",width:150},{title:"CELULAR",dataIndex:"phone",align:"center",width:100},{title:"EMAIL",dataIndex:"email",width:240},{title:"GÉNERO",dataIndex:"gender",align:"center",width:90},{title:"DISCAPACIDAD",dataIndex:"sick",align:"center",width:120},{title:"HIJOS",dataIndex:"hasSoon",align:"center",width:120},{title:"REGISTRADO POR",dataIndex:"registered",width:200},{title:"",dataIndex:"actions",width:50,align:"center",fixed:"right"}],O=()=>{console.log("handleNew...")},D=async()=>{u.value=!0;try{const e={paginate:!1};a.year&&(e.year=P(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);let t=null,o=null,l=null;a.type==1&&(t="historial/advisories/filters",o="download/asesories",l="Asesorías"),a.type==2&&(t="historial/formalizations-10/filters",o="download/formalizations-ruc10",l="Formalizaciones 10"),a.type==3&&(t="historial/formalizations-20/filters",o="download/formalizations-ruc20",l="Formalizaciones 20");const _=(await E({url:t,method:"GET",params:e})).data;await B(o,l,_)}catch(e){console.error("Error de red:",e)}finally{u.value=!1}},N=async e=>{a.page=e,await r()},A=async e=>{e&&(a.page=1,await r())},T=e=>{g.value=e,a.type==1&&(i.value=!0),a.type==2&&(x.value=!0),a.type==3&&(S.value=!0)},r=async()=>{c.value=!0;try{const e={page:a.page},t=await E({url:"person/list",method:"GET",params:e});m.value=t.data.data,h.value=t.data.total,w.value=t.data.per_page}catch(e){console.error("Error de red:",e)}finally{c.value=!1}},R=async()=>{try{const e=await U({url:"select/asesores-report",method:"GET"});e.status==200&&(v.value=e.data)}catch{console.log("Failed to delete")}};return M(async()=>{await r(),await R()}),f("search",a),f("loading",c),f("loadingFile",u),(e,t)=>{const o=I("a-menu-item"),l=I("a-drawer");return z(),k("div",F,[d(C,{title:"SOLICITANTES",new:!1,textNuevo:"NUEVO EVENTO",placeholderSearch:"Buscar",columns:y,titleSearch:"NÚMERO DE DOCUMENTO",pageSize:w.value,nameTotal:"Solicitantes",asesoresList:v.value,dataSource:m.value,total:h.value,onHandleNew:O,onHandleDownloadExcel:D,onHandleSearch:A,onHandlePaginator:N},{"custom-options":p(({record:s})=>[d(o,null,{default:p(()=>[G("a",{onClick:_=>T(s)},"Editar",8,H)]),_:2},1024)]),_:1},8,["pageSize","asesoresList","dataSource","total"]),d(l,{width:"500",title:"EDITAR ASESORÍA",open:i.value,"onUpdate:open":t[1]||(t[1]=s=>i.value=s),placement:"right"},{default:p(()=>[d(Y,{info:g.value,onCloseDraw:t[0]||(t[0]=s=>(i.value=!1,r()))},null,8,["info"])]),_:1},8,["open"])])}}};export{X as default};
