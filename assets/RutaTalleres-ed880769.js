import{_ as q}from"./TableComponent-833355f2.js";import{l as u,r as l,a as k,j as M,T as G,a5 as E,o as w,v as z,h as F,L as V,d as H,c,K as Y,m as P,b as R,w as p,f as J,e as b,a0 as j,x as Q}from"./index-c6541040.js";import{d as K}from"./downloadExcel-ecf0a4c1.js";import{_ as X}from"./FormComponent-bfcfb27c.js";import{u as W}from"./selectes-081ec1ef.js";import"./es-f71ef377.js";import"./icoexcel-1b303edf.js";import"./MoreOutlined-a634435d.js";import"./quill.snow-59fb5e10.js";/* empty css             */const Z={key:1,class:"f-20"},ee={__name:"RutaTalleresNuevo",props:["info"],emits:["closeDraw"],setup(O,{emit:I}){u.locale("es");const y=l({workshopName:{type:"iText",label:"NOMBRE DEL TALLER",name:"workshopName",required:!0,message:"Escribir el nombre del taller",disabled:!1,maxlength:250},date:{type:"iDate",label:"FECHA DEL TALLER",name:"date",required:!0,message:"Seleccionar una fecha",disabled:!1,disabledDate:n=>{const r=u().startOf("day");return n&&u(n).isBefore(r)}},hour:{type:"iText",label:"HORA DEL TALLER",name:"hour",required:!0,message:"Escribir hora",disabled:!1},link:{type:"iText",label:"ENLACE DE LA SALA",name:"link",required:!1,message:"Ingresa el link del taller",disabled:!1},description:{type:"iQuillEditor",label:"DESCRIPCIÓN DEL TALLER",name:"description",required:!1,message:"Escribir una descripción",disabled:!1},expositor:{type:"iText",label:"EXPOSITOR",name:"expositor",required:!1,message:"Ingresar un expositor",disabled:!1,maxlength:100}});JSON.parse(localStorage.getItem("profile"));const _=I,m=O,d=l(!1),f=l("CREAR"),o=k({}),i=l(!1);W();const h=l(null),a=l({theme_id:[]}),x=n=>{console.log("handleInputEvent",n)},D=async n=>{},T=async n=>{},A=async n=>{},L=n=>{},C=async()=>{i.value=!0;const n={workshopName:o.workshopName,date:u(o.date).format("YYYY-MM-DD"),hour:o.hour,link:o.link,description:o.description,expositor:o.expositor};try{const r=await Y({url:"route-digital/store",method:"POST",data:n});r.status===200&&(P.success(r.message),N(),_("closeDraw",!0))}catch(r){console.error("Error:",r);const S=document.getElementsByClassName("ant-drawer-body")[0];S&&(S.scrollTop=0)}finally{i.value=!1}},N=()=>{o.workshopName=null,o.date=null,o.hour=null,o.link=null,o.description=null,o.expositor=null},v=async n=>{console.log("set info",n),d.value=!0;try{}catch(r){console.error("Error al cargar la información:",r)}finally{d.value=!1}};return M(()=>{m.info&&v(m.info)}),G(()=>m.info,n=>{n&&v(n)}),E("formState",o),E("loadingState",i),(n,r)=>d.value?(w(),z(F(V),{key:0,style:{color:"#00a6db"}})):(w(),H("div",Z,[c(X,{fields:y.value,options:a.value,btnSaveName:f.value,onHandleInputEvent:x,resetSelect:h.value,onHandleChangeSelect:T,onHandleFocusSelect:A,onHandleBlurSelect:L,onHandleChangeClock:D,onOnSubmit:C},null,8,["fields","options","btnSaveName","resetSelect"])]))}};const ae={class:"advisory-table"},te=["onClick"],pe={__name:"RutaTalleres",setup(O){const I=JSON.parse(localStorage.getItem("role"))||[],y=l([]),_=l(0),m=l(150),d=l(!1),f=l(!1),o=l("Asesorías"),i=l(!1),h=l(null),a=k({year:u("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1}),x=l([]),D=l([{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:80},{title:"FECHA",fixed:"left",dataIndex:"date",width:100,align:"center"},{title:"ASESOR",dataIndex:"asesor",width:200},{title:"SOLICITANTE APELLIDO PATERNO",dataIndex:"emp_lastname",width:150},{title:"SOLICITANTE APELLIDO MATERNO",dataIndex:"emp_middlename",width:150},{title:"SOLICITANTE NONBRE",dataIndex:"emp_name",width:150},{title:"TIPO DOCUMENTO",dataIndex:"emp_document_type",width:100,align:"center"},{title:"NÚMERO DE DOCUMENTO",dataIndex:"emp_document_number",align:"center",width:140},{title:"PAÍS",dataIndex:"emp_country",align:"center",width:120},{title:"FEC. NAC",dataIndex:"emp_birth",align:"center",width:120},{title:"EDAD",dataIndex:"emp_age",align:"center",width:80},{title:"GÉNERO",dataIndex:"emp_gender",width:80,align:"center"},{title:"DISCAPACIDAD",dataIndex:"emp_discapabilities",width:120,align:"center"},{title:"HIJOS",dataIndex:"emp_soons",width:80,align:"center"},{title:"CELULAR",dataIndex:"emp_phone",width:120,align:"center"},{title:"EMAIL",dataIndex:"emp_email",width:200},{title:"CIUDAD",dataIndex:"city",width:120,align:"center"},{title:"PROVINCIA",dataIndex:"province",width:140,align:"center"},{title:"DISTRITO",dataIndex:"district",width:140,align:"center"},{title:"RUC",dataIndex:"ruc",width:120,align:"center"}]),T=()=>{h.value=null,i.value=!0},A=async e=>{try{let t=null;o.value=="Asesorias"&&(t=`advisory/delete/${e.id}`),o.value=="Formalizaciones RUC 10"&&(t=`formalization/delete-ruc-10/${e.id}`),o.value=="Formalizaciones RUC 20"&&(t=`formalization/delete-ruc-20/${e.id}`);const s=await Y({url:t,method:"DELETE"});r(),P.success(s.message)}catch(t){console.error("Error de red:",t)}},L=async()=>{f.value=!0;try{const e={};a.year&&(e.year=u(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);let t=null,s=null;a.type==1&&(t="download/asesories",s="Asesorías"),a.type==2&&(t="download/formalizations-ruc10",s="Formalizaciones 10"),a.type==3&&(t="download/formalizations-ruc20",s="Formalizaciones 20"),await K(t,s,e)}catch(e){console.error("Error de red:",e)}finally{f.value=!1}},C=async e=>{a.page=e,await r()},N=async e=>{e&&(a.page=1,await r())},v=e=>{h.value=e,a.type==1&&(i.value=!0),a.type==2&&(open2.value=!0),a.type==3&&(open3.value=!0)},n=e=>I.some(t=>e.includes(t.id)),r=async()=>{d.value=!0;try{const e={page:a.page};a.year&&(e.year=u(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.asesor&&(e.asesor=a.asesor),a.name&&(e.name=a.name);let t=null;a.type==1&&(t="historial/advisories/filters"),a.type==2&&(t="historial/formalizations-10/filters"),a.type==3&&(t="historial/formalizations-20/filters");const s=await Y({url:t,method:"GET",params:e});y.value=s.data.data,_.value=s.data.total,m.value=s.data.per_page}catch(e){console.error("Error de red:",e)}finally{d.value=!1}},S=async()=>{try{const e=await J({url:"select/asesores-report",method:"GET"});e.status==200&&(x.value=e.data)}catch{console.log("Failed to delete")}};return M(async()=>{await r(),await S()}),E("search",a),E("loading",d),E("loadingFile",f),(e,t)=>{const s=R("a-menu-item"),B=R("a-popconfirm"),U=R("a-drawer");return w(),H("div",ae,[c(q,{title:"TALLERES DE RUTA DIGITAL",new:!0,textNuevo:"NUEVO TALLER",placeholderSearch:"Buscar",searchYear:!0,rangeDate:!0,columns:D.value,titleSearch:"NOMBRE TALLER",pageSize:m.value,nameTotal:o.value,dataSource:y.value,total:_.value,onHandleNew:T,onHandleDownloadExcel:L,onHandleSearch:N,onHandlePaginator:C},{"custom-options":p(({record:g})=>[c(s,null,{default:p(()=>[b("a",{onClick:$=>v(g)},"Editar",8,te)]),_:2},1024),n([1,5])?(w(),z(s,{key:0},{default:p(()=>[c(B,{title:"¿Eliminar?",onConfirm:$=>A(g),class:"prod-alert",placement:"topRight"},{icon:p(()=>[c(F(j),{style:{color:"red"}})]),default:p(()=>[t[2]||(t[2]=b("a",null,"Eliminar",-1))]),_:2},1032,["onConfirm"])]),_:2},1024)):Q("",!0)]),_:1},8,["columns","pageSize","nameTotal","dataSource","total"]),c(U,{width:"500",title:"DETALLES DEL TALLER",open:i.value,"onUpdate:open":t[1]||(t[1]=g=>i.value=g),placement:"right"},{default:p(()=>[c(ee,{info:h.value,onCloseDraw:t[0]||(t[0]=g=>(i.value=!1,r()))},null,8,["info"])]),_:1},8,["open"])])}}};export{pe as default};
