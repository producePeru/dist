import{_ as W}from"./tuempresa-7c20bfb9.js";import{R as X}from"./ModalRegistroMYPE-87ba1082.js";import{l as Z,u as j,r as g,a as U,x as ee,n as te,b as d,o as p,d as m,e,c as r,j as v,t as l,w as f,y as oe,m as b,f as y,s as k,F as R,v as q,p as se,k as ae}from"./index-ef958b15.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";const c=w=>(se("data-v-584fd570"),w=w(),ae(),w),le={class:"background"},re={class:"container"},ue={class:"questionary"},ce={class:"box"},ie=c(()=>e("div",{class:"text-center"},[e("img",{src:W,alt:""}),e("h1",{class:"title"},"Test de salida")],-1)),de={class:"box-info-workshop"},_e=c(()=>e("b",null,"Taller: ",-1)),pe=c(()=>e("b",null,"Expositor: ",-1)),me=c(()=>e("b",null,"Fecha del taller:",-1)),he=c(()=>e("b",null,"Fecha de expiración del cuestionario:",-1)),ve={class:"box"},fe={key:0,class:"personal-info"},ge=c(()=>e("h4",{class:"c-primary"},"Mis Datos",-1)),be=c(()=>e("span",{class:"name"},"Nombres y Apellidos: ",-1)),ye=c(()=>e("span",{class:"name"},"Correo electrónico: ",-1)),we=c(()=>e("span",{class:"name"},"Número de contácto: ",-1)),ke=c(()=>e("br",null,null,-1)),xe={key:0},Se={class:"box-mensagge"},Te={class:"box-title"},De={key:1,class:"box rate"},Ee={class:"box-title"},Ie={class:"rate-wrapper"},Ue={class:"box-title"},$e={class:"box-title"},Ce={key:2,class:"box"},Fe=c(()=>e("span",{class:"box-mensagge"},"Sugerencias",-1)),Ne={class:"box-title"},Re={class:"box-btn"},qe={__name:"TestSalida",setup(w){const M=Z(),O=j(),x=g(!1),S=g(!1),T=g(!1),$=g(null),i=g(null),n=U({id:null,exponent:null,idIn:null,idOut:null,dateTestIn:null,dateTestOut:null,title:null,workShopDate:null}),a=U({name:null,email:null,phone:null,ruc:null,dni:null}),o=U({ruc:null,dni:null,ts1:null,ts2:null,ts3:null,ts4:null,ts5:null,rate_1:null,rate_2:null,rate_3:null,comments:null}),P=ee(()=>oe(n.dateTestOut).format("DD-MM-YYYY")),Y=()=>{o.ruc=o.ruc.replace(/\D/g,"")},z=s=>{a.name=s.name_complete,a.email=s.email,a.phone=s.phone,a.ruc=s.ruc,a.dni=s.dni_number},C=async()=>{let s=o.ruc;if(!s)return b.warning("Ingresa el número de RUC");S.value=!0;try{const{data:t}=await y({url:`/data-mype/${s}`,method:"GET"});t.ruc&&(a.ruc=t.ruc,a.name=t.name_complete,a.email=t.email,a.phone=t.phone,a.dni=t.dni_number)}catch(t){if(console.error("Error de red:",t.response.status),a.name=null,a.email=null,a.phone=null,a.dni=null,t.response.status==404)try{const{data:h}=await y({url:`/api-data-mype/${o.ruc}`,method:"GET"}),D={razonSocial:h.razonSocial,numeroDocumento:h.numeroDocumento};$.value=D,x.value=!0}catch(h){b.warning("El número de RUC no es válido"),console.error("Error de red:",h)}}finally{S.value=!1}},G=()=>{window.scrollTo({top:200,behavior:"smooth"})},V=async()=>{if(a.name==null&&a.dni==null&&a.ruc==null){C(),b.warning("Revisando sus respuestas"),G();return}const s={ts1:o.ts1,ts2:o.ts2,ts3:o.ts3,ts4:o.ts4,ts5:o.ts5,c1:o.rate_1,c2:o.rate_2,c3:o.rate_3,suggestions:o.comments,ruc_mype:a.ruc,dni_mype:a.dni,workshop_id:n.id};T.value=!0;try{const t=await y({url:`/sending-test-answers/${n.id}`,method:"POST",data:s});b.success(t.message),O.push({name:"enviado"})}catch(t){console.error("Error:",t.response.data.errors[0])}finally{T.value=!1}},B=()=>{b.error("Debes de completar todos los datos")},L=async s=>{console.log("uuuu",s);try{const{data:t}=await y({url:`/testout-questions/${s}`,method:"GET"});i.value=t}catch(t){console.error("Error de red:",t)}};return te(async()=>{try{const s=await y({url:`/get-workshop-slug/${M.params.slug}`,method:"GET"});n.id=s.workshop.id,n.exponent=s.workshop.exponent_name,n.idIn=s.workshop.id_in,n.idOut=s.workshop.id_out,n.dateTestIn=s.workshop.test_in_date,n.dateTestOut=s.workshop.test_out_date,n.title=s.workshop.title,n.workShopDate=s.workshop.workshop_date,await L(s.workshop.id)}catch(s){console.error("Error de red:",s)}}),(s,t)=>{const h=d("a-divider"),D=d("a-input-search"),F=d("a-form-item"),A=d("a-radio"),H=d("a-radio-group"),E=d("a-rate"),J=d("a-textarea"),K=d("a-button"),Q=d("a-form");return p(),m("div",le,[e("section",re,[e("div",ue,[e("div",ce,[ie,r(h),e("div",de,[e("span",null,[_e,v(l(n.title),1)]),e("span",null,[pe,v(l(n.exponent),1)]),e("span",null,[me,v(" "+l(n.workShopDate),1)]),e("span",null,[he,v(" "+l(P.value),1)])])]),r(Q,{layout:"vertical",model:o,autocomplete:"off",onFinish:V,onFinishFailed:B},{default:f(()=>[e("div",ve,[r(F,{class:"search-ruc f-15",name:"ruc",label:"Número de RUC",rules:[{required:!0,message:"Es importante el número de RUC"}]},{default:f(()=>[r(D,{maxlength:15,loading:S.value,size:"large",value:o.ruc,"onUpdate:value":t[0]||(t[0]=u=>o.ruc=u),"enter-button":"",onSearch:C,onInput:Y},null,8,["loading","value"])]),_:1}),a.name?(p(),m("div",fe,[ge,e("div",null,[be,e("span",null,l(a.name),1)]),e("div",null,[ye,e("span",null,l(a.email),1)]),e("div",null,[we,e("span",null,l(a.phone),1)]),ke])):k("",!0)]),i.value?(p(),m("div",xe,[(p(),m(R,null,q(5,(u,_)=>e("div",{class:"box",key:_},[e("span",Se,"Pregunta "+l(_+1),1),e("h3",Te,l(i.value["question"+(_+1)]),1),r(F,{name:`ts${_+1}`,rules:[{required:!0,message:"Escoge una respuesta"}]},{default:f(()=>[r(H,{class:"group-radios",value:o[`ts${_+1}`],"onUpdate:value":N=>o[`ts${_+1}`]=N},{default:f(()=>[(p(),m(R,null,q(3,(N,I)=>r(A,{key:I,class:"item-radio",value:I+1},{default:f(()=>[v(l(i.value[`question${_+1}_opt${I+1}`]),1)]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["name"])])),64))])):k("",!0),i.value?(p(),m("div",De,[e("div",null,[e("h3",Ee,l(i.value.satistaction1),1),r(E,{class:"star-rate",value:o.rate_1,"onUpdate:value":t[1]||(t[1]=u=>o.rate_1=u)},null,8,["value"])]),e("div",Ie,[e("h3",Ue,l(i.value.satistaction2),1),r(E,{class:"star-rate",value:o.rate_2,"onUpdate:value":t[2]||(t[2]=u=>o.rate_2=u)},null,8,["value"])]),e("div",null,[e("h3",$e,l(i.value.satistaction3),1),r(E,{class:"star-rate",value:o.rate_3,"onUpdate:value":t[3]||(t[3]=u=>o.rate_3=u)},null,8,["value"])])])):k("",!0),i.value?(p(),m("div",Ce,[Fe,e("h3",Ne,l(i.value.comments),1),r(J,{value:o.comments,"onUpdate:value":t[4]||(t[4]=u=>o.comments=u),"allow-clear":""},null,8,["value"])])):k("",!0),e("div",Re,[r(K,{type:"primary","html-type":"submit",size:"large",loading:T.value},{default:f(()=>[v("Enviar respuestas")]),_:1},8,["loading"])])]),_:1},8,["model"])])]),r(X,{open:x.value,onHandleCloseModal:t[5]||(t[5]=u=>x.value=!1),rucProp:$.value,onHandleSetData:z},null,8,["open","rucProp"])])}}},Ge=ne(qe,[["__scopeId","data-v-584fd570"]]);export{Ge as default};
