import{F as Y,_ as R,a as V}from"./FormalizacionFooter-5b442f6e.js";import{a as X,r as u,u as G,l as H,n as J,b as c,o as U,d as k,e as i,q as K,c as t,w as s,F as $,m as _,g as F,f as m,j as z,s as W,p as Z,k as ee}from"./index-7bd77afb.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";const oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAfCAYAAACYn/8/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABfSURBVHgB7c4hEYBAAAXRDxJFABwhMFQgAflIQAUMEdCEQHIdTuzMzexL8LpnnP9Ums4jw7qkxnfdebc9tfo0yjjNOM04zTjNOM04zTjNOM04zTjNOM04zTjNOK3ZeAGQ1whJsy738gAAAABJRU5ErkJggg==";const g=p=>(Z("data-v-13c9f7bb"),p=p(),ee(),p),te=g(()=>i("div",{class:"container header-wrapper"},[i("img",{src:R,alt:"logo-produce"}),i("img",{src:V,alt:"logo-tu-empresa"})],-1)),le=[te],ne={class:"form"},re={class:"container"},se={class:"form-wrapper"},ie=g(()=>i("h2",{class:"ff title"},"Formulario de formalización digital",-1)),ue=g(()=>i("h2",{class:"ff title2"},"Paso 1: Registro de datos",-1)),ce={class:"number-cel"},de=g(()=>i("div",{class:"flat-51"},[i("img",{src:oe,alt:"peru"}),i("span",null,"+51")],-1)),me={key:0,class:"error-msn"},pe={__name:"FormalizacionPge",setup(p){const a=X({dni:null,name_lastname:null,email:null,phone:null,departament:null,province:null,district:null,address:null,id_cde:null}),v=u(!1),A=u(!1),h=u(!1),E=u(null),b=u(!1),w=u([]),f=u([]),d=u([]),x=G(),B=()=>{v.value&&(v.value=!1)},D=()=>new Promise((o,e)=>{window.grecaptcha.ready(()=>{window.grecaptcha.execute("6LcQMYopAAAAAHSEhhbYKcmXQuwDPScDljW1ZBUu",{action:"submit"}).then(l=>{o(l)}).catch(l=>{e(l)})})}),S=async()=>{if(!A.value)return v.value=!0,_.error("Completa los valores del formulario");F.remove("formalizacion"),h.value=!0;try{const o=await D();(await m({url:"/public/formalization-recaptcha",method:"POST",data:{recaptcha_token:o}})).success?await m({url:"/public/formalization",method:"POST",data:a})&&(F.set("formalization-data",JSON.stringify(a)),x.push({name:"formalizacion-mapa"})):_.warning("No verificado")}catch{_.error("Error al registrar")}finally{h.value=!1}},T=()=>{_.error("Completa los valores del formulario")},C=o=>{a[o]=a[o].replace(/\D/g,"")},y=(o,e)=>{const l=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(l)},I=async()=>{try{const{data:o}=await m({url:"/departaments",method:"GET"});let e=o.map(l=>({label:l.label,value:l.id}));w.value=[...w.value,...e]}catch(o){console.log(o)}},j=async o=>{a.province=null,a.district=null,f.value=[],d.value=[];try{const{data:e}=await m({url:`/province/${o}`,method:"GET"});let l=e.map(r=>({label:r.label,value:r.id}));f.value=[...f.value,...l]}catch(e){console.log(e)}},O=async o=>{a.district=null,d.value=[];try{const{data:e}=await m({url:`/district/${o}`,method:"GET"});let l=e.map(r=>({label:r.label,value:r.id}));d.value=[...d.value,...l]}catch(e){console.log(e)}},P=()=>{window.pageYOffset>10?b.value=!0:b.value=!1};return H(()=>{const o=document.createElement("script");o.src="https://www.google.com/recaptcha/api.js?render=6LcQMYopAAAAAHSEhhbYKcmXQuwDPScDljW1ZBUu",o.async=!0,o.defer=!0,document.head.appendChild(o),I(),window.addEventListener("scroll",P)}),J(()=>{window.removeEventListener("scroll",P)}),(o,e)=>{const l=c("a-input"),r=c("a-form-item"),N=c("a-select"),q=c("router-link"),L=c("a-checkbox"),M=c("a-button"),Q=c("a-form");return U(),k($,null,[i("header",{class:K(["header",{floatingNav:b.value}]),ref_key:"navBar",ref:E},le,2),i("section",ne,[i("div",re,[i("div",se,[ie,t(Q,{class:"form-values",model:a,name:"basic",layout:"vertical",autocomplete:"off",onFinish:S,onFinishFailed:T},{default:s(()=>[ue,t(r,{label:"Número DNI",name:"dni",rules:[{required:!0,message:"Por favor ingresa tu número de DNI",min:8,max:8}]},{default:s(()=>[t(l,{value:a.dni,"onUpdate:value":e[0]||(e[0]=n=>a.dni=n),onInput:e[1]||(e[1]=n=>C("dni"))},null,8,["value"])]),_:1}),t(r,{label:"Nombres y Apellidos",name:"name_lastname",rules:[{required:!0,message:"Por favor ingresa tu número de DNI"}]},{default:s(()=>[t(l,{value:a.name_lastname,"onUpdate:value":e[2]||(e[2]=n=>a.name_lastname=n)},null,8,["value"])]),_:1}),t(r,{label:"Correo electrónico",name:"email",rules:[{required:!0,message:"Por favor ingresa tu correo electrónico",type:"email"}]},{default:s(()=>[t(l,{value:a.email,"onUpdate:value":e[3]||(e[3]=n=>a.email=n)},null,8,["value"])]),_:1}),t(r,{label:"Número de celular",name:"phone",rules:[{required:!0,message:"Por favor ingresa tu número de celular",min:9,max:9}]},{default:s(()=>[i("div",ce,[de,t(l,{value:a.phone,"onUpdate:value":e[4]||(e[4]=n=>a.phone=n),onInput:e[5]||(e[5]=n=>C("phone"))},null,8,["value"])])]),_:1}),t(r,{label:"Departamento",name:"departament",rules:[{required:!0,message:"Por favor selecciona un departamento"}]},{default:s(()=>[t(N,{value:a.departament,"onUpdate:value":e[6]||(e[6]=n=>a.departament=n),"show-search":"",options:w.value,"filter-option":y,onChange:j},null,8,["value","options"])]),_:1}),t(r,{label:"Provincia",name:"province",rules:[{required:!0,message:"Por favor selecciona tu provincia"}]},{default:s(()=>[t(N,{value:a.province,"onUpdate:value":e[7]||(e[7]=n=>a.province=n),"show-search":"",options:f.value,"filter-option":y,onChange:O},null,8,["value","options"])]),_:1}),t(r,{label:"Distrito",name:"district",rules:[{required:!0,message:"Por favor selecciona tu distrito"}]},{default:s(()=>[t(N,{value:a.district,"onUpdate:value":e[8]||(e[8]=n=>a.district=n),"show-search":"",options:d.value,"filter-option":y},null,8,["value","options"])]),_:1}),t(r,{label:"Dirección",name:"address",rules:[{required:!0,message:"Por favor ingresa tu dirección"}]},{default:s(()=>[t(l,{value:a.address,"onUpdate:value":e[9]||(e[9]=n=>a.address=n)},null,8,["value"])]),_:1}),t(r,null,{default:s(()=>[t(L,{checked:A.value,"onUpdate:checked":e[10]||(e[10]=n=>A.value=n),name:"type",onChange:B},{default:s(()=>[z(" He leído y acepto los términos y condiciones "),t(q,{to:"/politicas-privacidad",target:"_blank",style:{"margin-left":".5rem"}},{default:s(()=>[z("Ver términos y condiciones")]),_:1})]),_:1},8,["checked"]),v.value?(U(),k("div",me,"Acepta los términos y condiciones")):W("",!0)]),_:1}),t(r,null,{default:s(()=>[t(M,{loading:h.value,class:"form-button",type:"primary","html-type":"submit"},{default:s(()=>[z("CONTINUAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])]),t(Y)],64)}}},ge=ae(pe,[["__scopeId","data-v-13c9f7bb"]]);export{ge as default};
