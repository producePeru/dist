import{P as ee,l as ae,u as te,r as h,a as oe,n as le,b,o as n,d as q,e as y,t as se,i as m,c as u,B as i,w as c,F as C,D as R,h as D,m as w,f as ne,v as re,s as p,K as ue,L as ie,R as de,j as T,p as me,k as ce}from"./index-ed35c821.js";import"./es-d48b4101.js";import{d as pe,g as ve,f as _e,o as be,h as ge}from"./selects-0563509c.js";import{_ as ye}from"./_plugin-vue_export-helper-c27b6911.js";const fe={document_type:{type:"iSelect",label:"Tipo de documento",name:"document_type",required:!0,message:"Seleccionar tipo de documento",disabled:!0},document_number:{type:"iSearch",label:"Ingresar número",name:"document_number",required:!0,message:"Escribe número de documento",disabled:!1,max:8},last_name:{type:"iText",label:"Apellido paterno",name:"last_name",required:!0,message:"Escribe el apellido paterno"},middle_name:{type:"iText",label:"Apellido materno",name:"middle_name",required:!0,message:"Escribe el apellido materno"},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribe el nombre"},country_code:{type:"iSelectWrite",label:"País",name:"country_code",required:!0,message:"Seleccionar país"},email:{type:"iText",label:"Correo",name:"email",required:!0,email:"email",message:"Escribe el correo del usuario"},password:{type:"iPassword",label:"Contraseña",name:"password",required:!1,message:"Registra la contraseña"},office_code:{type:"iSelect",label:"Oficina",name:"office_code",required:!0,message:"Seleccionar un tipo"},sede_code:{type:"iSelect",label:"Sede donde labora",name:"sede_code",required:!0,message:"Seleccionar un tipo"},role:{type:"iSelect",label:"Tipo de usuario",name:"role",required:!0,message:"Seleccionar un tipo"},gender:{type:"iSelect",label:"Género",name:"gender",required:!1,message:"Seleccionar tipo de documento"}},he=[{value:"Nuevo Usuario"},{value:"Lista"}],Ue=[{value:"Subir archivo"},{value:"Mis archivos"}],ke=[{value:"Reportes"},{value:"Calendario"},{value:"Talleres"},{value:"MYPE"},{value:"Expositores"},{value:"Test Entrada"},{value:"Editar Test Entrada"},{value:"Test Salida"},{value:"Editar Test Salida"},{value:"Taller Descripcion"}];const A=U=>(me("data-v-46908e35"),U=U(),ce(),U),Se={key:1,class:"user"},qe={class:"grid-item"},De={class:"roles"},we=A(()=>y("br",null,null,-1)),Te=A(()=>y("br",null,null,-1)),xe=A(()=>y("br",null,null,-1)),Ee="YYYY-MM-DD",Ne={__name:"NuevoUsuarios",setup(U){ee.locale("es");const k=ae(),P=te(),x=h(!0),S=h(!1),I=h([]),F=h([]),G=h(!1),L=h(!1),a=oe({nick_name:null,birthdate:null,gender:null,is_disabled:0,phone_number:null,document_type:1,document_number:null,last_name:null,middle_name:null,name:null,country_code:173,email:null,password:null,office_code:null,sede_code:1,role:null,created_by:R,updated_by:R}),V=()=>{a.document_type=1,a.document_number=null,a.last_name=null,a.middle_name=null,a.middle_name=null,a.name=null,a.country_code=173,a.email=null,a.password=null,a.office_code=null,a.sede_code=1,a.role=null},d=h({drive:[],usuarios:[],rutaDigital:[]}),v=h({rutaDigital:!1,usuarios:!1,drive:!1}),E=o=>{d.value[o].length>0?v.value[o]=!0:v.value[o]=!1},z=async o=>{const t=Object.fromEntries(Object.entries(d.value).filter(([g,r])=>r.length>0)),f={id_user:o,created_by:R,views:t,exclusions:null};try{const g=await D({url:"/permission",method:"POST",data:f});w.success(g.message),P.push("/admin/usuarios/lista")}catch{w.error("No se pudo registrar este usuario")}finally{S.value=!1}},B=async()=>{const o=a;S.value=!0;try{const t=await D({url:"/register-user",method:"POST",data:o});await z(t.user_id)}catch{w.error("No se pudo registrar este usuario")}finally{S.value=!1}},M=()=>{w.error("Debes de completar todos los espacios requeridos")},Y=async o=>{console.log("Hello",o)},j=()=>{a.document_number=a.document_number.replace(/\D/g,"")},$=(o,t)=>{const f=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(f)},W=async()=>{try{const{data:o}=await ne({url:"/countries",method:"GET"});I.value=o}catch(o){console.error("Error de red:",o)}},H=async()=>{try{const{data:o}=await D({url:"/sedes",method:"GET"});F.value=o}catch(o){console.error("Error de red:",o)}},K=async()=>{var o,t,f,g,r,_;if(k.query.dni)try{const{data:s}=await D({url:`user/${k.query.dni}`,method:"GET"});a.document_number=s.document_number,L.value=!0,a.last_name=s.last_name,a.middle_name=s.middle_name,a.name=s.name,a.country_code=s.country_code,a.email=s.email,a.office_code=s.office_code,a.sede_code=s.sede_code,a.role=s.role,a.gender=s.gender,a.birthdate=s.birthdate,a.phone_number=s.phone_number,d.value=s.permission,((t=(o=d.value)==null?void 0:o.drive)==null?void 0:t.length)>=1&&(v.value.drive=!0),((g=(f=d.value)==null?void 0:f.usuarios)==null?void 0:g.length)>=1&&(v.value.usuarios=!0),((_=(r=d.value)==null?void 0:r.rutaDigital)==null?void 0:_.length)>=1&&(v.value.rutaDigital=!0),x.value=!1}catch(s){console.error("Error de red:",s)}else V(),x.value=!1};return le(()=>{W(),H(),K()}),(o,t)=>{const f=b("a-divider"),g=b("a-spin"),r=b("a-select"),_=b("a-form-item"),s=b("a-input-search"),O=b("a-input"),Z=b("a-date-picker"),J=b("a-button"),Q=b("a-form"),N=b("a-checkbox");return n(),q(C,null,[y("h3",null,se(m(k).query.dni?"ACTUALIZAR":"REGISTRO DE")+" USUARIO",1),u(f),x.value?(n(),i(g,{key:0})):(n(),q("div",Se,[u(Q,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:B,onFinishFailed:M},{default:c(()=>[y("div",qe,[(n(!0),q(C,null,re(m(fe),(e,X)=>(n(),q(C,{key:X},[e.type==="iSelect"?(n(),i(_,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[e.name=="document_type"?(n(),i(r,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:m(pe),disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):p("",!0),e.name=="gender"?(n(),i(r,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:m(ve)},null,8,["value","onUpdate:value","options"])):p("",!0),e.name=="isDisabled"?(n(),i(r,{key:2,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:m(_e)},null,8,["value","onUpdate:value","options"])):p("",!0),e.name=="office_code"?(n(),i(r,{key:3,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:m(be)},null,8,["value","onUpdate:value","options"])):p("",!0),e.name=="sede_code"?(n(),i(r,{key:4,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:F.value},null,8,["value","onUpdate:value","options"])):p("",!0),e.name=="role"?(n(),i(r,{key:5,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:m(ge)},null,8,["value","onUpdate:value","options"])):p("",!0)]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iSearch"?(n(),i(_,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:c(()=>[u(s,{maxlength:15,loading:G.value,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,onSearch:Y,onInput:j,disabled:L.value},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iText"?(n(),i(_,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:c(()=>[u(O,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iPassword"?ue((n(),i(_,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[u(O,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])),[[ie,!m(k).query.dni]]):p("",!0),e.type==="iSelectWrite"?(n(),i(_,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[u(r,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:I.value,"filter-option":$},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name","label","rules"])):p("",!0),e.type==="iDate"?(n(),i(_,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[u(Z,{locale:m(de),value:a.birthdate,"onUpdate:value":t[0]||(t[0]=l=>a.birthdate=l),style:{width:"100%"},format:Ee},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):p("",!0)],64))),128))]),u(_,null,{default:c(()=>[u(J,{type:"primary","html-type":"submit",loading:S.value},{default:c(()=>[T("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),y("section",De,[y("div",null,[u(N,{checked:v.value.drive,"onUpdate:checked":t[1]||(t[1]=e=>v.value.drive=e)},{default:c(()=>[T("Drive")]),_:1},8,["checked"]),u(r,{value:d.value.drive,"onUpdate:value":t[2]||(t[2]=e=>d.value.drive=e),mode:"multiple",style:{width:"100%"},placeholder:"Agrega vistas para este usuario",onChange:t[3]||(t[3]=e=>E("drive")),options:m(Ue)},null,8,["value","options"])]),we,y("div",null,[u(N,{checked:v.value.rutaDigital,"onUpdate:checked":t[4]||(t[4]=e=>v.value.rutaDigital=e)},{default:c(()=>[T("Ruta Digital")]),_:1},8,["checked"]),u(r,{value:d.value.rutaDigital,"onUpdate:value":t[5]||(t[5]=e=>d.value.rutaDigital=e),mode:"multiple",style:{width:"100%"},placeholder:"Agrega vistas para este usuario",onChange:t[6]||(t[6]=e=>E("rutaDigital")),options:m(ke)},null,8,["value","options"])]),Te,y("div",null,[u(N,{checked:v.value.usuarios,"onUpdate:checked":t[7]||(t[7]=e=>v.value.usuarios=e)},{default:c(()=>[T("Usuarios")]),_:1},8,["checked"]),u(r,{value:d.value.usuarios,"onUpdate:value":t[8]||(t[8]=e=>d.value.usuarios=e),mode:"multiple",style:{width:"100%"},placeholder:"Agrega vistas para este usuario",onChange:t[9]||(t[9]=e=>E("usuarios")),options:m(he)},null,8,["value","options"])]),xe])]))],64)}}},Fe=ye(Ne,[["__scopeId","data-v-46908e35"]]);export{Fe as default};
