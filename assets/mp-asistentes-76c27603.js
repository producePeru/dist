import{_ as G}from"./TableComponent-00128634.js";import{E as Q,r,u as j,a as q,p as O,k as J,X as C,b as y,o as m,d as x,c as f,w as i,m as S,y as D,z as h,e as c,t as o,i as X,a2 as K,h as W}from"./index-1618ed33.js";import{d as Z}from"./downloadExcel-21ed71ff.js";import"./es-0191a91e.js";import{_ as ee}from"./ParticipanteSed-cfbdcb8e.js";import"./icoexcel-1b303edf.js";import"./selectes-46e53dac.js";import"./SyncOutlined-bca6904a.js";import"./MoreOutlined-e7af4172.js";import"./FormComponent-f9ecb771.js";import"./quill.snow-83df5919.js";const ae={class:"layout-content mp-table"},te={key:1,class:"mp-empresario"},ne={key:2,class:"mp-empresario"},oe=["onClick"],_e={__name:"mp-asistentes",setup(le){const v=Q(),b=JSON.parse(localStorage.getItem("role"))||[],R=r([]),k=r(0),A=r(150),p=r(!1);j();const E=r(!1),_=r(null),w=r(!1),N=r({name:"Cargando..."}),n=q({year:O("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),M=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"ASISTIÃ“",dataIndex:"asistio",width:80,align:"center",fixed:"left"},{title:"EMPRESARIO",dataIndex:"empresario",width:360},{title:"DISCAPACIDAD",dataIndex:"sick",width:120,align:"center"},{title:"VINCULACIÃ“N CON LA MYPE",dataIndex:"roleCompany",width:200,align:"center"},{title:"EMPRESA",dataIndex:"empresa",width:360},{title:"SECTOR ECONÃ“MICO",dataIndex:"economicSector",align:"center",width:120},{title:"RUBRO",dataIndex:"rubro",align:"center",width:180},{title:"ACTIVIDAD COMERCIAL",dataIndex:"comercialActivity",align:"center",width:180}],P=e=>{_.value=e,p.value=!0},U=()=>{d(),p.value=!1},$=()=>{_.value=null,p.value=!0},B=async(e,a)=>{const g={slug:v.params.slug,ruc:a.ruc,doc_number:a.dni};try{const u=await S({url:"mp/toggle-attendance",method:"PUT",data:g});u.status==200&&console.log("status",u.message)}catch(u){console.error("Error de red:",u)}},V=async e=>{try{const a=await S({url:`fair/sed-delete-user/${e.id}`,method:"DELETE"});a.status==200&&(d(),W.success(a.message))}catch(a){console.error("Error de red:",a)}},L=async()=>{w.value=!0;try{const e={},a=v.params.slug;n.name&&(e.name=n.name);let l=`download/mp-attendance-export/${a}`;await Z(l,"inscritos",e)}catch(e){console.error("Error de red:",e)}finally{w.value=!1}},F=async e=>{n.page=e,await d()},H=async e=>{e&&(n.page=1,await d())},T=e=>b.some(a=>e.includes(a.id)),d=async()=>{try{E.value=!0;const e={page:n.page},a=v.params.slug;n.year&&(e.year=O(n.year).format("YYYY")),n.range&&(e.dateStart=n.range[0].format("YYYY/MM/DD"),e.dateEnd=n.range[1].format("YYYY/MM/DD")),n.name&&(e.name=n.name),n.orderby&&(e.orderby=n.orderby);const l=await S({url:`mp/attendance-event/${a}`,method:"GET",params:e});N.value.name=l.eventTitle,R.value=l.data.data,k.value=l.data.total,A.value=l.data.per_page}catch(e){console.error("Error de red:",e)}finally{E.value=!1}};return J(async()=>{await d()}),C("search",n),C("loading",E),C("loadingFile",w),(e,a)=>{var Y;const l=y("a-checkbox"),g=y("a-menu-item"),u=y("a-popconfirm"),z=y("a-drawer");return m(),x("div",ae,[f(G,{title:`ðŸ‘© INSCRITOS EN : ${(Y=N.value)==null?void 0:Y.name}`,new:!1,textNuevo:"NUEVO EVENTO",downloadExcel:!0,placeholderSearch:"Buscar",bread:!0,routeBack:"/admin/mp/capacitaciones",searchYear:!1,rangeDate:!1,columns:M,titleSearch:"FILTRAR POR RUC O DNI",pageSize:A.value,nameTotal:"Inscritos",dataSource:R.value,total:k.value,btnUpdate:!0,onHandleNew:$,onHandleCallFetchData:d,onHandleDownloadExcel:L,onHandleSearch:H,onHandlePaginator:F},{"data-cell":i(({column:s,record:t})=>[s.dataIndex=="asistio"?(m(),D(l,{key:0,checked:t.attendance,"onUpdate:checked":I=>t.attendance=I,onChange:I=>B(I,t)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),s.dataIndex=="empresario"?(m(),x("div",te,[c("b",null,o(t.name)+" "+o(t.last_name)+" "+o(t.middle_name),1),c("span",null,o(t.typeDocument)+" "+o(t.dni)+" / "+o(t.phone)+" / "+o(t.email),1)])):h("",!0),s.dataIndex=="empresa"?(m(),x("div",ne,[c("b",null,o(t.socialReason),1),c("span",null,o(t.ruc),1),c("span",null,o(t.city)+" - "+o(t.province)+" - "+o(t.district),1)])):h("",!0)]),"custom-options":i(({record:s})=>[T([1,5])?(m(),D(g,{key:0},{default:i(()=>[c("a",{onClick:t=>P(s)},"Editar",8,oe)]),_:2},1024)):h("",!0),T([1,5])?(m(),D(g,{key:1},{default:i(()=>[f(u,{placement:"rightBottom",title:`Â¿Quieres eliminar ${s.documentnumber} ?`,onConfirm:t=>V(s)},{icon:i(()=>[f(X(K),{style:{color:"red"}})]),default:i(()=>[a[1]||(a[1]=c("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):h("",!0)]),_:1},8,["title","pageSize","dataSource","total"]),f(z,{open:p.value,"onUpdate:open":a[0]||(a[0]=s=>p.value=s),title:_.value?"EDITAR DATOS DEL PARTICIPANTE":"NUEVO REGISTRO",placement:"right",width:"650"},{default:i(()=>[f(ee,{onCloseDraw:U,info:_.value},null,8,["info"])]),_:1},8,["open","title"])])}}};export{_e as default};
