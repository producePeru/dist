import{r as s,a as J,p as g,k as K,X as E,b as d,o as b,d as W,c as n,w as l,m as I,f as Z,y as ee,i as T,a1 as te,z as ae,e as v,O as oe,j as ne,a2 as le,h as y}from"./index-f60ff184.js";import{_ as re}from"./TableComponent-899d99fb.js";import{_ as se}from"./EventosUgo-fa9b77b0.js";import{d as ie}from"./downloadExcel-9ea73bdf.js";import{g as de}from"./usePermissions-77ac4ab6.js";import"./es-384c9dcb.js";import{g as N,a as ce}from"./publicInscripcion-ebc9ecb9.js";import"./icoexcel-1b303edf.js";import"./selectes-d6ad8ccd.js";import"./MoreOutlined-d1da6395.js";const ue={class:"layout-content"},pe=["onClick"],me=["onClick"],fe=["onClick"],ke={__name:"eventos-index",setup(_e){const x=s([]),C=s(0),D=s(150),m=s({}),u=s(!1),h=s(!1),f=s(null),w=s(!1),Y=s([]),a=J({year:g("2025","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),S=[{title:"",dataIndex:"copy",fixed:"left",width:50},{title:"ASESOR",dataIndex:"asesor",fixed:"left",width:180},{title:"DESCRIPCIÓN",dataIndex:"description",width:450},{title:"NOMBRE DE LA ACTIVIDAD",dataIndex:"title",width:220},{title:"INSCRITOS",dataIndex:"attendance_list_count",width:100,align:"center"},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"REGIÓN",dataIndex:"city",width:120},{title:"PROVINCIA",dataIndex:"province",width:150},{title:"DISTRITO",dataIndex:"district",width:150},{title:"LUGAR",dataIndex:"address",width:180},{title:"FECHA CREACIÓN",dataIndex:"created_at",width:140,align:"center"},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}];async function A(e,t){const o=O(e,t);await $(o)?y.success("Link copiado"):y.error("No se pudo copiar el link")}function O(e,t){return e===3?`${N()}/fortalece-tu-mercado/${t}`:`${ce()}/asistencias/${t}`}async function $(e){var t;try{if((t=navigator.clipboard)!=null&&t.writeText)return await navigator.clipboard.writeText(e),!0;const o=document.createElement("textarea");o.value=e,o.setAttribute("readonly",""),o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select();const _=document.execCommand("copy");return document.body.removeChild(o),_}catch{return!1}}const R=s([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]);function L(e,t){if(e==3){const o=`${N()}/fortalece-tu-mercado/${t}`;window.open(o,"_blank")}else{const o=`/asistencias/${t}`;window.open(o,"_blank")}}const V=e=>{f.value=e,u.value=!0},M=()=>{i(),u.value=!1},F=()=>{f.value=null,u.value=!0},U=async e=>{try{const t=await I({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(i(),y.success(t.message))}catch(t){console.error("Error de red:",t)}},G=async e=>{try{const t=await I({url:`attendance/event-finally/${e.id}`,method:"PUT"});t.status==200&&(i(),y.success(t.message))}catch(t){console.error("Error de red:",t)}},P=async()=>{w.value=!0;try{const e={};a.year&&(e.year=g(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor),await ie("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{w.value=!1}},B=async e=>{a.page=e,await i()},H=async e=>{e&&(a.page=1,await i())},i=async()=>{try{h.value=!0;const e={page:a.page};a.year&&(e.year=g(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor);const o=await I({url:"events-ugo/list",method:"GET",params:e});x.value=o.data.data,C.value=o.data.total,D.value=o.data.per_page}catch(e){console.error("Error de red:",e)}finally{h.value=!1}},z=async()=>{try{const e=await Z({url:"select/asesores",method:"GET"});e.status==200&&(Y.value=e.data)}catch{console.log("Failed to delete")}};return K(async()=>{var e;m.value=await de("eventos-ugo"),(e=m.value)!=null&&e.can_view_all&&(await i(),await z())}),E("search",a),E("loading",h),E("loadingFile",w),(e,t)=>{var k;const o=d("a-button"),_=d("a-tooltip"),j=d("a-input-group"),p=d("a-menu-item"),q=d("router-link"),Q=d("a-popconfirm"),X=d("a-drawer");return b(),W("div",ue,[n(re,{title:"LISTA EVENTOS UGO",textNuevo:"NUEVO EVENTO",new:!0,searchYear:!0,rangeDate:!0,btnUpdate:!0,btnImport:!0,downloadExcel:(k=m.value)==null?void 0:k.can_download,placeholderSearch:"Buscar",columns:S,othersList:R.value,titleSearch:"BUSCAR POR EVENTO",pageSize:D.value,nameTotal:"Eventos UGO",asesoresList:Y.value,dataSource:x.value,total:C.value,onHandleNew:F,onHandleDownloadExcel:P,onHandleSearch:H,permisos:m.value,onHandleCallFetchData:i,onHandlePaginator:B},{"data-cell":l(({column:r,record:c})=>[r.dataIndex=="copy"?(b(),ee(j,{key:0,compact:""},{default:l(()=>[n(_,{title:"copiar link"},{default:l(()=>[n(o,{type:"text",onClick:ve=>A(c.eventsoffice_id,c.slug)},{icon:l(()=>[n(T(te),{style:{"font-size":"11px"}})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):ae("",!0)]),"custom-options":l(({record:r})=>[n(p,null,{default:l(()=>[v("a",{href:"#",onClick:oe(c=>L(r.eventsoffice_id,r.slug),["prevent"])}," Ver Link ",8,pe)]),_:2},1024),n(p,null,{default:l(()=>[n(q,{to:`eventos-inscritos/${r.slug}`},{default:l(()=>t[1]||(t[1]=[ne("Inscritos")])),_:2},1032,["to"])]),_:2},1024),n(p,null,{default:l(()=>[v("a",{onClick:c=>V(r)},"Editar",8,me)]),_:2},1024),n(p,null,{default:l(()=>[v("span",{style:{color:"#ff4d4f"},onClick:c=>G(r)},"Finalizar",8,fe)]),_:2},1024),n(p,null,{default:l(()=>[n(Q,{placement:"rightBottom",title:`¿Quieres eliminar ${r.title} ?`,onConfirm:c=>U(r)},{icon:l(()=>[n(T(le),{style:{color:"red"}})]),default:l(()=>[t[2]||(t[2]=v("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:1},8,["downloadExcel","othersList","pageSize","asesoresList","dataSource","total","permisos"]),n(X,{open:u.value,"onUpdate:open":t[0]||(t[0]=r=>u.value=r),title:f.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD",placement:"right",width:"550"},{default:l(()=>[n(se,{onCloseDraw:M,dataRow:f.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{ke as default};
