import{L as ye,r as g,a as H,b as c,o as n,p as b,w as o,e as x,d as U,F as k,v as we,h as L,q as r,c as i,M as Ue,t as h,i as f,y as M,m as $,j as pe,K as ce,I as ke,J as xe,P as Ce}from"./index-19dbe2bd.js";import{f as Ie}from"./actualizarUsuario-3eaca126.js";import{u as Ae}from"./selectes-c649ed57.js";import"./es-7f7a9e94.js";import{_ as De}from"./_plugin-vue_export-helper-c27b6911.js";import{M as Se}from"./MoreOutlined-f02a377a.js";const Ee={class:"grid-profile"},Pe="YYYY-MM-DD",Fe={__name:"EditarPerfil.componente",props:["updateUser"],emits:["closeDraw"],setup(z,{emit:E}){ye.locale("es");const a=Ae(),P=JSON.parse(localStorage.getItem("profile")),I=E;a.$patch({genders:a.genders}),a.$patch({cdes:a.cdes}),a.$patch({Offices:a.Offices}),a.$patch({roles:a.roles}),a.$patch({supervisores:a.supervisores}),a.fetchGenders(),a.fetchCdes(),a.fetchOffices(),a.fetchRoles();const A=z,C=g(!1),m=g(Ie),D=g(null),t=H({name:null,lastname:null,middlename:null,birthday:null,sick:null,phone:null,gender_id:null,cde_id:null,office_id:null,user_id:P.id}),v=s=>{s&&(t.name=s.profile.name,t.lastname=s.profile.lastname,t.middlename=s.profile.middlename,t.birthday=s.profile.birthday,t.sick=s.profile.sick,t.phone=s.profile.phone,t.gender_id=s.profile.gender_id,t.cde_id=s.profile.cde_id,t.office_id=s.profile.office_id,t.email=s.email)},p=s=>{const y={type:"iSelect",label:"Supervisador",name:"supervisor_id",required:!0,message:"Seleccionar tipo de documento",disabled:!0};if(s===2)a.fetchSupervisores(),m.value={...m.value,supervisor_id:y};else{const{supervisor_id:F,...S}=m.value;m.value=S}},G=async()=>{C.value=!0;let s=t;delete s.email;try{const y=await M({url:`user/update/${A.updateUser.profile.id}`,method:"PUT",data:s});$.success(y.message),I("closeDraw",!0)}catch{$.error("No se pudo registrar este usuario")}finally{C.value=!1}},O=()=>{$.error("Debes de completar todos los espacios requeridos")};return(s,y)=>{const F=c("a-select"),S=c("a-form-item"),T=c("a-input"),B=c("a-date-picker"),Y=c("a-button"),R=c("a-form");return n(),b(R,{layout:"vertical",model:t,name:"basic",autocomplete:"off",onFinish:G,onFinishFailed:O},{default:o(()=>[x("div",Ee,[(n(!0),U(k,null,we(m.value,(e,j)=>(n(),U(k,{key:j},[e.type==="iSelect"?(n(),b(S,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[e.name=="gender_id"?(n(),b(F,{key:0,value:t[e.name],"onUpdate:value":l=>t[e.name]=l,options:L(a).genders},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="cde_id"?(n(),b(F,{key:1,value:t[e.name],"onUpdate:value":l=>t[e.name]=l,options:L(a).cdes},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="office_id"?(n(),b(F,{key:2,value:t[e.name],"onUpdate:value":l=>t[e.name]=l,options:L(a).Offices},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="role_id"?(n(),b(F,{key:3,value:t[e.name],"onUpdate:value":l=>t[e.name]=l,options:L(a).roles,onChange:p},null,8,["value","onUpdate:value","options"])):r("",!0),e.name=="supervisor_id"?(n(),b(F,{key:4,value:t[e.name],"onUpdate:value":l=>t[e.name]=l,options:L(a).supervisores},null,8,["value","onUpdate:value","options"])):r("",!0)]),_:2},1032,["name","label","rules"])):r("",!0),e.type==="iText"?(n(),b(S,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:o(()=>[i(T,{value:t[e.name],"onUpdate:value":l=>t[e.name]=l,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):r("",!0),e.type==="iDate"?(n(),b(S,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:o(()=>[i(B,{locale:L(Ue),value:D.value,"onUpdate:value":y[0]||(y[0]=l=>D.value=l),style:{width:"100%"},format:Pe},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):r("",!0)],64))),128))]),x("div",null,h(v(A.updateUser)),1),i(S,null,{default:o(()=>[i(Y,{class:"btn-produce",type:"primary","html-type":"submit",loading:C.value},{default:o(()=>y[1]||(y[1]=[f("GUARDAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])}}},Re=De(Fe,[["__scopeId","data-v-3578053d"]]);const Le={__name:"DrawAdministrarVistasUsuario",props:["idUser"],emits:["closeDraw"],setup(z,{emit:E}){const a=z,P=E,I=g(!0),A=g(!1),C=[{label:"Inicio",value:"inicio"},{label:"Drive Principal",value:"drive"},{label:"Drive Carpetas",value:"drive-mis-carpetas"},{label:"Drive Archivos",value:"drive-mis-archivos"},{label:"Drive Subir Archivo",value:"drive-subir-archivo"},{label:"AF - Principal",value:"asesorias"},{label:"AF - Registro",value:"asesorias-formalizaciones"},{label:"AF - Reportes",value:"asesorias"},{label:"AF - Planes de AcciÃ³n",value:"planes-accion"},{label:"AF - Solicitantes",value:"solicitantes"},{label:"AF - Notarias",value:"notarias"},{label:"AF - Asesores",value:"asesores"},{label:"Convenios Principal",value:"convenios"},{label:"Convenios UGO",value:"estado-convenio-ugo"},{label:"Convenios UGSE",value:"estado-convenio-ugse"},{label:"Calendario Principal",value:"eventos"},{label:"Eventos Lista",value:"eventos-calendario-google"},{label:"Usuarios Principal",value:"usuarios"},{label:"Usuarios Registrar",value:"usuarios-nuevo"},{label:"Usuarios Externo",value:"asesor-externo-notario"},{label:"Usuarios Lista",value:"usuarios-lista"},{label:"Config. Principal",value:"configuraciones"},{label:"Config. Token API",value:"tokens"}];pe(()=>{a.idUser&&t(a.idUser)});const m=H({indeterminate:!0,checkAll:!1,checkedList:[]});ce(()=>m.checkedList,v=>{m.indeterminate=!!v.length&&v.length<C.length,m.checkAll=v.length===C.length}),ce(()=>a.idUser,v=>{v&&t()});const D=async()=>{A.value=!0;const v={views:m.checkedList};try{const p=await M({url:`user/views/${a.idUser.id}`,method:"PUT",data:v});if(p.status==403)return $.error(p.message);$.success(p.message),P("closeDraw",!0)}catch{$.error("No se pudo registrar este usuario")}finally{A.value=!1}},t=async()=>{I.value=!0;try{const{data:v}=await M({url:`user/views/${a.idUser.id}`,method:"GET"});m.checkedList=v}catch(v){console.log("Error",v)}finally{I.value=!1}};return(v,p)=>{const G=c("a-checkbox-group"),O=c("a-spin"),s=c("a-button");return n(),U(k,null,[i(O,{spinning:I.value},{default:o(()=>[i(G,{value:m.checkedList,"onUpdate:value":p[0]||(p[0]=y=>m.checkedList=y),options:C,class:"views-list"},null,8,["value"])]),_:1},8,["spinning"]),p[2]||(p[2]=x("br",null,null,-1)),p[3]||(p[3]=x("br",null,null,-1)),i(s,{type:"primary","html-type":"submit",loading:A.value,onClick:D},{default:o(()=>p[1]||(p[1]=[f("GUARDAR")])),_:1},8,["loading"])],64)}}};const Oe=["onClick"],Ne=["onClick"],$e={class:"paginator"},Be={__name:"ListaUsuarios",setup(z){const E=g(null),a=g(!1),P=g(!1),I=g(50),A=g([]),C=g(!1),m=g(0),D=g({page:1}),t=g("user/list"),v=g(1200),p=g(window.innerHeight-100),G=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"DNI",dataIndex:"documentnumber",fixed:"left",width:80},{title:"Nombres",dataIndex:"name",width:120},{title:"Apellidos",dataIndex:"lastname",width:120},{title:"Correo",dataIndex:"email",width:200},{title:"Celular",dataIndex:"phone",width:100,align:"center"},{title:"Fecha Nac.",dataIndex:"birthday",width:100,align:"center"},{title:"Oficina",dataIndex:"office",width:120,align:"center"},{title:"CDE",dataIndex:"cde",width:140},{title:"ROL",dataIndex:"role",width:160},{title:"",dataIndex:"actions",align:"center",width:50,fixed:"right"}],O=()=>{p.value=window.innerHeight-300},s=H({search:""}),y=()=>{let l={search:s.search};R(l)},F=()=>{s.search||R()},S=()=>{R(),a.value=!1,P.value=!1},T=l=>{D.value.page=l,R()},B=l=>{E.value=l,a.value=!0},Y=l=>{E.value=l,P.value=!0},R=async l=>{try{C.value=!0;const u=D.value.page===1?"":D.value,V=l?{...u,...l}:u,{data:q}=await M({url:t.value,method:"GET",params:V});A.value=q.data,m.value=q.total,I.value=q.per_page}catch(u){console.error("Error de red:",u)}finally{C.value=!1}},e=ke(()=>l=>(D.value.page-1)*I.value+l+1);pe(()=>{R(),window.addEventListener("resize",O),O()});const j=()=>{console.log("Drawer state changed")};return(l,u)=>{const V=c("a-col"),q=c("a-input"),J=c("a-button"),me=c("a-input-group"),fe=c("a-row"),N=c("a-tag"),K=c("a-menu-item"),ve=c("a-menu"),_e=c("a-dropdown"),ge=c("a-table"),he=c("a-pagination"),X=c("a-drawer");return n(),U(k,null,[x("div",null,[u[6]||(u[6]=x("h3",{class:"title-produce"},"USUARIOS DEL PROGRAMA PNTE",-1)),i(fe,{style:{margin:"1rem 0"}},{default:o(()=>[i(V,{xs:24,md:12,lg:18}),i(V,{xs:24,md:12,lg:6},{default:o(()=>[i(me,{compact:""},{default:o(()=>[i(q,{value:s.search,"onUpdate:value":u[0]||(u[0]=_=>s.search=_),style:{width:"calc(100% - 80px)"},onInput:F},null,8,["value"]),i(J,{type:"primary",disabled:s.search==="",onClick:y},{default:o(()=>u[4]||(u[4]=[f("BUSCAR")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),i(ge,{bordered:"",scroll:{x:v.value,y:p.value},class:"table-users",columns:G,"data-source":A.value,pagination:!1,loading:C.value,size:"small"},{bodyCell:o(({column:_,record:d,index:be})=>{var Q,W,Z,ee,ae,te,ne,le,oe,se,ie,re,ue,de;return[_.dataIndex==="idx"?(n(),U(k,{key:0},[f(h(e.value(be)),1)],64)):r("",!0),_.dataIndex=="documentnumber"?(n(),U(k,{key:1},[f(h((Q=d.profile)==null?void 0:Q.documentnumber),1)],64)):r("",!0),_.dataIndex=="name"?(n(),U(k,{key:2},[f(h((W=d.profile)==null?void 0:W.name),1)],64)):r("",!0),_.dataIndex=="lastname"?(n(),U(k,{key:3},[f(h((Z=d.profile)==null?void 0:Z.lastname)+" "+h((ee=d.profile)==null?void 0:ee.middlename),1)],64)):r("",!0),_.dataIndex=="phone"?(n(),U(k,{key:4},[f(h((ae=d.profile)!=null&&ae.phone?(te=d.profile)==null?void 0:te.phone:"ðŸ”’"),1)],64)):r("",!0),_.dataIndex=="birthday"?(n(),U(k,{key:5},[f(h((ne=d.profile)!=null&&ne.birthday?(le=d.profile)==null?void 0:le.birthday:"ðŸ”’"),1)],64)):r("",!0),_.dataIndex=="office"?(n(),U(k,{key:6},[((oe=d.profile.office)==null?void 0:oe.name)=="UGSE"?(n(),b(N,{key:0,color:"blue"},{default:o(()=>{var w;return[f(h((w=d.profile)==null?void 0:w.office.name),1)]}),_:2},1024)):r("",!0),((se=d.profile.office)==null?void 0:se.name)=="UGO"?(n(),b(N,{key:1,color:"orange"},{default:o(()=>{var w;return[f(h((w=d.profile)==null?void 0:w.office.name),1)]}),_:2},1024)):r("",!0),((ie=d.profile.office)==null?void 0:ie.name)=="DE"?(n(),b(N,{key:2,color:"green"},{default:o(()=>{var w;return[f(h((w=d.profile)==null?void 0:w.office.name),1)]}),_:2},1024)):r("",!0),((re=d.profile.office)==null?void 0:re.name)=="UGEER"?(n(),b(N,{key:3,color:"gray"},{default:o(()=>{var w;return[f(h((w=d.profile)==null?void 0:w.office.name),1)]}),_:2},1024)):r("",!0),((ue=d.profile.office)==null?void 0:ue.id)==5?(n(),b(N,{key:4,color:"blue"},{default:o(()=>u[5]||(u[5]=[f("Asesor NotarÃ­a ")])),_:1})):r("",!0)],64)):r("",!0),_.dataIndex=="cde"?(n(),U(k,{key:7},[f(h((de=d.profile)==null?void 0:de.cde.name),1)],64)):r("",!0),_.dataIndex=="role"?(n(),U(k,{key:8},[f(h(d.roles[0].name),1)],64)):r("",!0),_.dataIndex=="actions"?(n(),b(_e,{key:9,trigger:["click"]},{overlay:o(()=>[i(ve,null,{default:o(()=>[i(K,null,{default:o(()=>[x("a",{onClick:w=>B(d)},"Editar",8,Oe)]),_:2},1024),i(K,null,{default:o(()=>[x("a",{onClick:w=>Y(d)},"Vistas",8,Ne)]),_:2},1024)]),_:2},1024)]),default:o(()=>[x("a",{class:"ant-dropdown-link",onClick:u[1]||(u[1]=xe(()=>{},["prevent"]))},[i(J,{shape:"circle",icon:Ce(L(Se)),size:"small"},null,8,["icon"])])]),_:2},1024)):r("",!0)]}),_:1},8,["scroll","data-source","loading"])]),x("div",$e,[x("span",null,[i(N,{color:"blue"},{default:o(()=>[x("b",null,h(m.value),1)]),_:1}),u[7]||(u[7]=f("Usuarios"))]),i(he,{size:"small",total:m.value,pageSize:I.value,onChange:T,showSizeChanger:!1},null,8,["total","pageSize"])]),i(X,{width:"550",open:a.value,"onUpdate:open":u[2]||(u[2]=_=>a.value=_),class:"draw-notary",title:"Editar Perfil",placement:"right",onAfterOpenChange:j},{default:o(()=>[i(Re,{updateUser:E.value,onCloseDraw:S},null,8,["updateUser"])]),_:1},8,["open"]),i(X,{width:"450",open:P.value,"onUpdate:open":u[3]||(u[3]=_=>P.value=_),class:"draw-notary",title:"Administrar Vistas",placement:"right"},{default:o(()=>[i(Le,{idUser:E.value,onCloseDraw:S},null,8,["idUser"])]),_:1},8,["open"])],64)}}};export{Be as default};
