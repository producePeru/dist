import{P as X,l as ee,u as ae,r as _,a as te,n as oe,b as m,o as n,d as k,e as g,t as se,i as d,c as l,B as r,w as c,F as E,D as T,h as q,m as D,f as ne,v as le,s as u,E as re,G as ue,R as ie,j as x,p as de,k as ce}from"./index-ef958b15.js";import"./es-17b81e24.js";import{d as me,g as pe,f as ve,o as _e,h as be}from"./selects-0563509c.js";import{_ as ge}from"./_plugin-vue_export-helper-c27b6911.js";const ye={document_type:{type:"iSelect",label:"Tipo de documento",name:"document_type",required:!0,message:"Seleccionar tipo de documento",disabled:!0},document_number:{type:"iSearch",label:"Ingresar número",name:"document_number",required:!0,message:"Escribe número de documento",disabled:!1,max:8},last_name:{type:"iText",label:"Apellido paterno",name:"last_name",required:!0,message:"Escribe el apellido paterno"},middle_name:{type:"iText",label:"Apellido materno",name:"middle_name",required:!0,message:"Escribe el apellido materno"},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribe el nombre"},country_code:{type:"iSelectWrite",label:"País",name:"country_code",required:!0,message:"Seleccionar país"},email:{type:"iText",label:"Correo",name:"email",required:!0,email:"email",message:"Escribe el correo del usuario"},password:{type:"iPassword",label:"Contraseña",name:"password",required:!1,message:"Registra la contraseña"},office_code:{type:"iSelect",label:"Oficina",name:"office_code",required:!0,message:"Seleccionar un tipo"},sede_code:{type:"iSelect",label:"Sede donde labora",name:"sede_code",required:!0,message:"Seleccionar un tipo"},role:{type:"iSelect",label:"Tipo de usuario",name:"role",required:!0,message:"Seleccionar un tipo"},gender:{type:"iSelect",label:"Género",name:"gender",required:!1,message:"Seleccionar tipo de documento"}},fe=[{value:"Nuevo Usuario"},{value:"Lista"}],he=[{value:"Reportes"},{value:"Calendario"},{value:"Talleres"},{value:"MYPE"},{value:"Expositores"},{value:"Test Entrada"},{value:"Editar Test Entrada"},{value:"Test Salida"},{value:"Editar Test Salida"},{value:"Taller Descripcion"}];const L=h=>(de("data-v-e32c0771"),h=h(),ce(),h),Ue={key:1,class:"user"},Se={class:"grid-item"},ke={class:"roles"},qe=L(()=>g("br",null,null,-1)),De=L(()=>g("br",null,null,-1)),we="YYYY-MM-DD",Ee={__name:"NuevoUsuarios",setup(h){X.locale("es");const U=ee(),O=ae(),w=_(!0),S=_(!1),N=_([]),R=_([]),G=_(!1),C=_(!1),a=te({nick_name:null,birthdate:null,gender:null,is_disabled:0,phone_number:null,document_type:1,document_number:null,last_name:null,middle_name:null,name:null,country_code:173,email:null,password:null,office_code:null,sede_code:1,role:null,created_by:T,updated_by:T}),p=_({usuarios:[],rutaDigital:[]}),v=_({rutaDigital:!1,usuarios:!1}),A=t=>{p.value[t].length>0?v.value[t]=!0:v.value[t]=!1},P=async t=>{const o=Object.fromEntries(Object.entries(p.value).filter(([y,i])=>i.length>0)),f={id_user:t,created_by:T,views:o,exclusions:null};try{const y=await q({url:"/permission",method:"POST",data:f});D.success(y.message),O.push("/admin/usuarios/lista")}catch{D.error("No se pudo registrar este usuario")}finally{S.value=!1}},z=async()=>{const t=a;S.value=!0;try{const o=await q({url:"/register-user",method:"POST",data:t});await P(o.user_id)}catch{D.error("No se pudo registrar este usuario")}finally{S.value=!1}},V=()=>{D.error("Debes de completar todos los espacios requeridos")},B=async t=>{console.log("Hello",t)},Y=()=>{a.document_number=a.document_number.replace(/\D/g,"")},j=(t,o)=>{const f=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return o.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(f)},M=async()=>{try{const{data:t}=await ne({url:"/countries",method:"GET"});N.value=t}catch(t){console.error("Error de red:",t)}},$=async()=>{try{const{data:t}=await q({url:"/sedes",method:"GET"});R.value=t}catch(t){console.error("Error de red:",t)}},W=async()=>{if(U.query.dni){try{const{data:t}=await q({url:`user/${U.query.dni}`,method:"GET"});a.document_type=+t.document_type,a.document_number=t.document_number,C.value=!0,a.last_name=t.last_name,a.middle_name=t.middle_name,a.name=t.name,a.country_code=t.country_code,a.email=t.email,a.office_code=t.office_code,a.sede_code=t.sede_code,a.role=t.role,a.gender=t.gender,a.birthdate=t.birthdate,a.phone_number=t.phone_number,p.value=t.permission,w.value=!1,t.permission.length>1&&(p.value.usuarios.length>=1&&(v.value.usuarios=!0),p.value.rutaDigital.length>=1&&(v.value.rutaDigital=!0))}catch(t){console.error("Error de red:",t)}return console.log("actualizar usuario")}console.log("crear usuario"),w.value=!1};return oe(()=>{M(),$(),W()}),(t,o)=>{const f=m("a-divider"),y=m("a-spin"),i=m("a-select"),b=m("a-form-item"),H=m("a-input-search"),I=m("a-input"),Z=m("a-date-picker"),J=m("a-button"),K=m("a-form"),F=m("a-checkbox");return n(),k(E,null,[g("h3",null,se(d(U).query.dni?"ACTUALIZAR":"REGISTRO DE")+" USUARIO",1),l(f),w.value?(n(),r(y,{key:0})):(n(),k("div",Ue,[l(K,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:z,onFinishFailed:V},{default:c(()=>[g("div",Se,[(n(!0),k(E,null,le(d(ye),(e,Q)=>(n(),k(E,{key:Q},[e.type==="iSelect"?(n(),r(b,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[e.name=="document_type"?(n(),r(i,{key:0,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:d(me),disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),e.name=="gender"?(n(),r(i,{key:1,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:d(pe)},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="isDisabled"?(n(),r(i,{key:2,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:d(ve)},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="office_code"?(n(),r(i,{key:3,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:d(_e)},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="sede_code"?(n(),r(i,{key:4,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:R.value},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="role"?(n(),r(i,{key:5,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:d(be)},null,8,["value","onUpdate:value","options"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSearch"?(n(),r(b,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:c(()=>[l(H,{maxlength:15,loading:G.value,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,onSearch:B,onInput:Y,disabled:C.value},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iText"?(n(),r(b,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:c(()=>[l(I,{value:a[e.name],"onUpdate:value":s=>a[e.name]=s},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iPassword"?re((n(),r(b,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[l(I,{value:a[e.name],"onUpdate:value":s=>a[e.name]=s},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])),[[ue,!d(U).query.dni]]):u("",!0),e.type==="iSelectWrite"?(n(),r(b,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[l(i,{value:a[e.name],"onUpdate:value":s=>a[e.name]=s,"show-search":"",options:N.value,"filter-option":j},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iDate"?(n(),r(b,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:c(()=>[l(Z,{locale:d(ie),value:a.birthdate,"onUpdate:value":o[0]||(o[0]=s=>a.birthdate=s),style:{width:"100%"},format:we},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),l(b,null,{default:c(()=>[l(J,{type:"primary","html-type":"submit",loading:S.value},{default:c(()=>[x("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),g("section",ke,[g("div",null,[l(F,{checked:v.value.rutaDigital,"onUpdate:checked":o[1]||(o[1]=e=>v.value.rutaDigital=e)},{default:c(()=>[x("Ruta Digital")]),_:1},8,["checked"]),l(i,{value:p.value.rutaDigital,"onUpdate:value":o[2]||(o[2]=e=>p.value.rutaDigital=e),mode:"multiple",style:{width:"100%"},placeholder:"Agrega vistas para este usuario",onChange:o[3]||(o[3]=e=>A("rutaDigital")),options:d(he)},null,8,["value","options"])]),qe,g("div",null,[l(F,{checked:v.value.usuarios,"onUpdate:checked":o[4]||(o[4]=e=>v.value.usuarios=e)},{default:c(()=>[x("Usuarios")]),_:1},8,["checked"]),l(i,{value:p.value.usuarios,"onUpdate:value":o[5]||(o[5]=e=>p.value.usuarios=e),mode:"multiple",style:{width:"100%"},placeholder:"Agrega vistas para este usuario",onChange:o[6]||(o[6]=e=>A("usuarios")),options:d(fe)},null,8,["value","options"])]),De])]))],64)}}},Ce=ge(Ee,[["__scopeId","data-v-e32c0771"]]);export{Ce as default};
