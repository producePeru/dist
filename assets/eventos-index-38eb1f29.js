import{r,a as me,p as C,k as ve,X as b,b as i,o as _,d as P,c as o,w as l,m as O,f as fe,e as d,s as Ee,i as T,z as f,y as g,a1 as ye,j as $,t as he,O as ge,a2 as we,h as D}from"./index-2a891b7b.js";import{_ as De}from"./TableComponent-89d40d54.js";import{_ as Ie}from"./EventosUgo-4021aa4a.js";import{d as z}from"./downloadExcel-1e9d6ec8.js";import{g as xe}from"./usePermissions-be9d6562.js";import"./es-bfd656c1.js";import{g as U}from"./publicInscripcion-623ff37e.js";import{F as Ae}from"./FileExcelOutlined-21e88144.js";import"./icoexcel-1b303edf.js";import"./selectes-c1938676.js";import"./SyncOutlined-e5c42275.js";import"./MoreOutlined-362d8093.js";const Ce={class:"layout-content"},be={style:{margin:".6rem 0 .6rem"}},Oe={class:"stat-box"},Te={class:"stat-box"},ke={class:"stat-box"},Ye={class:"stat-box"},Se={key:0},Ne={class:"draw-filter-item"},Re=["onClick"],Le=["onClick"],Me=["onClick"],Ze={__name:"eventos-index",setup(Ve){const k=r([]),Y=r(0),S=r(150),E=r(null),c=r({}),y=r(!1),I=r(!1),w=r(null),m=r(!1),N=r([]),a=me({year:C("2026","YYYY"),range:null,asesor:null,name:null,page:1,type:1,typeCde:null,orderby:null}),G=[{title:"",dataIndex:"copy",fixed:"left",width:50},{title:"TIPO DE ACTIVIDAD",dataIndex:"tipo_actividad",width:180},{title:"NOMBRE DE ACTIVIDAD",dataIndex:"nombre_actividad",width:180},{title:"TEMA DE ACTIVIDAD",dataIndex:"tema",width:180},{title:"NOMBRE DE ENTIDAD ORGANIZADORA",dataIndex:"entidad_aliada",width:180},{title:"ASESOR",dataIndex:"asesor",width:180},{title:"MYPE Y/O EMPRENDEDORES BENEFICIADOS ESPERADOS",dataIndex:"beneficiarios",align:"center",width:180},{title:"MYPE Y/O EMPRENDEDORES INSCRITOS",dataIndex:"attendance_list_count",align:"center",width:180},{title:"FECHA DE INICIO",dataIndex:"startDate",align:"center",width:140},{title:"FECHA DE FIN",dataIndex:"endDate",align:"center",width:140},{title:"MODALIDAD",dataIndex:"modality",align:"center",width:120},{title:"REGIÓN DE LA ACTIVIDAD",dataIndex:"city",width:120},{title:"PROVINCIA DE LA ACTIVIDAD",dataIndex:"province",width:120},{title:"DISTRITO DE LA ACTIVIDAD",dataIndex:"district",width:120},{title:"LUGAR DE LA ACTIVIDAD",dataIndex:"address",width:120},{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}],B=(e,t)=>{const n=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(n)};async function H(e,t){const n=j(e,t);await q(n)?D.success("Link copiado"):D.error("No se pudo copiar el link")}function j(e,t){return`${U()}/actividades-ugo/${t}`}async function q(e){var t;try{if((t=navigator.clipboard)!=null&&t.writeText)return await navigator.clipboard.writeText(e),!0;const n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n),n.select();const u=document.execCommand("copy");return document.body.removeChild(n),u}catch{return!1}}const Q=r([{value:1,label:"Mayor inscritos"},{value:2,label:"Menor inscritos"},{value:3,label:"Finalizados"}]);function X(e,t){const n=`${U()}/actividades-ugo/${t}`;window.open(n,"_blank")}const Z=e=>{w.value=e,y.value=!0},J=()=>{p(),y.value=!1},K=()=>{w.value=null,y.value=!0},W=async e=>{try{const t=await O({url:`attendance/delete/${e.id}`,method:"DELETE"});t.status==200&&(p(),D.success(t.message))}catch(t){console.error("Error de red:",t)}},ee=async e=>{try{const t=await O({url:`attendance/event-finally/${e.id}`,method:"PUT"});t.status==200&&(p(),D.success(t.message))}catch(t){console.error("Error de red:",t)}},te=async()=>{m.value=!0;try{const e={};a.year&&(e.year=C(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor),await z("download/attendance-ugo","Eventos-UGO",e)}catch(e){console.error("Error de red:",e)}finally{m.value=!1}},ae=async()=>{m.value=!0;try{await z("download/all-activities-the-year","Actividades-UGO-2025")}catch(e){console.error("Error de red:",e)}finally{m.value=!1}},ne=async e=>{a.page=e,await p()},oe=async e=>{e&&(a.page=1,await p())},p=async()=>{try{I.value=!0;const e={page:a.page};a.year&&(e.year=C(a.year).format("YYYY")),a.range&&(e.dateStart=a.range[0].format("YYYY/MM/DD"),e.dateEnd=a.range[1].format("YYYY/MM/DD")),a.name&&(e.name=a.name),a.orderby&&(e.orderby=a.orderby),a.asesor&&(e.asesor=a.asesor);const n=await O({url:"events-ugo/list",method:"GET",params:e});k.value=n.data.data,Y.value=n.data.total,S.value=n.data.per_page,E.value=n.statisti}catch(e){console.error("Error de red:",e)}finally{I.value=!1}},le=async()=>{try{const e=await fe({url:"select/asesores",method:"GET"});e.status==200&&(N.value=e.data)}catch{console.log("Failed to delete")}};return ve(async()=>{var e;c.value=await xe("eventos-ugo"),(e=c.value)!=null&&e.can_view_all&&(await p(),await le())}),b("search",a),b("loading",I),b("loadingFile",m),(e,t)=>{var L,M,V;const n=i("a-statistic"),u=i("a-col"),se=i("a-row"),R=i("a-button"),ie=i("a-select"),re=i("a-tooltip"),de=i("a-input-group"),ce=i("a-tag"),h=i("a-menu-item"),ue=i("router-link"),pe=i("a-popconfirm"),_e=i("a-drawer");return _(),P("div",Ce,[o(De,{title:"LISTA ACTIVIDADES UGO",textNuevo:"NUEVO EVENTO",new:(L=c.value)==null?void 0:L.can_create,searchYear:!0,rangeDate:(M=c.value)==null?void 0:M.can_date_range,btnUpdate:!0,btnImport:!0,downloadExcel:(V=c.value)==null?void 0:V.can_download_reporte,placeholderSearch:"Buscar",columns:G,othersList:Q.value,titleSearch:"BUSCAR POR EVENTO",pageSize:S.value,nameTotal:"Actividades UGO",dataSource:k.value,total:Y.value,onHandleNew:K,onHandleDownloadExcel:te,onHandleSearch:oe,permisos:c.value,onHandleCallFetchData:p,onHandlePaginator:ne,heightTable:440},{statics:l(()=>[d("div",be,[o(se,{gutter:16},{default:l(()=>[o(u,{span:6},{default:l(()=>[d("div",Oe,[o(n,{title:"Programación diaria",value:E.value.diaria},null,8,["value"])])]),_:1}),o(u,{span:6},{default:l(()=>[d("div",Te,[o(n,{title:"Programación consolidada",value:E.value.consolidada},null,8,["value"])])]),_:1}),o(u,{span:6},{default:l(()=>[d("div",ke,[o(n,{title:"Pendiente para resultado",value:E.value.pendiente},null,8,["value"])])]),_:1}),o(u,{span:6},{default:l(()=>[d("div",Ye,[o(n,{title:"Finalizadas",value:E.value.finalizadas},null,8,["value"])])]),_:1})]),_:1})])]),header:l(()=>[c.value.can_download_everything?(_(),P("div",Se,[o(R,{loading:m.value,type:"text",icon:Ee(T(Ae)),onClick:ae},null,8,["loading","icon"])])):f("",!0),d("div",Ne,[t[2]||(t[2]=d("span",null,"POR ASESOR",-1)),o(ie,{allowClear:!0,value:a.asesor,"onUpdate:value":t[0]||(t[0]=s=>a.asesor=s),placeholder:"Selecciona Asesor","show-search":"",options:N.value,"filter-option":B},null,8,["value","options"])])]),"data-cell":l(({column:s,record:v})=>[s.dataIndex=="copy"?(_(),g(de,{key:0,compact:""},{default:l(()=>[o(re,{title:"copiar link"},{default:l(()=>[o(R,{type:"text",onClick:x=>H(v.eventsoffice_id,v.slug)},{icon:l(()=>[o(T(ye),{style:{"font-size":"11px"}})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):f("",!0),s.dataIndex=="attendance_list_count"?(_(),g(ce,{key:1},{default:l(()=>[$(he(v.attendance_list_count),1)]),_:2},1024)):f("",!0)]),"custom-options":l(({record:s})=>{var v,x,F;return[o(h,null,{default:l(()=>[d("a",{href:"#",onClick:ge(A=>X(s.eventsoffice_id,s.slug),["prevent"])}," Ver Link ",8,Re)]),_:2},1024),o(h,null,{default:l(()=>[o(ue,{to:`eventos-inscritos/${s.slug}`},{default:l(()=>t[3]||(t[3]=[$("Inscritos")])),_:2},1032,["to"])]),_:2},1024),(v=c.value)!=null&&v.can_update?(_(),g(h,{key:0},{default:l(()=>[d("a",{onClick:A=>Z(s)},"Editar",8,Le)]),_:2},1024)):f("",!0),(x=c.value)!=null&&x.can_finish?(_(),g(h,{key:1},{default:l(()=>[d("span",{style:{color:"#ff4d4f"},onClick:A=>ee(s)},"Finalizar",8,Me)]),_:2},1024)):f("",!0),(F=c.value)!=null&&F.can_delete?(_(),g(h,{key:2},{default:l(()=>[o(pe,{placement:"rightBottom",title:`¿Quieres eliminar ${s.title} ?`,onConfirm:A=>W(s)},{icon:l(()=>[o(T(we),{style:{color:"red"}})]),default:l(()=>[t[4]||(t[4]=d("a",null,"Eliminar",-1))]),_:2},1032,["title","onConfirm"])]),_:2},1024)):f("",!0)]}),_:1},8,["new","rangeDate","downloadExcel","othersList","pageSize","dataSource","total","permisos"]),o(_e,{open:y.value,"onUpdate:open":t[1]||(t[1]=s=>y.value=s),title:w.value?"EDITAR EVENTO UGO":"NUEVA ACTIVIDAD",placement:"right",width:"550"},{default:l(()=>[o(Ie,{onCloseDraw:J,dataRow:w.value},null,8,["dataRow"])]),_:1},8,["open","title"])])}}};export{Ze as default};
