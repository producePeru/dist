import{_ as j}from"./TableComponent-2ad262e4.js";import{p as K,r as m,a as z,k as G,U as Z,X as D,b as T,o as n,y as k,i as M,L as J,d as c,c as I,w as S,e as w,F as X,v as Q,$ as W,z as r,s as Y,P as ee,m as B,h as H,t as _}from"./index-3d734e37.js";import{d as ae}from"./downloadExcel-2af544bd.js";import{_ as te}from"./FormComponent-23691bb6.js";import{u as ie}from"./selectes-d18063f4.js";import"./es-2f1b1998.js";import"./icoexcel-1b303edf.js";import"./SyncOutlined-8cbb0db5.js";import"./MoreOutlined-e2bc13b7.js";import"./quill.snow-56c31458.js";const le={key:1,class:"notary-grid"},ne={key:0},oe={__name:"DrawerNotaria.componente",props:["info"],emits:["closeDraw"],setup(U,{emit:V}){K.locale("es");const N=m({name:{type:"iText",label:"NOMBRE DE LA NOTARÍA",name:"name",required:!1,message:"Escribir el nombre de la notaría",disabled:!1,max:100},city_id:{type:"iSelect",label:"REGIÓN",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelect",label:"PROVINCIA",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!0},district_id:{type:"iSelect",label:"DISTRITO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!0},addressNotary:{type:"iText",label:"DIRECCIÓN",name:"addressNotary",required:!0,message:"Escribir la dirección de la notaría",disabled:!1,max:200},gastos:{type:"iSlot",name:"iSlotOptions"},testimonio:{type:"iMoney",label:"TESTIMONIO",name:"testimonio",required:!1,message:"Escribir testimonio",disabled:!1,max:20,minValue:0},legalization:{type:"iMoney",label:"LEGALIZACION DE BENEFICIARIO FINAL",name:"legalization",required:!1,message:"Escribir tarifa social",disabled:!1,max:20,minValue:0},biometric:{type:"iMoney",label:"BIOMÉTRICO / HUELLA DIGITAL",name:"biometric",required:!1,message:"Escribir biométrico o huella digital",disabled:!1,placeholder:"Ejemplo: Hasta 3 UIT",max:20,minValue:0},aclaratory:{type:"iMoney",label:"ACLARATORIA",name:"aclaratory",required:!1,message:"Escribir tarifa aclaratoria",disabled:!1,max:20,minValue:0},socio:{type:"iMoney",label:"SOCIO O INTERVINIENTE ADICIONAL",name:"socio",required:!1,message:"Escribir tarifa social",disabled:!1,placeholder:"Ejemplo: Hasta 3 UIT",max:20,minValue:0},conditions:{type:"iTextArea",label:"CONDICIONES",name:"conditions",required:!1,message:"Escribir monto de condiciones",disabled:!1,rows:3},etiqueta2:{type:"iLabel",label:"CONTÁCTO",name:"etiqueta2"},contactName:{type:"iText",label:"NOMBRE DE CONTACTO",name:"contactName",required:!1,message:"Escribir nombre de contacto",disabled:!1,max:100},contactEmail:{type:"iText",label:"CORREO ELECTRÓNICO",name:"contactEmail",required:!1,message:"Escribir correo electrónico",disabled:!1,max:100},contactPhone:{type:"iText",label:"TELEFONO",name:"contactPhone",required:!1,message:"Escribir teléfono de contacto",disabled:!1,max:50},etiqueta3:{type:"iLabel",label:"COSTO DE TARIFAS",name:"etiqueta3"},normalTarifa:{type:"iMoney",label:"TARIFA NORMAL",name:"normalTarifa",required:!1,message:"Escribir tarifa normal",disabled:!1,max:20,minValue:0}}),d=ie(),A=V,f=U,E=m(!1),x=m("GUARDAR"),e=z({}),b=m(!1),u=m(null),y=m({id_pnte:[],city_id:[],province_id:[],district_id:[]}),l=m([]),L=()=>{if(l.value.length>=6)return;const t={gasto:null,gastoDetalle:null};l.value.push(t)},P=t=>{l.value.splice(t,1);for(let a=1;a<=6;a++)delete e[`gasto${a}`],delete e[`gasto${a}Detail`];l.value.forEach((a,i)=>{const g=i+1;e[`gasto${g}`]=a.gasto??null,e[`gasto${g}Detail`]=a.gastoDetalle??null})},$=async t=>{t=="city_id"&&(console.log("city_id kakakaka"),await d.fetchProvinces(e.city_id),y.value.province_id=d.provinces,N.value.province_id.disabled=!1),t=="province_id"&&(await d.fetchDistricts(e.province_id),y.value.district_id=d.districts,N.value.district_id.disabled=!1)},q=async t=>{t=="city_id"&&(await d.fetchCities(),e.city_id=null,e.province_id=null,e.district_id=null,y.value.province_id=[],y.value.city_id=d.cities),t=="province_id"&&(e.province_id=null,e.district_id=null,y.value.district_id=[])},F=async()=>{b.value=!0;const t={name:e.name,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,addressNotary:e.addressNotary,gasto1:e.gasto1||null,gasto1Detail:e.gasto1Detail||null,gasto2:e.gasto2||null,gasto2Detail:e.gasto2Detail||null,gasto3:e.gasto3||null,gasto3Detail:e.gasto3Detail||null,gasto4:e.gasto4||null,gasto4Detail:e.gasto4Detail||null,gasto5:e.gasto5||null,gasto5Detail:e.gasto5Detail||null,gasto6:e.gasto6||null,gasto6Detail:e.gasto6Detail||null,testimonio:e.testimonio,legalization:e.legalization,biometric:e.biometric,aclaratory:e.aclaratory,socio:e.socio,conditions:e.conditions,contactName:e.contactName,contactEmail:e.contactEmail,contactPhone:e.contactPhone,normalTarifa:e.normalTarifa,status:1};try{const a=f.info?`notary/update/${f.info.id}`:"notary/create",i=f.info?"PATCH":"POST",g=await B({url:a,method:i,data:t});g.status===200&&(C(),H.success(g.message),A("closeDraw",!0))}catch(a){console.error("Error:",a);const i=document.getElementsByClassName("ant-drawer-body")[0];i&&(i.scrollTop=0)}finally{b.value=!1}},C=()=>{e.name=null,e.city_id=null,e.province_id=null,e.district_id=null,e.addressNotary=null,l.value=[],e.gasto1=null,e.gasto1Detail=null,e.gasto2=null,e.gasto2Detail=null,e.gasto3=null,e.gasto3Detail=null,e.gasto4=null,e.gasto4Detail=null,e.gasto5=null,e.gasto5Detail=null,e.gasto6=null,e.gasto6Detail=null,e.testimonio=null,e.legalization=null,e.biometric=null,e.aclaratory=null,e.socio=null,e.conditions=null,e.contactName=null,e.contactEmail=null,e.contactPhone=null,e.normalTarifa=null},R=async t=>{E.value=!0;try{if(t){e.name=t.name,e.addressNotary=t.addressNotary,e.testimonio=t.testimonio,e.legalization=t.legalization,e.biometric=t.biometric,e.aclaratory=t.aclaratory,e.socio=t.socio,e.conditions=t.conditions,e.contactName=t.contactName,e.contactEmail=t.contactEmail,e.contactPhone=t.contactPhone,e.normalTarifa=t.normalTarifa,l.value=[];for(let a=1;a<=6;a++){const i=`gasto${a}`,g=`gasto${a}Detail`,v=t[i],h=t[g];(v==null||v==="")&&(h==null||h==="")||(e[i]=v??null,e[g]=h??null,l.value.push({gasto:v??null,gastoDetalle:h??null}))}await d.fetchCities(),y.value.city_id=d.cities,e.city_id=t.city_id,await d.fetchProvinces(e.city_id),y.value.province_id=d.provinces,N.value.province_id.disabled=!1,e.province_id=t.province_id,await d.fetchDistricts(e.province_id),y.value.district_id=d.districts,N.value.district_id.disabled=!1,e.district_id=t.district_id}}finally{E.value=!1}};return G(()=>{f.info&&R(f.info)}),Z(()=>f.info,t=>{t?R(t):C()}),D("formState",e),D("loadingState",b),(t,a)=>{const i=T("a-input-number"),g=T("a-form-item"),v=T("a-input"),h=T("a-button");return E.value?(n(),k(M(J),{key:0,style:{color:"#00a6db"}})):(n(),c("div",le,[I(te,{fields:N.value,options:y.value,btnSaveName:x.value,mayus:!0,resetSelect:u.value,onHandleChangeSelect:$,onHandleFocusSelect:q,onOnSubmit:F},{default:S(({field:o})=>[a[0]||(a[0]=w("h4",{style:{margin:"0 0 0.5rem 0"}},"GASTOS NOTARIALES",-1)),o.name=="iSlotOptions"?(n(),c("div",ne,[(n(!0),c(X,null,Q(l.value,(s,p)=>(n(),c("div",{class:"slot-gastos",key:p},[w("div",null,[I(g,{label:`Opción ${p+1} Monto`},{default:S(()=>[I(i,{min:0,style:{width:"100%"},value:e[`gasto${p+1}`],"onUpdate:value":O=>e[`gasto${p+1}`]=O,formatter:O=>`S/ ${O}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:O=>O.replace(/S\/\s?|(,*)/g,"")},null,8,["value","onUpdate:value","formatter","parser"])]),_:2},1032,["label"])]),w("div",null,[I(g,{label:`Opción ${p+1} Detalle`},{default:S(()=>[I(v,{value:e[`gasto${p+1}Detail`],"onUpdate:value":O=>e[`gasto${p+1}Detail`]=O},null,8,["value","onUpdate:value"])]),_:2},1032,["label"])]),p!=0?(n(),k(h,{key:0,type:"text",danger:"",onClick:O=>P(p)},{default:S(()=>[I(M(W))]),_:2},1032,["onClick"])):r("",!0)]))),128))])):r("",!0),l.value.length<6?(n(),k(h,{key:1,type:"primary",shape:"circle",icon:Y(M(ee)),size:"small",onClick:L},null,8,["icon"])):r("",!0)]),_:1},8,["fields","options","btnSaveName","resetSelect"])]))}}};const se={class:"layout-content"},ce={class:"advisory-table"},re={key:0},de={key:1},ue={key:2},me={key:3},ge={key:4},pe={key:5},_e={key:6},ye={key:7},he={key:8},Ie={key:9},fe={key:10},ve={key:11},Ne=["onClick"],Re={__name:"NotariasLista",setup(U){const N=(JSON.parse(localStorage.getItem("role"))||[]).some(a=>a.id===10||a.id===5||a.id===1),d=m([]),A=m(0),f=m(150),E=m(!1),x=m(!1),e=m(!1),b=m(null),u=z({asesor:null,name:null,page:1}),y=[{title:"#",fixed:"left",dataIndex:"idx",align:"center",width:70},{title:"NOMBRE DE LA NOTARÍA",dataIndex:"name",width:240,fixed:"left"},{title:"REGIÓN",dataIndex:"city_name",width:120},{title:"PROVINCIA",dataIndex:"province_name",width:120},{title:"DISTRITO",dataIndex:"district_name",width:120},{title:"DIRECCIÓN",dataIndex:"addressNotary",width:180},{title:"GASTOS NOTARIALES",children:[{title:"TARIFA SOCIAL",children:[{title:"OPCION 1 (HASTA 1 UIT)",colSpan:2,children:[{dataIndex:"gasto1",width:100,colSpan:0,align:"center"},{dataIndex:"gasto1Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 2",colSpan:2,children:[{dataIndex:"gasto2",width:100,colSpan:0,align:"center"},{dataIndex:"gasto2Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 3",colSpan:2,children:[{dataIndex:"gasto3",width:100,colSpan:0,align:"center"},{dataIndex:"gasto3Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 4",colSpan:2,children:[{dataIndex:"gasto4",width:100,colSpan:0,align:"center"},{dataIndex:"gasto4Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 5",colSpan:2,children:[{dataIndex:"gasto5",width:100,colSpan:0,align:"center"},{dataIndex:"gasto5Detail",width:120,colSpan:0,align:"center"}]},{title:"OPCION 6",colSpan:2,children:[{dataIndex:"gasto6",width:100,colSpan:0,align:"center"},{dataIndex:"gasto6Detail",width:120,colSpan:0,align:"center"}]}]},{title:"TESTIMONIO",width:150,align:"center",dataIndex:"testimonio"},{title:"LEGALIZACION DE BENEFICIARIO FINAL",width:150,align:"center",dataIndex:"legalization"},{title:"BIOMÉTRICO / HUELLA DIGITAL",width:150,align:"center",dataIndex:"biometric"},{title:"ACLARATORIA",width:150,align:"center",dataIndex:"aclaratory"},{title:"SOCIO O INTERVINIENTE ADICIONAL",width:150,align:"center",dataIndex:"socio"}]},{title:"CONDICIONES",dataIndex:"conditions",width:280},{title:"NOMBRE DE CONTACTO",dataIndex:"contactName",width:200},{title:"CORREO",dataIndex:"contactEmail",width:180},{title:"TELEFONO",dataIndex:"contactPhone",width:100,align:"center"},{title:"TARIFA NORMAL",dataIndex:"normalTarifa",align:"center",width:100},...N?[{title:"DISPONIBLE",dataIndex:"status",width:100,align:"center"}]:[],...N?[{title:"",dataIndex:"actions",width:60,align:"center",fixed:"right"}]:[]],l=a=>{const i=parseFloat(a);return isNaN(i)?"":`S/ ${i.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})}`},L=()=>{e.value=!1,t()},P=()=>{b.value=null,e.value=!0},$=async()=>{x.value=!0;try{const a={};u.name&&(a.name=u.name),u.city_id&&(a.city_id=u.city_id),await ae("download/notaries","notarias-pnte",a)}catch(a){console.error("Error de red:",a)}finally{x.value=!1}},q=async a=>{u.page=a,await t()},F=async a=>{a&&(u.page=1,await t())},C=a=>{b.value=a,e.value=!0},R=async a=>{try{const i=await B({url:`notary/status/${a}`,method:"PUT"});i.status==200&&(t(),H.success(i.message))}catch(i){console.error("Error de red:",i)}},t=async()=>{E.value=!0;try{const a={page:u.page};u.name&&(a.name=u.name),u.city_id&&(a.city_id=u.city_id);const i=await B({url:"notary/list",method:"GET",params:a});d.value=i.data.data,A.value=i.data.total,f.value=i.data.per_page}catch(a){console.error("Error de red:",a)}finally{E.value=!1}};return G(async()=>{await t()}),D("search",u),D("loading",E),D("loadingFile",x),(a,i)=>{const g=T("a-switch"),v=T("a-menu-item"),h=T("a-drawer");return n(),c("div",se,[w("div",ce,[I(j,{title:"NOTARÍAS",new:!0,textNuevo:"NUEVO",placeholderSearch:"Buscar",columns:y,titleSearch:"NOMBRE DE NOTARÍA",pageSize:f.value,nameTotal:"Notarías",cityList:!0,dataSource:d.value,total:A.value,onHandleNew:P,heightTable:350,downloadExcel:!0,onHandleDownloadExcel:$,onHandleSearch:F,onHandlePaginator:q},{"data-cell":S(({column:o,record:s})=>[o.dataIndex=="gasto1"?(n(),c("span",re,_(l(s.gasto1)),1)):r("",!0),o.dataIndex=="gasto2"?(n(),c("span",de,_(l(s.gasto2)),1)):r("",!0),o.dataIndex=="gasto3"?(n(),c("span",ue,_(l(s.gasto3)),1)):r("",!0),o.dataIndex=="gasto4"?(n(),c("span",me,_(l(s.gasto4)),1)):r("",!0),o.dataIndex=="gasto5"?(n(),c("span",ge,_(l(s.gasto5)),1)):r("",!0),o.dataIndex=="gasto6"?(n(),c("span",pe,_(l(s.gasto6)),1)):r("",!0),o.dataIndex=="testimonio"?(n(),c("span",_e,_(l(s.testimonio)),1)):r("",!0),o.dataIndex=="legalization"?(n(),c("span",ye,_(l(s.legalization)),1)):r("",!0),o.dataIndex=="biometric"?(n(),c("span",he,_(l(s.biometric)),1)):r("",!0),o.dataIndex=="aclaratory"?(n(),c("span",Ie,_(l(s.aclaratory)),1)):r("",!0),o.dataIndex=="socio"?(n(),c("span",fe,_(l(s.socio)),1)):r("",!0),o.dataIndex=="normalTarifa"?(n(),c("span",ve,_(l(s.normalTarifa)),1)):r("",!0),o.dataIndex=="status"?(n(),k(g,{key:12,checked:s.status,"onUpdate:checked":p=>s.status=p,onChange:p=>R(s.id)},null,8,["checked","onUpdate:checked","onChange"])):r("",!0)]),"custom-options":S(({record:o})=>[I(v,null,{default:S(()=>[w("a",{onClick:s=>C(o)},"Editar",8,Ne)]),_:2},1024)]),_:1},8,["pageSize","dataSource","total"]),I(h,{width:"900",title:"EDITAR NOTARÍA",open:e.value,"onUpdate:open":i[0]||(i[0]=o=>e.value=o),placement:"right"},{default:S(()=>[I(oe,{onCloseDraw:L,info:b.value},null,8,["info"])]),_:1},8,["open"])])])}}};export{Re as default};
