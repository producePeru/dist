import{c,A as j,g as M,J as L,K as C,L as Y,m as y,M as $,u as H,r as k,a as G,b as m,o as i,d as S,e as u,w as s,F as U,h as J,v as W,z as p,i as g,s as f,N as Q,j as D,p as X,k as Z}from"./index-ed7fe153.js";import"./es-8684916a.js";import{c as K,a as ee}from"./selects-5c97b22d.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";var te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};const ne=te;function O(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(_){return Object.getOwnPropertyDescriptor(n,_).enumerable}))),a.forEach(function(_){oe(o,_,n[_])})}return o}function oe(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var q=function(t,n){var a=O({},t,n.attrs);return c(j,O({},a,{icon:ne}),null)};q.displayName="UploadOutlined";q.inheritAttrs=!1;const le=q,se={office:{type:"iSelect",label:"Oficina",name:"office",required:!0,message:"Seleccionar Oficina"},nameInstitution:{type:"iText",label:"Nombre Institución",name:"nameInstitution",required:!0,message:"Escribe cuenta de usuario"},component:{type:"iSelect",label:"Componente",name:"component",required:!0,message:"Seleccionar Componente"},responsible:{type:"iText",label:"Responsable del PNTE",name:"responsible",required:!0,message:"Escribe nombre del responsabable"},representative:{type:"iText",label:"Representante",name:"representative",required:!0,message:"Escribe nombre del representante"},representativeEmail:{type:"iText",label:"Correo Electrónico",name:"representativeEmail",required:!0,message:"Escribe el correo electrónico",email:"email"},addendum:{type:"iSwitch",label:"¿Es adenda?",name:"addendum",required:!0,message:"Adenda"},proponent:{type:"iText",label:"Proponente",name:"proponent",required:!0,message:"Nombre del proponente"},nameAgreement:{type:"iText",label:"Nombre del convenio",name:"nameAgreement",required:!0,message:"Nombre del convenio"},focalPoint:{type:"iText",label:"Punto Focal",name:"focalPoint",required:!0,message:"Nombre del punto focal"},phoneContact:{type:"iText",label:"Número Telefónico del contacto",name:"phoneContact",required:!0,message:"Número de contacto y 9 max",max:9},pdfDocument:{type:"iUpload",label:"Archivo de convenio / Adenda (PDF)",name:"pdfDocument",required:!0,message:"Archivo de convenio / Adenda (PDF)"},dateIssue:{type:"iDate",label:"Fecha de Emisión",name:"dateIssue",required:!0,message:"Seleccionar fecha"},effectiveDate:{type:"iDate",label:"Fecha de Inicio de Vigencia",name:"effectiveDate",required:!0,message:"Seleccionar fecha"},dueDate:{type:"iDate",label:"Fecha de vencimiento",name:"dueDate",required:!0,message:"Seleccionar fecha"}},re=M.get("token"),ie="https://apituempresa.soporte-pnte.com/api/v1",ce="http://127.0.0.1:8000/api/v1",ue=window.location.hostname=="127.0.0.1"?ce:ie,de=L("fileUpload",{state:()=>({}),actions:{async handleUpload(o){const t=new FormData;t.append("pdf",o),t.append("created",C);try{const{data:n}=await Y.post(`${ue}/agreements/upload-pdf`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${re}`}});y.success(n.message)}catch{y.error("Error al subir el archivo PDF, excede el tamaño del archivo permitido")}}}});const v=o=>(X("data-v-8b2eb48d"),o=o(),Z(),o),me=v(()=>u("h3",null,"NUEVO CONVENIO",-1)),pe=v(()=>u("br",null,null,-1)),fe={class:"agreement-wrapper"},ve={class:"grid-item"},be=v(()=>u("div",{class:"span1"},null,-1)),_e=v(()=>u("div",{class:"span2"},null,-1)),he=v(()=>u("div",{class:"span3"},null,-1)),ge=v(()=>u("div",{class:"span4"},null,-1)),ye=v(()=>u("div",{class:"span5"},null,-1)),De=v(()=>u("br",null,null,-1)),Se="YYYY-MM-DD",Ue={__name:"NuevoConvenio",setup(o){$.locale("es"),H();const t=k(!1),n=k(null),a=G({office:null,nameInstitution:null,component:null,responsible:null,representative:null,representativeEmail:null,addendum:0,proponent:null,nameAgreement:null,focalPoint:null,phoneContact:null,pdfDocument:null,dateIssue:null,effectiveDate:null,dueDate:null,created_by:C}),_=()=>{a.office=null,a.nameInstitution=null,a.component=null,a.responsible=null,a.representative=null,a.representativeEmail=null,a.addendum=0,a.proponent=null,a.nameAgreement=null,a.focalPoint=null,a.phoneContact=null,a.pdfDocument=null,a.dateIssue=null,a.effectiveDate=null,a.dueDate=null},N=()=>{let l=a.component;const d={1:"Responsable 1",2:"Responsable 2",3:"Responsable 3",4:"Responsable 4"};a.responsible=d[l]},w=l=>{a.pdfDocument=null;const d=n.value.indexOf(l),h=n.value.slice();h.splice(d,1),n.value=h},F=l=>l.size>10485760?y.error("El tamaño máximo del archivo PDF es 10MB"):(n.value=[l],a.pdfDocument=l.name,!1),E=async()=>{const l=de(),d=n.value[0];l.handleUpload(d)},P=async()=>{const l=a;t.value=!0;try{await J({url:"/agreements/new-agreement",method:"POST",data:l})&&(E(),_(),t.value=!1)}catch{y.error("Se presentó un error en el servidor"),t.value=!1}},I=()=>{y.error("Debes de completar todos los espacios requeridos")};return(l,d)=>{const h=m("a-select"),b=m("a-form-item"),A=m("a-input"),T=m("a-date-picker"),V=m("a-switch"),x=m("a-button"),R=m("a-upload"),z=m("a-form");return i(),S(U,null,[me,pe,u("div",fe,[c(z,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:P,onFinishFailed:I},{default:s(()=>[u("div",ve,[(i(!0),S(U,null,W(g(se),(e,B)=>(i(),S(U,{key:B},[e.type==="iSelect"?(i(),p(b,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[e.name=="office"?(i(),p(h,{key:0,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:g(K)},null,8,["value","onUpdate:value","options"])):f("",!0),e.name=="component"?(i(),p(h,{key:1,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:g(ee),onChange:N},null,8,["value","onUpdate:value","options"])):f("",!0)]),_:2},1032,["name","label","rules"])):f("",!0),e.type==="iText"?(i(),p(b,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email,max:e.max}]},{default:s(()=>[c(A,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):f("",!0),e.type==="iSelectWrite"?(i(),p(b,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[c(h,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,"show-search":"",options:l.countries,"filter-option":l.filterOption},null,8,["value","onUpdate:value","options","filter-option"])]),_:2},1032,["name","label","rules"])):f("",!0),e.type==="iDate"?(i(),p(b,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[c(T,{locale:g(Q),value:a[e.name],"onUpdate:value":r=>a[e.name]=r,style:{width:"100%"},format:Se},null,8,["locale","value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):f("",!0),e.type==="iSwitch"?(i(),p(b,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[c(V,{checked:a[e.name],"onUpdate:checked":r=>a[e.name]=r,checkedValue:1,unCheckedValue:0,class:"ml-1-3"},{checkedChildren:s(()=>[D("Si")]),unCheckedChildren:s(()=>[D("No")]),_:2},1032,["checked","onUpdate:checked"])]),_:2},1032,["name","label","rules"])):f("",!0),e.type==="iUpload"?(i(),p(b,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[c(R,{"file-list":n.value,"before-upload":F,onRemove:w,"max-count":1,accept:".pdf"},{default:s(()=>[c(x,null,{default:s(()=>[c(g(le)),D(" Subir archivo PDF ")]),_:1})]),_:1},8,["file-list"])]),_:2},1032,["name","label","rules"])):f("",!0)],64))),128)),be,_e,he,ge,ye]),De,c(b,null,{default:s(()=>[c(x,{type:"primary","html-type":"submit",loading:t.value},{default:s(()=>[D("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])],64)}}},Ce=ae(Ue,[["__scopeId","data-v-8b2eb48d"]]);export{Ce as default};
