import{c as oe,A as Ee,$ as Re,a0 as Ae,r as re,Z as Te,j as De,b as le,o as ae,d as ye,w as te,e as ie,i as se,F as ve,x as ge,y as he,R as Se,h as ze}from"./index-241df50d.js";import{_ as Oe}from"./icoexcel-1b303edf.js";import{_ as Me}from"./_plugin-vue_export-helper-c27b6911.js";var Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 248H728l-32.4-90.8a32.07 32.07 0 00-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 248H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V328c0-44.2-35.8-80-80-80zm8 536c0 4.4-3.6 8-8 8H160c-4.4 0-8-3.6-8-8V328c0-4.4 3.6-8 8-8h186.7l17.1-47.8 22.9-64.2h250.5l22.9 64.2 17.1 47.8H864c4.4 0 8 3.6 8 8v456zM512 384c-88.4 0-160 71.6-160 160s71.6 160 160 160 160-71.6 160-160-71.6-160-160-160zm0 256c-53 0-96-43-96-96s43-96 96-96 96 43 96 96-43 96-96 96z"}}]},name:"camera",theme:"outlined"};const Pe=Ie;function be(ee){for(var Q=1;Q<arguments.length;Q++){var q=arguments[Q]!=null?Object(arguments[Q]):{},J=Object.keys(q);typeof Object.getOwnPropertySymbols=="function"&&(J=J.concat(Object.getOwnPropertySymbols(q).filter(function(B){return Object.getOwnPropertyDescriptor(q,B).enumerable}))),J.forEach(function(B){ke(ee,B,q[B])})}return ee}function ke(ee,Q,q){return Q in ee?Object.defineProperty(ee,Q,{value:q,enumerable:!0,configurable:!0,writable:!0}):ee[Q]=q,ee}var _e=function(Q,q){var J=be({},Q,q.attrs);return oe(Ee,be({},J,{icon:Pe}),null)};_e.displayName="CameraOutlined";_e.inheritAttrs=!1;const Ne=_e;var Ce={exports:{}};(function(ee){(function(Q,q){var J=q.toString();ee.exports=q(J)})(Re,function(Q){/**
* @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
* Available via the MIT or new BSD license.
* see: http://github.com/jrburke/almond for details
*/var q,J,B;(function(e){var r,o,t,n,i={},a={},u={},l={},f=Object.prototype.hasOwnProperty,c=[].slice,h=/\.js$/;function d(v,E){return f.call(v,E)}function s(v,E){var w,T,z,M,R,S,k,j,O,W,$,D=E&&E.split("/"),P=u.map,N=P&&P["*"]||{};if(v&&v.charAt(0)===".")if(E){for(D=D.slice(0,D.length-1),v=v.split("/"),R=v.length-1,u.nodeIdCompat&&h.test(v[R])&&(v[R]=v[R].replace(h,"")),v=D.concat(v),O=0;O<v.length;O+=1)if($=v[O],$===".")v.splice(O,1),O-=1;else if($===".."){if(O===1&&(v[2]===".."||v[0]===".."))break;O>0&&(v.splice(O-1,2),O-=2)}v=v.join("/")}else v.indexOf("./")===0&&(v=v.substring(2));if((D||N)&&P){for(w=v.split("/"),O=w.length;O>0;O-=1){if(T=w.slice(0,O).join("/"),D){for(W=D.length;W>0;W-=1)if(z=P[D.slice(0,W).join("/")],z&&(z=z[T],z)){M=z,S=O;break}}if(M)break;!k&&N&&N[T]&&(k=N[T],j=O)}!M&&k&&(M=k,S=j),M&&(w.splice(0,S,M),v=w.join("/"))}return v}function p(v,E){return function(){return o.apply(e,c.call(arguments,0).concat([v,E]))}}function g(v){return function(E){return s(E,v)}}function y(v){return function(E){i[v]=E}}function _(v){if(d(a,v)){var E=a[v];delete a[v],l[v]=!0,r.apply(e,E)}if(!d(i,v)&&!d(l,v))throw new Error("No "+v);return i[v]}function x(v){var E,w=v?v.indexOf("!"):-1;return w>-1&&(E=v.substring(0,w),v=v.substring(w+1,v.length)),[E,v]}t=function(v,E){var w,T=x(v),z=T[0];return v=T[1],z&&(z=s(z,E),w=_(z)),z?w&&w.normalize?v=w.normalize(v,g(E)):v=s(v,E):(v=s(v,E),T=x(v),z=T[0],v=T[1],z&&(w=_(z))),{f:z?z+"!"+v:v,n:v,pr:z,p:w}};function b(v){return function(){return u&&u.config&&u.config[v]||{}}}n={require:function(v){return p(v)},exports:function(v){var E=i[v];return typeof E<"u"?E:i[v]={}},module:function(v){return{id:v,uri:"",exports:i[v],config:b(v)}}},r=function(v,E,w,T){var z,M,R,S,k,j=[],O=typeof w,W;if(T=T||v,O==="undefined"||O==="function"){for(E=!E.length&&w.length?["require","exports","module"]:E,k=0;k<E.length;k+=1)if(S=t(E[k],T),M=S.f,M==="require")j[k]=n.require(v);else if(M==="exports")j[k]=n.exports(v),W=!0;else if(M==="module")z=j[k]=n.module(v);else if(d(i,M)||d(a,M)||d(l,M))j[k]=_(M);else if(S.p)S.p.load(S.n,p(T,!0),y(M),{}),j[k]=i[M];else throw new Error(v+" missing "+M);R=w?w.apply(i[v],j):void 0,v&&(z&&z.exports!==e&&z.exports!==i[v]?i[v]=z.exports:(R!==e||!W)&&(i[v]=R))}else v&&(i[v]=w)},q=J=o=function(v,E,w,T,z){if(typeof v=="string")return n[v]?n[v](E):_(t(v,E).f);if(!v.splice){if(u=v,u.deps&&o(u.deps,u.callback),!E)return;E.splice?(v=E,E=w,w=null):v=e}return E=E||function(){},typeof w=="function"&&(w=T,T=z),T?r(e,v,E,w):setTimeout(function(){r(e,v,E,w)},4),o},o.config=function(v){return o(v)},q._defined=i,B=function(v,E,w){E.splice||(w=E,E=[]),!d(i,v)&&!d(a,v)&&(a[v]=[v,E,w])},B.amd={jQuery:!0}})(),B("almond",function(){}),B("image_loader",[],function(){var e={};e.load=function(o,t,n,i,a){var u=new Array(i),l=new Array(u.length),f,c,h;if(a===!1)u[0]=o;else for(f=0;f<u.length;f++)h=n+f,u[f]=o+"image-"+("00"+h).slice(-3)+".jpg";for(l.notLoaded=[],l.addImage=function(d){l.notLoaded.push(d)},l.loaded=function(d){for(var s=l.notLoaded,p=0;p<s.length;p++)if(s[p]==d){s.splice(p,1);for(var g=0;g<u.length;g++){var y=u[g].substr(u[g].lastIndexOf("/"));if(d.src.lastIndexOf(y)!=-1){l[g]=d;break}}break}s.length===0&&(console.log("Images loaded"),t.apply(null,[l]))},f=0;f<u.length;f++)c=new Image,l.addImage(c),r(c,l),c.src=u[f]};function r(o,t){o.onload=function(){t.loaded(this)}}return e}),B("input_stream",["image_loader"],function(e){var r={};return r.createVideoStream=function(o){var t={},n=null,i=["canrecord","ended"],a={},u,l,f={x:0,y:0},c={x:0,y:0};function h(){var d=o.videoWidth,s=o.videoHeight;u=n.size?d/s>1?n.size:Math.floor(d/s*n.size):d,l=n.size?d/s>1?Math.floor(s/d*n.size):n.size:s,c.x=u,c.y=l}return t.getRealWidth=function(){return o.videoWidth},t.getRealHeight=function(){return o.videoHeight},t.getWidth=function(){return u},t.getHeight=function(){return l},t.setWidth=function(d){u=d},t.setHeight=function(d){l=d},t.setInputStream=function(d){n=d,o.src=typeof d.src<"u"?d.src:""},t.ended=function(){return o.ended},t.getConfig=function(){return n},t.setAttribute=function(d,s){o.setAttribute(d,s)},t.pause=function(){o.pause()},t.play=function(){o.play()},t.setCurrentTime=function(d){n.type!=="LiveStream"&&(o.currentTime=d)},t.addEventListener=function(d,s,p){i.indexOf(d)!==-1?(a[d]||(a[d]=[]),a[d].push(s)):o.addEventListener(d,s,p)},t.clearEventHandlers=function(){i.forEach(function(d){var s=a[d];s&&s.length>0&&s.forEach(function(p){o.removeEventListener(d,p)})})},t.trigger=function(d,s){var p,g=a[d];if(d==="canrecord"&&h(),g&&g.length>0)for(p=0;p<g.length;p++)g[p].apply(t,s)},t.setTopRight=function(d){f.x=d.x,f.y=d.y},t.getTopRight=function(){return f},t.setCanvasSize=function(d){c.x=d.x,c.y=d.y},t.getCanvasSize=function(){return c},t.getFrame=function(){return o},t},r.createLiveStream=function(o){o.setAttribute("autoplay",!0);var t=r.createVideoStream(o);return t.ended=function(){return!1},t},r.createImageStream=function(){var o={},t=null,n=0,i=0,a=0,u=!0,l=!1,f=null,c=0,h=1,d=null,s=!1,p,g,y=["canrecord","ended"],_={},x={x:0,y:0},b={x:0,y:0};function v(){l=!1,e.load(d,function(w){f=w,n=w[0].width,i=w[0].height,p=t.size?n/i>1?t.size:Math.floor(n/i*t.size):n,g=t.size?n/i>1?Math.floor(i/n*t.size):t.size:i,b.x=p,b.y=g,l=!0,a=0,setTimeout(function(){E("canrecord",[])},0)},h,c,t.sequence)}function E(w,T){var z,M=_[w];if(M&&M.length>0)for(z=0;z<M.length;z++)M[z].apply(o,T)}return o.trigger=E,o.getWidth=function(){return p},o.getHeight=function(){return g},o.setWidth=function(w){p=w},o.setHeight=function(w){g=w},o.getRealWidth=function(){return n},o.getRealHeight=function(){return i},o.setInputStream=function(w){t=w,w.sequence===!1?(d=w.src,c=1):(d=w.src,c=w.length),v()},o.ended=function(){return s},o.setAttribute=function(){},o.getConfig=function(){return t},o.pause=function(){u=!0},o.play=function(){u=!1},o.setCurrentTime=function(w){a=w},o.addEventListener=function(w,T){y.indexOf(w)!==-1&&(_[w]||(_[w]=[]),_[w].push(T))},o.setTopRight=function(w){x.x=w.x,x.y=w.y},o.getTopRight=function(){return x},o.setCanvasSize=function(w){b.x=w.x,b.y=w.y},o.getCanvasSize=function(){return b},o.getFrame=function(){var w;return l?(u||(w=f[a],a<c-1?a++:setTimeout(function(){s=!0,E("ended",[])},0)),w):null},o},r}),glMatrixArrayType=Float32Array,typeof window<"u"&&(window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,r){window.setTimeout(e,1e3/60)}}(),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL),Math.imul=Math.imul||function(e,r){var o=e>>>16&65535,t=e&65535,n=r>>>16&65535,i=r&65535;return t*i+(o*i+t*n<<16>>>0)|0},B("typedefs",function(e){return function(){var r;return r||e.typedefs}}(this)),B("subImage",["typedefs"],function(){function e(r,o,t){t||(t={data:null,size:o}),this.data=t.data,this.originalSize=t.size,this.I=t,this.from=r,this.size=o}return e.prototype.show=function(r,o){var t,n,i,a,u,l,f;for(o||(o=1),t=r.getContext("2d"),r.width=this.size.x,r.height=this.size.y,n=t.getImageData(0,0,r.width,r.height),i=n.data,a=0,u=0;u<this.size.y;u++)for(l=0;l<this.size.x;l++)f=u*this.size.x+l,a=this.get(l,u)*o,i[f*4+0]=a,i[f*4+1]=a,i[f*4+2]=a,i[f*4+3]=255;n.data=i,t.putImageData(n,0,0)},e.prototype.get=function(r,o){return this.data[(this.from.y+o)*this.originalSize.x+this.from.x+r]},e.prototype.updateData=function(r){this.originalSize=r.size,this.data=r.data},e.prototype.updateFrom=function(r){return this.from=r,this},e}),B("cluster",[],function(){var e={create:function(r,o){var t=[],n={rad:0,vec:m.create([0,0])},i={};function a(){u(r),l()}function u(f){i[f.id]=f,t.push(f)}function l(){var f,c=0;for(f=0;f<t.length;f++)c+=t[f].rad;n.rad=c/t.length,n.vec=m.create([Math.cos(n.rad),Math.sin(n.rad)])}return a(),{add:function(f){i[f.id]||(u(f),l())},fits:function(f){var c=Math.abs(m.dot(f.point.vec,n.vec));return c>o},getPoints:function(){return t},getCenter:function(){return n}}},createPoint:function(r,o,t){return{rad:r[t],point:r,id:o}}};return e});var X={};X.create=function(e){var r;return e?(r=new glMatrixArrayType(3),r[0]=e[0],r[1]=e[1],r[2]=e[2]):glMatrixArrayType===Array?r=new glMatrixArrayType([0,0,0]):r=new glMatrixArrayType(3),r},X.set=function(e,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r},X.add=function(e,r,o){return!o||e==o?(e[0]+=r[0],e[1]+=r[1],e[2]+=r[2],e):(o[0]=e[0]+r[0],o[1]=e[1]+r[1],o[2]=e[2]+r[2],o)},X.subtract=function(e,r,o){return!o||e==o?(e[0]-=r[0],e[1]-=r[1],e[2]-=r[2],e):(o[0]=e[0]-r[0],o[1]=e[1]-r[1],o[2]=e[2]-r[2],o)},X.negate=function(e,r){return r||(r=e),r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r},X.scale=function(e,r,o){return!o||e==o?(e[0]*=r,e[1]*=r,e[2]*=r,e):(o[0]=e[0]*r,o[1]=e[1]*r,o[2]=e[2]*r,o)},X.normalize=function(e,r){r||(r=e);var o=e[0],t=e[1],n=e[2],i=Math.sqrt(o*o+t*t+n*n);if(i){if(i==1)return r[0]=o,r[1]=t,r[2]=n,r}else return r[0]=0,r[1]=0,r[2]=0,r;return i=1/i,r[0]=o*i,r[1]=t*i,r[2]=n*i,r},X.cross=function(e,r,o){o||(o=e);var t=e[0],n=e[1],i=e[2],a=r[0],u=r[1],l=r[2];return o[0]=n*l-i*u,o[1]=i*a-t*l,o[2]=t*u-n*a,o},X.length=function(e){var r=e[0],o=e[1],t=e[2];return Math.sqrt(r*r+o*o+t*t)},X.dot=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]},X.direction=function(e,r,o){o||(o=e);var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2],a=Math.sqrt(t*t+n*n+i*i);return a?(a=1/a,o[0]=t*a,o[1]=n*a,o[2]=i*a,o):(o[0]=0,o[1]=0,o[2]=0,o)},X.lerp=function(e,r,o,t){return t||(t=e),t[0]=e[0]+o*(r[0]-e[0]),t[1]=e[1]+o*(r[1]-e[1]),t[2]=e[2]+o*(r[2]-e[2]),t},X.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var Y={};Y.create=function(e){var r;return e?(r=new glMatrixArrayType(9),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8]):glMatrixArrayType===Array?r=new glMatrixArrayType([0,0,0,0,0,0,0,0,0]):r=new glMatrixArrayType(9),r},Y.set=function(e,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r},Y.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},Y.transpose=function(e,r){if(!r||e==r){var o=e[1],t=e[2],n=e[5];return e[1]=e[3],e[2]=e[6],e[3]=o,e[5]=e[7],e[6]=t,e[7]=n,e}return r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8],r},Y.toMat4=function(e,r){return r||(r=G.create()),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=0,r[4]=e[3],r[5]=e[4],r[6]=e[5],r[7]=0,r[8]=e[6],r[9]=e[7],r[10]=e[8],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Y.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"};var G={};G.create=function(e){var r;return e?(r=new glMatrixArrayType(16),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):glMatrixArrayType===Array?r=new glMatrixArrayType([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]):r=new glMatrixArrayType(16),r},G.set=function(e,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},G.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},G.transpose=function(e,r){if(!r||e==r){var o=e[1],t=e[2],n=e[3],i=e[6],a=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=o,e[6]=e[9],e[7]=e[13],e[8]=t,e[9]=i,e[11]=e[14],e[12]=n,e[13]=a,e[14]=u,e}return r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15],r},G.determinant=function(e){var r=e[0],o=e[1],t=e[2],n=e[3],i=e[4],a=e[5],u=e[6],l=e[7],f=e[8],c=e[9],h=e[10],d=e[11],s=e[12],p=e[13],g=e[14],y=e[15];return s*c*u*n-f*p*u*n-s*a*h*n+i*p*h*n+f*a*g*n-i*c*g*n-s*c*t*l+f*p*t*l+s*o*h*l-r*p*h*l-f*o*g*l+r*c*g*l+s*a*t*d-i*p*t*d-s*o*u*d+r*p*u*d+i*o*g*d-r*a*g*d-f*a*t*y+i*c*t*y+f*o*u*y-r*c*u*y-i*o*h*y+r*a*h*y},G.inverse=function(e,r){r||(r=e);var o=e[0],t=e[1],n=e[2],i=e[3],a=e[4],u=e[5],l=e[6],f=e[7],c=e[8],h=e[9],d=e[10],s=e[11],p=e[12],g=e[13],y=e[14],_=e[15],x=o*u-t*a,b=o*l-n*a,v=o*f-i*a,E=t*l-n*u,w=t*f-i*u,T=n*f-i*l,z=c*g-h*p,M=c*y-d*p,R=c*_-s*p,S=h*y-d*g,k=h*_-s*g,j=d*_-s*y,O=1/(x*j-b*k+v*S+E*R-w*M+T*z);return r[0]=(u*j-l*k+f*S)*O,r[1]=(-t*j+n*k-i*S)*O,r[2]=(g*T-y*w+_*E)*O,r[3]=(-h*T+d*w-s*E)*O,r[4]=(-a*j+l*R-f*M)*O,r[5]=(o*j-n*R+i*M)*O,r[6]=(-p*T+y*v-_*b)*O,r[7]=(c*T-d*v+s*b)*O,r[8]=(a*k-u*R+f*z)*O,r[9]=(-o*k+t*R-i*z)*O,r[10]=(p*w-g*v+_*x)*O,r[11]=(-c*w+h*v-s*x)*O,r[12]=(-a*S+u*M-l*z)*O,r[13]=(o*S-t*M+n*z)*O,r[14]=(-p*E+g*b-y*x)*O,r[15]=(c*E-h*b+d*x)*O,r},G.toRotationMat=function(e,r){return r||(r=G.create()),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},G.toMat3=function(e,r){return r||(r=Y.create()),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},G.toInverseMat3=function(e,r){var o=e[0],t=e[1],n=e[2],i=e[4],a=e[5],u=e[6],l=e[8],f=e[9],c=e[10],h=c*a-u*f,d=-c*i+u*l,s=f*i-a*l,p=o*h+t*d+n*s;if(!p)return null;var g=1/p;return r||(r=Y.create()),r[0]=h*g,r[1]=(-c*t+n*f)*g,r[2]=(u*t-n*a)*g,r[3]=d*g,r[4]=(c*o-n*l)*g,r[5]=(-u*o+n*i)*g,r[6]=s*g,r[7]=(-f*o+t*l)*g,r[8]=(a*o-t*i)*g,r},G.multiply=function(e,r,o){o||(o=e);var t=e[0],n=e[1],i=e[2],a=e[3],u=e[4],l=e[5],f=e[6],c=e[7],h=e[8],d=e[9],s=e[10],p=e[11],g=e[12],y=e[13],_=e[14],x=e[15],b=r[0],v=r[1],E=r[2],w=r[3],T=r[4],z=r[5],M=r[6],R=r[7],S=r[8],k=r[9],j=r[10],O=r[11],W=r[12],$=r[13],D=r[14],P=r[15];return o[0]=b*t+v*u+E*h+w*g,o[1]=b*n+v*l+E*d+w*y,o[2]=b*i+v*f+E*s+w*_,o[3]=b*a+v*c+E*p+w*x,o[4]=T*t+z*u+M*h+R*g,o[5]=T*n+z*l+M*d+R*y,o[6]=T*i+z*f+M*s+R*_,o[7]=T*a+z*c+M*p+R*x,o[8]=S*t+k*u+j*h+O*g,o[9]=S*n+k*l+j*d+O*y,o[10]=S*i+k*f+j*s+O*_,o[11]=S*a+k*c+j*p+O*x,o[12]=W*t+$*u+D*h+P*g,o[13]=W*n+$*l+D*d+P*y,o[14]=W*i+$*f+D*s+P*_,o[15]=W*a+$*c+D*p+P*x,o},G.multiplyVec3=function(e,r,o){o||(o=r);var t=r[0],n=r[1],i=r[2];return o[0]=e[0]*t+e[4]*n+e[8]*i+e[12],o[1]=e[1]*t+e[5]*n+e[9]*i+e[13],o[2]=e[2]*t+e[6]*n+e[10]*i+e[14],o},G.multiplyVec4=function(e,r,o){o||(o=r);var t=r[0],n=r[1],i=r[2],a=r[3];return o[0]=e[0]*t+e[4]*n+e[8]*i+e[12]*a,o[1]=e[1]*t+e[5]*n+e[9]*i+e[13]*a,o[2]=e[2]*t+e[6]*n+e[10]*i+e[14]*a,o[3]=e[3]*t+e[7]*n+e[11]*i+e[15]*a,o},G.translate=function(e,r,o){var t=r[0],n=r[1],i=r[2];if(!o||e==o)return e[12]=e[0]*t+e[4]*n+e[8]*i+e[12],e[13]=e[1]*t+e[5]*n+e[9]*i+e[13],e[14]=e[2]*t+e[6]*n+e[10]*i+e[14],e[15]=e[3]*t+e[7]*n+e[11]*i+e[15],e;var a=e[0],u=e[1],l=e[2],f=e[3],c=e[4],h=e[5],d=e[6],s=e[7],p=e[8],g=e[9],y=e[10],_=e[11];return o[0]=a,o[1]=u,o[2]=l,o[3]=f,o[4]=c,o[5]=h,o[6]=d,o[7]=s,o[8]=p,o[9]=g,o[10]=y,o[11]=_,o[12]=a*t+c*n+p*i+e[12],o[13]=u*t+h*n+g*i+e[13],o[14]=l*t+d*n+y*i+e[14],o[15]=f*t+s*n+_*i+e[15],o},G.scale=function(e,r,o){var t=r[0],n=r[1],i=r[2];return!o||e==o?(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=n,e[5]*=n,e[6]*=n,e[7]*=n,e[8]*=i,e[9]*=i,e[10]*=i,e[11]*=i,e):(o[0]=e[0]*t,o[1]=e[1]*t,o[2]=e[2]*t,o[3]=e[3]*t,o[4]=e[4]*n,o[5]=e[5]*n,o[6]=e[6]*n,o[7]=e[7]*n,o[8]=e[8]*i,o[9]=e[9]*i,o[10]=e[10]*i,o[11]=e[11]*i,o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15],o)},G.rotate=function(e,r,o,t){var n=o[0],i=o[1],a=o[2],u=Math.sqrt(n*n+i*i+a*a);if(!u)return null;u!=1&&(u=1/u,n*=u,i*=u,a*=u);var l=Math.sin(r),f=Math.cos(r),c=1-f,h=e[0],d=e[1],s=e[2],p=e[3],g=e[4],y=e[5],_=e[6],x=e[7],b=e[8],v=e[9],E=e[10],w=e[11],T=n*n*c+f,z=i*n*c+a*l,M=a*n*c-i*l,R=n*i*c-a*l,S=i*i*c+f,k=a*i*c+n*l,j=n*a*c+i*l,O=i*a*c-n*l,W=a*a*c+f;return t?e!=t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]):t=e,t[0]=h*T+g*z+b*M,t[1]=d*T+y*z+v*M,t[2]=s*T+_*z+E*M,t[3]=p*T+x*z+w*M,t[4]=h*R+g*S+b*k,t[5]=d*R+y*S+v*k,t[6]=s*R+_*S+E*k,t[7]=p*R+x*S+w*k,t[8]=h*j+g*O+b*W,t[9]=d*j+y*O+v*W,t[10]=s*j+_*O+E*W,t[11]=p*j+x*O+w*W,t},G.rotateX=function(e,r,o){var t=Math.sin(r),n=Math.cos(r),i=e[4],a=e[5],u=e[6],l=e[7],f=e[8],c=e[9],h=e[10],d=e[11];return o?e!=o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]):o=e,o[4]=i*n+f*t,o[5]=a*n+c*t,o[6]=u*n+h*t,o[7]=l*n+d*t,o[8]=i*-t+f*n,o[9]=a*-t+c*n,o[10]=u*-t+h*n,o[11]=l*-t+d*n,o},G.rotateY=function(e,r,o){var t=Math.sin(r),n=Math.cos(r),i=e[0],a=e[1],u=e[2],l=e[3],f=e[8],c=e[9],h=e[10],d=e[11];return o?e!=o&&(o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]):o=e,o[0]=i*n+f*-t,o[1]=a*n+c*-t,o[2]=u*n+h*-t,o[3]=l*n+d*-t,o[8]=i*t+f*n,o[9]=a*t+c*n,o[10]=u*t+h*n,o[11]=l*t+d*n,o},G.rotateZ=function(e,r,o){var t=Math.sin(r),n=Math.cos(r),i=e[0],a=e[1],u=e[2],l=e[3],f=e[4],c=e[5],h=e[6],d=e[7];return o?e!=o&&(o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]):o=e,o[0]=i*n+f*t,o[1]=a*n+c*t,o[2]=u*n+h*t,o[3]=l*n+d*t,o[4]=i*-t+f*n,o[5]=a*-t+c*n,o[6]=u*-t+h*n,o[7]=l*-t+d*n,o},G.frustum=function(e,r,o,t,n,i,a){a||(a=G.create());var u=r-e,l=t-o,f=i-n;return a[0]=n*2/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n*2/l,a[6]=0,a[7]=0,a[8]=(r+e)/u,a[9]=(t+o)/l,a[10]=-(i+n)/f,a[11]=-1,a[12]=0,a[13]=0,a[14]=-(i*n*2)/f,a[15]=0,a},G.perspective=function(e,r,o,t,n){var i=o*Math.tan(e*Math.PI/360),a=i*r;return G.frustum(-a,a,-i,i,o,t,n)},G.ortho=function(e,r,o,t,n,i,a){a||(a=G.create());var u=r-e,l=t-o,f=i-n;return a[0]=2/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-2/f,a[11]=0,a[12]=-(e+r)/u,a[13]=-(t+o)/l,a[14]=-(i+n)/f,a[15]=1,a},G.lookAt=function(e,r,o,t){t||(t=G.create());var n=e[0],i=e[1],a=e[2],u=o[0],l=o[1],f=o[2],c=r[0],h=r[1],d=r[2];if(n==c&&i==h&&a==d)return G.identity(t);var s,p,g,y,_,x,b,v,E,w;return s=n-r[0],p=i-r[1],g=a-r[2],w=1/Math.sqrt(s*s+p*p+g*g),s*=w,p*=w,g*=w,y=l*g-f*p,_=f*s-u*g,x=u*p-l*s,w=Math.sqrt(y*y+_*_+x*x),w?(w=1/w,y*=w,_*=w,x*=w):(y=0,_=0,x=0),b=p*x-g*_,v=g*y-s*x,E=s*_-p*y,w=Math.sqrt(b*b+v*v+E*E),w?(w=1/w,b*=w,v*=w,E*=w):(b=0,v=0,E=0),t[0]=y,t[1]=b,t[2]=s,t[3]=0,t[4]=_,t[5]=v,t[6]=p,t[7]=0,t[8]=x,t[9]=E,t[10]=g,t[11]=0,t[12]=-(y*n+_*i+x*a),t[13]=-(b*n+v*i+E*a),t[14]=-(s*n+p*i+g*a),t[15]=1,t},G.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+`,
 `+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+`,
 `+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+`,
 `+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"},quat4={},quat4.create=function(e){var r;return e?(r=new glMatrixArrayType(4),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]):glMatrixArrayType===Array?r=new glMatrixArrayType([0,0,0,0]):r=new glMatrixArrayType(4),r},quat4.set=function(e,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r},quat4.calculateW=function(e,r){var o=e[0],t=e[1],n=e[2];return!r||e==r?(e[3]=-Math.sqrt(Math.abs(1-o*o-t*t-n*n)),e):(r[0]=o,r[1]=t,r[2]=n,r[3]=-Math.sqrt(Math.abs(1-o*o-t*t-n*n)),r)},quat4.inverse=function(e,r){return!r||e==r?(e[0]*=-1,e[1]*=-1,e[2]*=-1,e):(r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r)},quat4.length=function(e){var r=e[0],o=e[1],t=e[2],n=e[3];return Math.sqrt(r*r+o*o+t*t+n*n)},quat4.normalize=function(e,r){r||(r=e);var o=e[0],t=e[1],n=e[2],i=e[3],a=Math.sqrt(o*o+t*t+n*n+i*i);return a==0?(r[0]=0,r[1]=0,r[2]=0,r[3]=0,r):(a=1/a,r[0]=o*a,r[1]=t*a,r[2]=n*a,r[3]=i*a,r)},quat4.multiply=function(e,r,o){o||(o=e);var t=e[0],n=e[1],i=e[2],a=e[3],u=r[0],l=r[1],f=r[2],c=r[3];return o[0]=t*c+a*u+n*f-i*l,o[1]=n*c+a*l+i*u-t*f,o[2]=i*c+a*f+t*l-n*u,o[3]=a*c-t*u-n*l-i*f,o},quat4.multiplyVec3=function(e,r,o){o||(o=r);var t=r[0],n=r[1],i=r[2],a=e[0],u=e[1],l=e[2],f=e[3],c=f*t+u*i-l*n,h=f*n+l*t-a*i,d=f*i+a*n-u*t,s=-a*t-u*n-l*i;return o[0]=c*f+s*-a+h*-l-d*-u,o[1]=h*f+s*-u+d*-a-c*-l,o[2]=d*f+s*-l+c*-u-h*-a,o},quat4.toMat3=function(e,r){r||(r=Y.create());var o=e[0],t=e[1],n=e[2],i=e[3],a=o+o,u=t+t,l=n+n,f=o*a,c=o*u,h=o*l,d=t*u,s=t*l,p=n*l,g=i*a,y=i*u,_=i*l;return r[0]=1-(d+p),r[1]=c-_,r[2]=h+y,r[3]=c+_,r[4]=1-(f+p),r[5]=s-g,r[6]=h-y,r[7]=s+g,r[8]=1-(f+d),r},quat4.toMat4=function(e,r){r||(r=G.create());var o=e[0],t=e[1],n=e[2],i=e[3],a=o+o,u=t+t,l=n+n,f=o*a,c=o*u,h=o*l,d=t*u,s=t*l,p=n*l,g=i*a,y=i*u,_=i*l;return r[0]=1-(d+p),r[1]=c-_,r[2]=h+y,r[3]=0,r[4]=c+_,r[5]=1-(f+p),r[6]=s-g,r[7]=0,r[8]=h-y,r[9]=s+g,r[10]=1-(f+d),r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},quat4.slerp=function(e,r,o,t){t||(t=e);var n=e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3];if(Math.abs(n)>=1)return t!=e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t;var i=Math.acos(n),a=Math.sqrt(1-n*n);if(Math.abs(a)<.001)return t[0]=e[0]*.5+r[0]*.5,t[1]=e[1]*.5+r[1]*.5,t[2]=e[2]*.5+r[2]*.5,t[3]=e[3]*.5+r[3]*.5,t;var u=Math.sin((1-o)*i)/a,l=Math.sin(o*i)/a;return t[0]=e[0]*u+r[0]*l,t[1]=e[1]*u+r[1]*l,t[2]=e[2]*u+r[2]*l,t[3]=e[3]*u+r[3]*l,t},quat4.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},B("glMatrix",["typedefs"],function(e){return function(){var r;return r||e.glMatrix}}(this)),G.xVec4=function(e,r,o){o||(o=r);var t=r[0],n=r[1],i=r[2],a=r[3];return o[0]=e[0]*t+e[1]*n+e[2]*i+e[3]*a,o[1]=e[4]*t+e[5]*n+e[6]*i+e[7]*a,o[2]=e[8]*t+e[9]*n+e[10]*i+e[11]*a,o[3]=e[12]*t+e[13]*n+e[14]*i+e[15]*a,o},Y.scale=function(e,r,o){return!o||e==o?(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e[4]*=r,e[5]*=r,e[6]*=r,e[7]*=r,e[8]*=r,e):(o=Y.create(),o[0]=e[0]*r,o[1]=e[1]*r,o[2]=e[2]*r,o[3]=e[3]*r,o[4]=e[4]*r,o[5]=e[5]*r,o[6]=e[6]*r,o[7]=e[7]*r,o[8]=e[8]*r,o)},Y.inverse=function(e,r){r||(r=e);var o=e[0],t=e[1],n=e[2],i=e[3],a=e[4],u=e[5],l=e[6],f=e[7],c=e[8],h=1/(o*a*c+t*u*l+n*i*f-n*a*l-t*i*c-o*u*f);return r[0]=(a*c-u*f)*h,r[1]=(n*f-t*c)*h,r[2]=(t*u-n*a)*h,r[3]=(u*l-i*c)*h,r[4]=(o*c-n*l)*h,r[5]=(n*i-o*u)*h,r[6]=(i*f-a*l)*h,r[7]=(t*l-o*f)*h,r[8]=(o*a-t*i)*h,r},Y.multiply=function(e,r,o){o||(o=e);var t=e[0],n=e[1],i=e[2],a=e[3],u=e[4],l=e[5],f=e[6],c=e[7],h=e[8],d=r[0],s=r[1],p=r[2],g=r[3],y=r[4],_=r[5],x=r[6],b=r[7],v=r[8];return o[0]=t*d+n*g+i*x,o[1]=t*s+n*y+i*b,o[2]=t*p+n*_+i*v,o[3]=a*d+u*g+l*x,o[4]=a*s+u*y+l*b,o[5]=a*p+u*_+l*v,o[6]=f*d+c*g+h*x,o[7]=f*s+c*y+h*b,o[8]=f*p+c*_+h*v,o},Y.xVec3=function(e,r,o){o||(o=r);var t=r[0],n=r[1],i=r[2];return o[0]=e[0]*t+e[1]*n+e[2]*i,o[1]=e[3]*t+e[4]*n+e[5]*i,o[2]=e[6]*t+e[7]*n+e[8]*i,o};var K={};K.create=function(e){var r;return e?(r=new glMatrixArrayType(4),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]):glMatrixArrayType===Array?r=new glMatrixArrayType([0,0,0,0]):r=new glMatrixArrayType(4),r},K.xVec2=function(e,r,o){o||(o=r);var t=r[0],n=r[1];return o[0]=e[0]*t+e[1]*n,o[1]=e[2]*t+e[3]*n,o},K.scale=function(e,r,o){return!o||e==o?(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e):(o[0]=e[0]*r,o[1]=e[1]*r,o[2]=e[2]*r,o[3]=e[3]*r,o)},K.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},K.inverse=function(e){var r=1/K.determinant(e),o=e[3]*r,t=-e[1]*r,n=-e[2]*r,i=e[0];return e[0]=o,e[1]=t,e[2]=n,e[3]=i,e};var m={};return m.create=function(e){var r;return e?(r=new glMatrixArrayType(2),r[0]=e[0],r[1]=e[1]):glMatrixArrayType===Array?r=new glMatrixArrayType([0,0]):r=new glMatrixArrayType(2),r},m.subtract=function(e,r,o){return!o||e==o?(e[0]-=r[0],e[1]-=r[1],e):(o[0]=e[0]-r[0],o[1]=e[1]-r[1],o)},m.add=function(e,r,o){return!o||e==o?(e[0]+=r[0],e[1]+=r[1],e):(o[0]=e[0]+r[0],o[1]=e[1]+r[1],o)},m.scale=function(e,r,o){return!o||e==o?(e[0]*=r,e[1]*=r,e):(o[0]=e[0]*r,o[1]=e[1]*r,o)},m.normalize=function(e,r){r||(r=e);var o=e[0],t=e[1],n=Math.sqrt(o*o+t*t);if(n){if(n==1)return r[0]=o,r[1]=t,r}else return r[0]=0,r[1]=0,r;return n=1/n,r[0]=o*n,r[1]=t*n,r},m.dot=function(e,r){return e[0]*r[0]+e[1]*r[1]},m.multiply=function(e,r,o){return o||(o=e),o[0]=e[0]*r[0],o[1]=e[1]*r[1],o},m.unproject=function(e){return X.create([e[0],e[1],1])},m.length=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},m.perspectiveProject=function(e){var r=m.create(e);return m.scale(r,1/e[2])},X.project=function(e){return m.scale(m.create(e),1/e[2])},Y.xVec3=function(e,r,o){o||(o=r);var t=r[0],n=r[1],i=r[2];return o[0]=e[0]*t+e[1]*n+e[2]*i,o[1]=e[3]*t+e[4]*n+e[5]*i,o[2]=e[6]*t+e[7]*n+e[8]*i,o},B("glMatrixAddon",["glMatrix"],function(e){return function(){var r;return r||e.glMatrixAddon}}(this)),B("array_helper",[],function(){return{init:function(e,r){for(var o=e.length;o--;)e[o]=r},shuffle:function(e){var r=e.length-1,o,t;for(r;r>=0;r--)o=Math.floor(Math.random()*r),t=e[r],e[r]=e[o],e[o]=t;return e},toPointList:function(e){var r,o,t=[],n=[];for(r=0;r<e.length;r++){for(t=[],o=0;o<e[r].length;o++)t[o]=e[r][o];n[r]="["+t.join(",")+"]"}return"["+n.join(`,\r
`)+"]"},threshold:function(e,r,o){var t,n=[];for(t=0;t<e.length;t++)o.apply(e,[e[t]])>=r&&n.push(e[t]);return n},maxIndex:function(e){var r,o=0;for(r=0;r<e.length;r++)e[r]>e[o]&&(o=r);return o},max:function(e){var r,o=0;for(r=0;r<e.length;r++)e[r]>o&&(o=e[r]);return o},sum:function(e){for(var r=e.length,o=0;r--;)o+=e[r];return o}}}),B("cv_utils",["cluster","glMatrixAddon","array_helper"],function(e,r,o){var t={};return t.imageRef=function(n,i){var a={x:n,y:i,toVec2:function(){return m.create([this.x,this.y])},toVec3:function(){return X.create([this.x,this.y,1])},round:function(){return this.x=this.x>0?Math.floor(this.x+.5):Math.floor(this.x-.5),this.y=this.y>0?Math.floor(this.y+.5):Math.floor(this.y-.5),this}};return a},t.computeIntegralImage2=function(n,i){var a=n.data,u=n.size.x,l=n.size.y,f=i.data,c=0,h=0,d=0,s=0,p=0,g,y;for(d=u,c=0,y=1;y<l;y++)c+=a[h],f[d]+=c,h+=u,d+=u;for(h=0,d=1,c=0,g=1;g<u;g++)c+=a[h],f[d]+=c,h++,d++;for(y=1;y<l;y++)for(h=y*u+1,d=(y-1)*u+1,s=y*u,p=(y-1)*u,g=1;g<u;g++)f[h]+=a[h]+f[d]+f[s]-f[p],h++,d++,s++,p++},t.computeIntegralImage=function(n,i){for(var a=n.data,u=n.size.x,l=n.size.y,f=i.data,c=0,h=0;h<u;h++)c+=a[h],f[h]=c;for(var d=1;d<l;d++){c=0;for(var s=0;s<u;s++)c+=a[d*u+s],f[d*u+s]=c+f[(d-1)*u+s]}},t.thresholdImage=function(n,i,a){a||(a=n);for(var u=n.data,l=u.length,f=a.data;l--;)f[l]=u[l]<i?1:0},t.computeHistogram=function(n,i){i||(i=8);for(var a=n.data,u=a.length,l=8-i,f=1<<i,c=new Int32Array(f);u--;)c[a[u]>>l]++;return c},t.sharpenLine=function(n){var i,a=n.length,u=n[0],l=n[1],f;for(i=1;i<a-1;i++)f=n[i+1],n[i-1]=l*2-u-f&255,u=l,l=f;return n},t.determineOtsuThreshold=function(n,i){i||(i=8);var a,u,l=8-i;function f(d,s){var p=0,g;for(g=d;g<=s;g++)p+=a[g];return p}function c(d,s){var p,g=0;for(p=d;p<=s;p++)g+=p*a[p];return g}function h(){var d=[0],s,p,g,y,_,x,b,v=(1<<i)-1;for(a=t.computeHistogram(n,i),y=1;y<v;y++)s=f(0,y),p=f(y+1,v),g=s*p,g===0&&(g=1),_=c(0,y)*p,x=c(y+1,v)*s,b=_-x,d[y]=b*b/g;return o.maxIndex(d)}return u=h(),u<<l},t.otsuThreshold=function(n,i){var a=t.determineOtsuThreshold(n);return t.thresholdImage(n,a,i),a},t.computeBinaryImage=function(n,i,a){t.computeIntegralImage(n,i),a||(a=n);var u=n.data,l=a.data,f=n.size.x,c=n.size.y,h=i.data,d=0,s,p,g=3,y,_,x,b,v,E=(g*2+1)*(g*2+1);for(s=0;s<=g;s++)for(p=0;p<f;p++)l[s*f+p]=0,l[(c-1-s)*f+p]=0;for(s=g;s<c-g;s++)for(p=0;p<=g;p++)l[s*f+p]=0,l[s*f+(f-1-p)]=0;for(s=g+1;s<c-g-1;s++)for(p=g+1;p<f-g;p++)y=h[(s-g-1)*f+(p-g-1)],_=h[(s-g-1)*f+(p+g)],x=h[(s+g)*f+(p-g-1)],b=h[(s+g)*f+(p+g)],d=b-x-_+y,v=d/E,l[s*f+p]=u[s*f+p]>v+5?0:1},t.cluster=function(n,i,a){var u,l,f,c,h=[];a||(a="rad");function d(s){var p=!1;for(l=0;l<h.length;l++)f=h[l],f.fits(s)&&(f.add(s),p=!0);return p}for(u=0;u<n.length;u++)c=e.createPoint(n[u],u,a),d(c)||h.push(e.create(c,i));return h},t.Tracer={trace:function(n,i){var a,u=10,l=[],f=[],c=0,h=0;function d(s,p){var g,y,_,x,b=1,v=Math.abs(i[1]/10),E=!1;function w(T,z){return T.x>z.x-b&&T.x<z.x+b&&T.y>z.y-v&&T.y<z.y+v}for(g=n[s],p?x={x:g.x+i[0],y:g.y+i[1]}:x={x:g.x-i[0],y:g.y-i[1]},_=p?s+1:s-1,y=n[_];y&&(E=w(y,x))!==!0&&Math.abs(y.y-g.y)<i[1];)_=p?_+1:_-1,y=n[_];return E?_:null}for(a=0;a<u;a++){for(c=Math.floor(Math.random()*n.length),l=[],h=c,l.push(n[h]);(h=d(h,!0))!==null;)l.push(n[h]);if(c>0)for(h=c;(h=d(h,!1))!==null;)l.push(n[h]);l.length>f.length&&(f=l)}return f}},t.DILATE=1,t.ERODE=2,t.dilate=function(n,i){var a,u,l=n.data,f=i.data,c=n.size.y,h=n.size.x,d,s,p,g,y;for(a=1;a<c-1;a++)for(u=1;u<h-1;u++)s=a-1,p=a+1,g=u-1,y=u+1,d=l[s*h+g]+l[s*h+y]+l[a*h+u]+l[p*h+g]+l[p*h+y],f[a*h+u]=d>0?1:0},t.erode=function(n,i){var a,u,l=n.data,f=i.data,c=n.size.y,h=n.size.x,d,s,p,g,y;for(a=1;a<c-1;a++)for(u=1;u<h-1;u++)s=a-1,p=a+1,g=u-1,y=u+1,d=l[s*h+g]+l[s*h+y]+l[a*h+u]+l[p*h+g]+l[p*h+y],f[a*h+u]=d===5?1:0},t.subtract=function(n,i,a){a||(a=n);for(var u=n.data.length,l=n.data,f=i.data,c=a.data;u--;)c[u]=l[u]-f[u]},t.bitwiseOr=function(n,i,a){a||(a=n);for(var u=n.data.length,l=n.data,f=i.data,c=a.data;u--;)c[u]=l[u]||f[u]},t.countNonZero=function(n){for(var i=n.data.length,a=n.data,u=0;i--;)u+=a[i];return u},t.topGeneric=function(n,i,a){var u,l=0,f=0,c=[],h,d,s;for(u=0;u<i;u++)c[u]={score:0,item:null};for(u=0;u<n.length;u++)if(h=a.apply(this,[n[u]]),h>f)for(d=c[l],d.score=h,d.item=n[u],f=Number.MAX_VALUE,s=0;s<i;s++)c[s].score<f&&(f=c[s].score,l=s);return c},t.grayArrayFromImage=function(n,i,a,u){a.drawImage(n,i,0,n.width,n.height);var l=a.getImageData(i,0,n.width,n.height).data;t.computeGray(l,u)},t.grayArrayFromContext=function(n,i,a,u){var l=n.getImageData(a.x,a.y,i.x,i.y).data;t.computeGray(l,u)},t.grayAndHalfSampleFromCanvasData=function(n,i,a){for(var u=0,l=i.x,f=Math.floor(n.length/4),c=i.x/2,h=0,d=i.x,s;l<f;){for(s=0;s<c;s++)a[h]=Math.floor((.299*n[u*4+0]+.587*n[u*4+1]+.114*n[u*4+2]+(.299*n[(u+1)*4+0]+.587*n[(u+1)*4+1]+.114*n[(u+1)*4+2])+(.299*n[l*4+0]+.587*n[l*4+1]+.114*n[l*4+2])+(.299*n[(l+1)*4+0]+.587*n[(l+1)*4+1]+.114*n[(l+1)*4+2]))/4),h++,u=u+2,l=l+2;u=u+d,l=l+d}},t.computeGray=function(n,i,a){var u=n.length/4|0,l,f=a&&a.singleChannel===!0;if(f)for(l=0;l<u;l++)i[l]=n[l*4+0];else for(l=0;l<u;l++)i[l]=Math.floor(.299*n[l*4+0]+.587*n[l*4+1]+.114*n[l*4+2])},t.loadImageArray=function(n,i,a){a||(a=document.createElement("canvas"));var u=new Image;u.callback=i,u.onload=function(){a.width=this.width,a.height=this.height;var l=a.getContext("2d");l.drawImage(this,0,0);var f=new Uint8Array(this.width*this.height);l.drawImage(this,0,0);var c=l.getImageData(0,0,this.width,this.height).data;t.computeGray(c,f),this.callback(f,{x:this.width,y:this.height},this)},u.src=n},t.halfSample=function(n,i){for(var a=n.data,u=n.size.x,l=i.data,f=0,c=u,h=a.length,d=u/2,s=0;c<h;){for(var p=0;p<d;p++)l[s]=Math.floor((a[f]+a[f+1]+a[c]+a[c+1])/4),s++,f=f+2,c=c+2;f=f+u,c=c+u}},t.hsv2rgb=function(n,i){var a=n[0],u=n[1],l=n[2],f=l*u,c=f*(1-Math.abs(a/60%2-1)),h=l-f,d=0,s=0,p=0;return i=i||[0,0,0],a<60?(d=f,s=c):a<120?(d=c,s=f):a<180?(s=f,p=c):a<240?(s=c,p=f):a<300?(d=c,p=f):a<360&&(d=f,p=c),i[0]=(d+h)*255|0,i[1]=(s+h)*255|0,i[2]=(p+h)*255|0,i},t._computeDivisors=function(n){var i=[],a=[],u;for(u=1;u<Math.sqrt(n)+1;u++)n%u===0&&(a.push(u),u!==n/u&&i.unshift(Math.floor(n/u)));return a.concat(i)},t._computeIntersection=function(n,i){for(var a=0,u=0,l=[];a<n.length&&u<i.length;)n[a]===i[u]?(l.push(n[a]),a++,u++):n[a]>i[u]?u++:a++;return l},t.calculatePatchSize=function(n,i){var a=this._computeDivisors(i.x),u=this._computeDivisors(i.y),l=Math.max(i.x,i.y),f=this._computeIntersection(a,u),c=[8,10,15,20,32,60,80],h={"x-small":5,small:4,medium:3,large:2,"x-large":1},d=h[n]||h.medium,s=c[d],p=Math.floor(l/s),g;function y(_){for(var x=0,b=_[Math.floor(_.length/2)];x<_.length-1&&_[x]<p;)x++;return x>0&&(Math.abs(_[x]-p)>Math.abs(_[x-1]-p)?b=_[x-1]:b=_[x]),p/b<c[d+1]/c[d]&&p/b>c[d-1]/c[d]?{x:b,y:b}:null}return g=y(f),g||(g=y(this._computeDivisors(l)),g||(g=y(this._computeDivisors(p*s)))),g},t._parseCSSDimensionValues=function(n){var i={value:parseFloat(n),unit:(n.indexOf("%")===n.length-1,"%")};return i},t._dimensionsConverters={top:function(n,i){if(n.unit==="%")return Math.floor(i.height*(n.value/100))},right:function(n,i){if(n.unit==="%")return Math.floor(i.width-i.width*(n.value/100))},bottom:function(n,i){if(n.unit==="%")return Math.floor(i.height-i.height*(n.value/100))},left:function(n,i){if(n.unit==="%")return Math.floor(i.width*(n.value/100))}},t.computeImageArea=function(n,i,a){var u={width:n,height:i},l=Object.keys(a).reduce(function(f,c){var h=a[c],d=t._parseCSSDimensionValues(h),s=t._dimensionsConverters[c](d,u);return f[c]=s,f},{});return{sx:l.left,sy:l.top,sw:l.right-l.left,sh:l.bottom-l.top}},t}),B("image_wrapper",["subImage","cv_utils","array_helper"],function(e,r,o){function t(n,i,a,u){i?this.data=i:a?(this.data=new a(n.x*n.y),a===Array&&u&&o.init(this.data,0)):(this.data=new Uint8Array(n.x*n.y),Uint8Array===Array&&u&&o.init(this.data,0)),this.size=n}return t.prototype.inImageWithBorder=function(n,i){return n.x>=i&&n.y>=i&&n.x<this.size.x-i&&n.y<this.size.y-i},t.transform=function(n,i,a,u,l){var f=i.size.x,c=i.size.y,h=n.size.x,d=n.size.y,s=m.create([a[0],a[2]]),p=m.create([a[1],a[3]]),g=0,y=m.subtract(u,K.xVec2(a,l,m.create()),m.create()),_=y[0],x=y[1],b=_,v=x,E,w,T,z=t.sample;s[0]<0?_+=f*s[0]:b+=f*s[0],p[0]<0?_+=c*p[0]:b+=c*p[0],s[1]<0?x+=f*s[1]:v+=f*s[1],p[1]<0?x+=c*p[1]:v+=c*p[1];var M=m.subtract(p,m.scale(s,f,m.create()),m.create());if(_>=0&&x>=0&&b<h-1&&v<d-1){for(E=y,w=0;w<c;++w,m.add(E,M))for(T=0;T<f;++T,m.add(E,s))i.set(T,w,z(n,E[0],E[1]));return 0}else{var R=h-1,S=d-1,k=0;for(E=y,w=0;w<c;++w,m.add(E,M))for(T=0;T<f;++T,m.add(E,s))0<=E[0]&&0<=E[1]&&E[0]<R&&E[1]<S?i.set(T,w,z(n,E[0],E[1])):(i.set(T,w,g),++k);return k}},t.sample=function(n,i,a){var u=Math.floor(i),l=Math.floor(a),f=n.size.x,c=l*n.size.x+u,h=n.data[c+0],d=n.data[c+1],s=n.data[c+f],p=n.data[c+f+1],g=h-d;i-=u,a-=l;var y=Math.floor(i*(a*(g-s+p)-g)+a*(s-h)+h);return y},t.clearArray=function(n){for(var i=n.length;i--;)n[i]=0},t.prototype.subImage=function(n,i){return new e(n,i,this)},t.prototype.subImageAsCopy=function(n,i){var a=n.size.y,u=n.size.x,l,f;for(l=0;l<u;l++)for(f=0;f<a;f++)n.data[f*u+l]=this.data[(i.y+f)*this.size.x+i.x+l]},t.prototype.copyTo=function(n){for(var i=this.data.length,a=this.data,u=n.data;i--;)u[i]=a[i]},t.prototype.get=function(n,i){return this.data[i*this.size.x+n]},t.prototype.getSafe=function(n,i){var a;if(!this.indexMapping){for(this.indexMapping={x:[],y:[]},a=0;a<this.size.x;a++)this.indexMapping.x[a]=a,this.indexMapping.x[a+this.size.x]=a;for(a=0;a<this.size.y;a++)this.indexMapping.y[a]=a,this.indexMapping.y[a+this.size.y]=a}return this.data[this.indexMapping.y[i+this.size.y]*this.size.x+this.indexMapping.x[n+this.size.x]]},t.prototype.set=function(n,i,a){return this.data[i*this.size.x+n]=a,this},t.prototype.zeroBorder=function(){var n,i=this.size.x,a=this.size.y,u=this.data;for(n=0;n<i;n++)u[n]=u[(a-1)*i+n]=0;for(n=1;n<a-1;n++)u[n*i]=u[n*i+(i-1)]=0},t.prototype.invert=function(){for(var n=this.data,i=n.length;i--;)n[i]=n[i]?0:1},t.prototype.convolve=function(n){var i,a,u,l,f=n.length/2|0,c=0;for(a=0;a<this.size.y;a++)for(i=0;i<this.size.x;i++){for(c=0,l=-f;l<=f;l++)for(u=-f;u<=f;u++)c+=n[l+f][u+f]*this.getSafe(i+u,a+l);this.data[a*this.size.x+i]=c}},t.prototype.moments=function(n){var i=this.data,a,u,l=this.size.y,f=this.size.x,c,h,d=[],s,p,g,y,_,x,b,v,E=[],w=Math.PI,T=w/4;if(n<=0)return E;for(s=0;s<n;s++)d[s]={m00:0,m01:0,m10:0,m11:0,m02:0,m20:0,theta:0,rad:0};for(u=0;u<l;u++)for(h=u*u,a=0;a<f;a++)c=i[u*f+a],c>0&&(p=d[c-1],p.m00+=1,p.m01+=u,p.m10+=a,p.m11+=a*u,p.m02+=h,p.m20+=a*a);for(s=0;s<n;s++)p=d[s],!isNaN(p.m00)&&p.m00!==0&&(x=p.m10/p.m00,b=p.m01/p.m00,g=p.m11/p.m00-x*b,y=p.m02/p.m00-b*b,_=p.m20/p.m00-x*x,v=(y-_)/(2*g),v=.5*Math.atan(v)+(g>=0?T:-T)+w,p.theta=(v*180/w+90)%180-90,p.theta<0&&(p.theta+=180),p.rad=v>w?v-w:v,p.vec=m.create([Math.cos(v),Math.sin(v)]),E.push(p));return E},t.prototype.show=function(n,i){var a,u,l,f,c,h,d;for(i||(i=1),a=n.getContext("2d"),n.width=this.size.x,n.height=this.size.y,u=a.getImageData(0,0,n.width,n.height),l=u.data,f=0,d=0;d<this.size.y;d++)for(h=0;h<this.size.x;h++)c=d*this.size.x+h,f=this.get(h,d)*i,l[c*4+0]=f,l[c*4+1]=f,l[c*4+2]=f,l[c*4+3]=255;a.putImageData(u,0,0)},t.prototype.overlay=function(n,i,a){(!i||i<0||i>360)&&(i=360);for(var u=[0,1,1],l=[0,0,0],f=[255,255,255],c=[0,0,0],h=[],d=n.getContext("2d"),s=d.getImageData(a.x,a.y,this.size.x,this.size.y),p=s.data,g=this.data.length;g--;)u[0]=this.data[g]*i,h=u[0]<=0?f:u[0]>=360?c:r.hsv2rgb(u,l),p[g*4+0]=h[0],p[g*4+1]=h[1],p[g*4+2]=h[2],p[g*4+3]=255;d.putImageData(s,a.x,a.y)},t}),B("tracer",[],function(){var e={searchDirections:[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],create:function(r,o){var t=r.data,n=o.data,i=this.searchDirections,a=r.size.x,u;function l(h,d,s,p){var g,y,_;for(g=0;g<7;g++){if(y=h.cy+i[h.dir][0],_=h.cx+i[h.dir][1],u=y*a+_,t[u]===d&&(n[u]===0||n[u]===s))return n[u]=s,h.cy=y,h.cx=_,!0;n[u]===0&&(n[u]=p),h.dir=(h.dir+1)%8}return!1}function f(h,d,s){return{dir:s,x:h,y:d,next:null,prev:null}}function c(h,d,s,p,g){var y=null,_,x,b,v={cx:d,cy:h,dir:0};if(l(v,p,s,g)){y=f(d,h,v.dir),_=y,b=v.dir,x=f(v.cx,v.cy,0),x.prev=_,_.next=x,x.next=null,_=x;do v.dir=(v.dir+6)%8,l(v,p,s,g),b!=v.dir?(_.dir=v.dir,x=f(v.cx,v.cy,0),x.prev=_,_.next=x,x.next=null,_=x):(_.dir=b,_.x=v.cx,_.y=v.cy),b=v.dir;while(v.cx!=d||v.cy!=h);y.prev=_.prev,_.prev.next=y}return y}return{trace:function(h,d,s,p){return l(h,d,s,p)},contourTracing:function(h,d,s,p,g){return c(h,d,s,p,g)}}}};return e}),B("rasterizer",["tracer"],function(e){var r={createContour2D:function(){return{dir:null,index:null,firstVertex:null,insideContours:null,nextpeer:null,prevpeer:null}},CONTOUR_DIR:{CW_DIR:0,CCW_DIR:1,UNKNOWN_DIR:2},DIR:{OUTSIDE_EDGE:-32767,INSIDE_EDGE:-32766},create:function(o,t){var n=o.data,i=t.data,a=o.size.x,u=o.size.y,l=e.create(o,t);return{rasterize:function(f){var c,h,d,s,p,g,y=[],_,x,b,v,E,w=0,T;for(T=0;T<400;T++)y[T]=0;for(y[0]=n[0],b=null,g=1;g<u-1;g++)for(s=0,h=y[0],p=1;p<a-1;p++)if(E=g*a+p,i[E]===0)if(c=n[E],c!==h){if(s===0)d=w+1,y[d]=c,h=c,_=l.contourTracing(g,p,d,c,r.DIR.OUTSIDE_EDGE),_!==null&&(w++,s=d,x=r.createContour2D(),x.dir=r.CONTOUR_DIR.CW_DIR,x.index=s,x.firstVertex=_,x.nextpeer=b,x.insideContours=null,b!==null&&(b.prevpeer=x),b=x);else if(_=l.contourTracing(g,p,r.DIR.INSIDE_EDGE,c,s),_!==null){for(x=r.createContour2D(),x.firstVertex=_,x.insideContours=null,f===0?x.dir=r.CONTOUR_DIR.CCW_DIR:x.dir=r.CONTOUR_DIR.CW_DIR,x.index=f,v=b;v!==null&&v.index!==s;)v=v.nextpeer;v!==null&&(x.nextpeer=v.insideContours,v.insideContours!==null&&(v.insideContours.prevpeer=x),v.insideContours=x)}}else i[E]=s;else i[E]===r.DIR.OUTSIDE_EDGE||i[E]===r.DIR.INSIDE_EDGE?(s=0,i[E]===r.DIR.INSIDE_EDGE?h=n[E]:h=y[0]):(s=i[E],h=y[s]);for(v=b;v!==null;)v.index=f,v=v.nextpeer;return{cc:b,count:w}},debug:{drawContour:function(f,c){var h=f.getContext("2d"),d=c,s,p,g;for(h.strokeStyle="red",h.fillStyle="red",h.lineWidth=1,d!==null?s=d.insideContours:s=null;d!==null;){switch(s!==null?(p=s,s=s.nextpeer):(p=d,d=d.nextpeer,d!==null?s=d.insideContours:s=null),p.dir){case r.CONTOUR_DIR.CW_DIR:h.strokeStyle="red";break;case r.CONTOUR_DIR.CCW_DIR:h.strokeStyle="blue";break;case r.CONTOUR_DIR.UNKNOWN_DIR:h.strokeStyle="green";break}g=p.firstVertex,h.beginPath(),h.moveTo(g.x,g.y);do g=g.next,h.lineTo(g.x,g.y);while(g!==p.firstVertex);h.stroke()}}}}}};return r}),B("skeletonizer",[],function(){/* @preserve ASM BEGIN */function e(r,o,t){var n=new r.Uint8Array(t),i=o.size|0,a=r.Math.imul;function u(y,_){y=y|0,_=_|0;var x=0,b=0,v=0,E=0,w=0,T=0,z=0,M=0;for(x=1;(x|0)<(i-1|0);x=x+1|0)for(M=M+i|0,b=1;(b|0)<(i-1|0);b=b+1|0)E=M-i|0,w=M+i|0,T=b-1|0,z=b+1|0,v=(n[y+E+T|0]|0)+(n[y+E+z|0]|0)+(n[y+M+b|0]|0)+(n[y+w+T|0]|0)+(n[y+w+z|0]|0)|0,(v|0)==5?n[_+M+b|0]=1:n[_+M+b|0]=0}function l(y,_,x){y=y|0,_=_|0,x=x|0;var b=0;for(b=a(i,i)|0;(b|0)>0;)b=b-1|0,n[x+b|0]=(n[y+b|0]|0)-(n[_+b|0]|0)|0}function f(y,_,x){y=y|0,_=_|0,x=x|0;var b=0;for(b=a(i,i)|0;(b|0)>0;)b=b-1|0,n[x+b|0]=n[y+b|0]|0|(n[_+b|0]|0)|0}function c(y){y=y|0;var _=0,x=0;for(x=a(i,i)|0;(x|0)>0;)x=x-1|0,_=(_|0)+(n[y+x|0]|0)|0;return _|0}function h(y,_){y=y|0,_=_|0;var x=0;for(x=a(i,i)|0;(x|0)>0;)x=x-1|0,n[y+x|0]=_}function d(y,_){y=y|0,_=_|0;var x=0,b=0,v=0,E=0,w=0,T=0,z=0,M=0;for(x=1;(x|0)<(i-1|0);x=x+1|0)for(M=M+i|0,b=1;(b|0)<(i-1|0);b=b+1|0)E=M-i|0,w=M+i|0,T=b-1|0,z=b+1|0,v=(n[y+E+T|0]|0)+(n[y+E+z|0]|0)+(n[y+M+b|0]|0)+(n[y+w+T|0]|0)+(n[y+w+z|0]|0)|0,(v|0)>0?n[_+M+b|0]=1:n[_+M+b|0]=0}function s(y,_){y=y|0,_=_|0;var x=0;for(x=a(i,i)|0;(x|0)>0;)x=x-1|0,n[_+x|0]=n[y+x|0]|0}function p(y){y=y|0;var _=0,x=0;for(_=0;(_|0)<(i-1|0);_=_+1|0)n[y+_|0]=0,n[y+x|0]=0,x=x+i-1|0,n[y+x|0]=0,x=x+1|0;for(_=0;(_|0)<(i|0);_=_+1|0)n[y+x|0]=0,x=x+1|0}function g(){var y=0,_=0,x=0,b=0,v=0,E=0;_=a(i,i)|0,x=_+_|0,b=x+_|0,h(b,0),p(y);do u(y,_),d(_,x),l(y,x,x),f(b,x,b),s(_,y),v=c(y)|0,E=(v|0)==0|0;while(!E)}return{skeletonize:g}}/* @preserve ASM END */return e}),B("image_debug",[],function(){return{drawRect:function(e,r,o,t){o.strokeStyle=t.color,o.fillStyle=t.color,o.lineWidth=1,o.beginPath(),o.strokeRect(e.x,e.y,r.x,r.y)},drawPath:function(e,r,o,t){o.strokeStyle=t.color,o.fillStyle=t.color,o.lineWidth=t.lineWidth,o.beginPath(),o.moveTo(e[0][r.x],e[0][r.y]);for(var n=1;n<e.length;n++)o.lineTo(e[n][r.x],e[n][r.y]);o.closePath(),o.stroke()},drawImage:function(e,r,o){var t=o.getImageData(0,0,r.x,r.y),n=t.data,i=e.length,a=n.length,u;if(a/i!==4)return!1;for(;i--;)u=e[i],n[--a]=255,n[--a]=u,n[--a]=u,n[--a]=u;return o.putImageData(t,0,0),!0}}}),B("barcode_locator",["image_wrapper","cv_utils","rasterizer","tracer","skeletonizer","array_helper","image_debug"],function(e,r,o,t,n,i,a){var u,l,f,c,h,d,s,p,g,y,_={ctx:{binary:null},dom:{binary:null}},x={x:0,y:0},b,v,E=this;function w(){var D;u.halfSample?l=new e({x:b.size.x/2|0,y:b.size.y/2|0}):l=b,y=r.calculatePatchSize(u.patchSize,l.size),x.x=l.size.x/y.x|0,x.y=l.size.y/y.y|0,g=new e(l.size,void 0,Uint8Array,!1),h=new e(y,void 0,Array,!0),D=new ArrayBuffer(64*1024),c=new e(y,new Uint8Array(D,0,y.x*y.y)),f=new e(y,new Uint8Array(D,y.x*y.y*3,y.x*y.y),void 0,!0),v=n(E,{size:y.x},D),p=new e({x:l.size.x/c.size.x|0,y:l.size.y/c.size.y|0},void 0,Array,!0),d=new e(p.size,void 0,void 0,!0),s=new e(p.size,void 0,Int32Array,!0)}function T(){u.useWorker||typeof document>"u"||(_.dom.binary=document.createElement("canvas"),_.dom.binary.className="binaryBuffer",u.showCanvas===!0&&document.querySelector("#debug").appendChild(_.dom.binary),_.ctx.binary=_.dom.binary.getContext("2d"),_.dom.binary.width=g.size.x,_.dom.binary.height=g.size.y)}function z(D){var P,N,I,L,F,C=g.size.x,A=g.size.y,U=-g.size.x,H=-g.size.y,V,Z;for(P=0,N=0;N<D.length;N++)L=D[N],P+=L.rad,u.showPatches&&a.drawRect(L.pos,c.size,_.ctx.binary,{color:"red"});for(P/=D.length,P=(P*180/Math.PI+90)%180-90,P<0&&(P+=180),P=(180-P)*Math.PI/180,F=K.create([Math.cos(P),-Math.sin(P),Math.sin(P),Math.cos(P)]),N=0;N<D.length;N++){for(L=D[N],I=0;I<4;I++)K.xVec2(F,L.box[I]);u.boxFromPatches.showTransformed&&a.drawPath(L.box,{x:0,y:1},_.ctx.binary,{color:"#99ff00",lineWidth:2})}for(N=0;N<D.length;N++)for(L=D[N],I=0;I<4;I++)L.box[I][0]<C&&(C=L.box[I][0]),L.box[I][0]>U&&(U=L.box[I][0]),L.box[I][1]<A&&(A=L.box[I][1]),L.box[I][1]>H&&(H=L.box[I][1]);for(V=[[C,A],[U,A],[U,H],[C,H]],u.boxFromPatches.showTransformedBox&&a.drawPath(V,{x:0,y:1},_.ctx.binary,{color:"#ff0000",lineWidth:2}),Z=u.halfSample?2:1,F=K.inverse(F),I=0;I<4;I++)K.xVec2(F,V[I]);for(u.boxFromPatches.showBB&&a.drawPath(V,{x:0,y:1},_.ctx.binary,{color:"#ff0000",lineWidth:2}),I=0;I<4;I++)m.scale(V[I],Z);return V}function M(){r.otsuThreshold(l,g),g.zeroBorder(),u.showCanvas&&g.show(_.dom.binary,255)}function R(){var D,P,N,I,L,F=[],C,A,U;for(D=0;D<x.x;D++)for(P=0;P<x.y;P++)N=c.size.x*D,I=c.size.y*P,O(N,I),f.zeroBorder(),i.init(h.data,0),C=o.create(f,h),A=C.rasterize(0),u.showLabels&&h.overlay(_.dom.binary,Math.floor(360/A.count),{x:N,y:I}),L=h.moments(A.count),F=F.concat(W(L,[D,P],N,I));if(u.showFoundPatches)for(D=0;D<F.length;D++)U=F[D],a.drawRect(U.pos,c.size,_.ctx.binary,{color:"#99ff00",lineWidth:2});return F}function S(D){var P,N,I=[],L=[];for(P=0;P<D;P++)I.push(0);for(N=s.data.length;N--;)s.data[N]>0&&I[s.data[N]-1]++;return I=I.map(function(F,C){return{val:F,label:C+1}}),I.sort(function(F,C){return C.val-F.val}),L=I.filter(function(F){return F.val>=5}),L}function k(D,P){var N,I,L,F=[],C,A,U=[],H=[0,1,1],V=[0,0,0];for(N=0;N<D.length;N++){for(L=s.data.length,F.length=0;L--;)s.data[L]===D[N].label&&(C=p.data[L],F.push(C));if(A=z(F),A&&(U.push(A),u.showRemainingPatchLabels))for(I=0;I<F.length;I++)C=F[I],H[0]=D[N].label/(P+1)*360,r.hsv2rgb(H,V),a.drawRect(C.pos,c.size,_.ctx.binary,{color:"rgb("+V.join(",")+")",lineWidth:2})}return U}function j(D){var P=r.cluster(D,.9),N=r.topGeneric(P,1,function(C){return C.getPoints().length}),I=[],L=[];if(N.length===1){I=N[0].item.getPoints();for(var F=0;F<I.length;F++)L.push(I[F].point)}return L}function O(D,P){g.subImageAsCopy(c,r.imageRef(D,P)),v.skeletonize(),u.showSkeleton&&f.overlay(_.dom.binary,360,r.imageRef(D,P))}function W(D,P,N,I){var L,F,C=[],A,U,H=[],V=Math.ceil(y.x/3);if(D.length>=2){for(L=0;L<D.length;L++)D[L].m00>V&&C.push(D[L]);if(C.length>=2){for(C.length,A=j(C),F=0,L=0;L<A.length;L++)F+=A[L].rad;A.length>1&&A.length>=C.length/4*3&&A.length>D.length/4&&(F/=A.length,U={index:P[1]*x.x+P[0],pos:{x:N,y:I},box:[m.create([N,I]),m.create([N+c.size.x,I]),m.create([N+c.size.x,I+c.size.y]),m.create([N,I+c.size.y])],moments:A,rad:F,vec:m.create([Math.cos(F),Math.sin(F)])},H.push(U))}}return H}function $(D){var P=0,N=.95,I=0,L,F,C=[0,1,1],A=[0,0,0];function U(){var V;for(V=0;V<s.data.length;V++)if(s.data[V]===0&&d.data[V]===1)return V;return s.length}function H(V){var Z,ue,ne,fe,ce,de,xe={x:V%s.size.x,y:V/s.size.x|0},we;if(V<s.data.length)for(ne=p.data[V],s.data[V]=P,de=0;de<t.searchDirections.length;de++){if(ue=xe.y+t.searchDirections[de][0],Z=xe.x+t.searchDirections[de][1],ce=ue*s.size.x+Z,d.data[ce]===0){s.data[ce]=Number.MAX_VALUE;continue}fe=p.data[ce],s.data[ce]===0&&(we=Math.abs(m.dot(fe.vec,ne.vec)),we>N&&H(ce))}}for(i.init(d.data,0),i.init(s.data,0),i.init(p.data,null),L=0;L<D.length;L++)F=D[L],p.data[F.index]=F,d.data[F.index]=1;for(d.zeroBorder();(I=U())<s.data.length;)P++,H(I);if(u.showPatchLabels)for(L=0;L<s.data.length;L++)s.data[L]>0&&s.data[L]<=P&&(F=p.data[L],C[0]=s.data[L]/(P+1)*360,r.hsv2rgb(C,A),a.drawRect(F.pos,c.size,_.ctx.binary,{color:"rgb("+A.join(",")+")",lineWidth:2}));return P}return{init:function(D,P){u=P,b=D,w(),T()},locate:function(){var D,P,N;if(u.halfSample&&r.halfSample(b,l),M(),D=R(),D.length<x.x*x.y*.05)return null;var I=$(D);return I<1||(P=S(I),P.length===0)?null:(N=k(P,I),N)},checkImageConstraints:function(D,P){var N,I=D.getWidth(),L=D.getHeight(),F=P.halfSample?.5:1,C,A;if(D.getConfig().area&&(A=r.computeImageArea(I,L,D.getConfig().area),D.setTopRight({x:A.sx,y:A.sy}),D.setCanvasSize({x:I,y:L}),I=A.sw,L=A.sh),C={x:Math.floor(I*F),y:Math.floor(L*F)},N=r.calculatePatchSize(P.patchSize,C),console.log("Patch-Size: "+JSON.stringify(N)),D.setWidth(Math.floor(Math.floor(C.x/N.x)*(1/F)*N.x)),D.setHeight(Math.floor(Math.floor(C.y/N.y)*(1/F)*N.y)),D.getWidth()%N.x===0&&D.getHeight()%N.y===0)return!0;throw new Error("Image dimensions do not comply with the current settings: Width ("+I+" )and height ("+L+") must a multiple of "+N.x)}}}),B("bresenham",["cv_utils","image_wrapper"],function(e,r){var o={},t={DIR:{UP:1,DOWN:-1}};return o.getBarcodeLine=function(n,i,a){var u=i.x|0,l=i.y|0,f=a.x|0,c=a.y|0,h=Math.abs(c-l)>Math.abs(f-u),d,s,p,g,y,_,x,b=[],v=n.data,E=n.size.x,w,T=255,z=0;function M(R,S){w=v[S*E+R],T=w<T?w:T,z=w>z?w:z,b.push(w)}for(h&&(_=u,u=l,l=_,_=f,f=c,c=_),u>f&&(_=u,u=f,f=_,_=l,l=c,c=_),d=f-u,s=Math.abs(c-l),p=d/2|0,y=l,g=l<c?1:-1,x=u;x<f;x++)h?M(y,x):M(x,y),p=p-s,p<0&&(y=y+g,p=p+d);return{line:b,min:T,max:z}},o.toOtsuBinaryLine=function(n){var i=n.line,a=new r({x:i.length-1,y:1},i),u=e.determineOtsuThreshold(a,5);return i=e.sharpenLine(i),e.thresholdImage(a,u),{line:i,threshold:u}},o.toBinaryLine=function(n){var i=n.min,a=n.max,u=n.line,l,f,c=i+(a-i)/2,h=[],d,s,p=(a-i)/12,g=-p,y,_;for(d=u[0]>c?t.DIR.UP:t.DIR.DOWN,h.push({pos:0,val:u[0]}),y=0;y<u.length-2;y++)l=u[y+1]-u[y],f=u[y+2]-u[y+1],l+f<g&&u[y+1]<c*1.5?s=t.DIR.DOWN:l+f>p&&u[y+1]>c*.5?s=t.DIR.UP:s=d,d!==s&&(h.push({pos:y,val:u[y]}),d=s);for(h.push({pos:u.length,val:u[u.length-1]}),_=h[0].pos;_<h[1].pos;_++)u[_]=u[_]>c?0:1;for(y=1;y<h.length-1;y++)for(h[y+1].val>h[y].val?p=h[y].val+(h[y+1].val-h[y].val)/3*2|0:p=h[y+1].val+(h[y].val-h[y+1].val)/3|0,_=h[y].pos;_<h[y+1].pos;_++)u[_]=u[_]>p?0:1;return{line:u,threshold:p}},o.debug={printFrequency:function(n,i){var a,u=i.getContext("2d");for(i.width=n.length,i.height=256,u.beginPath(),u.strokeStyle="blue",a=0;a<n.length;a++)u.moveTo(a,255),u.lineTo(a,255-n[a]);u.stroke(),u.closePath()},printPattern:function(n,i){var a=i.getContext("2d"),u;for(i.width=n.length,a.fillColor="black",u=0;u<n.length;u++)n[u]===1&&a.fillRect(u,0,1,100)}},o}),B("barcode_reader",[],function(){function e(r){return this._row=[],this.config=r||{},this}return e.prototype._nextUnset=function(r,o){var t;for(o===void 0&&(o=0),t=o;t<r.length;t++)if(!r[t])return t;return r.length},e.prototype._matchPattern=function(r,o){var t,n=0,i=0,a=this.MODULO,u=this.SINGLE_CODE_ERROR||1;for(t=0;t<r.length;t++){if(i=Math.abs(o[t]-r[t]),i>u)return Number.MAX_VALUE;n+=i}return n/a},e.prototype._nextSet=function(r,o){var t;for(o=o||0,t=o;t<r.length;t++)if(r[t])return t;return r.length},e.prototype._normalize=function(r,o){var t,n=this,i=0,a,u=0,l=[],f=0;for(o||(o=n.MODULO),t=0;t<r.length;t++)r[t]===1?u++:i+=r[t];if(a=i/(o-u),a>1)for(t=0;t<r.length;t++)f=r[t]===1?r[t]:r[t]/a,l.push(f);else for(a=(i+u)/o,t=0;t<r.length;t++)f=r[t]/a,l.push(f);return l},e.prototype._matchTrace=function(r,o){var t=[],n,i=this,a=i._nextSet(i._row),u=!i._row[a],l=0,f={error:Number.MAX_VALUE,code:-1,start:0},c;if(r){for(n=0;n<r.length;n++)t.push(0);for(n=a;n<i._row.length;n++)if(i._row[n]^u)t[l]++;else{if(l===t.length-1)return c=i._matchPattern(t,r),c<o?(f.start=n-a,f.end=n,f.counter=t,f):null;l++,t[l]=1,u=!u}}else for(t.push(0),n=a;n<i._row.length;n++)i._row[n]^u?t[l]++:(l++,t.push(0),t[l]=1,u=!u);return f.start=a,f.end=i._row.length-1,f.counter=t,f},e.prototype.decodePattern=function(r){var o=this,t;return o._row=r,t=o._decode(),t===null?(o._row.reverse(),t=o._decode(),t&&(t.direction=e.DIRECTION.REVERSE,t.start=o._row.length-t.start,t.end=o._row.length-t.end)):t.direction=e.DIRECTION.FORWARD,t&&(t.format=o.FORMAT),t},e.prototype._matchRange=function(r,o,t){var n;for(r=r<0?0:r,n=r;n<o;n++)if(this._row[n]!==t)return!1;return!0},e.prototype._fillCounters=function(r,o,t){var n=this,i=0,a,u=[];for(t=typeof t<"u"?t:!0,r=typeof r<"u"?r:n._nextUnset(n._row),o=o||n._row.length,u[i]=0,a=r;a<o;a++)n._row[a]^t?u[i]++:(i++,u[i]=1,t=!t);return u},Object.defineProperty(e.prototype,"FORMAT",{value:"unknown",writeable:!1}),e.DIRECTION={FORWARD:1,REVERSE:-1},e.Exception={StartNotFoundException:"Start-Info was not found!",CodeNotFoundException:"Code could not be found!",PatternNotFoundException:"Pattern could not be found!"},e.CONFIG_KEYS={},e}),B("code_128_reader",["./barcode_reader"],function(e){function r(){e.call(this)}var o={CODE_SHIFT:{value:98},CODE_C:{value:99},CODE_B:{value:100},CODE_A:{value:101},START_CODE_A:{value:103},START_CODE_B:{value:104},START_CODE_C:{value:105},STOP_CODE:{value:106},MODULO:{value:11},CODE_PATTERN:{value:[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]]},SINGLE_CODE_ERROR:{value:1},AVG_CODE_ERROR:{value:.5},FORMAT:{value:"code_128",writeable:!1}};return r.prototype=Object.create(e.prototype,o),r.prototype.constructor=r,r.prototype._decodeCode=function(t){var n=[0,0,0,0,0,0],i,a=this,u=t,l=!a._row[u],f=0,c={error:Number.MAX_VALUE,code:-1,start:t,end:t},h,d,s;for(i=u;i<a._row.length;i++)if(a._row[i]^l)n[f]++;else{if(f===n.length-1){if(s=a._normalize(n),s){for(h=0;h<a.CODE_PATTERN.length;h++)d=a._matchPattern(s,a.CODE_PATTERN[h]),d<c.error&&(c.code=h,c.error=d);return c.end=i,c}}else f++;n[f]=1,l=!l}return null},r.prototype._findStart=function(){var t=[0,0,0,0,0,0],n,i=this,a=i._nextSet(i._row),u=!1,l=0,f={error:Number.MAX_VALUE,code:-1,start:0,end:0},c,h,d,s,p;for(n=a;n<i._row.length;n++)if(i._row[n]^u)t[l]++;else{if(l===t.length-1){for(s=0,d=0;d<t.length;d++)s+=t[d];if(p=i._normalize(t),p){for(c=i.START_CODE_A;c<=i.START_CODE_C;c++)h=i._matchPattern(p,i.CODE_PATTERN[c]),h<f.error&&(f.code=c,f.error=h);if(f.error<i.AVG_CODE_ERROR)return f.start=n-s,f.end=n,f}for(d=0;d<4;d++)t[d]=t[d+2];t[4]=0,t[5]=0,l--}else l++;t[l]=1,u=!u}return null},r.prototype._decode=function(){var t=this,n=t._findStart(),i=null,a=!1,u=[],l=0,f=0,c,h=[],d=[],s=!1,p;if(n===null)return null;switch(i={code:n.code,start:n.start,end:n.end},d.push(i),f=i.code,i.code){case t.START_CODE_A:c=t.CODE_A;break;case t.START_CODE_B:c=t.CODE_B;break;case t.START_CODE_C:c=t.CODE_C;break;default:return null}for(;!a;){if(p=s,s=!1,i=t._decodeCode(i.end),i!==null)switch(i.code!==t.STOP_CODE&&(h.push(i.code),l++,f+=l*i.code),d.push(i),c){case t.CODE_A:if(i.code<64)u.push(String.fromCharCode(32+i.code));else if(i.code<96)u.push(String.fromCharCode(i.code-64));else switch(i.code){case t.CODE_SHIFT:s=!0,c=t.CODE_B;break;case t.CODE_B:c=t.CODE_B;break;case t.CODE_C:c=t.CODE_C;break;case t.STOP_CODE:a=!0;break}break;case t.CODE_B:if(i.code<96)u.push(String.fromCharCode(32+i.code));else switch(i.code!=t.STOP_CODE,i.code){case t.CODE_SHIFT:s=!0,c=t.CODE_A;break;case t.CODE_A:c=t.CODE_A;break;case t.CODE_C:c=t.CODE_C;break;case t.STOP_CODE:a=!0;break}break;case t.CODE_C:switch(i.code<100&&u.push(i.code<10?"0"+i.code:i.code),i.code){case t.CODE_A:c=t.CODE_A;break;case t.CODE_B:c=t.CODE_B;break;case t.STOP_CODE:a=!0;break}break}else a=!0;p&&(c=c==t.CODE_A?t.CODE_B:t.CODE_A)}return i===null||(i.end=t._nextUnset(t._row,i.end),!t._verifyTrailingWhitespace(i))||(f-=l*h[h.length-1],f%103!=h[h.length-1])||!u.length?null:(u.splice(u.length-1,1),{code:u.join(""),start:n.start,end:i.end,codeset:c,startInfo:n,decodedCodes:d,endInfo:i})},e.prototype._verifyTrailingWhitespace=function(t){var n=this,i;return i=t.end+(t.end-t.start)/2,i<n._row.length&&n._matchRange(t.end,i,0)?t:null},r}),B("ean_reader",["./barcode_reader"],function(e){function r(t){e.call(this,t)}var o={CODE_L_START:{value:0},MODULO:{value:7},CODE_G_START:{value:10},START_PATTERN:{value:[1/3*7,1/3*7,1/3*7]},STOP_PATTERN:{value:[1/3*7,1/3*7,1/3*7]},MIDDLE_PATTERN:{value:[1/5*7,1/5*7,1/5*7,1/5*7,1/5*7]},CODE_PATTERN:{value:[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2],[1,1,2,3],[1,2,2,2],[2,2,1,2],[1,1,4,1],[2,3,1,1],[1,3,2,1],[4,1,1,1],[2,1,3,1],[3,1,2,1],[2,1,1,3]]},CODE_FREQUENCY:{value:[0,11,13,14,19,25,28,21,22,26]},SINGLE_CODE_ERROR:{value:.67},AVG_CODE_ERROR:{value:.27},FORMAT:{value:"ean_13",writeable:!1}};return r.prototype=Object.create(e.prototype,o),r.prototype.constructor=r,r.prototype._decodeCode=function(t,n){var i=[0,0,0,0],a,u=this,l=t,f=!u._row[l],c=0,h={error:Number.MAX_VALUE,code:-1,start:t,end:t},d,s,p;for(n||(n=u.CODE_PATTERN.length),a=l;a<u._row.length;a++)if(u._row[a]^f)i[c]++;else{if(c===i.length-1){if(p=u._normalize(i),p){for(d=0;d<n;d++)s=u._matchPattern(p,u.CODE_PATTERN[d]),s<h.error&&(h.code=d,h.error=s);return h.end=a,h.error>u.AVG_CODE_ERROR?null:h}}else c++;i[c]=1,f=!f}return null},r.prototype._findPattern=function(t,n,i,a,u){var l=[],f=this,c,h=0,d={error:Number.MAX_VALUE,code:-1,start:0,end:0},s,p,g,y;for(n||(n=f._nextSet(f._row)),i===void 0&&(i=!1),a===void 0&&(a=!0),u===void 0&&(u=f.AVG_CODE_ERROR),c=0;c<t.length;c++)l[c]=0;for(c=n;c<f._row.length;c++)if(f._row[c]^i)l[h]++;else{if(h===l.length-1){for(g=0,p=0;p<l.length;p++)g+=l[p];if(y=f._normalize(l),y&&(s=f._matchPattern(y,t),s<u))return d.error=s,d.start=c-g,d.end=c,d;if(a){for(p=0;p<l.length-2;p++)l[p]=l[p+2];l[l.length-2]=0,l[l.length-1]=0,h--}else return null}else h++;l[h]=1,i=!i}return null},r.prototype._findStart=function(){for(var t=this,n,i=t._nextSet(t._row),a;!a;){if(a=t._findPattern(t.START_PATTERN,i),!a)return null;if(n=a.start-(a.end-a.start),n>=0&&t._matchRange(n,a.start,0))return a;i=a.end,a=null}},r.prototype._verifyTrailingWhitespace=function(t){var n=this,i;return i=t.end+(t.end-t.start),i<n._row.length&&n._matchRange(t.end,i,0)?t:null},r.prototype._findEnd=function(t,n){var i=this,a=i._findPattern(i.STOP_PATTERN,t,n,!1);return a!==null?i._verifyTrailingWhitespace(a):null},r.prototype._calculateFirstDigit=function(t){var n,i=this;for(n=0;n<i.CODE_FREQUENCY.length;n++)if(t===i.CODE_FREQUENCY[n])return n;return null},r.prototype._decodePayload=function(t,n,i){var a,u=this,l=0,f;for(a=0;a<6;a++){if(t=u._decodeCode(t.end),!t)return null;t.code>=u.CODE_G_START?(t.code=t.code-u.CODE_G_START,l|=1<<5-a):l|=0<<5-a,n.push(t.code),i.push(t)}if(f=u._calculateFirstDigit(l),f===null||(n.unshift(f),t=u._findPattern(u.MIDDLE_PATTERN,t.end,!0,!1),t===null))return null;for(i.push(t),a=0;a<6;a++){if(t=u._decodeCode(t.end,u.CODE_G_START),!t)return null;i.push(t),n.push(t.code)}return t},r.prototype._decode=function(){var t,n=this,i,a=[],u=[];return t=n._findStart(),!t||(i={code:t.code,start:t.start,end:t.end},u.push(i),i=n._decodePayload(i,a,u),!i)||(i=n._findEnd(i.end,!1),!i)||(u.push(i),!n._checksum(a))?null:{code:a.join(""),start:t.start,end:i.end,codeset:"",startInfo:t,decodedCodes:u}},r.prototype._checksum=function(t){var n=0,i;for(i=t.length-2;i>=0;i-=2)n+=t[i];for(n*=3,i=t.length-1;i>=0;i-=2)n+=t[i];return n%10===0},r}),B("code_39_reader",["./barcode_reader","./array_helper"],function(e,r){function o(){e.call(this)}var t={ALPHABETH_STRING:{value:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. *$/+%"},ALPHABET:{value:[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,45,46,32,42,36,47,43,37]},CHARACTER_ENCODINGS:{value:[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,148,168,162,138,42]},ASTERISK:{value:148},FORMAT:{value:"code_39",writeable:!1}};return o.prototype=Object.create(e.prototype,t),o.prototype.constructor=o,o.prototype._toCounters=function(n,i){var a=this,u=i.length,l=a._row.length,f=!a._row[n],c,h=0;for(r.init(i,0),c=n;c<l;c++)if(a._row[c]^f)i[h]++;else{if(h++,h===u)break;i[h]=1,f=!f}return i},o.prototype._decode=function(){var n=this,i=[0,0,0,0,0,0,0,0,0],a=[],u=n._findStart(),l,f,c,h;if(!u)return null;h=n._nextSet(n._row,u.end);do{if(i=n._toCounters(h,i),c=n._toPattern(i),c<0||(l=n._patternToChar(c),l<0))return null;a.push(l),f=h,h+=r.sum(i),h=n._nextSet(n._row,h)}while(l!=="*");return a.pop(),!a.length||!n._verifyTrailingWhitespace(f,h,i)?null:{code:a.join(""),start:u.start,end:h,startInfo:u,decodedCodes:a}},o.prototype._verifyTrailingWhitespace=function(n,i,a){var u,l=r.sum(a);return u=i-n-l,u*3>=l},o.prototype._patternToChar=function(n){var i,a=this;for(i=0;i<a.CHARACTER_ENCODINGS.length;i++)if(a.CHARACTER_ENCODINGS[i]===n)return String.fromCharCode(a.ALPHABET[i])},o.prototype._findNextWidth=function(n,i){var a,u=Number.MAX_VALUE;for(a=0;a<n.length;a++)n[a]<u&&n[a]>i&&(u=n[a]);return u},o.prototype._toPattern=function(n){for(var i=n.length,a=0,u=i,l=0,f=this,c,h;u>3;){for(a=f._findNextWidth(n,a),u=0,c=0,h=0;h<i;h++)n[h]>a&&(c|=1<<i-1-h,u++,l+=n[h]);if(u===3){for(h=0;h<i&&u>0;h++)if(n[h]>a&&(u--,n[h]*2>=l))return-1;return c}}return-1},o.prototype._findStart=function(){var n=this,i=n._nextSet(n._row),a=i,u=[0,0,0,0,0,0,0,0,0],l=0,f=!1,c,h,d;for(c=i;c<n._row.length;c++)if(n._row[c]^f)u[l]++;else{if(l===u.length-1){if(n._toPattern(u)===n.ASTERISK&&(d=Math.floor(Math.max(0,a-(c-a)/4)),n._matchRange(d,a,0)))return{start:a,end:c};for(a+=u[0]+u[1],h=0;h<7;h++)u[h]=u[h+2];u[7]=0,u[8]=0,l--}else l++;u[l]=1,f=!f}return null},o}),B("code_39_vin_reader",["./code_39_reader"],function(e){function r(){e.call(this)}var o={IOQ:/[IOQ]/g,AZ09:/[A-Z0-9]{17}/};return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._decode=function(){var t=e.prototype._decode.apply(this);if(!t)return null;var n=t.code;if(n)return n=n.replace(o.IOQ,""),n.match(o.AZ09)?this._checkChecksum(n)?(t.code=n,t):null:(console.log("Failed AZ09 pattern code:",n),null)},r.prototype._checkChecksum=function(t){return!!t},r}),B("codabar_reader",["./barcode_reader"],function(e){function r(){e.call(this),this._counters=[]}var o={ALPHABETH_STRING:{value:"0123456789-$:/.+ABCD"},ALPHABET:{value:[48,49,50,51,52,53,54,55,56,57,45,36,58,47,46,43,65,66,67,68]},CHARACTER_ENCODINGS:{value:[3,6,9,96,18,66,33,36,48,72,12,24,69,81,84,21,26,41,11,14]},START_END:{value:[26,41,11,14]},MIN_ENCODED_CHARS:{value:4},MAX_ACCEPTABLE:{value:2},PADDING:{value:1.5},FORMAT:{value:"codabar",writeable:!1}};return r.prototype=Object.create(e.prototype,o),r.prototype.constructor=r,r.prototype._decode=function(){var t=this,n=[],i,a,u,l,f;if(this._counters=t._fillCounters(),i=t._findStart(),!i)return null;l=i.startCounter;do{if(u=t._toPattern(l),u<0||(a=t._patternToChar(u),a<0))return null;if(n.push(a),l+=8,n.length>1&&t._isStartEnd(u))break}while(l<t._counters.length);return n.length-2<t.MIN_ENCODED_CHARS||!t._isStartEnd(u)||!t._verifyWhitespace(i.startCounter,l-8)||!t._validateResult(n,i.startCounter)?null:(l=l>t._counters.length?t._counters.length:l,f=i.start+t._sumCounters(i.startCounter,l-8),{code:n.join(""),start:i.start,end:f,startInfo:i,decodedCodes:n})},r.prototype._verifyWhitespace=function(t,n){return(t-1<=0||this._counters[t-1]>=this._calculatePatternLength(t)/2)&&(n+8>=this._counters.length||this._counters[n+7]>=this._calculatePatternLength(n)/2)},r.prototype._calculatePatternLength=function(t){var n,i=0;for(n=t;n<t+7;n++)i+=this._counters[n];return i},r.prototype._thresholdResultPattern=function(t,n){var i=this,a={space:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}},bar:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}}},u,l,f,c,h=n,d;for(f=0;f<t.length;f++){for(d=i._charToPattern(t[f]),c=6;c>=0;c--)u=(c&1)===2?a.bar:a.space,l=(d&1)===1?u.wide:u.narrow,l.size+=i._counters[h+c],l.counts++,d>>=1;h+=8}return["space","bar"].forEach(function(s){var p=a[s];p.wide.min=Math.floor((p.narrow.size/p.narrow.counts+p.wide.size/p.wide.counts)/2),p.narrow.max=Math.ceil(p.wide.min),p.wide.max=Math.ceil((p.wide.size*i.MAX_ACCEPTABLE+i.PADDING)/p.wide.counts)}),a},r.prototype._charToPattern=function(t){var n=this,i=t.charCodeAt(0),a;for(a=0;a<n.ALPHABET.length;a++)if(n.ALPHABET[a]===i)return n.CHARACTER_ENCODINGS[a];return 0},r.prototype._validateResult=function(t,n){var i=this,a=i._thresholdResultPattern(t,n),u,l,f,c,h,d=n,s;for(u=0;u<t.length;u++){for(s=i._charToPattern(t[u]),l=6;l>=0;l--){if(f=l&1?a.space:a.bar,c=(s&1)===1?f.wide:f.narrow,h=i._counters[d+l],h<c.min||h>c.max)return!1;s>>=1}d+=8}return!0},r.prototype._patternToChar=function(t){var n,i=this;for(n=0;n<i.CHARACTER_ENCODINGS.length;n++)if(i.CHARACTER_ENCODINGS[n]===t)return String.fromCharCode(i.ALPHABET[n]);return-1},r.prototype._computeAlternatingThreshold=function(t,n){var i,a=Number.MAX_VALUE,u=0,l;for(i=t;i<n;i+=2)l=this._counters[i],l>u&&(u=l),l<a&&(a=l);return(a+u)/2|0},r.prototype._toPattern=function(t){var n=7,i=t+n,a,u,l=1<<n-1,f=0,c,h;if(i>this._counters.length)return-1;for(a=this._computeAlternatingThreshold(t,i),u=this._computeAlternatingThreshold(t+1,i),c=0;c<n;c++)h=c&1?u:a,this._counters[t+c]>h&&(f|=l),l>>=1;return f},r.prototype._isStartEnd=function(t){var n;for(n=0;n<this.START_END.length;n++)if(this.START_END[n]===t)return!0;return!1},r.prototype._sumCounters=function(t,n){var i,a=0;for(i=t;i<n;i++)a+=this._counters[i];return a},r.prototype._findStart=function(){var t=this,n,i,a=t._nextUnset(t._row),u;for(n=1;n<this._counters.length;n++)if(i=t._toPattern(n),i!==-1&&t._isStartEnd(i))return a+=t._sumCounters(0,n),u=a+t._sumCounters(n,n+8),{start:a,end:u,startCounter:n,endCounter:n+8}},r}),B("upc_reader",["./ean_reader"],function(e){function r(){e.call(this)}var o={FORMAT:{value:"upc_a",writeable:!1}};return r.prototype=Object.create(e.prototype,o),r.prototype.constructor=r,r.prototype._decode=function(){var t=e.prototype._decode.call(this);return t&&t.code&&t.code.length===13&&t.code.charAt(0)==="0"?(t.code=t.code.substring(1),t):null},r}),B("ean_8_reader",["./ean_reader"],function(e){function r(){e.call(this)}var o={FORMAT:{value:"ean_8",writeable:!1}};return r.prototype=Object.create(e.prototype,o),r.prototype.constructor=r,r.prototype._decodePayload=function(t,n,i){var a,u=this;for(a=0;a<4;a++){if(t=u._decodeCode(t.end,u.CODE_G_START),!t)return null;n.push(t.code),i.push(t)}if(t=u._findPattern(u.MIDDLE_PATTERN,t.end,!0,!1),t===null)return null;for(i.push(t),a=0;a<4;a++){if(t=u._decodeCode(t.end,u.CODE_G_START),!t)return null;i.push(t),n.push(t.code)}return t},r}),B("upc_e_reader",["./ean_reader"],function(e){function r(){e.call(this)}var o={CODE_FREQUENCY:{value:[[56,52,50,49,44,38,35,42,41,37],[7,11,13,14,19,25,28,21,22,26]]},STOP_PATTERN:{value:[1/6*7,1/6*7,1/6*7,1/6*7,1/6*7,1/6*7]},FORMAT:{value:"upc_e",writeable:!1}};return r.prototype=Object.create(e.prototype,o),r.prototype.constructor=r,r.prototype._decodePayload=function(t,n,i){var a,u=this,l=0;for(a=0;a<6;a++){if(t=u._decodeCode(t.end),!t)return null;t.code>=u.CODE_G_START&&(t.code=t.code-u.CODE_G_START,l|=1<<5-a),n.push(t.code),i.push(t)}return u._determineParity(l,n)?t:null},r.prototype._determineParity=function(t,n){var i=this,a,u;for(u=0;u<i.CODE_FREQUENCY.length;u++)for(a=0;a<i.CODE_FREQUENCY[u].length;a++)if(t===i.CODE_FREQUENCY[u][a])return n.unshift(u),n.push(a),!0;return!1},r.prototype._convertToUPCA=function(t){var n=[t[0]],i=t[t.length-2];return i<=2?n=n.concat(t.slice(1,3)).concat([i,0,0,0,0]).concat(t.slice(3,6)):i===3?n=n.concat(t.slice(1,4)).concat([0,0,0,0,0]).concat(t.slice(4,6)):i===4?n=n.concat(t.slice(1,5)).concat([0,0,0,0,0,t[5]]):n=n.concat(t.slice(1,6)).concat([0,0,0,0,i]),n.push(t[t.length-1]),n},r.prototype._checksum=function(t){return e.prototype._checksum.call(this,this._convertToUPCA(t))},r.prototype._findEnd=function(t,n){return n=!0,e.prototype._findEnd.call(this,t,n)},r.prototype._verifyTrailingWhitespace=function(t){var n=this,i;if(i=t.end+(t.end-t.start)/2,i<n._row.length&&n._matchRange(t.end,i,0))return t},r}),B("html_utils",[],function(){function e(o){var t=document.createElement("div");for(t.innerHTML=o;t.firstChild;)return t.firstChild}function r(o,t){for(var n in t)try{t[n].constructor==Object?o[n]=r(o[n],t[n]):o[n]=t[n]}catch{o[n]=t[n]}return o}return{createNode:function(o){return e(o)},mergeObjects:function(o,t){return r(o,t)}}}),B("i2of5_reader",["./barcode_reader","./html_utils"],function(e,r){function o(u){u=r.mergeObjects(t(),u),e.call(this,u),this.barSpaceRatio=[1,1],u.normalizeBarSpaceWidth&&(this.SINGLE_CODE_ERROR=.38,this.AVG_CODE_ERROR=.09)}function t(){var u={};return Object.keys(o.CONFIG_KEYS).forEach(function(l){u[l]=o.CONFIG_KEYS[l].default}),u}var n=1,i=3,a={MODULO:{value:10},START_PATTERN:{value:[n*2.5,n*2.5,n*2.5,n*2.5]},STOP_PATTERN:{value:[n*2,n*2,i*2]},CODE_PATTERN:{value:[[n,n,i,i,n],[i,n,n,n,i],[n,i,n,n,i],[i,i,n,n,n],[n,n,i,n,i],[i,n,i,n,n],[n,i,i,n,n],[n,n,n,i,i],[i,n,n,i,n],[n,i,n,i,n]]},SINGLE_CODE_ERROR:{value:.78,writable:!0},AVG_CODE_ERROR:{value:.38,writable:!0},MAX_CORRECTION_FACTOR:{value:5},FORMAT:{value:"i2of5"}};return o.prototype=Object.create(e.prototype,a),o.prototype.constructor=o,o.prototype._matchPattern=function(u,l){if(this.config.normalizeBarSpaceWidth){var f,c=[0,0],h=[0,0],d=[0,0],s=this.MAX_CORRECTION_FACTOR,p=1/s;for(f=0;f<u.length;f++)c[f%2]+=u[f],h[f%2]+=l[f];for(d[0]=h[0]/c[0],d[1]=h[1]/c[1],d[0]=Math.max(Math.min(d[0],s),p),d[1]=Math.max(Math.min(d[1],s),p),this.barSpaceRatio=d,f=0;f<u.length;f++)u[f]*=this.barSpaceRatio[f%2]}return e.prototype._matchPattern.call(this,u,l)},o.prototype._findPattern=function(u,l,f,c){var h=[],d=this,s,p=0,g={error:Number.MAX_VALUE,code:-1,start:0,end:0},y,_,x,b,v=d.AVG_CODE_ERROR;for(f=f||!1,c=c||!1,l||(l=d._nextSet(d._row)),s=0;s<u.length;s++)h[s]=0;for(s=l;s<d._row.length;s++)if(d._row[s]^f)h[p]++;else{if(p===h.length-1){for(x=0,_=0;_<h.length;_++)x+=h[_];if(b=d._normalize(h),b&&(y=d._matchPattern(b,u),y<v))return g.error=y,g.start=s-x,g.end=s,g;if(c){for(_=0;_<h.length-2;_++)h[_]=h[_+2];h[h.length-2]=0,h[h.length-1]=0,p--}else return null}else p++;h[p]=1,f=!f}return null},o.prototype._findStart=function(){for(var u=this,l,f=u._nextSet(u._row),c,h=1;!c;){if(c=u._findPattern(u.START_PATTERN,f,!1,!0),!c)return null;if(h=Math.floor((c.end-c.start)/4),l=c.start-h*10,l>=0&&u._matchRange(l,c.start,0))return c;f=c.end,c=null}},o.prototype._verifyTrailingWhitespace=function(u){var l=this,f;return f=u.end+(u.end-u.start)/2,f<l._row.length&&l._matchRange(u.end,f,0)?u:null},o.prototype._findEnd=function(){var u=this,l,f;return u._row.reverse(),l=u._findPattern(u.STOP_PATTERN),u._row.reverse(),l===null?null:(f=l.start,l.start=u._row.length-l.end,l.end=u._row.length-f,l!==null?u._verifyTrailingWhitespace(l):null)},o.prototype._decodePair=function(u){var l,f,c=[],h=this;for(l=0;l<u.length;l++){if(f=h._decodeCode(u[l]),!f)return null;c.push(f)}return c},o.prototype._decodeCode=function(u){var l,f=this,c=0,h,d,s=f.AVG_CODE_ERROR,p,g={error:Number.MAX_VALUE,code:-1,start:0,end:0};for(l=0;l<u.length;l++)c+=u[l];if(h=f._normalize(u),h){for(p=0;p<f.CODE_PATTERN.length;p++)d=f._matchPattern(h,f.CODE_PATTERN[p]),d<g.error&&(g.code=p,g.error=d);if(g.error<s)return g}return null},o.prototype._decodePayload=function(u,l,f){for(var c,h=this,d=0,s=u.length,p=[[0,0,0,0,0],[0,0,0,0,0]],g;d<s;){for(c=0;c<5;c++)p[0][c]=u[d]*this.barSpaceRatio[0],p[1][c]=u[d+1]*this.barSpaceRatio[1],d+=2;if(g=h._decodePair(p),!g)return null;for(c=0;c<g.length;c++)l.push(g[c].code+""),f.push(g[c])}return g},o.prototype._verifyCounterLength=function(u){return u.length%10===0},o.prototype._decode=function(){var u,l,f=this,c,h=[],d=[],s;return u=f._findStart(),!u||(d.push(u),l=f._findEnd(),!l)||(s=f._fillCounters(u.end,l.start,!1),!f._verifyCounterLength(s))||(c=f._decodePayload(s,h,d),!c)||h.length%2!==0||h.length<6?null:(d.push(l),{code:h.join(""),start:u.start,end:l.end,startInfo:u,decodedCodes:d})},o.CONFIG_KEYS={normalizeBarSpaceWidth:{type:"boolean",default:!1,description:"If true, the reader tries to normalize thewidth-difference between bars and spaces"}},o}),B("barcode_decoder",["bresenham","image_debug","code_128_reader","ean_reader","code_39_reader","code_39_vin_reader","codabar_reader","upc_reader","ean_8_reader","upc_e_reader","i2of5_reader"],function(e,r,o,t,n,i,a,u,l,f,c){var h={code_128_reader:o,ean_reader:t,ean_8_reader:l,code_39_reader:n,code_39_vin_reader:i,codabar_reader:a,upc_reader:u,upc_e_reader:f,i2of5_reader:c},d={create:function(s,p){var g={ctx:{frequency:null,pattern:null,overlay:null},dom:{frequency:null,pattern:null,overlay:null}},y=[];_(),x(),b();function _(){if(typeof document<"u"){var R=document.querySelector("#debug.detection");g.dom.frequency=document.querySelector("canvas.frequency"),g.dom.frequency||(g.dom.frequency=document.createElement("canvas"),g.dom.frequency.className="frequency",R&&R.appendChild(g.dom.frequency)),g.ctx.frequency=g.dom.frequency.getContext("2d"),g.dom.pattern=document.querySelector("canvas.patternBuffer"),g.dom.pattern||(g.dom.pattern=document.createElement("canvas"),g.dom.pattern.className="patternBuffer",R&&R.appendChild(g.dom.pattern)),g.ctx.pattern=g.dom.pattern.getContext("2d"),g.dom.overlay=document.querySelector("canvas.drawingBuffer"),g.dom.overlay&&(g.ctx.overlay=g.dom.overlay.getContext("2d"))}}function x(){s.readers.forEach(function(R){var S,k={};typeof R=="object"?(S=R.format,k=R.config):typeof R=="string"&&(S=R),y.push(new h[S](k))}),console.log("Registered Readers: "+y.map(function(R){return JSON.stringify({format:R.FORMAT,config:R.config})}).join(", "))}function b(){if(typeof document<"u"){var R,S=[{node:g.dom.frequency,prop:s.showFrequency},{node:g.dom.pattern,prop:s.showPattern}];for(R=0;R<S.length;R++)S[R].prop===!0?S[R].node.style.display="block":S[R].node.style.display="none"}}function v(R,S,k){function j(O){var W={y:O*Math.sin(S),x:O*Math.cos(S)};R[0].y-=W.y,R[0].x-=W.x,R[1].y+=W.y,R[1].x+=W.x}for(j(k);k>1&&(!p.inImageWithBorder(R[0],0)||!p.inImageWithBorder(R[1],0));)k-=Math.ceil(k/2),j(-k);return R}function E(R){return[{x:(R[1][0]-R[0][0])/2+R[0][0],y:(R[1][1]-R[0][1])/2+R[0][1]},{x:(R[3][0]-R[2][0])/2+R[2][0],y:(R[3][1]-R[2][1])/2+R[2][1]}]}function w(R){var S=null,k,j=e.getBarcodeLine(p,R[0],R[1]);for(s.showFrequency&&(r.drawPath(R,{x:"x",y:"y"},g.ctx.overlay,{color:"red",lineWidth:3}),e.debug.printFrequency(j.line,g.dom.frequency)),e.toBinaryLine(j),s.showPattern&&e.debug.printPattern(j.line,g.dom.pattern),k=0;k<y.length&&S===null;k++)S=y[k].decodePattern(j.line);return S===null?null:{codeResult:S,barcodeLine:j}}function T(R,S,k){var j=Math.sqrt(Math.pow(R[1][0]-R[0][0],2)+Math.pow(R[1][1]-R[0][1],2)),O,W=16,$=null,D,P,N=Math.sin(k),I=Math.cos(k);for(O=1;O<W&&$===null;O++)D=j/W*O*(O%2===0?-1:1),P={y:D*N,x:D*I},S[0].y+=P.x,S[0].x-=P.y,S[1].y+=P.x,S[1].x-=P.y,$=w(S);return $}function z(R){return Math.sqrt(Math.pow(Math.abs(R[1].y-R[0].y),2)+Math.pow(Math.abs(R[1].x-R[0].x),2))}function M(R){var S,k,j=g.ctx.overlay,O,W;return s.drawBoundingBox&&j&&r.drawPath(R,{x:0,y:1},j,{color:"blue",lineWidth:2}),S=E(R),W=z(S),k=Math.atan2(S[1].y-S[0].y,S[1].x-S[0].x),S=v(S,k,Math.floor(W*.1)),S===null||(O=w(S),O===null&&(O=T(R,S,k)),O===null)?null:(O&&s.drawScanline&&j&&r.drawPath(S,{x:"x",y:"y"},j,{color:"red",lineWidth:3}),{codeResult:O.codeResult,line:S,angle:k,pattern:O.barcodeLine.line,threshold:O.barcodeLine.threshold})}return{decodeFromBoundingBox:function(R){return M(R)},decodeFromBoundingBoxes:function(R){var S,k;for(S=0;S<R.length;S++)if(k=M(R[S]),k&&k.codeResult)return k.box=R[S],k},setReaders:function(R){s.readers=R,y.length=0,x()}}}};return d}),B("frame_grabber",["cv_utils"],function(e){var r={};return r.create=function(o,t){var n={},i=o.getConfig(),a=e.imageRef(o.getRealWidth(),o.getRealHeight()),u=o.getCanvasSize(),l=e.imageRef(o.getWidth(),o.getHeight()),f=o.getTopRight(),c=f.x,h=f.y,d,s=null,p=null;return d=t||document.createElement("canvas"),d.width=u.x,d.height=u.y,s=d.getContext("2d"),p=new Uint8Array(l.x*l.y),console.log("FrameGrabber",JSON.stringify({size:l,topRight:f,videoSize:a,canvasSize:u})),n.attachData=function(g){p=g},n.getData=function(){return p},n.grab=function(){var g=i.halfSample,y=o.getFrame(),_;return y?(s.drawImage(y,0,0,u.x,u.y),_=s.getImageData(c,h,l.x,l.y).data,g?e.grayAndHalfSampleFromCanvasData(_,l,p):e.computeGray(_,p,i),!0):!1},n.getSize=function(){return l},n},r}),B("config",[],function(){var e={inputStream:{name:"Live",type:"LiveStream",constraints:{width:640,height:480,minAspectRatio:0,maxAspectRatio:100,facing:"environment"},area:{top:"0%",right:"0%",left:"0%",bottom:"0%"},singleChannel:!1},tracking:!1,debug:!1,controls:!1,locate:!0,numOfWorkers:4,visual:{show:!0},decoder:{drawBoundingBox:!1,showFrequency:!1,drawScanline:!1,showPattern:!1,readers:["code_128_reader"]},locator:{halfSample:!0,patchSize:"medium",showCanvas:!1,showPatches:!1,showFoundPatches:!1,showSkeleton:!1,showLabels:!1,showPatchLabels:!1,showRemainingPatchLabels:!1,boxFromPatches:{showTransformed:!1,showTransformedBox:!1,showBB:!1}}};return e}),B("events",[],function(){var e=function(){var r={};function o(a){return r[a]||(r[a]={subscribers:[]}),r[a]}function t(){r={}}function n(a,u){a.async?setTimeout(function(){a.callback(u)},4):a.callback(u)}function i(a,u,l){var f;if(typeof u=="function")f={callback:u,async:l};else if(f=u,!f.callback)throw"Callback was not specified on options";o(a).subscribers.push(f)}return{subscribe:function(a,u,l){return i(a,u,l)},publish:function(a,u){var l=o(a),f=l.subscribers;l.subscribers=f.filter(function(c){return n(c,u),!c.once})},once:function(a,u,l){i(a,{callback:u,async:l,once:!0})},unsubscribe:function(a,u){var l;a?(l=o(a),l&&u?l.subscribers=l.subscribers.filter(function(f){return f.callback!==u}):l.subscribers=[]):t()}}}();return e}),B("camera_access",["html_utils"],function(e){var r,o;function t(l,f,c){typeof navigator.getUserMedia<"u"?navigator.getUserMedia(l,function(h){r=h;var d=window.URL&&window.URL.createObjectURL(h)||h;f.apply(null,[d])},c):c(new TypeError("getUserMedia not available"))}function n(l,f){var c=10;function h(){c>0?l.videoWidth>0&&l.videoHeight>0?(console.log(l.videoWidth+"px x "+l.videoHeight+"px"),f()):window.setTimeout(h,500):f("Unable to play video stream. Is webcam working?"),c--}h()}function i(l,f,c){t(l,function(h){f.src=h,o&&f.removeEventListener("loadeddata",o,!1),o=n.bind(null,f,c),f.addEventListener("loadeddata",o,!1),f.play()},function(h){c(h)})}function a(l,f){var c={audio:!1,video:!0},h=e.mergeObjects({width:640,height:480,minAspectRatio:0,maxAspectRatio:100,facing:"environment"},l);if(typeof MediaStreamTrack<"u"&&typeof MediaStreamTrack.getSources<"u")MediaStreamTrack.getSources(function(d){for(var s,p=0;p!=d.length;++p){var g=d[p];g.kind=="video"&&g.facing==h.facing&&(s=g.id)}return c.video={mandatory:{minWidth:h.width,minHeight:h.height,minAspectRatio:h.minAspectRatio,maxAspectRatio:h.maxAspectRatio},optional:[{sourceId:s}]},f(c)});else return c.video={mediaSource:"camera",width:{min:h.width,max:h.width},height:{min:h.height,max:h.height},require:["width","height"]},f(c)}function u(l,f,c){a(f,function(h){i(h,l,c)})}return{request:function(l,f,c){u(l,f,c)},release:function(){var l=r&&r.getVideoTracks();l.length&&l[0].stop(),r=null}}}),B("result_collector",["image_debug"],function(e){function r(t,n){return n?n.some(function(i){return Object.keys(i).every(function(a){return i[a]===t[a]})}):!1}function o(t,n){return typeof n=="function"?n(t):!0}return{create:function(t){var n=document.createElement("canvas"),i=n.getContext("2d"),a=[],u=t.capacity||20,l=t.capture===!0;function f(c){return u&&c&&!r(c,t.blacklist)&&o(c,t.filter)}return{addResult:function(c,h,d){var s={};f(d)&&(u--,s.codeResult=d,l&&(n.width=h.x,n.height=h.y,e.drawImage(c,h,i),s.frame=n.toDataURL()),a.push(s))},getResults:function(){return a}}}}}),B("quagga",["input_stream","image_wrapper","barcode_locator","barcode_decoder","frame_grabber","html_utils","config","events","camera_access","image_debug","result_collector"],function(e,r,o,t,n,i,a,u,l,f,c){var h,d,s,p={ctx:{image:null,overlay:null},dom:{image:null,overlay:null}},g,y,_,x=[],b=!0,v;function E(C){S(C),_=t.create(a.decoder,g)}function w(){if(typeof document<"u")for(var C=[{node:document.querySelector("div[data-controls]"),prop:a.controls},{node:p.dom.overlay,prop:a.visual.show}],A=0;A<C.length;A++)C[A].node&&(C[A].prop===!0?C[A].node.style.display="block":C[A].node.style.display="none")}function T(C){var A;if(a.inputStream.type=="VideoStream")A=document.createElement("video"),h=e.createVideoStream(A);else if(a.inputStream.type=="ImageStream")h=e.createImageStream();else if(a.inputStream.type=="LiveStream"){var U=document.querySelector("#interactive.viewport");U&&(A=U.querySelector("video"),A||(A=document.createElement("video"),U.appendChild(A))),h=e.createLiveStream(A),l.request(A,a.inputStream.constraints,function(H){if(!H)h.trigger("canrecord");else return C(H)})}h.setAttribute("preload","auto"),h.setAttribute("autoplay",!0),h.setInputStream(a.inputStream),h.addEventListener("canrecord",z.bind(void 0,C))}function z(C){o.checkImageConstraints(h,a.locator),R(),d=n.create(h,p.dom.image),w(),a.numOfWorkers>0?P(function(){console.log("Workers created"),M(C)}):(E(),M(C))}function M(C){h.play(),C()}function R(){if(typeof document<"u"){var C=document.querySelector("#interactive.viewport");if(p.dom.image=document.querySelector("canvas.imgBuffer"),p.dom.image||(p.dom.image=document.createElement("canvas"),p.dom.image.className="imgBuffer",C&&a.inputStream.type=="ImageStream"&&C.appendChild(p.dom.image)),p.ctx.image=p.dom.image.getContext("2d"),p.dom.image.width=h.getCanvasSize().x,p.dom.image.height=h.getCanvasSize().y,p.dom.overlay=document.querySelector("canvas.drawingBuffer"),!p.dom.overlay){p.dom.overlay=document.createElement("canvas"),p.dom.overlay.className="drawingBuffer",C&&C.appendChild(p.dom.overlay);var A=document.createElement("br");A.setAttribute("clear","all"),C&&C.appendChild(A)}p.ctx.overlay=p.dom.overlay.getContext("2d"),p.dom.overlay.width=h.getCanvasSize().x,p.dom.overlay.height=h.getCanvasSize().y}}function S(C){C?g=C:g=new r({x:h.getWidth(),y:h.getHeight()}),console.log(g.size),y=[m.create([0,0]),m.create([0,g.size.y]),m.create([g.size.x,g.size.y]),m.create([g.size.x,0])],o.init(g,a.locator)}function k(){return a.locate?o.locate():[[m.create(y[0]),m.create(y[1]),m.create(y[2]),m.create(y[3])]]}function j(C){var A=h.getTopRight(),U=A.x,H=A.y,V;if(!C||U===0&&H===0)return;if(C.line&&C.line.length===2&&ue(C.line),C.boxes&&C.boxes.length>0)for(V=0;V<C.boxes.length;V++)Z(C.boxes[V]);function Z(ne){for(var fe=ne.length;fe--;)ne[fe][0]+=U,ne[fe][1]+=H}function ue(ne){ne[0].x+=U,ne[0].y+=H,ne[1].x+=U,ne[1].y+=H}}function O(C,A){b&&(j(C),A&&C&&C.codeResult&&v&&v.addResult(A,h.getCanvasSize(),C.codeResult)),u.publish("processed",C),C&&C.codeResult&&u.publish("detected",C)}function W(){var C,A;A=k(),A?(C=_.decodeFromBoundingBoxes(A),C=C||{},C.boxes=A,O(C,g.data)):O()}function $(){var C;if(b){if(x.length>0)if(C=x.filter(function(A){return!A.busy})[0],C)d.attachData(C.imageData);else return;else d.attachData(g.data);d.grab()&&(C?(C.busy=!0,C.worker.postMessage({cmd:"process",imageData:C.imageData},[C.imageData.buffer])):W())}else W()}function D(){s=!1,function C(){s||($(),b&&a.inputStream.type=="LiveStream"&&window.requestAnimFrame(C))}()}function P(C){var A;for(x=[],A=0;A<a.numOfWorkers;A++)N(U);function U(H){x.push(H),x.length>=a.numOfWorkers&&C()}}function N(C){var A,U={worker:void 0,imageData:new Uint8Array(h.getWidth()*h.getHeight()),busy:!0};A=L(),U.worker=new Worker(A),U.worker.onmessage=function(H){if(H.data.event==="initialized")return URL.revokeObjectURL(A),U.busy=!1,U.imageData=new Uint8Array(H.data.imageData),console.log("Worker initialized"),C(U);H.data.event==="processed"?(U.imageData=new Uint8Array(H.data.imageData),U.busy=!1,O(H.data.result,U.imageData)):H.data.event==="error"&&console.log("Worker error: "+H.data.message)},U.worker.postMessage({cmd:"init",size:{x:h.getWidth(),y:h.getHeight()},imageData:U.imageData,config:a},[U.imageData.buffer])}function I(C){if(C){var A=C();if(!A){self.postMessage({event:"error",message:"Quagga could not be created"});return}}var U;self.onmessage=function(Z){if(Z.data.cmd==="init"){var ue=Z.data.config;ue.numOfWorkers=0,U=new A.ImageWrapper({x:Z.data.size.x,y:Z.data.size.y},new Uint8Array(Z.data.imageData)),A.init(ue,V,U),A.onProcessed(H)}else Z.data.cmd==="process"?(U.data=new Uint8Array(Z.data.imageData),A.start()):Z.data.cmd==="setReaders"&&A.setReaders(Z.data.readers)};function H(Z){self.postMessage({event:"processed",imageData:U.data,result:Z},[U.data.buffer])}function V(){self.postMessage({event:"initialized",imageData:U.data},[U.data.buffer])}}function L(){var C,A;return typeof Q<"u"&&(A=Q),C=new Blob(["("+I.toString()+")("+A+");"],{type:"text/javascript"}),window.URL.createObjectURL(C)}function F(C){_?_.setReaders(C):b&&x.length>0&&x.forEach(function(A){A.worker.postMessage({cmd:"setReaders",readers:C})})}return{init:function(C,A,U){if(a=i.mergeObjects(a,C),U)return b=!1,E(U),A();T(A)},start:function(){D()},stop:function(){s=!0,x.forEach(function(C){C.worker.terminate(),console.log("Worker terminated!")}),x.length=0,a.inputStream.type==="LiveStream"&&(l.release(),h.clearEventHandlers())},pause:function(){s=!0},onDetected:function(C){u.subscribe("detected",C)},offDetected:function(C){u.unsubscribe("detected",C)},onProcessed:function(C){u.subscribe("processed",C)},offProcessed:function(C){u.unsubscribe("processed",C)},setReaders:function(C){F(C)},registerResultCollector:function(C){C&&typeof C.addResult=="function"&&(v=C)},canvas:p,decodeSingle:function(C,A){C=i.mergeObjects({inputStream:{type:"ImageStream",sequence:!1,size:800,src:C.src},numOfWorkers:1,locator:{halfSample:!1}},C),this.init(C,function(){u.once("processed",function(U){s=!0,A.call(null,U)},!0),D()})},ImageWrapper:r,ImageDebug:f,ResultCollector:c}}),J("quagga")})})(Ce);var Le=Ce.exports;const pe=Ae(Le);const me={class:"paginator"},Ue={__name:"TableScan",setup(ee){const Q=re(!1),q=re(!1),J=re(0),B=re(1200),X=re(window.innerHeight-100),Y=re([]),G=re({page:1}),K=[{title:"RUC",dataIndex:"ruc",fixed:"left",width:120},{title:"Razón social",dataIndex:"socialReason",fixed:"left",width:250},{title:"Rubro",dataIndex:"category",width:200},{title:"Tipo",dataIndex:"type",align:"center",width:140,filters:[{text:"NATURAL",value:"NATURAL"},{text:"JURIDICA",value:"JURIDICA"}]},{title:"Departamento",dataIndex:"department",width:140},{title:"Distrito",dataIndex:"district",width:130},{title:"Nombres y Apellidos",dataIndex:"nameComplete",width:300},{title:"DNI",dataIndex:"dniNumber",align:"center",width:120},{title:"Sexo",dataIndex:"sex",align:"center",width:130},{title:"Teléfono",dataIndex:"phone",align:"center",width:130},{title:"Email",dataIndex:"email",width:300}],m=()=>{X.value=window.innerHeight-300};Te(()=>{window.removeEventListener("resize",m)});const e=n=>{G.value.page=n,t()},r=()=>{},o=(n,i,a)=>{console.log("88a8a8a8a",i.type)},t=async()=>{try{q.value=!0;const n=await Se({url:"/mype",method:"GET",params:G.value});Y.value=n.data,J.value=n.meta.total}catch(n){console.error("Error de red:",n)}finally{q.value=!1}};return De(()=>{t(),window.addEventListener("resize",m),m()}),(n,i)=>{const a=le("a-button"),u=le("a-tag"),l=le("a-table"),f=le("a-pagination");return ae(),ye("div",null,[oe(a,{onClick:r,loading:Q.value},{default:te(()=>i[0]||(i[0]=[ie("img",{width:"20",style:{"margin-right":"6px"},src:Oe},null,-1),se(" CARGAR EXCEL ")])),_:1},8,["loading"]),i[5]||(i[5]=ie("br",null,null,-1)),oe(l,{onChange:o,bordered:"",class:"ant-table-striped",scroll:{x:B.value,y:X.value},columns:K,"data-source":Y.value,pagination:!1,loading:q.value,size:"small"},{bodyCell:te(({column:c,record:h})=>[c.dataIndex=="type"?(ae(),ye(ve,{key:0},[h.type=="NATURAL"?(ae(),ge(u,{key:0,color:"success"},{default:te(()=>i[1]||(i[1]=[se("Natural")])),_:1})):he("",!0),h.type=="JURIDICA"?(ae(),ge(u,{key:1,color:"error"},{default:te(()=>i[2]||(i[2]=[se("Jurídica")])),_:1})):he("",!0)],64)):he("",!0),c.dataIndex=="sex"?(ae(),ye(ve,{key:1},[h.sex=="MASCULINO"?(ae(),ge(u,{key:0,color:"blue"},{default:te(()=>i[3]||(i[3]=[se("Masculino")])),_:1})):he("",!0),h.sex=="FEMENINO"?(ae(),ge(u,{key:1,color:"pink"},{default:te(()=>i[4]||(i[4]=[se("Femenino")])),_:1})):he("",!0)],64)):he("",!0)]),_:1},8,["scroll","data-source","loading"]),ie("div",me,[oe(f,{size:"small",pageSize:50,total:J.value,onChange:e,showSizeChanger:!1},null,8,["total"])])])}}};const Fe={class:"heritage"},Be={ref:"scan-canvas",style:{display:"none"}},je={__name:"PatrimonioIndex",setup(ee){const Q=re(!1),q=re(null),J=re(null),B=re(!1),X=re(null);let Y=null;const G=async()=>{try{const r={video:{facingMode:"environment"}},o=await navigator.mediaDevices.getUserMedia(r);q.value.srcObject=o,Y=o,B.value=!0,pe.init({inputStream:{name:"Live",type:"LiveStream",target:q.value},decoder:{readers:["code_128_reader","ean_reader","upc_reader"]}},t=>{if(t){console.error("Error initializing:",t);return}pe.start()}),pe.onDetected(t=>{pe.stop(),X.value=t.codeResult.code,Q.value=!1,K()})}catch(r){console.error("Error accessing camera:",r)}q.value.addEventListener("loadedmetadata",()=>{J.value.width=q.value.videoWidth,J.value.height=q.value.videoHeight})},K=()=>{console.log("cerrado"),Y&&(Y.getTracks().forEach(o=>o.stop()),q.value.srcObject=null,B.value=!1,pe.stop())},m=()=>{Q.value=!0,G()},e=()=>{K()};return(r,o)=>{const t=le("a-input"),n=le("a-button"),i=le("a-modal");return ae(),ye(ve,null,[ie("div",null,[ie("div",Fe,[oe(t,{value:X.value,"onUpdate:value":o[0]||(o[0]=a=>X.value=a)},{addonAfter:te(()=>[oe(ze(Ne),{onClick:m})]),_:1},8,["value"]),oe(n,{type:"primary"},{default:te(()=>o[2]||(o[2]=[se("Buscar")])),_:1})]),oe(i,{open:Q.value,"onUpdate:open":o[1]||(o[1]=a=>Q.value=a),title:"Scan Code",footer:null,onCancel:e},{default:te(()=>[ie("div",null,[ie("video",{class:"scan-video",ref_key:"video",ref:q,autoplay:""},null,512),ie("canvas",Be,null,512)])]),_:1},8,["open"])]),o[3]||(o[3]=ie("br",null,null,-1)),oe(Ue)],64)}}},Ve=Me(je,[["__scopeId","data-v-8fa2267c"]]);export{Ve as default};
