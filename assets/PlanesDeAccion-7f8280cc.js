import{L as B,r as s,a as W,b as r,o,d as D,c as i,w as d,e as S,F as M,x as j,q as p,s as u,h as x,M as X,i as E,t as V,m as k,z as L,I as J,k as K}from"./index-3cc1e668.js";import"./es-1caad6bf.js";import{u as Q}from"./selectes-19985054.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";const ae={numberDocument:{type:"iSearch",label:"Número de documento",name:"numberDocument",required:!0,message:"Ingresar Número de documento",disabled:!1},namePerson:{type:"iText",label:"Nombre",name:"namePerson",required:!0,message:"Escribe nombre",disabled:!1},city_id:{type:"iSelectWrite",label:"Región del negocio",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelectWrite",label:"Provincia del negocio",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelectWrite",label:"Distrito del negocio",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},gender_id:{type:"iSelect",label:"Género",name:"gender_id",required:!0,message:"Seleccionar género"},sick:{type:"iSelect",label:"¿Tiene discapacidad?",name:"sick",required:!0,message:"Seleccionar estado"},ruc:{type:"iSearch",label:"Número de RUC",name:"ruc",required:!0,message:"Escribe el número de RUC",disabled:!1},divider:{type:"iDivider"},component1:{type:"iSelectWrite",label:"Componente 1",name:"component",required:!0,message:"Seleccionar componente 1",disabled:!1},component2:{type:"iSelectWrite",label:"Componente 2",name:"component",required:!0,message:"Seleccionar componente 2",disabled:!1},component3:{type:"iSelectWrite",label:"Componente 3",name:"component",required:!0,message:"Seleccionar componente 3",disabled:!1},dateStart:{type:"iDate",label:"Día Inicio",name:"dateStart",required:!0,message:"Seleccionar fecha de inicio",placeholder:"año-mes-día"},dateEnd:{type:"iDate",label:"Día Fin",name:"dateEnd",required:!0,message:"Seleccionar fecha de fin",placeholder:"año-mes-día"}};const te={class:"grid-planes"},ne="DD/MM/YYYY",le={__name:"NuevoPlanAccion",emits:["closeDraw"],setup(Z,{emit:N}){B.locale("es");const O=N,c=Q();c.$patch({cities:c.cities}),c.$patch({genders:c.genders}),c.fetchCities(),c.fetchGenders();const w=s(ae),b=s(!1),v=s(null),T=[{value:"FORMALIZACIÓN",label:"FORMALIZACIÓN"},{value:"GESTIÓN EMPRESARIAL",label:"GESTIÓN EMPRESARIAL"},{value:"DIGITALIZACIÓN",label:"DIGITALIZACIÓN"},{value:"DESARROLLO PRODUCTIVO",label:"DESARROLLO PRODUCTIVO"},{value:"ACCESO AL FINANCIAMIENTO",label:"ACCESO AL FINANCIAMIENTO"}],R=[{value:1,label:"DNI"},{value:2,label:"RUC"}],C=[{label:"Si",value:"yes"},{label:"No",value:"no"}],a=W({numberDocument:null}),P=n=>n&&n>B().endOf("day"),f=n=>{a[n]=a[n].replace(/\D/g,"")},I=(n,t)=>{const h=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(h)},U=async n=>{if(!a.numberDocument)return k.warning("Ingrese un número a buscar...");try{if(n=="numberDocument"){v.value=n;const t=await L({url:`person/data/${a.numberDocument}`,method:"GET"});if(console.log("Searching",t),t.status==404)return v.value=null,a.numberDocument=null,k.warning("Este usuario no fue registrado");t.status==200&&(a.namePerson=t.data.namePerson,a.city_id=t.data.city_id,A(t.data.city_id),a.province_id=t.data.province_id,y(t.data.province_id),a.district_id=t.data.district_id,a.gender_id=t.data.gender_id,a.sick=t.data.sick)}if(n=="ruc"&&(v.value=n,(await L({url:`plans-action/list/${a.ruc}`,method:"GET"})).status!=200))return v.value=null,a.ruc=null,k.warning("No se han registrado datos con ese número de RUC")}catch{console.log("Failed to update record")}finally{v.value=null}},A=n=>{a.province_id=null,a.district_id=null,c.fetchProvinces(n)},y=n=>{a.district_id=null,c.fetchDistricts(n)},q=async()=>{b.value=!0;const n={};try{const t=await L({url:`mype/update-by-ruc/${props.info.id}`,method:"PUT",data:n});t.status==200&&(k.success(t.message),O("closeDraw"))}catch{console.log("Failed to update record")}finally{b.value=!1}};return(n,t)=>{const h=r("a-input"),m=r("a-form-item"),g=r("a-select"),z=r("a-input-search"),F=r("a-divider"),$=r("a-date-picker"),G=r("a-button"),Y=r("a-form");return o(),D("div",null,[i(Y,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:q},{default:d(()=>[S("div",te,[(o(!0),D(M,null,j(w.value,(e,_)=>(o(),D(M,{key:_},[e.type==="iText"?(o(),p(m,{key:0,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:d(()=>[i(h,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,maxlength:e.max,disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSelect"?(o(),p(m,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[e.name=="typeDocument"?(o(),p(g,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:R},null,8,["value","onUpdate:value"])):u("",!0),e.name=="gender_id"?(o(),p(g,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:x(c).genders},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="sick"?(o(),p(g,{key:2,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:C},null,8,["value","onUpdate:value"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSearch"?(o(),p(m,{key:2,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[i(z,{loading:v.value==e.name,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,onSearch:l=>U(e.name),onInput:l=>f(e.name),onEnterButton:l=>U(e.name),maxlength:11},null,8,["loading","value","onUpdate:value","onSearch","onInput","onEnterButton"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iDivider"?(o(),p(F,{key:3,dashed:"",style:{"grid-column":"1/3",margin:".5rem 0 1rem 0"}})):u("",!0),e.type==="iSelectWrite"?(o(),p(m,{key:4,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[e.name=="city_id"?(o(),p(g,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:x(c).cities,"filter-option":I,onChange:A},null,8,["value","onUpdate:value","options"])):u("",!0),e.name=="province_id"?(o(),p(g,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:x(c).provinces,"filter-option":I,onChange:y,disabled:!a.city_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),e.name=="district_id"?(o(),p(g,{key:2,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:x(c).districts,"filter-option":I,disabled:!a.province_id},null,8,["value","onUpdate:value","options","disabled"])):u("",!0),e.name=="component"?(o(),p(g,{key:3,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"show-search":"",options:T,"filter-option":I,onChange:A},null,8,["value","onUpdate:value"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iDate"?(o(),p(m,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:d(()=>[i($,{"disabled-date":P,locale:x(X),value:a[e.name],"onUpdate:value":l=>a[e.name]=l,style:{width:"100%"},format:ne,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):u("",!0)],64))),128))]),i(m,null,{default:d(()=>[i(G,{class:"btn-produce",type:"primary","html-type":"submit",loading:b.value},{default:d(()=>[E("GUARDAR")]),_:1},8,["loading"])]),_:1}),S("pre",null,V(v.value),1)]),_:1},8,["model"])])}}},oe=ee(le,[["__scopeId","data-v-7e6e8af1"]]);const ie=S("h3",{class:"title-produce"},"PLANES DE ACCIÓN",-1),se={class:"paginator"},me={__name:"PlanesDeAccion",setup(Z){B.locale("es"),s(null),s(!1),s();const N=s(50),O=s([]),c=s(!1),w=s(0),b=s({page:1}),v=s("user/list-asesories"),T=s(1200),R=s(window.innerHeight-100),C=s(!1);s(null),s([{value:"si",label:"Si"},{value:"no",label:"No"}]);const a=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:50},{title:"CENTRO TU EMPRESA",dataIndex:"tuempresa",width:120},{title:"ASESOR",dataIndex:"lastname",width:180},{title:"REGION DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"PROVINCIA DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"DISTRITO DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"NOMBRE DEL EMPRENDEDOR O MYPE",dataIndex:"lastname",width:170},{title:"RUC",dataIndex:"lastname",width:100,align:"center"},{title:"Genero",dataIndex:"lastname",width:80,align:"center"},{title:"Tiene alguna Discapacidad ? (SI / NO)",dataIndex:"lastname",width:120,align:"center"},{title:"COMPONENTE 1",dataIndex:"lastname",width:180},{title:"COMPONENTE 2",dataIndex:"lastname",width:180},{title:"COMPONENTE 3",dataIndex:"lastname",width:180},{title:"NÚMERO DE SESIONES REALIZADAS",dataIndex:"lastname",width:180},{title:"DÍA INICIO",dataIndex:"lastname",width:120,align:"center"},{title:"DÍA FIN",dataIndex:"lastname",width:120,align:"center"},{title:"TOTAL DE DÍAS",dataIndex:"lastname",width:120},{title:"ACTA DE COMPROMISO",dataIndex:"acta_compromiso",width:180,align:"center"},{title:"CULMINÓ EL PLAN DE ACCIÓN Y ENVIÓ CORREO",dataIndex:"envio_correo",width:180,align:"center"}],P=()=>{R.value=window.innerHeight-315},f=W({search:""}),I=()=>{y({search:f.search})},U=()=>{f.search||y()},A=n=>{b.value.page=n,y()},y=async n=>{try{c.value=!0;const t=b.value.page===1?"":b.value,h=n?{...t,...n}:t,m=await L({url:v.value,method:"GET",params:h});O.value=m.data,w.value=m.total,N.value=m.per_page}catch(t){console.error("Error de red:",t)}finally{c.value=!1}},q=J(()=>n=>(b.value.page-1)*N.value+n+1);return K(()=>{y(),window.addEventListener("resize",P),P()}),(n,t)=>{const h=r("a-button"),m=r("a-col"),g=r("a-input"),z=r("a-input-group"),F=r("a-row"),$=r("a-table"),G=r("a-tag"),Y=r("a-pagination"),e=r("a-drawer");return o(),D("div",null,[ie,i(F,{style:{margin:"1rem 0"}},{default:d(()=>[i(m,{xs:24,md:12,lg:18},{default:d(()=>[i(h,{onClick:t[0]||(t[0]=_=>C.value=!0),type:"primary"},{default:d(()=>[E("Agregar")]),_:1})]),_:1}),i(m,{xs:24,md:12,lg:6},{default:d(()=>[i(z,{compact:""},{default:d(()=>[i(g,{value:f.search,"onUpdate:value":t[1]||(t[1]=_=>f.search=_),style:{width:"calc(100% - 80px)"},onInput:U},null,8,["value"]),i(h,{type:"primary",disabled:f.search==="",onClick:I},{default:d(()=>[E("BUSCAR")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),i($,{bordered:"",scroll:{x:T.value,y:R.value},class:"table-users",columns:a,"data-source":O.value,pagination:!1,loading:c.value,size:"small"},{bodyCell:d(({column:_,record:l,index:H})=>[_.dataIndex==="idx"?(o(),D(M,{key:0},[E(V(q.value(H)),1)],64)):u("",!0),_.dataIndex==="tuempresa"?(o(),D(M,{key:1},[E(" cde Miraflores ")],64)):u("",!0)]),_:1},8,["scroll","data-source","loading"]),S("div",se,[S("span",null,[i(G,{color:"blue"},{default:d(()=>[S("b",null,V(w.value),1)]),_:1}),E("Registros")]),i(Y,{size:"small",total:w.value,pageSize:N.value,onChange:A,showSizeChanger:!1},null,8,["total","pageSize"])]),i(e,{open:C.value,"onUpdate:open":t[3]||(t[3]=_=>C.value=_),title:"Agregar un nuevo Plan de Acción",placement:"right",width:"650"},{default:d(()=>[i(oe,{onCloseDraw:t[2]||(t[2]=_=>n.handleCloseDrawopen(1))})]),_:1},8,["open"])])}}};export{me as default};
