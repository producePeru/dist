import{N as Z,r as a,a as ee,b as t,o as r,s as C,w as o,c as n,e as m,d,F as D,y as ae,h as M,v as f,i as z,B as A,m as h,u as te,x as ne,K as oe,k as se,t as q,a6 as re,X as le}from"./index-b7e174ec.js";import{u as ie}from"./selectes-639f74bd.js";import"./es-cb05a220.js";const ue={token:{type:"iText",label:"Token",name:"token",required:!0,message:"Escribir el token",disabled:!0},name:{type:"iText",label:"Nombre",name:"name",required:!0,message:"Escribir nombre",disabled:!0}},ce={class:"grid-convenios"},de={__name:"NuevoToken",emits:["closeDraw"],setup(P,{emit:E}){Z.locale("es");const p=E,u=a(!1),y=a(!1),i=ee({}),k=()=>{i.token=null,i.name=null},w=async()=>{u.value=!0;const I={token:i.token,name:i.name};try{const c=await A({url:"token/create",method:"POST",data:I});c.status==200&&(h.success(c.message),p("closeDraw",!0),k())}catch(c){h.error("Se originÃ³ un error: "+c.message)}finally{u.value=!1}},_=()=>{h.error("Debes de completar todos los espacios requeridos")};return(I,c)=>{const S=t("a-input"),v=t("a-form-item"),O=t("a-button"),x=t("a-form"),B=t("a-spin");return r(),C(B,{spinning:y.value},{default:o(()=>[n(x,{layout:"vertical",model:i,name:"basic",autocomplete:"off",onFinish:w,onFinishFailed:_},{default:o(()=>[m("div",ce,[(r(!0),d(D,null,ae(M(ue),(l,R)=>(r(),d(D,{key:R},[l.type==="iText"?(r(),C(v,{key:0,name:l.name,label:l.label,rules:[{required:l.required,message:l.message,max:l.max}]},{default:o(()=>[n(S,{value:i[l.name],"onUpdate:value":F=>i[l.name]=F,maxlength:l.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):f("",!0)],64))),128))]),n(v,null,{default:o(()=>[n(O,{type:"primary","html-type":"submit",loading:u.value},{default:o(()=>[z("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])}}};const me=m("h3",{class:"title-produce"},"TOKENS",-1),pe=m("a",{href:"https://apis.net.pe/app/account/signup",target:"_blank"},"Crear cuenta",-1),_e={key:1},ve={key:1},ge={class:"paginator"},ke={__name:"MisTokens",setup(P){const E=ie();E.$patch({cdes:E.cdes});const p=a(!1),u=a(1);a(0);const y=a(50),i=a([]),k=a(!1),w=a(0);te();const _=a({page:0}),I=a("token/list"),c=a(1200),S=a(window.innerHeight-100),v=a(!1),O=[{title:"#",dataIndex:"idx",fixed:"left",align:"center",width:20},{title:"NOMBRE",dataIndex:"name",width:60},{title:"TOKEN",dataIndex:"token",width:120},{title:"TOTAL",dataIndex:"count",width:30,align:"center"},{title:"CREADO",dataIndex:"date",width:50},{title:"ACTIVADO",dataIndex:"status",width:30,align:"center"},{title:"TEST",dataIndex:"test",width:30,align:"center"}],x=()=>{S.value=window.innerHeight-300};ne(()=>{window.removeEventListener("resize",x)});const B=e=>le(e).format("DD/MM/YYYY HH:mm A"),l=async e=>{await A({url:`token/update-status/${e.id}`,method:"PUT"})},R=async()=>{v.value=!0;try{const e=await A({url:"user/only-dni/45424747",method:"GET"});if(e.status==429)return h.warning(e.message);if(e.status==401)return h.error(e.message);h.success("Puedes usar este token")}catch(e){console.error("Error de red:",e)}finally{v.value=!1}},F=()=>{p.value=!0},V=()=>{U(),p.value=!1},Y=e=>{_.value.page=e,U()},U=async e=>{try{k.value=!0;let s;s=_.value.page==0?"":_.value,s=e?{...s,...e}:s;const b=await A({url:I.value,method:"GET",params:s}),T=b.data;i.value=T.data,w.value=T.total,y.value=T.per_page,u.value=b.id_active}catch(s){console.error("Error de red:",s)}finally{k.value=!1}},$=oe(()=>e=>_.value.page*y.value+e+1);return se(()=>{U(),window.addEventListener("resize",x),x()}),(e,s)=>{const b=t("a-button"),T=t("a-col"),H=t("a-row"),G=t("a-radio"),K=t("a-radio-group"),X=t("a-table"),j=t("a-tag"),J=t("a-pagination"),Q=t("a-drawer");return r(),d(D,null,[m("div",null,[me,n(H,{style:{margin:"1rem 0"}},{default:o(()=>[n(T,{xs:24,md:12,lg:18},{default:o(()=>[n(b,{type:"primary",onClick:F,style:{"margin-right":".5rem"}},{default:o(()=>[z("Nuevo Token")]),_:1}),pe]),_:1})]),_:1}),n(X,{bordered:"",scroll:{x:c.value,y:S.value},class:"table-users",columns:O,"data-source":i.value,pagination:!1,loading:k.value,size:"small"},{bodyCell:o(({column:g,record:N,index:W})=>[g.dataIndex=="idx"?(r(),d(D,{key:0},[z(q($.value(W)),1)],64)):f("",!0),g.dataIndex=="date"?(r(),d("div",_e,q(B(N.created_at)),1)):f("",!0),g.dataIndex=="status"?(r(),C(K,{key:2,value:u.value,"onUpdate:value":s[0]||(s[0]=L=>u.value=L),onChange:L=>l(N)},{default:o(()=>[n(G,{value:N.id},null,8,["value"])]),_:2},1032,["value","onChange"])):f("",!0),g.dataIndex=="test"?(r(),d(D,{key:3},[u.value==N.id?(r(),C(b,{key:0,primary:"",type:"text",onClick:R,style:{"font-size":"13px"}},{default:o(()=>[v.value?(r(),C(M(re),{key:0})):(r(),d("span",ve,"PROBAR"))]),_:1})):f("",!0)],64)):f("",!0)]),_:1},8,["scroll","data-source","loading"])]),m("div",ge,[m("span",null,[n(j,{color:"blue"},{default:o(()=>[m("b",null,q(w.value),1)]),_:1}),z("Itens")]),n(J,{size:"small",total:w.value,pageSize:y.value,onChange:Y,showSizeChanger:!1},null,8,["total","pageSize"])]),n(Q,{open:p.value,"onUpdate:open":s[1]||(s[1]=g=>p.value=g),class:"draw-notary","root-class-name":"root-class-name",title:"Tokens",placement:"right",width:"500"},{default:o(()=>[n(de,{onCloseDraw:V})]),_:1},8,["open"])],64)}}};export{ke as default};
