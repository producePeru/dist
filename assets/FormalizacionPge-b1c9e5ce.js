import{F as T,_ as D,a as q}from"./FormalizacionFooter-b6250857.js";import{a as O,r as u,u as S,l as j,n as L,b as c,o as M,d as R,e as s,q as k,c as o,w as i,F as Q,g as y,f as v,m as Y,j as G,p as J,k as V}from"./index-eadd5391.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";const H="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAfCAYAAACYn/8/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABfSURBVHgB7c4hEYBAAAXRDxJFABwhMFQgAflIQAUMEdCEQHIdTuzMzexL8LpnnP9Ums4jw7qkxnfdebc9tfo0yjjNOM04zTjNOM04zTjNOM04zTjNOM04zTjNOK3ZeAGQ1whJsy738gAAAABJRU5ErkJggg==";const f=m=>(J("data-v-8ceb4809"),m=m(),V(),m),K=f(()=>s("div",{class:"container header-wrapper"},[s("img",{src:D,alt:"logo-produce"}),s("img",{src:q,alt:"logo-tu-empresa"})],-1)),$=[K],W={class:"form"},Z={class:"container"},ee={class:"form-wrapper"},ae=f(()=>s("h2",{class:"ff title"},"Formulario de formalización digital",-1)),oe=f(()=>s("h2",{class:"ff title2"},"Paso 1: Registro de datos",-1)),te={class:"number-cel"},le=f(()=>s("div",{class:"flat-51"},[s("img",{src:H,alt:"peru"}),s("span",null,"+51")],-1)),ne={__name:"FormalizacionPge",setup(m){const a=O({dni:null,name_lastname:null,email:null,phone:null,departament:null,province:null,district:null,address:null,id_cde:null}),_=u(!1),N=u(null),g=u(!1),A=u([]),p=u([]),d=u([]),z=S(),F=async()=>{y.remove("formalizacion"),_.value=!0;try{await v({url:"/public/formalization",method:"POST",data:a})&&(y.set("formalization-data",JSON.stringify(a)),z.push({name:"formalizacion-mapa"}))}catch{Y.error("Error al registrar")}finally{_.value=!1}},U=n=>{console.log("Failed:",n)},P=()=>{a.dni=a.dni.replace(/\D/g,"")},b=(n,e)=>{const r=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(r)},C=async()=>{try{const{data:n}=await v({url:"/departaments",method:"GET"});let e=n.map(r=>({label:r.label,value:r.id}));A.value=[...A.value,...e]}catch(n){console.log(n)}},B=async n=>{a.province=null,a.district=null,p.value=[],d.value=[];try{const{data:e}=await v({url:`/province/${n}`,method:"GET"});let r=e.map(t=>({label:t.label,value:t.id}));p.value=[...p.value,...r]}catch(e){console.log(e)}},E=async n=>{a.district=null,d.value=[];try{const{data:e}=await v({url:`/district/${n}`,method:"GET"});let r=e.map(t=>({label:t.label,value:t.id}));d.value=[...d.value,...r]}catch(e){console.log(e)}},w=()=>{window.pageYOffset>10?g.value=!0:g.value=!1};return j(()=>{C(),window.addEventListener("scroll",w)}),L(()=>{window.removeEventListener("scroll",w)}),(n,e)=>{const r=c("a-input"),t=c("a-form-item"),h=c("a-select"),I=c("a-button"),x=c("a-form");return M(),R(Q,null,[s("header",{class:k(["header",{floatingNav:g.value}]),ref_key:"navBar",ref:N},$,2),s("section",W,[s("div",Z,[s("div",ee,[ae,o(x,{class:"form-values",model:a,name:"basic",layout:"vertical",autocomplete:"off",onFinish:F,onFinishFailed:U},{default:i(()=>[oe,o(t,{label:"Número DNI",name:"dni",rules:[{required:!0,message:"Por favor ingresa tu número de DNI",min:8,max:8}]},{default:i(()=>[o(r,{value:a.dni,"onUpdate:value":e[0]||(e[0]=l=>a.dni=l),onInput:P},null,8,["value"])]),_:1}),o(t,{label:"Nombres y Apellidos",name:"name_lastname",rules:[{required:!0,message:"Por favor ingresa tu número de DNI"}]},{default:i(()=>[o(r,{value:a.name_lastname,"onUpdate:value":e[1]||(e[1]=l=>a.name_lastname=l)},null,8,["value"])]),_:1}),o(t,{label:"Correo electrónico",name:"email",rules:[{required:!0,message:"Por favor ingresa tu correo electrónico",type:"email"}]},{default:i(()=>[o(r,{value:a.email,"onUpdate:value":e[2]||(e[2]=l=>a.email=l)},null,8,["value"])]),_:1}),o(t,{label:"Número de celular",name:"phone",rules:[{required:!0,message:"Por favor ingresa tu número de celular",min:9,max:9}]},{default:i(()=>[s("div",te,[le,o(r,{value:a.phone,"onUpdate:value":e[3]||(e[3]=l=>a.phone=l)},null,8,["value"])])]),_:1}),o(t,{label:"Departamento",name:"departament",rules:[{required:!0,message:"Por favor selecciona un departamento"}]},{default:i(()=>[o(h,{value:a.departament,"onUpdate:value":e[4]||(e[4]=l=>a.departament=l),"show-search":"",options:A.value,"filter-option":b,onChange:B},null,8,["value","options"])]),_:1}),o(t,{label:"Provincia",name:"province",rules:[{required:!0,message:"Por favor selecciona tu provincia"}]},{default:i(()=>[o(h,{value:a.province,"onUpdate:value":e[5]||(e[5]=l=>a.province=l),"show-search":"",options:p.value,"filter-option":b,onChange:E},null,8,["value","options"])]),_:1}),o(t,{label:"Distrito",name:"district",rules:[{required:!0,message:"Por favor selecciona tu distrito"}]},{default:i(()=>[o(h,{value:a.district,"onUpdate:value":e[6]||(e[6]=l=>a.district=l),"show-search":"",options:d.value,"filter-option":b},null,8,["value","options"])]),_:1}),o(t,{label:"Dirección",name:"address",rules:[{required:!0,message:"Por favor ingresa tu dirección"}]},{default:i(()=>[o(r,{value:a.address,"onUpdate:value":e[7]||(e[7]=l=>a.address=l)},null,8,["value"])]),_:1}),o(t,null,{default:i(()=>[o(I,{loading:_.value,class:"form-button",type:"primary","html-type":"submit"},{default:i(()=>[G("CONTINUAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])]),o(T)],64)}}},ue=X(ne,[["__scopeId","data-v-8ceb4809"]]);export{ue as default};
