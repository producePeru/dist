import{P as ee,g as ae,l as te,u as oe,r as g,a as se,n as ne,b as _,o as l,d as q,e as h,t as le,i as c,c as u,B as i,w as m,F as E,h as w,m as D,f as re,v as ue,s as d,K as ie,L as de,R as ce,j as N,p as me,k as pe}from"./index-dabf2cf0.js";import"./es-6ea6a8ae.js";import{d as ve,g as _e,f as be,o as ye,h as fe}from"./selects-0563509c.js";import{_ as ge}from"./_plugin-vue_export-helper-c27b6911.js";const he={document_type:{type:"iSelect",label:"Tipo de documento",name:"document_type",required:!0,message:"Seleccionar tipo de documento",disabled:!0},document_number:{type:"iText",label:"Ingresar número",name:"document_number",required:!0,message:"Escribe número de documento",disabled:!1,max:8},last_name:{type:"iText",label:"Apellido paterno",name:"last_name",required:!0,message:"Escribe el apellido paterno"},middle_name:{type:"iText",label:"Apellido materno",name:"middle_name",required:!0,message:"Escribe el apellido materno"},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribe el nombre"},country_code:{type:"iSelectWrite",label:"País",name:"country_code",required:!0,message:"Seleccionar país"},email:{type:"iText",label:"Correo",name:"email",required:!0,email:"email",message:"Escribe el correo del usuario"},password:{type:"iPassword",label:"Contraseña",name:"password",required:!1,message:"Registra la contraseña"},office_code:{type:"iSelect",label:"Oficina",name:"office_code",required:!0,message:"Seleccionar un tipo"},sede_code:{type:"iSelect",label:"Sede donde labora",name:"sede_code",required:!0,message:"Seleccionar un tipo"},role:{type:"iSelect",label:"Tipo de usuario",name:"role",required:!0,message:"Seleccionar un tipo"},gender:{type:"iSelect",label:"Género",name:"gender",required:!1,message:"Seleccionar tipo de documento"}},Ue=[{value:"Nuevo Usuario"},{value:"Lista"}],ke=[{value:"Subir archivo"},{value:"Mis archivos"}];const A=U=>(me("data-v-290cb27a"),U=U(),pe(),U),Se={key:1,class:"user"},qe={class:"grid-item"},we={class:"roles"},De=A(()=>h("br",null,null,-1)),xe=A(()=>h("br",null,null,-1)),Te=A(()=>h("br",null,null,-1)),Ee="YYYY-MM-DD",Ne={__name:"NuevoUsuarios",setup(U){ee.locale("es");const x=ae.get("usuario"),k=te(),G=oe(),T=g(!0),S=g(!1),C=g([]),R=g([]),P=g(!1),I=g(!1),a=se({nick_name:null,birthdate:null,gender:null,is_disabled:0,phone_number:null,document_type:1,document_number:null,last_name:null,middle_name:null,name:null,country_code:173,email:null,password:null,office_code:null,sede_code:1,role:null,created_by:x,updated_by:x}),V=()=>{a.document_type=1,a.document_number=null,a.last_name=null,a.middle_name=null,a.middle_name=null,a.name=null,a.country_code=173,a.email=null,a.password=null,a.office_code=null,a.sede_code=1,a.role=null},p=g({drive:[],usuarios:[],rutaDigital:[]}),b=g({rutaDigital:!1,usuarios:!1,drive:!1}),F=o=>{p.value[o].length>0?b.value[o]=!0:b.value[o]=!1},z=async o=>{const t=Object.fromEntries(Object.entries(p.value).filter(([y,r])=>r.length>0)),f={id_user:o,created_by:x,views:t,exclusions:null};try{const y=await w({url:"/permission",method:"POST",data:f});D.success(y.message),G.push("/admin/usuarios/lista")}catch{D.error("No se pudo registrar este usuario")}finally{S.value=!1}},B=async()=>{const o=a;S.value=!0;try{const t=await w({url:"/register-user",method:"POST",data:o});await z(t.user_id)}catch{D.error("No se pudo registrar este usuario")}finally{S.value=!1}},j=()=>{D.error("Debes de completar todos los espacios requeridos")},M=async o=>{console.log("Hello",o)},Y=()=>{a.document_number=a.document_number.replace(/\D/g,"")},$=(o,t)=>{const f=o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(f)},W=async()=>{try{const{data:o}=await re({url:"/countries",method:"GET"});C.value=o}catch(o){console.error("Error de red:",o)}},H=async()=>{try{const{data:o}=await w({url:"/sedes",method:"GET"});R.value=o}catch(o){console.error("Error de red:",o)}},K=async()=>{var o,t,f,y,r,v;if(k.query.dni)try{const{data:n}=await w({url:`user/${k.query.dni}`,method:"GET"});a.document_number=n.document_number,I.value=!0,a.last_name=n.last_name,a.middle_name=n.middle_name,a.name=n.name,a.country_code=n.country_code,a.email=n.email,a.office_code=n.office_code,a.sede_code=n.sede_code,a.role=n.role,a.gender=n.gender,a.birthdate=n.birthdate,a.phone_number=n.phone_number,p.value=n.permission,((t=(o=p.value)==null?void 0:o.drive)==null?void 0:t.length)>=1&&(b.value.drive=!0),((y=(f=p.value)==null?void 0:f.usuarios)==null?void 0:y.length)>=1&&(b.value.usuarios=!0),((v=(r=p.value)==null?void 0:r.rutaDigital)==null?void 0:v.length)>=1&&(b.value.rutaDigital=!0),T.value=!1}catch(n){console.error("Error de red:",n)}else V(),T.value=!1};return ne(()=>{W(),H(),K()}),(o,t)=>{const f=_("a-divider"),y=_("a-spin"),r=_("a-select"),v=_("a-form-item"),n=_("a-input-search"),L=_("a-input"),Z=_("a-date-picker"),J=_("a-button"),Q=_("a-form"),O=_("a-checkbox");return l(),q(E,null,[h("h3",null,le(c(k).query.dni?"ACTUALIZAR":"REGISTRO DE")+" USUARIO",1),u(f),T.value?(l(),i(y,{key:0})):(l(),q("div",Se,[u(Q,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:B,onFinishFailed:j},{default:m(()=>[h("div",qe,[(l(!0),q(E,null,ue(c(he),(e,X)=>(l(),q(E,{key:X},[e.type==="iSelect"?(l(),i(v,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:m(()=>[e.name=="document_type"?(l(),i(r,{key:0,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:c(ve),disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),e.name=="gender"?(l(),i(r,{key:1,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:c(_e)},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="isDisabled"?(l(),i(r,{key:2,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:c(be)},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="office_code"?(l(),i(r,{key:3,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:c(ye)},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="sede_code"?(l(),i(r,{key:4,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:R.value},null,8,["value","onUpdate:value","options"])):d("",!0),e.name=="role"?(l(),i(r,{key:5,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,options:c(fe)},null,8,["value","onUpdate:value","options"])):d("",!0)]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iSearch"?(l(),i(v,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:m(()=>[u(n,{maxlength:15,loading:P.value,value:a[e.name],"onUpdate:value":s=>a[e.name]=s,onSearch:M,onInput:Y,disabled:I.value},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iText"?(l(),i(v,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email}]},{default:m(()=>[u(L,{value:a[e.name],"onUpdate:value":s=>a[e.name]=s},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iPassword"?ie((l(),i(v,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:m(()=>[u(L,{value:a[e.name],"onUpdate:value":s=>a[e.name]=s},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])),[[de,!c(k).query.dni]]):d("",!0),e.type==="iSelectWrite"?(l(),i(v,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:m(()=>[u(r,{value:a[e.name],"onUpdate:value":s=>a[e.name]=s,"show-search":"",options:C.value,"filter-option":$},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iDate"?(l(),i(v,{key:5,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:m(()=>[u(Z,{locale:c(ce),value:a.birthdate,"onUpdate:value":t[0]||(t[0]=s=>a.birthdate=s),style:{width:"100%"},format:Ee},null,8,["locale","value"])]),_:2},1032,["name","label","rules"])):d("",!0)],64))),128))]),u(v,null,{default:m(()=>[u(J,{type:"primary","html-type":"submit",loading:S.value},{default:m(()=>[N("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),h("section",we,[h("div",null,[u(O,{checked:b.value.drive,"onUpdate:checked":t[1]||(t[1]=e=>b.value.drive=e)},{default:m(()=>[N("Drive")]),_:1},8,["checked"]),u(r,{value:p.value.drive,"onUpdate:value":t[2]||(t[2]=e=>p.value.drive=e),mode:"multiple",style:{width:"100%"},placeholder:"Agrega vistas para este usuario",onChange:t[3]||(t[3]=e=>F("drive")),options:c(ke)},null,8,["value","options"])]),De,xe,h("div",null,[u(O,{checked:b.value.usuarios,"onUpdate:checked":t[4]||(t[4]=e=>b.value.usuarios=e)},{default:m(()=>[N("Usuarios")]),_:1},8,["checked"]),u(r,{value:p.value.usuarios,"onUpdate:value":t[5]||(t[5]=e=>p.value.usuarios=e),mode:"multiple",style:{width:"100%"},placeholder:"Agrega vistas para este usuario",onChange:t[6]||(t[6]=e=>F("usuarios")),options:c(Ue)},null,8,["value","options"])]),Te])]))],64)}}},Fe=ge(Ne,[["__scopeId","data-v-290cb27a"]]);export{Fe as default};
