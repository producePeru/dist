import{G as z,r as m,v as oe,u as re,a as de,l as ie,b as r,o as s,d as k,c as p,w as u,e as g,t as ue,i as x,B as o,F as E,f as N,h as B,m as U,z as ce,y as d,H as me,j as pe,p as be,k as _e}from"./index-eadd5391.js";import"./es-eb9ba457.js";import{d as ve,g as ye}from"./selects-1ceaf713.js";import{_ as fe}from"./_plugin-vue_export-helper-c27b6911.js";const ge={document_type:{type:"iSelect",label:"Tipo de documento",name:"document_type",required:!0,message:"Seleccionar tipo de documento",disabled:!0},number_document:{type:"iSearch",label:"Ingresar número",name:"number_document",required:!0,message:"Escribe número de documento",disabled:!0},last_name:{type:"iText",label:"Apellido Paterno",name:"last_name",required:!0,message:"Escribir apellido",disabled:!1},middle_name:{type:"iText",label:"Apellido Materno",name:"middle_name",required:!0,message:"Escribir apellido",disabled:!1},name:{type:"iText",label:"Nombres",name:"name",required:!0,message:"Escribir nombre",disabled:!1},department:{type:"iSelect",label:"Departamento",name:"department",required:!1,message:"Seleccionar departamento",disabled:!1},province:{type:"iSelect",label:"Provincia",name:"province",required:!1,message:"Seleccionar provincia",disabled:!1},district:{type:"iSelect",label:"Distrito",name:"district",required:!1,message:"Seleccionar distrito",disabled:!1},phone:{type:"iText",label:"Número Telefónico del contacto",name:"phone",required:!1,message:"Número de contacto y 9 max",max:9,disabled:!1},email:{type:"iText",label:"Correo electrónico",name:"email",required:!1,message:"Número de contacto y 9 max",email:"email",disabled:!1},birthdate:{type:"iDate",label:"Fecha de nacimiento",name:"birthdate",required:!1,message:"Seleccionar fecha",disabled:!1},gender:{type:"iSelect",label:"Género",name:"gender",required:!1,message:"Seleccionar tipo de documento"},lession:{type:"iSelect",label:"¿Tiene discapacidad?",name:"lession",required:!1,message:"Seleccionar un tipo"}};const M=h=>(be("data-v-e696def5"),h=h(),_e(),h),he=M(()=>g("br",null,null,-1)),qe={class:"uppercase"},Se=M(()=>g("br",null,null,-1)),ke={key:1,class:"agreement-wrapper"},xe={class:"grid-item"},R="YYYY-MM-DD",Ue={__name:"ActualizarPersona",setup(h){z.locale("es");const w=JSON.parse(localStorage.getItem("user")),i=m(ge),_=oe(),q=re(),D=m(null),C=m(!0),V=m(!1),T=m(!1),A=m([]),S=m([]),y=m([]),Y=[{label:"DNI",value:"dni"},{label:"CE",value:"ce"},{label:"PAS",value:"pas"},{label:"PTP",value:"ptp"}],a=de({document_type:"dni",number_document:null,last_name:null,middle_name:null,name:null,department:null,province:null,district:null,phone:null,email:null,birthdate:null,gender:null,lession:null,created_by:w.id,update_by:w.id,post:_.query.access}),P=()=>{a.document_type=null,a.number_document=null,a.last_name=null,a.middle_name=null,a.name=null,a.department=null,a.province=null,a.district=null,a.phone=null,a.email=null},$=()=>{i.value.document_type.disabled=!0,i.value.number_document.disabled=!0,i.value.name.disabled=!0,i.value.department.disabled=!0,i.value.province.disabled=!0,i.value.district.disabled=!0,i.value.phone.disabled=!0,i.value.email.disabled=!0},L=()=>{a.number_document=a.number_document.replace(/\D/g,"")},j=async()=>{},O=t=>{P(),$(),a.document_type=t},H=(t,n)=>{a.province=null,a.district=null,S.value=[],y.value=[],I(n.value)},J=(t,n)=>{a.district=null,y.value=[],G(n.value)},F=()=>{if(_.query.dni){const t={dni:_.query.dni};q.push({name:"asesorias-formalizaciones",query:t})}else{const t=_.query.access;t==1&&q.push("/admin/asesorias/supervisores"),t==2&&q.push("/admin/asesorias/asesores"),t==3&&q.push("/admin/asesorias/solicitantes")}},Z=async()=>{try{const{data:t}=await N({url:"/departaments",method:"GET"});let n=t.map(c=>({label:c.label,value:c.id}));A.value=[...A.value,...n]}catch(t){console.log(t)}},I=async t=>{try{const{data:n}=await N({url:`/province/${t}`,method:"GET"});let c=n.map(b=>({label:b.label,value:b.id}));S.value=[...S.value,...c]}catch(n){console.log(n)}},G=async t=>{try{const{data:n}=await N({url:`/district/${t}`,method:"GET"});let c=n.map(b=>({label:b.label,value:b.id}));y.value=[...y.value,...c]}catch(n){console.log(n)}},K=async()=>{const t=a;T.value=!0;try{await B({url:"/new-person",method:"POST",data:t})&&(P(),F(),U.success("Usuario actualizado exitosamente."))}catch(n){if(n.response.status==550)return U.error("El usuario ya se encuentra registrado");U.error("Error al registrar")}finally{T.value=!1}},Q=()=>{U.error("Debes de completar todos los espacios requeridos")},W=async()=>{try{const{data:t}=await B({url:`/person-by-dni/${_.query.dni}`,method:"GET"});I(t.department),G(t.province),a.document_type=t.document_type,a.number_document=t.number_document,a.last_name=t.last_name,a.middle_name=t.middle_name,a.name=t.name,a.department=t.department,a.province=t.province,a.district=t.district,a.phone=t.phone,a.email=t.email,a.gender=t.gender,a.lession=t.lession,t.birthdate&&(D.value=z(t.birthdate,R)),C.value=!1}catch(t){console.error("Error de red:",t)}};return ie(()=>{Z(),W()}),(t,n)=>{const c=r("a-breadcrumb-item"),b=r("a-breadcrumb"),X=r("a-spin"),v=r("a-select"),f=r("a-form-item"),ee=r("a-input-search"),ae=r("a-input"),te=r("a-date-picker"),ne=r("a-button"),le=r("a-form");return s(),k(E,null,[p(b,null,{default:u(()=>[p(c,null,{default:u(()=>[g("a",{onClick:F},"Atrás")]),_:1})]),_:1}),he,g("h3",qe,"ACTUALIZAR "+ue(x(_).query.rol),1),Se,C.value?(s(),o(X,{key:0})):(s(),k("div",ke,[p(le,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:K,onFinishFailed:Q},{default:u(()=>[g("div",xe,[(s(!0),k(E,null,ce(i.value,(e,se)=>(s(),k(E,{key:se},[e.type==="iSelect"?(s(),o(f,{key:0,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:u(()=>[e.name=="document_type"?(s(),o(v,{key:0,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:Y,disabled:e.disabled,onChange:O},null,8,["value","onUpdate:value","disabled"])):d("",!0),e.name=="department"?(s(),o(v,{key:1,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:A.value,onChange:H,disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),e.name=="province"?(s(),o(v,{key:2,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:S.value,onChange:J,disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),e.name=="district"?(s(),o(v,{key:3,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:y.value,disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),e.name=="lession"?(s(),o(v,{key:4,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:x(ve),disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),e.name=="gender"?(s(),o(v,{key:5,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,options:x(ye),disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):d("",!0)]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iSearch"?(s(),o(f,{key:1,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:u(()=>[p(ee,{maxlength:15,loading:V.value,value:a[e.name],"onUpdate:value":l=>a[e.name]=l,"enter-button":"",onSearch:j,onInput:L,disabled:e.disabled},null,8,["loading","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iText"?(s(),o(f,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,type:e.email,max:e.max}]},{default:u(()=>[p(ae,{value:a[e.name],"onUpdate:value":l=>a[e.name]=l,disabled:e.disabled},null,8,["value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):d("",!0),e.type==="iDate"?(s(),o(f,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:u(()=>[p(te,{locale:x(me),value:D.value,"onUpdate:value":n[0]||(n[0]=l=>D.value=l),style:{width:"100%"},format:R,disabled:e.disabled},null,8,["locale","value","disabled"])]),_:2},1032,["name","label","rules"])):d("",!0)],64))),128))]),p(f,null,{default:u(()=>[p(ne,{type:"primary","html-type":"submit",loading:T.value},{default:u(()=>[pe("GUARDAR")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]))],64)}}},Ne=fe(Ue,[["__scopeId","data-v-e696def5"]]);export{Ne as default};
