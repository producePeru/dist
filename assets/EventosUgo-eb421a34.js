import{p as b,r as R,E as j,a as G,U as g,k as H,b as m,o as l,y as o,w as c,e as Z,d as w,F as C,v as J,c as _,z as d,i as y,M as K,j as Q,t as X,m as ee,h as A}from"./index-ee09c546.js";import{u as ae}from"./selectes-5d6f0a7a.js";import"./es-e24fa9d4.js";const te={class:"form-attendance"},se="DD/MM/YYYY",ne={__name:"EventosUgo",props:["dataRow"],emits:["closeDraw"],setup(S,{emit:L}){b.locale("es");const i=ae();i.$patch({cities:i.cities}),i.$patch({provinces:i.provinces}),i.$patch({districts:i.districts}),i.fetchCities(),i.fetchAsesores();const h=R(!1),v=S,q=L;j();const e=G({}),p=R({eventsoffice_id:{type:"iSelect",label:"TIPO DE EVENTO",name:"eventsoffice_id",required:!0,message:"Seleccionar un tipo",disabled:!0},title:{type:"iText",label:"NOMBRE DE LA ACTIVIDAD DEL EVENTO",name:"title",required:!0,message:"Escribir el nombre de la Feria",disabled:!0,max:100},startDate:{type:"iDate",label:"FECHA INICIO DE LA ACTIVIDAD",name:"startDate",required:!0,message:"Seleccionar fecha de Inicio",disabled:!1},endDate:{type:"iDate",label:"FECHA CIERRE DE LA ACTIVIDAD",name:"endDate",required:!0,message:"Seleccionar fecha de Fin",disabled:!1,placeholder:"Ejemplo: Lunes 20 de enero"},modality:{type:"iSelect",label:"MODALIDAD DEL EVENTO",name:"modality",required:!0,message:"Seleccionar una opción",disabled:!0},city_id:{type:"iSelectWrite",label:"REGIÓN DEL EVENTO",name:"city_id",required:!0,message:"Seleccionar región",disabled:!1},province_id:{type:"iSelectWrite",label:"PROVINCIA DEL EVENTO",name:"province_id",required:!0,message:"Seleccionar provincia",disabled:!1},district_id:{type:"iSelectWrite",label:"DISTRITO DEL EVENTO",name:"district_id",required:!0,message:"Seleccionar distrito",disabled:!1},address:{type:"iText",label:"LUGAR DEL EVENTO",name:"address",required:!0,message:"Escribir lugar del evento",disabled:!0,max:100,placeholder:"Ejemplo: Av. Los Incas 1234 - San Miguel"},people_id:{type:"iSelectWrite",label:"ASESOR - RESPONSABLE",name:"people_id",required:!0,message:"Seleccionar al asesor",disabled:!0},description:{type:"iTextarea",label:"DETALLE DEL EVENTO",name:"description",required:!1,message:"Escribir detalles",disabled:!0}}),N=[{label:"PRESENCIAL",value:"p"},{label:"VIRTUAL",value:"v"}],O={hora:{type:"iText",label:"TEMA DE LA CAPACITACIÓN",name:"hora",required:!0,message:"Escribir tema de la capacitación",disabled:!0,max:100,placeholder:""}},T=(t,n)=>{if(t=="eventsoffice_id")if(n==3)p.value={...p.value,...O};else{const{hora:u,...r}=p.value;p.value=r}};g(()=>e.startDate,t=>{e.endDate&&new Date(t)>new Date(e.endDate)&&(e.endDate=null)}),g(()=>e.endDate,t=>{e.startDate&&new Date(t)<new Date(e.startDate)&&(e.startDate=null)});const f=(t,n)=>{const u=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return n.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(u)},M=t=>{if(t=="modality")return N;if(t=="powerBy")return pertenece;if(t=="fairtype_id")return typeFair;if(t=="eventsoffice_id")return Y()},Y=()=>[{value:1,label:"DESPEGA TU EMPRESA"},{value:8,label:"DIFUSIÓN"},{value:3,label:"FORTALECE TU MERCADO"},{value:5,label:"POTENCIA TU EMPRESA"}],I=t=>{e.province_id=null,e.district_id=null,i.fetchProvinces(t)},U=t=>{e.district_id=null,i.fetchDistricts(t)},E=()=>{e.eventsoffice_id=null,e.title=null,e.startDate=null,e.endDate=null,e.modality=null,e.city_id=null,e.province_id=null,e.district_id=null,e.address=null,e.people_id=null,e.description=null,e.hora=null;const{fecha:t,hora:n,...u}=p.value;p.value=u},k=async()=>{h.value=!0;const t={eventsoffice_id:e.eventsoffice_id,title:e.title,startDate:b(e.startDate).format("YYYY-MM-DD"),endDate:b(e.endDate).format("YYYY-MM-DD"),modality:e.modality,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,address:e.address,fecha:e.fecha,hora:e.hora,asesorId:e.people_id,description:e.description};try{const n=v.dataRow?"PUT":"POST",u=v.dataRow?`attendance/update/${v.dataRow.id}`:"attendance/create",r=await ee({url:u,method:n,data:t});r.status==200&&(A.success(r.message),q("closeDraw"),E()),r.status==500&&(A.error(r.message),E())}catch(n){A.error("Se presentó un error, los valores son requeridos",n)}finally{h.value=!1}},V=t=>{const n=e[t]?e[t].trim():"";e[t]=n};function x(t){e.eventsoffice_id=t.id_pnte,e.title=t.title,e.startDate=t.startDate?b(t.startDate,"DD/MM/YYYY"):null,e.endDate=t.endDate?b(t.endDate,"DD/MM/YYYY"):null,e.modality=t.modality,e.city_id=t.city_id,I(t.city_id),e.province_id=t.province_id,U(t.province_id),e.district_id=t.district_id,e.address=t.address,e.fecha=t.fecha,e.hora=t.hora,e.people_id=t==null?void 0:t.people_id,e.description=t.description,T("eventsoffice_id",t.id_pnte)}return H(()=>{v.dataRow&&x(v.dataRow)}),g(()=>v.dataRow,t=>{t?x(t):E()}),(t,n)=>{const u=m("a-input"),r=m("a-form-item"),D=m("a-select"),F=m("a-textarea"),P=m("a-input-number"),B=m("a-date-picker"),z=m("a-button"),W=m("a-form");return l(),o(W,{layout:"vertical",model:e,name:"basic",autocomplete:"off",onFinish:k},{default:c(()=>[Z("div",te,[(l(!0),w(C,null,J(p.value,(a,$)=>(l(),w(C,{key:$},[a.type==="iText"?(l(),o(r,{key:0,name:a.name,label:a.label,rules:[{required:a.required,message:a.message,max:a.max}]},{default:c(()=>[_(u,{value:e[a.name],"onUpdate:value":s=>e[a.name]=s,maxlength:a.max,onBlur:s=>V(a.name),placeholder:a.placeholder},null,8,["value","onUpdate:value","maxlength","onBlur","placeholder"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iSelect"?(l(),o(r,{key:1,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:c(()=>[_(D,{value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:M(a.name),onChange:s=>T(a.name,s)},null,8,["value","onUpdate:value","options","onChange"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iTextarea"?(l(),o(r,{key:2,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:c(()=>[_(F,{value:e[a.name],"onUpdate:value":s=>e[a.name]=s,rows:8,maxlength:a.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iNumber"?(l(),o(r,{key:3,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:c(()=>[_(P,{value:e[a.name],"onUpdate:value":s=>e[a.name]=s,min:1,max:500,style:{width:"100%"}},null,8,["value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iDate"?(l(),o(r,{key:4,name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:c(()=>[_(B,{locale:y(K),value:e[a.name],"onUpdate:value":s=>e[a.name]=s,style:{width:"100%"},format:se,placeholder:"día/mes/año"},null,8,["locale","value","onUpdate:value"])]),_:2},1032,["name","label","rules"])):d("",!0),a.type==="iSelectWrite"?(l(),o(r,{key:5,class:"item-max",name:a.name,label:a.label,rules:[{required:a.required,message:a.message}]},{default:c(()=>[a.name=="city_id"?(l(),o(D,{key:0,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:y(i).cities,"show-search":"","filter-option":f,onChange:I},null,8,["value","onUpdate:value","options"])):d("",!0),a.name=="province_id"?(l(),o(D,{key:1,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:y(i).provinces,"show-search":"","filter-option":f,onChange:U,disabled:!e.city_id},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),a.name=="district_id"?(l(),o(D,{key:2,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:y(i).districts,"show-search":"","filter-option":f,disabled:!e.province_id},null,8,["value","onUpdate:value","options","disabled"])):d("",!0),a.name=="people_id"?(l(),o(D,{key:3,value:e[a.name],"onUpdate:value":s=>e[a.name]=s,options:y(i).asesores,"show-search":"","filter-option":f},null,8,["value","onUpdate:value","options"])):d("",!0)]),_:2},1032,["name","label","rules"])):d("",!0)],64))),128))]),_(r,null,{default:c(()=>[_(z,{type:"primary","html-type":"submit",loading:h.value},{default:c(()=>[Q(X(S.dataRow?"ACTUALIZAR":"GUARDAR"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])}}};export{ne as _};
