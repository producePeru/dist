import{l as H,z as X,r as v,a as J,b,o as l,d as h,e as f,c as i,w as s,G as Q,H as ee,F as O,f as N,M as C,p as _,t as U,s as ae,y as u,x as c,h as L,E as te,i as y,m as T}from"./index-e53dd249.js";import{u as ne}from"./selectes-ed8b675a.js";import{F as oe}from"./FormalizacionFooter-7bc3853d.js";import"./es-0ea6c240.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./EnvironmentOutlined-c5f73230.js";const re={class:"attendance"},se={class:"container"},le={class:"attendance-section"},ie={class:"attendance-title"},de={class:"qr-form"},me={key:0,class:"qr-title"},ue={key:9},ce="DD/MM/YYYY",Ee={__name:"ValoracionNotarias",setup(pe){H.locale("es"),X();const m=ne();m.$patch({typeDocuments:m.typeDocuments}),m.$patch({economicSectors:m.economicSectors}),m.$patch({genders:m.genders}),m.fetchEconomicSectors(),m.fetchTypeDocuments(),m.fetchGenders(),v(!1),v(!0);const k=v(null),D=v(!1),w=v(!1),S=v(!1),a=J({}),M=[{value:"si",label:"SI"},{value:"no",label:"NO"}],P=n=>{if(n==="country_id")return m.countries;if(n==="gender_id")return m.genders;if(n==="sick")return M;if(n==="typedocument_id")return m.typeDocuments},p=v({title1:{type:"iTittle",label:"DATOS DEL USUARIO"},typedocument_id:{type:"iSelect",label:"TIPO DE DOCUMENTO DE IDENTIDAD",name:"typedocument_id",required:!0,message:"Seleccionar tipo",disabled:!1},documentnumber:{type:"iSearch",label:"INGRESE NÚMERO DE IDENTIDAD",name:"documentnumber",required:!0,message:"Escribir tu número de documento",disabled:!0,max:11},nationality:{type:"iText",label:"NACIONALIDAD",name:"nationality",required:!0,message:"Escribir nacionalidad",disabled:!1,max:50},name:{type:"iText",label:"NOMBRES",name:"name",required:!0,message:"Escribir nombre",disabled:!0,max:80},lastname:{type:"iText",label:"APELLIDO PATERNO",name:"lastname",required:!0,message:"Escribir nombre",disabled:!0,max:80},middlename:{type:"iText",label:"APELLIDO MATERNO",name:"middlename",required:!0,message:"Escribir nombre",disabled:!0,max:80},phone:{type:"iText",label:"NÚMERO DE CELULAR",name:"phone",required:!1,message:"Escribe tu num. de celular",disabled:!1,max:9},email:{type:"iText",label:"CORREO ELECTRÓNICO",name:"email",required:!1,message:"Ingresar email",email:"email",disabled:!1,max:150},economicsector_id:{type:"iSelectWrite",label:"SECTOR ECONÓMICO",name:"economicsector_id",required:!1,message:"Seleccionar sector económnico",disabled:!1},title2:{type:"iTittle",label:"DATOS DEL TRAMITE"},motivo:{type:"iRadio",label:"1. EL MOTIVO DE SU VISITA ES PARA REALIZAR EL TRÁMITE DE:",name:"motivo",required:!0,message:"Escoger opción",disabled:!0,other:!1},notary:{type:"iText",label:"2. ¿CUÁL ES EL NOMBRE DE LA NOTARIA?",name:"notary",required:!0,message:"Escribir nombre de la notaría",disabled:!1,max:150},califica:{type:"iRadio",label:"3. ¿CÓMO CALIFICARÍA LA ATENCIÓN?",name:"califica",required:!0,message:"Escoger opción",disabled:!0,other:!1}}),V=(n,t)=>{if(!t)return Promise.reject("La fecha es requerida");const o=new Date,d=new Date(t);let E=o.getFullYear()-d.getFullYear();const x=o.getMonth()-d.getMonth();return(x<0||x===0&&o.getDate()<d.getDate())&&E--,E<18||E>99?Promise.reject("La edad debe estar entre 18 y 99 años"):Promise.resolve()},B=(n,t)=>{if(n.field==="phone"){const o=/^9\d{8}$/;if(t){if(!o.test(t))return Promise.reject("El número debe empezar con 9 y tener exactamente 9 dígitos")}}return Promise.resolve()},F=n=>{const t=a[n]?a[n].trim():"";a[n]=t},z=n=>{n=="typedocument_id"&&(a.documentnumber=null,a.name=null,a.lastname=null,a.middlename=null,a.typedocument_id!=1?(p.value.name.disabled=!1,p.value.lastname.disabled=!1,p.value.middlename.disabled=!1):(p.value.name.disabled=!0,p.value.lastname.disabled=!0,p.value.middlename.disabled=!0))},$=(n,t)=>{const o=a.typedocument_id;return/^\d+$/.test(t)?o===1&&t.length!==8?Promise.reject("Debe tener exactamente 8 caracteres."):o!==1&&t.length>12?Promise.reject("Debe tener exactamente 12 caracteres."):(o===1&&t.startsWith("0")&&t.length===8,Promise.resolve()):Promise.reject("Solo se permiten números.")},j=async()=>{const{typedocument_id:n,documentnumber:t}=a;if(!n||!t){T.error("El tipo de documento y el número de documento no pueden estar vacíos.");return}if(!/^\d+$/.test(t)){T.error("El número de documento solo debe contener caracteres numéricos.");return}if(n===1&&t.length!==8){T.error("El número de documento debe tener exactamente 8 caracteres para el tipo de documento DNI.");return}try{if(D.value=!0,a.typedocument_id==1){p.value.name.disabled=!0,p.value.lastname.disabled=!0,p.value.middlename.disabled=!0;const o=await N({url:`public/search-api-dni/${a.documentnumber}`,method:"GET"});o.status==200&&(a.name=o.data.name,a.lastname=o.data.lastname,a.middlename=o.data.middlename,a.nationality="PERUANO")}}catch(o){console.error("Error de red:",o),T.error("Error al procesar ese dato")}finally{D.value=!1}},R=(n,t)=>{const o=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.label.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)},q=()=>{a.typedocument_id=null,a.documentnumber=null,a.nationality=null,a.name=null,a.lastname=null,a.middlename=null,a.phone=null,a.email=null,a.economicsector_id=null,a.motivo=null,a.notary=null,a.califica=null},G=async()=>{S.value=!0;const n={typedocument_id:a.typedocument_id,documentnumber:a.documentnumber,nationality:a.nationality,name:a.name,lastname:a.lastname,middlename:a.middlename,phone:a.phone,email:a.email,economicsector_id:a.economicsector_id,motivo:a.motivo,notary:a.notary,califica:a.califica};try{const t=await N({url:"public/valorization-notary",method:"POST",data:n});t.status==200&&C.success({title:"¡Tus datos han sido enviados con éxito!",content:_("div",{class:"modal-content"},[_("div",{class:"modal-image"},[_("img",{src:"https://static.vecteezy.com/system/resources/thumbnails/010/872/413/small/3d-message-sent-successfully-icon-png.png",alt:"Éxito",class:"success-image"})]),_("p",{class:"modal-message"},"¡Gracias por enviar tus datos! Estamos procesando tu solicitud.")]),onOk(){q(),window.scrollTo({top:0,behavior:"smooth"})},class:"attendance-modal"}),t.status==400&&C.warning({title:"REGISTRO AVISO",content:_("div",{},[_("p",t.message)]),onOk(){q(),window.scrollTo({top:0,behavior:"smooth"})},class:"attendance-modal"})}catch(t){console.error("Error de red:",t)}finally{S.value=!1}};return(n,t)=>{const o=b("a-input-search"),d=b("a-form-item"),E=b("a-input"),x=b("a-date-picker"),A=b("a-select"),Y=b("a-textarea"),g=b("a-radio"),I=b("a-radio-group"),W=b("a-button"),K=b("a-form");return l(),h(O,null,[f("div",re,[f("div",se,[f("section",le,[i(K,{layout:"vertical",model:a,name:"basic",autocomplete:"off",onFinish:G,onKeydown:t[0]||(t[0]=Q(ee(()=>{},["prevent"]),["enter"]))},{default:s(()=>[f("div",ie,[t[1]||(t[1]=f("h2",null,"VALORIZACIÓN",-1)),f("h3",null,U(k.value),1)]),f("div",de,[(l(!0),h(O,null,ae(p.value,(e,Z)=>(l(),h(O,{key:Z},[e.type==="iTittle"?(l(),h("div",me,[f("h4",null,U(e.label),1)])):u("",!0),e.type==="iSearch"?(l(),c(d,{key:1,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,validator:$}]},{default:s(()=>[i(o,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,placeholder:"","enter-button":"BUSCAR",loading:D.value,maxlength:a.typedocument_id===1?8:12,onSearch:j},null,8,["value","onUpdate:value","loading","maxlength"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSearchRuc"?(l(),c(d,{key:2,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max},{pattern:/^(10|15|20)\d{9,}$/,message:"El número debe comenzar con 10, 15 o 20, tener solo números, y al menos 11 caracteres"}]},{default:s(()=>[i(o,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,placeholder:"Ingresar RUC","enter-button":"BUSCAR",loading:w.value,maxlength:e.max,onSearch:n.handleSearchRUCC,disabled:e.disabled},null,8,["value","onUpdate:value","loading","maxlength","onSearch","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iText"?(l(),c(d,{key:3,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max},{validator:B}]},{default:s(()=>[i(E,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,maxlength:e.max,onBlur:r=>F(e.name),disabled:e.disabled},null,8,["value","onUpdate:value","maxlength","onBlur","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iDate"?(l(),c(d,{key:4,name:e.name,label:e.label,rules:[{required:e.required,message:e.message},{validator:V,message:"La edad debe estar entre 18 y 99 años"}]},{default:s(()=>[i(x,{locale:L(te),value:a[e.name],"onUpdate:value":r=>a[e.name]=r,style:{width:"100%"},format:ce,placeholder:"día/mes/año",disabled:e.disabled},null,8,["locale","value","onUpdate:value","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSelect"?(l(),c(d,{key:5,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[i(A,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,options:P(e.name),"show-search":"","filter-option":R,onChange:r=>z(e.name),disabled:e.disabled},null,8,["value","onUpdate:value","options","onChange","disabled"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iTextarea"?(l(),c(d,{key:6,name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[i(Y,{value:a[e.name],"onUpdate:value":r=>a[e.name]=r,rows:4,maxlength:e.max},null,8,["value","onUpdate:value","maxlength"])]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iSelectWrite"?(l(),c(d,{key:7,class:"item-max",name:e.name,label:e.label,rules:[{required:e.required,message:e.message}]},{default:s(()=>[e.name=="economicsector_id"?(l(),c(A,{key:0,value:a[e.name],"onUpdate:value":r=>a[e.name]=r,"show-search":"",options:L(m).economicSectors,"filter-option":R,disabled:e.disabled},null,8,["value","onUpdate:value","options","disabled"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="iRadio"?(l(),c(d,{key:8,name:e.name,label:e.label,rules:[{required:e.required,message:e.message,max:e.max}]},{default:s(()=>[e.name=="motivo"?(l(),c(I,{key:0,class:"qr-califica",value:a[e.name],"onUpdate:value":r=>a[e.name]=r,name:e.name},{default:s(()=>[i(g,{value:"reserva",class:"qr-radio"},{default:s(()=>t[2]||(t[2]=[y("RESERVA DE NOMBRE")])),_:1}),i(g,{value:"acto",class:"qr-radio"},{default:s(()=>t[3]||(t[3]=[y("ACTO CONSTITUTIVO")])),_:1})]),_:2},1032,["value","onUpdate:value","name"])):u("",!0),e.name=="califica"?(l(),c(I,{key:1,class:"qr-califica",value:a[e.name],"onUpdate:value":r=>a[e.name]=r,name:e.name},{default:s(()=>[i(g,{value:"4",class:"qr-radio"},{default:s(()=>t[4]||(t[4]=[y("EXCELENTE")])),_:1}),i(g,{value:"3",class:"qr-radio"},{default:s(()=>t[5]||(t[5]=[y("BUENO")])),_:1}),i(g,{value:"2",class:"qr-radio"},{default:s(()=>t[6]||(t[6]=[y("REGULAR")])),_:1}),i(g,{value:"1",class:"qr-radio"},{default:s(()=>t[7]||(t[7]=[y("MALO")])),_:1})]),_:2},1032,["value","onUpdate:value","name"])):u("",!0)]),_:2},1032,["name","label","rules"])):u("",!0),e.type==="space1"?(l(),h("div",ue)):u("",!0)],64))),128))]),i(d,null,{default:s(()=>[i(W,{type:"primary","html-type":"submit",loading:S.value,class:"attendance-btn"},{default:s(()=>t[8]||(t[8]=[y("ENVIAR")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])]),i(oe)],64)}}};export{Ee as default};
